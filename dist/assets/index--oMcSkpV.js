var uy=Object.defineProperty;var dy=(e,t,s)=>t in e?uy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var ke=(e,t,s)=>dy(e,typeof t!="symbol"?t+"":t,s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=s(r);fetch(r.href,a)}})();function hy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var wg={exports:{}},ml={},jg={exports:{}},we={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ra=Symbol.for("react.element"),fy=Symbol.for("react.portal"),my=Symbol.for("react.fragment"),gy=Symbol.for("react.strict_mode"),py=Symbol.for("react.profiler"),xy=Symbol.for("react.provider"),yy=Symbol.for("react.context"),vy=Symbol.for("react.forward_ref"),by=Symbol.for("react.suspense"),wy=Symbol.for("react.memo"),jy=Symbol.for("react.lazy"),ch=Symbol.iterator;function _y(e){return e===null||typeof e!="object"?null:(e=ch&&e[ch]||e["@@iterator"],typeof e=="function"?e:null)}var _g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ng=Object.assign,kg={};function $r(e,t,s){this.props=e,this.context=t,this.refs=kg,this.updater=s||_g}$r.prototype.isReactComponent={};$r.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};$r.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Sg(){}Sg.prototype=$r.prototype;function Bu(e,t,s){this.props=e,this.context=t,this.refs=kg,this.updater=s||_g}var Hu=Bu.prototype=new Sg;Hu.constructor=Bu;Ng(Hu,$r.prototype);Hu.isPureReactComponent=!0;var uh=Array.isArray,Cg=Object.prototype.hasOwnProperty,Uu={current:null},Eg={key:!0,ref:!0,__self:!0,__source:!0};function Tg(e,t,s){var n,r={},a=null,o=null;if(t!=null)for(n in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(a=""+t.key),t)Cg.call(t,n)&&!Eg.hasOwnProperty(n)&&(r[n]=t[n]);var l=arguments.length-2;if(l===1)r.children=s;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps,l)r[n]===void 0&&(r[n]=l[n]);return{$$typeof:ra,type:e,key:a,ref:o,props:r,_owner:Uu.current}}function Ny(e,t){return{$$typeof:ra,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Vu(e){return typeof e=="object"&&e!==null&&e.$$typeof===ra}function ky(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(s){return t[s]})}var dh=/\/+/g;function Fl(e,t){return typeof e=="object"&&e!==null&&e.key!=null?ky(""+e.key):t.toString(36)}function so(e,t,s,n,r){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(a){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case ra:case fy:o=!0}}if(o)return o=e,r=r(o),e=n===""?"."+Fl(o,0):n,uh(r)?(s="",e!=null&&(s=e.replace(dh,"$&/")+"/"),so(r,t,s,"",function(u){return u})):r!=null&&(Vu(r)&&(r=Ny(r,s+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(dh,"$&/")+"/")+e)),t.push(r)),1;if(o=0,n=n===""?".":n+":",uh(e))for(var l=0;l<e.length;l++){a=e[l];var c=n+Fl(a,l);o+=so(a,t,s,c,r)}else if(c=_y(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=n+Fl(a,l++),o+=so(a,t,s,c,r);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function ma(e,t,s){if(e==null)return e;var n=[],r=0;return so(e,n,"","",function(a){return t.call(s,a,r++)}),n}function Sy(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(s){(e._status===0||e._status===-1)&&(e._status=1,e._result=s)},function(s){(e._status===0||e._status===-1)&&(e._status=2,e._result=s)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var _t={current:null},no={transition:null},Cy={ReactCurrentDispatcher:_t,ReactCurrentBatchConfig:no,ReactCurrentOwner:Uu};function Lg(){throw Error("act(...) is not supported in production builds of React.")}we.Children={map:ma,forEach:function(e,t,s){ma(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return ma(e,function(){t++}),t},toArray:function(e){return ma(e,function(t){return t})||[]},only:function(e){if(!Vu(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};we.Component=$r;we.Fragment=my;we.Profiler=py;we.PureComponent=Bu;we.StrictMode=gy;we.Suspense=by;we.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cy;we.act=Lg;we.cloneElement=function(e,t,s){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Ng({},e.props),r=e.key,a=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,o=Uu.current),t.key!==void 0&&(r=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Cg.call(t,c)&&!Eg.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=s;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];n.children=l}return{$$typeof:ra,type:e.type,key:r,ref:a,props:n,_owner:o}};we.createContext=function(e){return e={$$typeof:yy,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:xy,_context:e},e.Consumer=e};we.createElement=Tg;we.createFactory=function(e){var t=Tg.bind(null,e);return t.type=e,t};we.createRef=function(){return{current:null}};we.forwardRef=function(e){return{$$typeof:vy,render:e}};we.isValidElement=Vu;we.lazy=function(e){return{$$typeof:jy,_payload:{_status:-1,_result:e},_init:Sy}};we.memo=function(e,t){return{$$typeof:wy,type:e,compare:t===void 0?null:t}};we.startTransition=function(e){var t=no.transition;no.transition={};try{e()}finally{no.transition=t}};we.unstable_act=Lg;we.useCallback=function(e,t){return _t.current.useCallback(e,t)};we.useContext=function(e){return _t.current.useContext(e)};we.useDebugValue=function(){};we.useDeferredValue=function(e){return _t.current.useDeferredValue(e)};we.useEffect=function(e,t){return _t.current.useEffect(e,t)};we.useId=function(){return _t.current.useId()};we.useImperativeHandle=function(e,t,s){return _t.current.useImperativeHandle(e,t,s)};we.useInsertionEffect=function(e,t){return _t.current.useInsertionEffect(e,t)};we.useLayoutEffect=function(e,t){return _t.current.useLayoutEffect(e,t)};we.useMemo=function(e,t){return _t.current.useMemo(e,t)};we.useReducer=function(e,t,s){return _t.current.useReducer(e,t,s)};we.useRef=function(e){return _t.current.useRef(e)};we.useState=function(e){return _t.current.useState(e)};we.useSyncExternalStore=function(e,t,s){return _t.current.useSyncExternalStore(e,t,s)};we.useTransition=function(){return _t.current.useTransition()};we.version="18.3.1";jg.exports=we;var j=jg.exports;const Ey=hy(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ty=j,Ly=Symbol.for("react.element"),Ay=Symbol.for("react.fragment"),My=Object.prototype.hasOwnProperty,Py=Ty.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ry={key:!0,ref:!0,__self:!0,__source:!0};function Ag(e,t,s){var n,r={},a=null,o=null;s!==void 0&&(a=""+s),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(o=t.ref);for(n in t)My.call(t,n)&&!Ry.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)r[n]===void 0&&(r[n]=t[n]);return{$$typeof:Ly,type:e,key:a,ref:o,props:r,_owner:Py.current}}ml.Fragment=Ay;ml.jsx=Ag;ml.jsxs=Ag;wg.exports=ml;var i=wg.exports,Lc={},Mg={exports:{}},It={},Pg={exports:{}},Rg={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(P,O){var A=P.length;P.push(O);e:for(;0<A;){var L=A-1>>>1,M=P[L];if(0<r(M,O))P[L]=O,P[A]=M,A=L;else break e}}function s(P){return P.length===0?null:P[0]}function n(P){if(P.length===0)return null;var O=P[0],A=P.pop();if(A!==O){P[0]=A;e:for(var L=0,M=P.length,I=M>>>1;L<I;){var $=2*(L+1)-1,Q=P[$],X=$+1,F=P[X];if(0>r(Q,A))X<M&&0>r(F,Q)?(P[L]=F,P[X]=A,L=X):(P[L]=Q,P[$]=A,L=$);else if(X<M&&0>r(F,A))P[L]=F,P[X]=A,L=X;else break e}}return O}function r(P,O){var A=P.sortIndex-O.sortIndex;return A!==0?A:P.id-O.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,v=!1,x=!1,y=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(P){for(var O=s(u);O!==null;){if(O.callback===null)n(u);else if(O.startTime<=P)n(u),O.sortIndex=O.expirationTime,t(c,O);else break;O=s(u)}}function b(P){if(x=!1,w(P),!v)if(s(c)!==null)v=!0,S(k);else{var O=s(u);O!==null&&V(b,O.startTime-P)}}function k(P,O){v=!1,x&&(x=!1,g(N),N=-1),m=!0;var A=f;try{for(w(O),h=s(c);h!==null&&(!(h.expirationTime>O)||P&&!q());){var L=h.callback;if(typeof L=="function"){h.callback=null,f=h.priorityLevel;var M=L(h.expirationTime<=O);O=e.unstable_now(),typeof M=="function"?h.callback=M:h===s(c)&&n(c),w(O)}else n(c);h=s(c)}if(h!==null)var I=!0;else{var $=s(u);$!==null&&V(b,$.startTime-O),I=!1}return I}finally{h=null,f=A,m=!1}}var E=!1,_=null,N=-1,U=5,B=-1;function q(){return!(e.unstable_now()-B<U)}function z(){if(_!==null){var P=e.unstable_now();B=P;var O=!0;try{O=_(!0,P)}finally{O?G():(E=!1,_=null)}}else E=!1}var G;if(typeof p=="function")G=function(){p(z)};else if(typeof MessageChannel<"u"){var C=new MessageChannel,W=C.port2;C.port1.onmessage=z,G=function(){W.postMessage(null)}}else G=function(){y(z,0)};function S(P){_=P,E||(E=!0,G())}function V(P,O){N=y(function(){P(e.unstable_now())},O)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(P){P.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,S(k))},e.unstable_forceFrameRate=function(P){0>P||125<P?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<P?Math.floor(1e3/P):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return s(c)},e.unstable_next=function(P){switch(f){case 1:case 2:case 3:var O=3;break;default:O=f}var A=f;f=O;try{return P()}finally{f=A}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(P,O){switch(P){case 1:case 2:case 3:case 4:case 5:break;default:P=3}var A=f;f=P;try{return O()}finally{f=A}},e.unstable_scheduleCallback=function(P,O,A){var L=e.unstable_now();switch(typeof A=="object"&&A!==null?(A=A.delay,A=typeof A=="number"&&0<A?L+A:L):A=L,P){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=A+M,P={id:d++,callback:O,priorityLevel:P,startTime:A,expirationTime:M,sortIndex:-1},A>L?(P.sortIndex=A,t(u,P),s(c)===null&&P===s(u)&&(x?(g(N),N=-1):x=!0,V(b,A-L))):(P.sortIndex=M,t(c,P),v||m||(v=!0,S(k))),P},e.unstable_shouldYield=q,e.unstable_wrapCallback=function(P){var O=f;return function(){var A=f;f=O;try{return P.apply(this,arguments)}finally{f=A}}}})(Rg);Pg.exports=Rg;var Dy=Pg.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oy=j,Ft=Dy;function ee(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Dg=new Set,Mi={};function Jn(e,t){Er(e,t),Er(e+"Capture",t)}function Er(e,t){for(Mi[e]=t,e=0;e<t.length;e++)Dg.add(t[e])}var Is=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ac=Object.prototype.hasOwnProperty,Fy=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,hh={},fh={};function zy(e){return Ac.call(fh,e)?!0:Ac.call(hh,e)?!1:Fy.test(e)?fh[e]=!0:(hh[e]=!0,!1)}function Iy(e,t,s,n){if(s!==null&&s.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:s!==null?!s.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function $y(e,t,s,n){if(t===null||typeof t>"u"||Iy(e,t,s,n))return!0;if(n)return!1;if(s!==null)switch(s.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Nt(e,t,s,n,r,a,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=r,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=o}var ht={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ht[e]=new Nt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ht[t]=new Nt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ht[e]=new Nt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ht[e]=new Nt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ht[e]=new Nt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ht[e]=new Nt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ht[e]=new Nt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ht[e]=new Nt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ht[e]=new Nt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Wu=/[\-:]([a-z])/g;function Xu(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Wu,Xu);ht[t]=new Nt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Wu,Xu);ht[t]=new Nt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Wu,Xu);ht[t]=new Nt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ht[e]=new Nt(e,1,!1,e.toLowerCase(),null,!1,!1)});ht.xlinkHref=new Nt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ht[e]=new Nt(e,1,!1,e.toLowerCase(),null,!0,!0)});function qu(e,t,s,n){var r=ht.hasOwnProperty(t)?ht[t]:null;(r!==null?r.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&($y(t,s,r,n)&&(s=null),n||r===null?zy(t)&&(s===null?e.removeAttribute(t):e.setAttribute(t,""+s)):r.mustUseProperty?e[r.propertyName]=s===null?r.type===3?!1:"":s:(t=r.attributeName,n=r.attributeNamespace,s===null?e.removeAttribute(t):(r=r.type,s=r===3||r===4&&s===!0?"":""+s,n?e.setAttributeNS(n,t,s):e.setAttribute(t,s))))}var Ws=Oy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ga=Symbol.for("react.element"),ir=Symbol.for("react.portal"),ar=Symbol.for("react.fragment"),Yu=Symbol.for("react.strict_mode"),Mc=Symbol.for("react.profiler"),Og=Symbol.for("react.provider"),Fg=Symbol.for("react.context"),Gu=Symbol.for("react.forward_ref"),Pc=Symbol.for("react.suspense"),Rc=Symbol.for("react.suspense_list"),Ku=Symbol.for("react.memo"),Ks=Symbol.for("react.lazy"),zg=Symbol.for("react.offscreen"),mh=Symbol.iterator;function Yr(e){return e===null||typeof e!="object"?null:(e=mh&&e[mh]||e["@@iterator"],typeof e=="function"?e:null)}var qe=Object.assign,zl;function ci(e){if(zl===void 0)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);zl=t&&t[1]||""}return`
`+zl+e}var Il=!1;function $l(e,t){if(!e||Il)return"";Il=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),a=n.stack.split(`
`),o=r.length-1,l=a.length-1;1<=o&&0<=l&&r[o]!==a[l];)l--;for(;1<=o&&0<=l;o--,l--)if(r[o]!==a[l]){if(o!==1||l!==1)do if(o--,l--,0>l||r[o]!==a[l]){var c=`
`+r[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Il=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?ci(e):""}function By(e){switch(e.tag){case 5:return ci(e.type);case 16:return ci("Lazy");case 13:return ci("Suspense");case 19:return ci("SuspenseList");case 0:case 2:case 15:return e=$l(e.type,!1),e;case 11:return e=$l(e.type.render,!1),e;case 1:return e=$l(e.type,!0),e;default:return""}}function Dc(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case ar:return"Fragment";case ir:return"Portal";case Mc:return"Profiler";case Yu:return"StrictMode";case Pc:return"Suspense";case Rc:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Fg:return(e.displayName||"Context")+".Consumer";case Og:return(e._context.displayName||"Context")+".Provider";case Gu:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case Ku:return t=e.displayName||null,t!==null?t:Dc(e.type)||"Memo";case Ks:t=e._payload,e=e._init;try{return Dc(e(t))}catch{}}return null}function Hy(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dc(t);case 8:return t===Yu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function yn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Ig(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Uy(e){var t=Ig(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof s<"u"&&typeof s.get=="function"&&typeof s.set=="function"){var r=s.get,a=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(o){n=""+o,a.call(this,o)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return n},setValue:function(o){n=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function pa(e){e._valueTracker||(e._valueTracker=Uy(e))}function $g(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),n="";return e&&(n=Ig(e)?e.checked?"true":"false":e.value),e=n,e!==s?(t.setValue(e),!0):!1}function ko(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Oc(e,t){var s=t.checked;return qe({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:s??e._wrapperState.initialChecked})}function gh(e,t){var s=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;s=yn(t.value!=null?t.value:s),e._wrapperState={initialChecked:n,initialValue:s,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Bg(e,t){t=t.checked,t!=null&&qu(e,"checked",t,!1)}function Fc(e,t){Bg(e,t);var s=yn(t.value),n=t.type;if(s!=null)n==="number"?(s===0&&e.value===""||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?zc(e,t.type,s):t.hasOwnProperty("defaultValue")&&zc(e,t.type,yn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ph(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}s=e.name,s!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,s!==""&&(e.name=s)}function zc(e,t,s){(t!=="number"||ko(e.ownerDocument)!==e)&&(s==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var ui=Array.isArray;function yr(e,t,s,n){if(e=e.options,t){t={};for(var r=0;r<s.length;r++)t["$"+s[r]]=!0;for(s=0;s<e.length;s++)r=t.hasOwnProperty("$"+e[s].value),e[s].selected!==r&&(e[s].selected=r),r&&n&&(e[s].defaultSelected=!0)}else{for(s=""+yn(s),t=null,r=0;r<e.length;r++){if(e[r].value===s){e[r].selected=!0,n&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Ic(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ee(91));return qe({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function xh(e,t){var s=t.value;if(s==null){if(s=t.children,t=t.defaultValue,s!=null){if(t!=null)throw Error(ee(92));if(ui(s)){if(1<s.length)throw Error(ee(93));s=s[0]}t=s}t==null&&(t=""),s=t}e._wrapperState={initialValue:yn(s)}}function Hg(e,t){var s=yn(t.value),n=yn(t.defaultValue);s!=null&&(s=""+s,s!==e.value&&(e.value=s),t.defaultValue==null&&e.defaultValue!==s&&(e.defaultValue=s)),n!=null&&(e.defaultValue=""+n)}function yh(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Ug(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $c(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Ug(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var xa,Vg=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,s,n,r){MSApp.execUnsafeLocalFunction(function(){return e(t,s,n,r)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(xa=xa||document.createElement("div"),xa.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=xa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Pi(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&s.nodeType===3){s.nodeValue=t;return}}e.textContent=t}var yi={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vy=["Webkit","ms","Moz","O"];Object.keys(yi).forEach(function(e){Vy.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),yi[t]=yi[e]})});function Wg(e,t,s){return t==null||typeof t=="boolean"||t===""?"":s||typeof t!="number"||t===0||yi.hasOwnProperty(e)&&yi[e]?(""+t).trim():t+"px"}function Xg(e,t){e=e.style;for(var s in t)if(t.hasOwnProperty(s)){var n=s.indexOf("--")===0,r=Wg(s,t[s],n);s==="float"&&(s="cssFloat"),n?e.setProperty(s,r):e[s]=r}}var Wy=qe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Bc(e,t){if(t){if(Wy[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ee(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ee(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ee(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ee(62))}}function Hc(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Uc=null;function Qu(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Vc=null,vr=null,br=null;function vh(e){if(e=oa(e)){if(typeof Vc!="function")throw Error(ee(280));var t=e.stateNode;t&&(t=vl(t),Vc(e.stateNode,e.type,t))}}function qg(e){vr?br?br.push(e):br=[e]:vr=e}function Yg(){if(vr){var e=vr,t=br;if(br=vr=null,vh(e),t)for(e=0;e<t.length;e++)vh(t[e])}}function Gg(e,t){return e(t)}function Kg(){}var Bl=!1;function Qg(e,t,s){if(Bl)return e(t,s);Bl=!0;try{return Gg(e,t,s)}finally{Bl=!1,(vr!==null||br!==null)&&(Kg(),Yg())}}function Ri(e,t){var s=e.stateNode;if(s===null)return null;var n=vl(s);if(n===null)return null;s=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(s&&typeof s!="function")throw Error(ee(231,t,typeof s));return s}var Wc=!1;if(Is)try{var Gr={};Object.defineProperty(Gr,"passive",{get:function(){Wc=!0}}),window.addEventListener("test",Gr,Gr),window.removeEventListener("test",Gr,Gr)}catch{Wc=!1}function Xy(e,t,s,n,r,a,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(s,u)}catch(d){this.onError(d)}}var vi=!1,So=null,Co=!1,Xc=null,qy={onError:function(e){vi=!0,So=e}};function Yy(e,t,s,n,r,a,o,l,c){vi=!1,So=null,Xy.apply(qy,arguments)}function Gy(e,t,s,n,r,a,o,l,c){if(Yy.apply(this,arguments),vi){if(vi){var u=So;vi=!1,So=null}else throw Error(ee(198));Co||(Co=!0,Xc=u)}}function Zn(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(s=t.return),e=t.return;while(e)}return t.tag===3?s:null}function Jg(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function bh(e){if(Zn(e)!==e)throw Error(ee(188))}function Ky(e){var t=e.alternate;if(!t){if(t=Zn(e),t===null)throw Error(ee(188));return t!==e?null:e}for(var s=e,n=t;;){var r=s.return;if(r===null)break;var a=r.alternate;if(a===null){if(n=r.return,n!==null){s=n;continue}break}if(r.child===a.child){for(a=r.child;a;){if(a===s)return bh(r),e;if(a===n)return bh(r),t;a=a.sibling}throw Error(ee(188))}if(s.return!==n.return)s=r,n=a;else{for(var o=!1,l=r.child;l;){if(l===s){o=!0,s=r,n=a;break}if(l===n){o=!0,n=r,s=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===s){o=!0,s=a,n=r;break}if(l===n){o=!0,n=a,s=r;break}l=l.sibling}if(!o)throw Error(ee(189))}}if(s.alternate!==n)throw Error(ee(190))}if(s.tag!==3)throw Error(ee(188));return s.stateNode.current===s?e:t}function Zg(e){return e=Ky(e),e!==null?ep(e):null}function ep(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ep(e);if(t!==null)return t;e=e.sibling}return null}var tp=Ft.unstable_scheduleCallback,wh=Ft.unstable_cancelCallback,Qy=Ft.unstable_shouldYield,Jy=Ft.unstable_requestPaint,Ke=Ft.unstable_now,Zy=Ft.unstable_getCurrentPriorityLevel,Ju=Ft.unstable_ImmediatePriority,sp=Ft.unstable_UserBlockingPriority,Eo=Ft.unstable_NormalPriority,ev=Ft.unstable_LowPriority,np=Ft.unstable_IdlePriority,gl=null,ws=null;function tv(e){if(ws&&typeof ws.onCommitFiberRoot=="function")try{ws.onCommitFiberRoot(gl,e,void 0,(e.current.flags&128)===128)}catch{}}var os=Math.clz32?Math.clz32:rv,sv=Math.log,nv=Math.LN2;function rv(e){return e>>>=0,e===0?32:31-(sv(e)/nv|0)|0}var ya=64,va=4194304;function di(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function To(e,t){var s=e.pendingLanes;if(s===0)return 0;var n=0,r=e.suspendedLanes,a=e.pingedLanes,o=s&268435455;if(o!==0){var l=o&~r;l!==0?n=di(l):(a&=o,a!==0&&(n=di(a)))}else o=s&~r,o!==0?n=di(o):a!==0&&(n=di(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&r)&&(r=n&-n,a=t&-t,r>=a||r===16&&(a&4194240)!==0))return t;if(n&4&&(n|=s&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)s=31-os(t),r=1<<s,n|=e[s],t&=~r;return n}function iv(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function av(e,t){for(var s=e.suspendedLanes,n=e.pingedLanes,r=e.expirationTimes,a=e.pendingLanes;0<a;){var o=31-os(a),l=1<<o,c=r[o];c===-1?(!(l&s)||l&n)&&(r[o]=iv(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function qc(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function rp(){var e=ya;return ya<<=1,!(ya&4194240)&&(ya=64),e}function Hl(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function ia(e,t,s){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-os(t),e[t]=s}function ov(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<s;){var r=31-os(s),a=1<<r;t[r]=0,n[r]=-1,e[r]=-1,s&=~a}}function Zu(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var n=31-os(s),r=1<<n;r&t|e[n]&t&&(e[n]|=t),s&=~r}}var Ae=0;function ip(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ap,ed,op,lp,cp,Yc=!1,ba=[],on=null,ln=null,cn=null,Di=new Map,Oi=new Map,Js=[],lv="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jh(e,t){switch(e){case"focusin":case"focusout":on=null;break;case"dragenter":case"dragleave":ln=null;break;case"mouseover":case"mouseout":cn=null;break;case"pointerover":case"pointerout":Di.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oi.delete(t.pointerId)}}function Kr(e,t,s,n,r,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:s,eventSystemFlags:n,nativeEvent:a,targetContainers:[r]},t!==null&&(t=oa(t),t!==null&&ed(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function cv(e,t,s,n,r){switch(t){case"focusin":return on=Kr(on,e,t,s,n,r),!0;case"dragenter":return ln=Kr(ln,e,t,s,n,r),!0;case"mouseover":return cn=Kr(cn,e,t,s,n,r),!0;case"pointerover":var a=r.pointerId;return Di.set(a,Kr(Di.get(a)||null,e,t,s,n,r)),!0;case"gotpointercapture":return a=r.pointerId,Oi.set(a,Kr(Oi.get(a)||null,e,t,s,n,r)),!0}return!1}function up(e){var t=Rn(e.target);if(t!==null){var s=Zn(t);if(s!==null){if(t=s.tag,t===13){if(t=Jg(s),t!==null){e.blockedOn=t,cp(e.priority,function(){op(s)});return}}else if(t===3&&s.stateNode.current.memoizedState.isDehydrated){e.blockedOn=s.tag===3?s.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ro(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var s=Gc(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(s===null){s=e.nativeEvent;var n=new s.constructor(s.type,s);Uc=n,s.target.dispatchEvent(n),Uc=null}else return t=oa(s),t!==null&&ed(t),e.blockedOn=s,!1;t.shift()}return!0}function _h(e,t,s){ro(e)&&s.delete(t)}function uv(){Yc=!1,on!==null&&ro(on)&&(on=null),ln!==null&&ro(ln)&&(ln=null),cn!==null&&ro(cn)&&(cn=null),Di.forEach(_h),Oi.forEach(_h)}function Qr(e,t){e.blockedOn===t&&(e.blockedOn=null,Yc||(Yc=!0,Ft.unstable_scheduleCallback(Ft.unstable_NormalPriority,uv)))}function Fi(e){function t(r){return Qr(r,e)}if(0<ba.length){Qr(ba[0],e);for(var s=1;s<ba.length;s++){var n=ba[s];n.blockedOn===e&&(n.blockedOn=null)}}for(on!==null&&Qr(on,e),ln!==null&&Qr(ln,e),cn!==null&&Qr(cn,e),Di.forEach(t),Oi.forEach(t),s=0;s<Js.length;s++)n=Js[s],n.blockedOn===e&&(n.blockedOn=null);for(;0<Js.length&&(s=Js[0],s.blockedOn===null);)up(s),s.blockedOn===null&&Js.shift()}var wr=Ws.ReactCurrentBatchConfig,Lo=!0;function dv(e,t,s,n){var r=Ae,a=wr.transition;wr.transition=null;try{Ae=1,td(e,t,s,n)}finally{Ae=r,wr.transition=a}}function hv(e,t,s,n){var r=Ae,a=wr.transition;wr.transition=null;try{Ae=4,td(e,t,s,n)}finally{Ae=r,wr.transition=a}}function td(e,t,s,n){if(Lo){var r=Gc(e,t,s,n);if(r===null)Jl(e,t,n,Ao,s),jh(e,n);else if(cv(r,e,t,s,n))n.stopPropagation();else if(jh(e,n),t&4&&-1<lv.indexOf(e)){for(;r!==null;){var a=oa(r);if(a!==null&&ap(a),a=Gc(e,t,s,n),a===null&&Jl(e,t,n,Ao,s),a===r)break;r=a}r!==null&&n.stopPropagation()}else Jl(e,t,n,null,s)}}var Ao=null;function Gc(e,t,s,n){if(Ao=null,e=Qu(n),e=Rn(e),e!==null)if(t=Zn(e),t===null)e=null;else if(s=t.tag,s===13){if(e=Jg(t),e!==null)return e;e=null}else if(s===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ao=e,null}function dp(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zy()){case Ju:return 1;case sp:return 4;case Eo:case ev:return 16;case np:return 536870912;default:return 16}default:return 16}}var en=null,sd=null,io=null;function hp(){if(io)return io;var e,t=sd,s=t.length,n,r="value"in en?en.value:en.textContent,a=r.length;for(e=0;e<s&&t[e]===r[e];e++);var o=s-e;for(n=1;n<=o&&t[s-n]===r[a-n];n++);return io=r.slice(e,1<n?1-n:void 0)}function ao(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function wa(){return!0}function Nh(){return!1}function $t(e){function t(s,n,r,a,o){this._reactName=s,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(s=e[l],this[l]=s?s(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?wa:Nh,this.isPropagationStopped=Nh,this}return qe(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var s=this.nativeEvent;s&&(s.preventDefault?s.preventDefault():typeof s.returnValue!="unknown"&&(s.returnValue=!1),this.isDefaultPrevented=wa)},stopPropagation:function(){var s=this.nativeEvent;s&&(s.stopPropagation?s.stopPropagation():typeof s.cancelBubble!="unknown"&&(s.cancelBubble=!0),this.isPropagationStopped=wa)},persist:function(){},isPersistent:wa}),t}var Br={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nd=$t(Br),aa=qe({},Br,{view:0,detail:0}),fv=$t(aa),Ul,Vl,Jr,pl=qe({},aa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:rd,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Jr&&(Jr&&e.type==="mousemove"?(Ul=e.screenX-Jr.screenX,Vl=e.screenY-Jr.screenY):Vl=Ul=0,Jr=e),Ul)},movementY:function(e){return"movementY"in e?e.movementY:Vl}}),kh=$t(pl),mv=qe({},pl,{dataTransfer:0}),gv=$t(mv),pv=qe({},aa,{relatedTarget:0}),Wl=$t(pv),xv=qe({},Br,{animationName:0,elapsedTime:0,pseudoElement:0}),yv=$t(xv),vv=qe({},Br,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bv=$t(vv),wv=qe({},Br,{data:0}),Sh=$t(wv),jv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_v={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kv(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Nv[e])?!!t[e]:!1}function rd(){return kv}var Sv=qe({},aa,{key:function(e){if(e.key){var t=jv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ao(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?_v[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:rd,charCode:function(e){return e.type==="keypress"?ao(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ao(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Cv=$t(Sv),Ev=qe({},pl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ch=$t(Ev),Tv=qe({},aa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:rd}),Lv=$t(Tv),Av=qe({},Br,{propertyName:0,elapsedTime:0,pseudoElement:0}),Mv=$t(Av),Pv=qe({},pl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Rv=$t(Pv),Dv=[9,13,27,32],id=Is&&"CompositionEvent"in window,bi=null;Is&&"documentMode"in document&&(bi=document.documentMode);var Ov=Is&&"TextEvent"in window&&!bi,fp=Is&&(!id||bi&&8<bi&&11>=bi),Eh=" ",Th=!1;function mp(e,t){switch(e){case"keyup":return Dv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gp(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var or=!1;function Fv(e,t){switch(e){case"compositionend":return gp(t);case"keypress":return t.which!==32?null:(Th=!0,Eh);case"textInput":return e=t.data,e===Eh&&Th?null:e;default:return null}}function zv(e,t){if(or)return e==="compositionend"||!id&&mp(e,t)?(e=hp(),io=sd=en=null,or=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return fp&&t.locale!=="ko"?null:t.data;default:return null}}var Iv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Lh(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Iv[e.type]:t==="textarea"}function pp(e,t,s,n){qg(n),t=Mo(t,"onChange"),0<t.length&&(s=new nd("onChange","change",null,s,n),e.push({event:s,listeners:t}))}var wi=null,zi=null;function $v(e){Cp(e,0)}function xl(e){var t=ur(e);if($g(t))return e}function Bv(e,t){if(e==="change")return t}var xp=!1;if(Is){var Xl;if(Is){var ql="oninput"in document;if(!ql){var Ah=document.createElement("div");Ah.setAttribute("oninput","return;"),ql=typeof Ah.oninput=="function"}Xl=ql}else Xl=!1;xp=Xl&&(!document.documentMode||9<document.documentMode)}function Mh(){wi&&(wi.detachEvent("onpropertychange",yp),zi=wi=null)}function yp(e){if(e.propertyName==="value"&&xl(zi)){var t=[];pp(t,zi,e,Qu(e)),Qg($v,t)}}function Hv(e,t,s){e==="focusin"?(Mh(),wi=t,zi=s,wi.attachEvent("onpropertychange",yp)):e==="focusout"&&Mh()}function Uv(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return xl(zi)}function Vv(e,t){if(e==="click")return xl(t)}function Wv(e,t){if(e==="input"||e==="change")return xl(t)}function Xv(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var cs=typeof Object.is=="function"?Object.is:Xv;function Ii(e,t){if(cs(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var s=Object.keys(e),n=Object.keys(t);if(s.length!==n.length)return!1;for(n=0;n<s.length;n++){var r=s[n];if(!Ac.call(t,r)||!cs(e[r],t[r]))return!1}return!0}function Ph(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Rh(e,t){var s=Ph(e);e=0;for(var n;s;){if(s.nodeType===3){if(n=e+s.textContent.length,e<=t&&n>=t)return{node:s,offset:t-e};e=n}e:{for(;s;){if(s.nextSibling){s=s.nextSibling;break e}s=s.parentNode}s=void 0}s=Ph(s)}}function vp(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?vp(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function bp(){for(var e=window,t=ko();t instanceof e.HTMLIFrameElement;){try{var s=typeof t.contentWindow.location.href=="string"}catch{s=!1}if(s)e=t.contentWindow;else break;t=ko(e.document)}return t}function ad(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function qv(e){var t=bp(),s=e.focusedElem,n=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&vp(s.ownerDocument.documentElement,s)){if(n!==null&&ad(s)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if(e=(t=s.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var r=s.textContent.length,a=Math.min(n.start,r);n=n.end===void 0?a:Math.min(n.end,r),!e.extend&&a>n&&(r=n,n=a,a=r),r=Rh(s,a);var o=Rh(s,n);r&&o&&(e.rangeCount!==1||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(r.node,r.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=s;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof s.focus=="function"&&s.focus(),s=0;s<t.length;s++)e=t[s],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Yv=Is&&"documentMode"in document&&11>=document.documentMode,lr=null,Kc=null,ji=null,Qc=!1;function Dh(e,t,s){var n=s.window===s?s.document:s.nodeType===9?s:s.ownerDocument;Qc||lr==null||lr!==ko(n)||(n=lr,"selectionStart"in n&&ad(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ji&&Ii(ji,n)||(ji=n,n=Mo(Kc,"onSelect"),0<n.length&&(t=new nd("onSelect","select",null,t,s),e.push({event:t,listeners:n}),t.target=lr)))}function ja(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var cr={animationend:ja("Animation","AnimationEnd"),animationiteration:ja("Animation","AnimationIteration"),animationstart:ja("Animation","AnimationStart"),transitionend:ja("Transition","TransitionEnd")},Yl={},wp={};Is&&(wp=document.createElement("div").style,"AnimationEvent"in window||(delete cr.animationend.animation,delete cr.animationiteration.animation,delete cr.animationstart.animation),"TransitionEvent"in window||delete cr.transitionend.transition);function yl(e){if(Yl[e])return Yl[e];if(!cr[e])return e;var t=cr[e],s;for(s in t)if(t.hasOwnProperty(s)&&s in wp)return Yl[e]=t[s];return e}var jp=yl("animationend"),_p=yl("animationiteration"),Np=yl("animationstart"),kp=yl("transitionend"),Sp=new Map,Oh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nn(e,t){Sp.set(e,t),Jn(t,[e])}for(var Gl=0;Gl<Oh.length;Gl++){var Kl=Oh[Gl],Gv=Kl.toLowerCase(),Kv=Kl[0].toUpperCase()+Kl.slice(1);Nn(Gv,"on"+Kv)}Nn(jp,"onAnimationEnd");Nn(_p,"onAnimationIteration");Nn(Np,"onAnimationStart");Nn("dblclick","onDoubleClick");Nn("focusin","onFocus");Nn("focusout","onBlur");Nn(kp,"onTransitionEnd");Er("onMouseEnter",["mouseout","mouseover"]);Er("onMouseLeave",["mouseout","mouseover"]);Er("onPointerEnter",["pointerout","pointerover"]);Er("onPointerLeave",["pointerout","pointerover"]);Jn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Jn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Jn("onBeforeInput",["compositionend","keypress","textInput","paste"]);Jn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Jn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Jn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hi="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qv=new Set("cancel close invalid load scroll toggle".split(" ").concat(hi));function Fh(e,t,s){var n=e.type||"unknown-event";e.currentTarget=s,Gy(n,t,void 0,e),e.currentTarget=null}function Cp(e,t){t=(t&4)!==0;for(var s=0;s<e.length;s++){var n=e[s],r=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var o=n.length-1;0<=o;o--){var l=n[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&r.isPropagationStopped())break e;Fh(r,l,u),a=c}else for(o=0;o<n.length;o++){if(l=n[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&r.isPropagationStopped())break e;Fh(r,l,u),a=c}}}if(Co)throw e=Xc,Co=!1,Xc=null,e}function $e(e,t){var s=t[su];s===void 0&&(s=t[su]=new Set);var n=e+"__bubble";s.has(n)||(Ep(t,e,2,!1),s.add(n))}function Ql(e,t,s){var n=0;t&&(n|=4),Ep(s,e,n,t)}var _a="_reactListening"+Math.random().toString(36).slice(2);function $i(e){if(!e[_a]){e[_a]=!0,Dg.forEach(function(s){s!=="selectionchange"&&(Qv.has(s)||Ql(s,!1,e),Ql(s,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[_a]||(t[_a]=!0,Ql("selectionchange",!1,t))}}function Ep(e,t,s,n){switch(dp(t)){case 1:var r=dv;break;case 4:r=hv;break;default:r=td}s=r.bind(null,t,s,e),r=void 0,!Wc||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),n?r!==void 0?e.addEventListener(t,s,{capture:!0,passive:r}):e.addEventListener(t,s,!0):r!==void 0?e.addEventListener(t,s,{passive:r}):e.addEventListener(t,s,!1)}function Jl(e,t,s,n,r){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var o=n.tag;if(o===3||o===4){var l=n.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(o===4)for(o=n.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;l!==null;){if(o=Rn(l),o===null)return;if(c=o.tag,c===5||c===6){n=a=o;continue e}l=l.parentNode}}n=n.return}Qg(function(){var u=a,d=Qu(s),h=[];e:{var f=Sp.get(e);if(f!==void 0){var m=nd,v=e;switch(e){case"keypress":if(ao(s)===0)break e;case"keydown":case"keyup":m=Cv;break;case"focusin":v="focus",m=Wl;break;case"focusout":v="blur",m=Wl;break;case"beforeblur":case"afterblur":m=Wl;break;case"click":if(s.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=kh;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=gv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=Lv;break;case jp:case _p:case Np:m=yv;break;case kp:m=Mv;break;case"scroll":m=fv;break;case"wheel":m=Rv;break;case"copy":case"cut":case"paste":m=bv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Ch}var x=(t&4)!==0,y=!x&&e==="scroll",g=x?f!==null?f+"Capture":null:f;x=[];for(var p=u,w;p!==null;){w=p;var b=w.stateNode;if(w.tag===5&&b!==null&&(w=b,g!==null&&(b=Ri(p,g),b!=null&&x.push(Bi(p,b,w)))),y)break;p=p.return}0<x.length&&(f=new m(f,v,null,s,d),h.push({event:f,listeners:x}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",f&&s!==Uc&&(v=s.relatedTarget||s.fromElement)&&(Rn(v)||v[$s]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(v=s.relatedTarget||s.toElement,m=u,v=v?Rn(v):null,v!==null&&(y=Zn(v),v!==y||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=u),m!==v)){if(x=kh,b="onMouseLeave",g="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(x=Ch,b="onPointerLeave",g="onPointerEnter",p="pointer"),y=m==null?f:ur(m),w=v==null?f:ur(v),f=new x(b,p+"leave",m,s,d),f.target=y,f.relatedTarget=w,b=null,Rn(d)===u&&(x=new x(g,p+"enter",v,s,d),x.target=w,x.relatedTarget=y,b=x),y=b,m&&v)t:{for(x=m,g=v,p=0,w=x;w;w=tr(w))p++;for(w=0,b=g;b;b=tr(b))w++;for(;0<p-w;)x=tr(x),p--;for(;0<w-p;)g=tr(g),w--;for(;p--;){if(x===g||g!==null&&x===g.alternate)break t;x=tr(x),g=tr(g)}x=null}else x=null;m!==null&&zh(h,f,m,x,!1),v!==null&&y!==null&&zh(h,y,v,x,!0)}}e:{if(f=u?ur(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var k=Bv;else if(Lh(f))if(xp)k=Wv;else{k=Uv;var E=Hv}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=Vv);if(k&&(k=k(e,u))){pp(h,k,s,d);break e}E&&E(e,f,u),e==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&zc(f,"number",f.value)}switch(E=u?ur(u):window,e){case"focusin":(Lh(E)||E.contentEditable==="true")&&(lr=E,Kc=u,ji=null);break;case"focusout":ji=Kc=lr=null;break;case"mousedown":Qc=!0;break;case"contextmenu":case"mouseup":case"dragend":Qc=!1,Dh(h,s,d);break;case"selectionchange":if(Yv)break;case"keydown":case"keyup":Dh(h,s,d)}var _;if(id)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else or?mp(e,s)&&(N="onCompositionEnd"):e==="keydown"&&s.keyCode===229&&(N="onCompositionStart");N&&(fp&&s.locale!=="ko"&&(or||N!=="onCompositionStart"?N==="onCompositionEnd"&&or&&(_=hp()):(en=d,sd="value"in en?en.value:en.textContent,or=!0)),E=Mo(u,N),0<E.length&&(N=new Sh(N,e,null,s,d),h.push({event:N,listeners:E}),_?N.data=_:(_=gp(s),_!==null&&(N.data=_)))),(_=Ov?Fv(e,s):zv(e,s))&&(u=Mo(u,"onBeforeInput"),0<u.length&&(d=new Sh("onBeforeInput","beforeinput",null,s,d),h.push({event:d,listeners:u}),d.data=_))}Cp(h,t)})}function Bi(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Mo(e,t){for(var s=t+"Capture",n=[];e!==null;){var r=e,a=r.stateNode;r.tag===5&&a!==null&&(r=a,a=Ri(e,s),a!=null&&n.unshift(Bi(e,a,r)),a=Ri(e,t),a!=null&&n.push(Bi(e,a,r))),e=e.return}return n}function tr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function zh(e,t,s,n,r){for(var a=t._reactName,o=[];s!==null&&s!==n;){var l=s,c=l.alternate,u=l.stateNode;if(c!==null&&c===n)break;l.tag===5&&u!==null&&(l=u,r?(c=Ri(s,a),c!=null&&o.unshift(Bi(s,c,l))):r||(c=Ri(s,a),c!=null&&o.push(Bi(s,c,l)))),s=s.return}o.length!==0&&e.push({event:t,listeners:o})}var Jv=/\r\n?/g,Zv=/\u0000|\uFFFD/g;function Ih(e){return(typeof e=="string"?e:""+e).replace(Jv,`
`).replace(Zv,"")}function Na(e,t,s){if(t=Ih(t),Ih(e)!==t&&s)throw Error(ee(425))}function Po(){}var Jc=null,Zc=null;function eu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var tu=typeof setTimeout=="function"?setTimeout:void 0,eb=typeof clearTimeout=="function"?clearTimeout:void 0,$h=typeof Promise=="function"?Promise:void 0,tb=typeof queueMicrotask=="function"?queueMicrotask:typeof $h<"u"?function(e){return $h.resolve(null).then(e).catch(sb)}:tu;function sb(e){setTimeout(function(){throw e})}function Zl(e,t){var s=t,n=0;do{var r=s.nextSibling;if(e.removeChild(s),r&&r.nodeType===8)if(s=r.data,s==="/$"){if(n===0){e.removeChild(r),Fi(t);return}n--}else s!=="$"&&s!=="$?"&&s!=="$!"||n++;s=r}while(s);Fi(t)}function un(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Bh(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="$"||s==="$!"||s==="$?"){if(t===0)return e;t--}else s==="/$"&&t++}e=e.previousSibling}return null}var Hr=Math.random().toString(36).slice(2),ys="__reactFiber$"+Hr,Hi="__reactProps$"+Hr,$s="__reactContainer$"+Hr,su="__reactEvents$"+Hr,nb="__reactListeners$"+Hr,rb="__reactHandles$"+Hr;function Rn(e){var t=e[ys];if(t)return t;for(var s=e.parentNode;s;){if(t=s[$s]||s[ys]){if(s=t.alternate,t.child!==null||s!==null&&s.child!==null)for(e=Bh(e);e!==null;){if(s=e[ys])return s;e=Bh(e)}return t}e=s,s=e.parentNode}return null}function oa(e){return e=e[ys]||e[$s],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ur(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ee(33))}function vl(e){return e[Hi]||null}var nu=[],dr=-1;function kn(e){return{current:e}}function He(e){0>dr||(e.current=nu[dr],nu[dr]=null,dr--)}function Fe(e,t){dr++,nu[dr]=e.current,e.current=t}var vn={},vt=kn(vn),At=kn(!1),Vn=vn;function Tr(e,t){var s=e.type.contextTypes;if(!s)return vn;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var r={},a;for(a in s)r[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Mt(e){return e=e.childContextTypes,e!=null}function Ro(){He(At),He(vt)}function Hh(e,t,s){if(vt.current!==vn)throw Error(ee(168));Fe(vt,t),Fe(At,s)}function Tp(e,t,s){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return s;n=n.getChildContext();for(var r in n)if(!(r in t))throw Error(ee(108,Hy(e)||"Unknown",r));return qe({},s,n)}function Do(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||vn,Vn=vt.current,Fe(vt,e),Fe(At,At.current),!0}function Uh(e,t,s){var n=e.stateNode;if(!n)throw Error(ee(169));s?(e=Tp(e,t,Vn),n.__reactInternalMemoizedMergedChildContext=e,He(At),He(vt),Fe(vt,e)):He(At),Fe(At,s)}var Ms=null,bl=!1,ec=!1;function Lp(e){Ms===null?Ms=[e]:Ms.push(e)}function ib(e){bl=!0,Lp(e)}function Sn(){if(!ec&&Ms!==null){ec=!0;var e=0,t=Ae;try{var s=Ms;for(Ae=1;e<s.length;e++){var n=s[e];do n=n(!0);while(n!==null)}Ms=null,bl=!1}catch(r){throw Ms!==null&&(Ms=Ms.slice(e+1)),tp(Ju,Sn),r}finally{Ae=t,ec=!1}}return null}var hr=[],fr=0,Oo=null,Fo=0,Ut=[],Vt=0,Wn=null,Rs=1,Ds="";function An(e,t){hr[fr++]=Fo,hr[fr++]=Oo,Oo=e,Fo=t}function Ap(e,t,s){Ut[Vt++]=Rs,Ut[Vt++]=Ds,Ut[Vt++]=Wn,Wn=e;var n=Rs;e=Ds;var r=32-os(n)-1;n&=~(1<<r),s+=1;var a=32-os(t)+r;if(30<a){var o=r-r%5;a=(n&(1<<o)-1).toString(32),n>>=o,r-=o,Rs=1<<32-os(t)+r|s<<r|n,Ds=a+e}else Rs=1<<a|s<<r|n,Ds=e}function od(e){e.return!==null&&(An(e,1),Ap(e,1,0))}function ld(e){for(;e===Oo;)Oo=hr[--fr],hr[fr]=null,Fo=hr[--fr],hr[fr]=null;for(;e===Wn;)Wn=Ut[--Vt],Ut[Vt]=null,Ds=Ut[--Vt],Ut[Vt]=null,Rs=Ut[--Vt],Ut[Vt]=null}var Ot=null,Dt=null,Ue=!1,ss=null;function Mp(e,t){var s=Wt(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,t=e.deletions,t===null?(e.deletions=[s],e.flags|=16):t.push(s)}function Vh(e,t){switch(e.tag){case 5:var s=e.type;return t=t.nodeType!==1||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ot=e,Dt=un(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ot=e,Dt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(s=Wn!==null?{id:Rs,overflow:Ds}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},s=Wt(18,null,null,0),s.stateNode=t,s.return=e,e.child=s,Ot=e,Dt=null,!0):!1;default:return!1}}function ru(e){return(e.mode&1)!==0&&(e.flags&128)===0}function iu(e){if(Ue){var t=Dt;if(t){var s=t;if(!Vh(e,t)){if(ru(e))throw Error(ee(418));t=un(s.nextSibling);var n=Ot;t&&Vh(e,t)?Mp(n,s):(e.flags=e.flags&-4097|2,Ue=!1,Ot=e)}}else{if(ru(e))throw Error(ee(418));e.flags=e.flags&-4097|2,Ue=!1,Ot=e}}}function Wh(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ot=e}function ka(e){if(e!==Ot)return!1;if(!Ue)return Wh(e),Ue=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!eu(e.type,e.memoizedProps)),t&&(t=Dt)){if(ru(e))throw Pp(),Error(ee(418));for(;t;)Mp(e,t),t=un(t.nextSibling)}if(Wh(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ee(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var s=e.data;if(s==="/$"){if(t===0){Dt=un(e.nextSibling);break e}t--}else s!=="$"&&s!=="$!"&&s!=="$?"||t++}e=e.nextSibling}Dt=null}}else Dt=Ot?un(e.stateNode.nextSibling):null;return!0}function Pp(){for(var e=Dt;e;)e=un(e.nextSibling)}function Lr(){Dt=Ot=null,Ue=!1}function cd(e){ss===null?ss=[e]:ss.push(e)}var ab=Ws.ReactCurrentBatchConfig;function Zr(e,t,s){if(e=s.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(s._owner){if(s=s._owner,s){if(s.tag!==1)throw Error(ee(309));var n=s.stateNode}if(!n)throw Error(ee(147,e));var r=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(o){var l=r.refs;o===null?delete l[a]:l[a]=o},t._stringRef=a,t)}if(typeof e!="string")throw Error(ee(284));if(!s._owner)throw Error(ee(290,e))}return e}function Sa(e,t){throw e=Object.prototype.toString.call(t),Error(ee(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xh(e){var t=e._init;return t(e._payload)}function Rp(e){function t(g,p){if(e){var w=g.deletions;w===null?(g.deletions=[p],g.flags|=16):w.push(p)}}function s(g,p){if(!e)return null;for(;p!==null;)t(g,p),p=p.sibling;return null}function n(g,p){for(g=new Map;p!==null;)p.key!==null?g.set(p.key,p):g.set(p.index,p),p=p.sibling;return g}function r(g,p){return g=mn(g,p),g.index=0,g.sibling=null,g}function a(g,p,w){return g.index=w,e?(w=g.alternate,w!==null?(w=w.index,w<p?(g.flags|=2,p):w):(g.flags|=2,p)):(g.flags|=1048576,p)}function o(g){return e&&g.alternate===null&&(g.flags|=2),g}function l(g,p,w,b){return p===null||p.tag!==6?(p=oc(w,g.mode,b),p.return=g,p):(p=r(p,w),p.return=g,p)}function c(g,p,w,b){var k=w.type;return k===ar?d(g,p,w.props.children,b,w.key):p!==null&&(p.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ks&&Xh(k)===p.type)?(b=r(p,w.props),b.ref=Zr(g,p,w),b.return=g,b):(b=mo(w.type,w.key,w.props,null,g.mode,b),b.ref=Zr(g,p,w),b.return=g,b)}function u(g,p,w,b){return p===null||p.tag!==4||p.stateNode.containerInfo!==w.containerInfo||p.stateNode.implementation!==w.implementation?(p=lc(w,g.mode,b),p.return=g,p):(p=r(p,w.children||[]),p.return=g,p)}function d(g,p,w,b,k){return p===null||p.tag!==7?(p=$n(w,g.mode,b,k),p.return=g,p):(p=r(p,w),p.return=g,p)}function h(g,p,w){if(typeof p=="string"&&p!==""||typeof p=="number")return p=oc(""+p,g.mode,w),p.return=g,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case ga:return w=mo(p.type,p.key,p.props,null,g.mode,w),w.ref=Zr(g,null,p),w.return=g,w;case ir:return p=lc(p,g.mode,w),p.return=g,p;case Ks:var b=p._init;return h(g,b(p._payload),w)}if(ui(p)||Yr(p))return p=$n(p,g.mode,w,null),p.return=g,p;Sa(g,p)}return null}function f(g,p,w,b){var k=p!==null?p.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return k!==null?null:l(g,p,""+w,b);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ga:return w.key===k?c(g,p,w,b):null;case ir:return w.key===k?u(g,p,w,b):null;case Ks:return k=w._init,f(g,p,k(w._payload),b)}if(ui(w)||Yr(w))return k!==null?null:d(g,p,w,b,null);Sa(g,w)}return null}function m(g,p,w,b,k){if(typeof b=="string"&&b!==""||typeof b=="number")return g=g.get(w)||null,l(p,g,""+b,k);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ga:return g=g.get(b.key===null?w:b.key)||null,c(p,g,b,k);case ir:return g=g.get(b.key===null?w:b.key)||null,u(p,g,b,k);case Ks:var E=b._init;return m(g,p,w,E(b._payload),k)}if(ui(b)||Yr(b))return g=g.get(w)||null,d(p,g,b,k,null);Sa(p,b)}return null}function v(g,p,w,b){for(var k=null,E=null,_=p,N=p=0,U=null;_!==null&&N<w.length;N++){_.index>N?(U=_,_=null):U=_.sibling;var B=f(g,_,w[N],b);if(B===null){_===null&&(_=U);break}e&&_&&B.alternate===null&&t(g,_),p=a(B,p,N),E===null?k=B:E.sibling=B,E=B,_=U}if(N===w.length)return s(g,_),Ue&&An(g,N),k;if(_===null){for(;N<w.length;N++)_=h(g,w[N],b),_!==null&&(p=a(_,p,N),E===null?k=_:E.sibling=_,E=_);return Ue&&An(g,N),k}for(_=n(g,_);N<w.length;N++)U=m(_,g,N,w[N],b),U!==null&&(e&&U.alternate!==null&&_.delete(U.key===null?N:U.key),p=a(U,p,N),E===null?k=U:E.sibling=U,E=U);return e&&_.forEach(function(q){return t(g,q)}),Ue&&An(g,N),k}function x(g,p,w,b){var k=Yr(w);if(typeof k!="function")throw Error(ee(150));if(w=k.call(w),w==null)throw Error(ee(151));for(var E=k=null,_=p,N=p=0,U=null,B=w.next();_!==null&&!B.done;N++,B=w.next()){_.index>N?(U=_,_=null):U=_.sibling;var q=f(g,_,B.value,b);if(q===null){_===null&&(_=U);break}e&&_&&q.alternate===null&&t(g,_),p=a(q,p,N),E===null?k=q:E.sibling=q,E=q,_=U}if(B.done)return s(g,_),Ue&&An(g,N),k;if(_===null){for(;!B.done;N++,B=w.next())B=h(g,B.value,b),B!==null&&(p=a(B,p,N),E===null?k=B:E.sibling=B,E=B);return Ue&&An(g,N),k}for(_=n(g,_);!B.done;N++,B=w.next())B=m(_,g,N,B.value,b),B!==null&&(e&&B.alternate!==null&&_.delete(B.key===null?N:B.key),p=a(B,p,N),E===null?k=B:E.sibling=B,E=B);return e&&_.forEach(function(z){return t(g,z)}),Ue&&An(g,N),k}function y(g,p,w,b){if(typeof w=="object"&&w!==null&&w.type===ar&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ga:e:{for(var k=w.key,E=p;E!==null;){if(E.key===k){if(k=w.type,k===ar){if(E.tag===7){s(g,E.sibling),p=r(E,w.props.children),p.return=g,g=p;break e}}else if(E.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Ks&&Xh(k)===E.type){s(g,E.sibling),p=r(E,w.props),p.ref=Zr(g,E,w),p.return=g,g=p;break e}s(g,E);break}else t(g,E);E=E.sibling}w.type===ar?(p=$n(w.props.children,g.mode,b,w.key),p.return=g,g=p):(b=mo(w.type,w.key,w.props,null,g.mode,b),b.ref=Zr(g,p,w),b.return=g,g=b)}return o(g);case ir:e:{for(E=w.key;p!==null;){if(p.key===E)if(p.tag===4&&p.stateNode.containerInfo===w.containerInfo&&p.stateNode.implementation===w.implementation){s(g,p.sibling),p=r(p,w.children||[]),p.return=g,g=p;break e}else{s(g,p);break}else t(g,p);p=p.sibling}p=lc(w,g.mode,b),p.return=g,g=p}return o(g);case Ks:return E=w._init,y(g,p,E(w._payload),b)}if(ui(w))return v(g,p,w,b);if(Yr(w))return x(g,p,w,b);Sa(g,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,p!==null&&p.tag===6?(s(g,p.sibling),p=r(p,w),p.return=g,g=p):(s(g,p),p=oc(w,g.mode,b),p.return=g,g=p),o(g)):s(g,p)}return y}var Ar=Rp(!0),Dp=Rp(!1),zo=kn(null),Io=null,mr=null,ud=null;function dd(){ud=mr=Io=null}function hd(e){var t=zo.current;He(zo),e._currentValue=t}function au(e,t,s){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===s)break;e=e.return}}function jr(e,t){Io=e,ud=mr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Tt=!0),e.firstContext=null)}function Yt(e){var t=e._currentValue;if(ud!==e)if(e={context:e,memoizedValue:t,next:null},mr===null){if(Io===null)throw Error(ee(308));mr=e,Io.dependencies={lanes:0,firstContext:e}}else mr=mr.next=e;return t}var Dn=null;function fd(e){Dn===null?Dn=[e]:Dn.push(e)}function Op(e,t,s,n){var r=t.interleaved;return r===null?(s.next=s,fd(t)):(s.next=r.next,r.next=s),t.interleaved=s,Bs(e,n)}function Bs(e,t){e.lanes|=t;var s=e.alternate;for(s!==null&&(s.lanes|=t),s=e,e=e.return;e!==null;)e.childLanes|=t,s=e.alternate,s!==null&&(s.childLanes|=t),s=e,e=e.return;return s.tag===3?s.stateNode:null}var Qs=!1;function md(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Fp(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function dn(e,t,s){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Se&2){var r=n.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),n.pending=t,Bs(e,s)}return r=n.interleaved,r===null?(t.next=t,fd(n)):(t.next=r.next,r.next=t),n.interleaved=t,Bs(e,s)}function oo(e,t,s){if(t=t.updateQueue,t!==null&&(t=t.shared,(s&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,s|=n,t.lanes=s,Zu(e,s)}}function qh(e,t){var s=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,s===n)){var r=null,a=null;if(s=s.firstBaseUpdate,s!==null){do{var o={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};a===null?r=a=o:a=a.next=o,s=s.next}while(s!==null);a===null?r=a=t:a=a.next=t}else r=a=t;s={baseState:n.baseState,firstBaseUpdate:r,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=s;return}e=s.lastBaseUpdate,e===null?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function $o(e,t,s,n){var r=e.updateQueue;Qs=!1;var a=r.firstBaseUpdate,o=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?a=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var h=r.baseState;o=0,d=u=c=null,l=a;do{var f=l.lane,m=l.eventTime;if((n&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var v=e,x=l;switch(f=t,m=s,x.tag){case 1:if(v=x.payload,typeof v=="function"){h=v.call(m,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=x.payload,f=typeof v=="function"?v.call(m,h,f):v,f==null)break e;h=qe({},h,f);break e;case 2:Qs=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=r.effects,f===null?r.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=f;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;f=l,l=f.next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}while(!0);if(d===null&&(c=h),r.baseState=c,r.firstBaseUpdate=u,r.lastBaseUpdate=d,t=r.shared.interleaved,t!==null){r=t;do o|=r.lane,r=r.next;while(r!==t)}else a===null&&(r.shared.lanes=0);qn|=o,e.lanes=o,e.memoizedState=h}}function Yh(e,t,s){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],r=n.callback;if(r!==null){if(n.callback=null,n=s,typeof r!="function")throw Error(ee(191,r));r.call(n)}}}var la={},js=kn(la),Ui=kn(la),Vi=kn(la);function On(e){if(e===la)throw Error(ee(174));return e}function gd(e,t){switch(Fe(Vi,t),Fe(Ui,e),Fe(js,la),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:$c(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=$c(t,e)}He(js),Fe(js,t)}function Mr(){He(js),He(Ui),He(Vi)}function zp(e){On(Vi.current);var t=On(js.current),s=$c(t,e.type);t!==s&&(Fe(Ui,e),Fe(js,s))}function pd(e){Ui.current===e&&(He(js),He(Ui))}var We=kn(0);function Bo(e){for(var t=e;t!==null;){if(t.tag===13){var s=t.memoizedState;if(s!==null&&(s=s.dehydrated,s===null||s.data==="$?"||s.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var tc=[];function xd(){for(var e=0;e<tc.length;e++)tc[e]._workInProgressVersionPrimary=null;tc.length=0}var lo=Ws.ReactCurrentDispatcher,sc=Ws.ReactCurrentBatchConfig,Xn=0,Xe=null,nt=null,lt=null,Ho=!1,_i=!1,Wi=0,ob=0;function ft(){throw Error(ee(321))}function yd(e,t){if(t===null)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!cs(e[s],t[s]))return!1;return!0}function vd(e,t,s,n,r,a){if(Xn=a,Xe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,lo.current=e===null||e.memoizedState===null?db:hb,e=s(n,r),_i){a=0;do{if(_i=!1,Wi=0,25<=a)throw Error(ee(301));a+=1,lt=nt=null,t.updateQueue=null,lo.current=fb,e=s(n,r)}while(_i)}if(lo.current=Uo,t=nt!==null&&nt.next!==null,Xn=0,lt=nt=Xe=null,Ho=!1,t)throw Error(ee(300));return e}function bd(){var e=Wi!==0;return Wi=0,e}function ps(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lt===null?Xe.memoizedState=lt=e:lt=lt.next=e,lt}function Gt(){if(nt===null){var e=Xe.alternate;e=e!==null?e.memoizedState:null}else e=nt.next;var t=lt===null?Xe.memoizedState:lt.next;if(t!==null)lt=t,nt=e;else{if(e===null)throw Error(ee(310));nt=e,e={memoizedState:nt.memoizedState,baseState:nt.baseState,baseQueue:nt.baseQueue,queue:nt.queue,next:null},lt===null?Xe.memoizedState=lt=e:lt=lt.next=e}return lt}function Xi(e,t){return typeof t=="function"?t(e):t}function nc(e){var t=Gt(),s=t.queue;if(s===null)throw Error(ee(311));s.lastRenderedReducer=e;var n=nt,r=n.baseQueue,a=s.pending;if(a!==null){if(r!==null){var o=r.next;r.next=a.next,a.next=o}n.baseQueue=r=a,s.pending=null}if(r!==null){a=r.next,n=n.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((Xn&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=n):c=c.next=h,Xe.lanes|=d,qn|=d}u=u.next}while(u!==null&&u!==a);c===null?o=n:c.next=l,cs(n,t.memoizedState)||(Tt=!0),t.memoizedState=n,t.baseState=o,t.baseQueue=c,s.lastRenderedState=n}if(e=s.interleaved,e!==null){r=e;do a=r.lane,Xe.lanes|=a,qn|=a,r=r.next;while(r!==e)}else r===null&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function rc(e){var t=Gt(),s=t.queue;if(s===null)throw Error(ee(311));s.lastRenderedReducer=e;var n=s.dispatch,r=s.pending,a=t.memoizedState;if(r!==null){s.pending=null;var o=r=r.next;do a=e(a,o.action),o=o.next;while(o!==r);cs(a,t.memoizedState)||(Tt=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),s.lastRenderedState=a}return[a,n]}function Ip(){}function $p(e,t){var s=Xe,n=Gt(),r=t(),a=!cs(n.memoizedState,r);if(a&&(n.memoizedState=r,Tt=!0),n=n.queue,wd(Up.bind(null,s,n,e),[e]),n.getSnapshot!==t||a||lt!==null&&lt.memoizedState.tag&1){if(s.flags|=2048,qi(9,Hp.bind(null,s,n,r,t),void 0,null),ct===null)throw Error(ee(349));Xn&30||Bp(s,t,r)}return r}function Bp(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.stores=[e]):(s=t.stores,s===null?t.stores=[e]:s.push(e))}function Hp(e,t,s,n){t.value=s,t.getSnapshot=n,Vp(t)&&Wp(e)}function Up(e,t,s){return s(function(){Vp(t)&&Wp(e)})}function Vp(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!cs(e,s)}catch{return!0}}function Wp(e){var t=Bs(e,1);t!==null&&ls(t,e,1,-1)}function Gh(e){var t=ps();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Xi,lastRenderedState:e},t.queue=e,e=e.dispatch=ub.bind(null,Xe,e),[t.memoizedState,e]}function qi(e,t,s,n){return e={tag:e,create:t,destroy:s,deps:n,next:null},t=Xe.updateQueue,t===null?(t={lastEffect:null,stores:null},Xe.updateQueue=t,t.lastEffect=e.next=e):(s=t.lastEffect,s===null?t.lastEffect=e.next=e:(n=s.next,s.next=e,e.next=n,t.lastEffect=e)),e}function Xp(){return Gt().memoizedState}function co(e,t,s,n){var r=ps();Xe.flags|=e,r.memoizedState=qi(1|t,s,void 0,n===void 0?null:n)}function wl(e,t,s,n){var r=Gt();n=n===void 0?null:n;var a=void 0;if(nt!==null){var o=nt.memoizedState;if(a=o.destroy,n!==null&&yd(n,o.deps)){r.memoizedState=qi(t,s,a,n);return}}Xe.flags|=e,r.memoizedState=qi(1|t,s,a,n)}function Kh(e,t){return co(8390656,8,e,t)}function wd(e,t){return wl(2048,8,e,t)}function qp(e,t){return wl(4,2,e,t)}function Yp(e,t){return wl(4,4,e,t)}function Gp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Kp(e,t,s){return s=s!=null?s.concat([e]):null,wl(4,4,Gp.bind(null,t,e),s)}function jd(){}function Qp(e,t){var s=Gt();t=t===void 0?null:t;var n=s.memoizedState;return n!==null&&t!==null&&yd(t,n[1])?n[0]:(s.memoizedState=[e,t],e)}function Jp(e,t){var s=Gt();t=t===void 0?null:t;var n=s.memoizedState;return n!==null&&t!==null&&yd(t,n[1])?n[0]:(e=e(),s.memoizedState=[e,t],e)}function Zp(e,t,s){return Xn&21?(cs(s,t)||(s=rp(),Xe.lanes|=s,qn|=s,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Tt=!0),e.memoizedState=s)}function lb(e,t){var s=Ae;Ae=s!==0&&4>s?s:4,e(!0);var n=sc.transition;sc.transition={};try{e(!1),t()}finally{Ae=s,sc.transition=n}}function ex(){return Gt().memoizedState}function cb(e,t,s){var n=fn(e);if(s={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null},tx(e))sx(t,s);else if(s=Op(e,t,s,n),s!==null){var r=jt();ls(s,e,n,r),nx(s,t,n)}}function ub(e,t,s){var n=fn(e),r={lane:n,action:s,hasEagerState:!1,eagerState:null,next:null};if(tx(e))sx(t,r);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,l=a(o,s);if(r.hasEagerState=!0,r.eagerState=l,cs(l,o)){var c=t.interleaved;c===null?(r.next=r,fd(t)):(r.next=c.next,c.next=r),t.interleaved=r;return}}catch{}finally{}s=Op(e,t,r,n),s!==null&&(r=jt(),ls(s,e,n,r),nx(s,t,n))}}function tx(e){var t=e.alternate;return e===Xe||t!==null&&t===Xe}function sx(e,t){_i=Ho=!0;var s=e.pending;s===null?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function nx(e,t,s){if(s&4194240){var n=t.lanes;n&=e.pendingLanes,s|=n,t.lanes=s,Zu(e,s)}}var Uo={readContext:Yt,useCallback:ft,useContext:ft,useEffect:ft,useImperativeHandle:ft,useInsertionEffect:ft,useLayoutEffect:ft,useMemo:ft,useReducer:ft,useRef:ft,useState:ft,useDebugValue:ft,useDeferredValue:ft,useTransition:ft,useMutableSource:ft,useSyncExternalStore:ft,useId:ft,unstable_isNewReconciler:!1},db={readContext:Yt,useCallback:function(e,t){return ps().memoizedState=[e,t===void 0?null:t],e},useContext:Yt,useEffect:Kh,useImperativeHandle:function(e,t,s){return s=s!=null?s.concat([e]):null,co(4194308,4,Gp.bind(null,t,e),s)},useLayoutEffect:function(e,t){return co(4194308,4,e,t)},useInsertionEffect:function(e,t){return co(4,2,e,t)},useMemo:function(e,t){var s=ps();return t=t===void 0?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var n=ps();return t=s!==void 0?s(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=cb.bind(null,Xe,e),[n.memoizedState,e]},useRef:function(e){var t=ps();return e={current:e},t.memoizedState=e},useState:Gh,useDebugValue:jd,useDeferredValue:function(e){return ps().memoizedState=e},useTransition:function(){var e=Gh(!1),t=e[0];return e=lb.bind(null,e[1]),ps().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var n=Xe,r=ps();if(Ue){if(s===void 0)throw Error(ee(407));s=s()}else{if(s=t(),ct===null)throw Error(ee(349));Xn&30||Bp(n,t,s)}r.memoizedState=s;var a={value:s,getSnapshot:t};return r.queue=a,Kh(Up.bind(null,n,a,e),[e]),n.flags|=2048,qi(9,Hp.bind(null,n,a,s,t),void 0,null),s},useId:function(){var e=ps(),t=ct.identifierPrefix;if(Ue){var s=Ds,n=Rs;s=(n&~(1<<32-os(n)-1)).toString(32)+s,t=":"+t+"R"+s,s=Wi++,0<s&&(t+="H"+s.toString(32)),t+=":"}else s=ob++,t=":"+t+"r"+s.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},hb={readContext:Yt,useCallback:Qp,useContext:Yt,useEffect:wd,useImperativeHandle:Kp,useInsertionEffect:qp,useLayoutEffect:Yp,useMemo:Jp,useReducer:nc,useRef:Xp,useState:function(){return nc(Xi)},useDebugValue:jd,useDeferredValue:function(e){var t=Gt();return Zp(t,nt.memoizedState,e)},useTransition:function(){var e=nc(Xi)[0],t=Gt().memoizedState;return[e,t]},useMutableSource:Ip,useSyncExternalStore:$p,useId:ex,unstable_isNewReconciler:!1},fb={readContext:Yt,useCallback:Qp,useContext:Yt,useEffect:wd,useImperativeHandle:Kp,useInsertionEffect:qp,useLayoutEffect:Yp,useMemo:Jp,useReducer:rc,useRef:Xp,useState:function(){return rc(Xi)},useDebugValue:jd,useDeferredValue:function(e){var t=Gt();return nt===null?t.memoizedState=e:Zp(t,nt.memoizedState,e)},useTransition:function(){var e=rc(Xi)[0],t=Gt().memoizedState;return[e,t]},useMutableSource:Ip,useSyncExternalStore:$p,useId:ex,unstable_isNewReconciler:!1};function es(e,t){if(e&&e.defaultProps){t=qe({},t),e=e.defaultProps;for(var s in e)t[s]===void 0&&(t[s]=e[s]);return t}return t}function ou(e,t,s,n){t=e.memoizedState,s=s(n,t),s=s==null?t:qe({},t,s),e.memoizedState=s,e.lanes===0&&(e.updateQueue.baseState=s)}var jl={isMounted:function(e){return(e=e._reactInternals)?Zn(e)===e:!1},enqueueSetState:function(e,t,s){e=e._reactInternals;var n=jt(),r=fn(e),a=Fs(n,r);a.payload=t,s!=null&&(a.callback=s),t=dn(e,a,r),t!==null&&(ls(t,e,r,n),oo(t,e,r))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var n=jt(),r=fn(e),a=Fs(n,r);a.tag=1,a.payload=t,s!=null&&(a.callback=s),t=dn(e,a,r),t!==null&&(ls(t,e,r,n),oo(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=jt(),n=fn(e),r=Fs(s,n);r.tag=2,t!=null&&(r.callback=t),t=dn(e,r,n),t!==null&&(ls(t,e,n,s),oo(t,e,n))}};function Qh(e,t,s,n,r,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,o):t.prototype&&t.prototype.isPureReactComponent?!Ii(s,n)||!Ii(r,a):!0}function rx(e,t,s){var n=!1,r=vn,a=t.contextType;return typeof a=="object"&&a!==null?a=Yt(a):(r=Mt(t)?Vn:vt.current,n=t.contextTypes,a=(n=n!=null)?Tr(e,r):vn),t=new t(s,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=jl,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=a),t}function Jh(e,t,s,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(s,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(s,n),t.state!==e&&jl.enqueueReplaceState(t,t.state,null)}function lu(e,t,s,n){var r=e.stateNode;r.props=s,r.state=e.memoizedState,r.refs={},md(e);var a=t.contextType;typeof a=="object"&&a!==null?r.context=Yt(a):(a=Mt(t)?Vn:vt.current,r.context=Tr(e,a)),r.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(ou(e,t,a,s),r.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(t=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),t!==r.state&&jl.enqueueReplaceState(r,r.state,null),$o(e,s,r,n),r.state=e.memoizedState),typeof r.componentDidMount=="function"&&(e.flags|=4194308)}function Pr(e,t){try{var s="",n=t;do s+=By(n),n=n.return;while(n);var r=s}catch(a){r=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:r,digest:null}}function ic(e,t,s){return{value:e,source:null,stack:s??null,digest:t??null}}function cu(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var mb=typeof WeakMap=="function"?WeakMap:Map;function ix(e,t,s){s=Fs(-1,s),s.tag=3,s.payload={element:null};var n=t.value;return s.callback=function(){Wo||(Wo=!0,vu=n),cu(e,t)},s}function ax(e,t,s){s=Fs(-1,s),s.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var r=t.value;s.payload=function(){return n(r)},s.callback=function(){cu(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(s.callback=function(){cu(e,t),typeof n!="function"&&(hn===null?hn=new Set([this]):hn.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),s}function Zh(e,t,s){var n=e.pingCache;if(n===null){n=e.pingCache=new mb;var r=new Set;n.set(t,r)}else r=n.get(t),r===void 0&&(r=new Set,n.set(t,r));r.has(s)||(r.add(s),e=Eb.bind(null,e,t,s),t.then(e,e))}function ef(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function tf(e,t,s,n,r){return e.mode&1?(e.flags|=65536,e.lanes=r,e):(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,s.tag===1&&(s.alternate===null?s.tag=17:(t=Fs(-1,1),t.tag=2,dn(s,t,1))),s.lanes|=1),e)}var gb=Ws.ReactCurrentOwner,Tt=!1;function bt(e,t,s,n){t.child=e===null?Dp(t,null,s,n):Ar(t,e.child,s,n)}function sf(e,t,s,n,r){s=s.render;var a=t.ref;return jr(t,r),n=vd(e,t,s,n,a,r),s=bd(),e!==null&&!Tt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Hs(e,t,r)):(Ue&&s&&od(t),t.flags|=1,bt(e,t,n,r),t.child)}function nf(e,t,s,n,r){if(e===null){var a=s.type;return typeof a=="function"&&!Ld(a)&&a.defaultProps===void 0&&s.compare===null&&s.defaultProps===void 0?(t.tag=15,t.type=a,ox(e,t,a,n,r)):(e=mo(s.type,null,n,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&r)){var o=a.memoizedProps;if(s=s.compare,s=s!==null?s:Ii,s(o,n)&&e.ref===t.ref)return Hs(e,t,r)}return t.flags|=1,e=mn(a,n),e.ref=t.ref,e.return=t,t.child=e}function ox(e,t,s,n,r){if(e!==null){var a=e.memoizedProps;if(Ii(a,n)&&e.ref===t.ref)if(Tt=!1,t.pendingProps=n=a,(e.lanes&r)!==0)e.flags&131072&&(Tt=!0);else return t.lanes=e.lanes,Hs(e,t,r)}return uu(e,t,s,n,r)}function lx(e,t,s){var n=t.pendingProps,r=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Fe(pr,Rt),Rt|=s;else{if(!(s&1073741824))return e=a!==null?a.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Fe(pr,Rt),Rt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:s,Fe(pr,Rt),Rt|=n}else a!==null?(n=a.baseLanes|s,t.memoizedState=null):n=s,Fe(pr,Rt),Rt|=n;return bt(e,t,r,s),t.child}function cx(e,t){var s=t.ref;(e===null&&s!==null||e!==null&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function uu(e,t,s,n,r){var a=Mt(s)?Vn:vt.current;return a=Tr(t,a),jr(t,r),s=vd(e,t,s,n,a,r),n=bd(),e!==null&&!Tt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~r,Hs(e,t,r)):(Ue&&n&&od(t),t.flags|=1,bt(e,t,s,r),t.child)}function rf(e,t,s,n,r){if(Mt(s)){var a=!0;Do(t)}else a=!1;if(jr(t,r),t.stateNode===null)uo(e,t),rx(t,s,n),lu(t,s,n,r),n=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=s.contextType;typeof u=="object"&&u!==null?u=Yt(u):(u=Mt(s)?Vn:vt.current,u=Tr(t,u));var d=s.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==n||c!==u)&&Jh(t,o,n,u),Qs=!1;var f=t.memoizedState;o.state=f,$o(t,n,o,r),c=t.memoizedState,l!==n||f!==c||At.current||Qs?(typeof d=="function"&&(ou(t,s,d,n),c=t.memoizedState),(l=Qs||Qh(t,s,l,n,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),o.props=n,o.state=c,o.context=u,n=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{o=t.stateNode,Fp(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:es(t.type,l),o.props=u,h=t.pendingProps,f=o.context,c=s.contextType,typeof c=="object"&&c!==null?c=Yt(c):(c=Mt(s)?Vn:vt.current,c=Tr(t,c));var m=s.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&Jh(t,o,n,c),Qs=!1,f=t.memoizedState,o.state=f,$o(t,n,o,r);var v=t.memoizedState;l!==h||f!==v||At.current||Qs?(typeof m=="function"&&(ou(t,s,m,n),v=t.memoizedState),(u=Qs||Qh(t,s,u,n,f,v,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(n,v,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(n,v,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),o.props=n,o.state=v,o.context=c,n=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return du(e,t,s,n,a,r)}function du(e,t,s,n,r,a){cx(e,t);var o=(t.flags&128)!==0;if(!n&&!o)return r&&Uh(t,s,!1),Hs(e,t,a);n=t.stateNode,gb.current=t;var l=o&&typeof s.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&o?(t.child=Ar(t,e.child,null,a),t.child=Ar(t,null,l,a)):bt(e,t,l,a),t.memoizedState=n.state,r&&Uh(t,s,!0),t.child}function ux(e){var t=e.stateNode;t.pendingContext?Hh(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Hh(e,t.context,!1),gd(e,t.containerInfo)}function af(e,t,s,n,r){return Lr(),cd(r),t.flags|=256,bt(e,t,s,n),t.child}var hu={dehydrated:null,treeContext:null,retryLane:0};function fu(e){return{baseLanes:e,cachePool:null,transitions:null}}function dx(e,t,s){var n=t.pendingProps,r=We.current,a=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(r&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(r|=1),Fe(We,r&1),e===null)return iu(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=n.children,e=n.fallback,a?(n=t.mode,a=t.child,o={mode:"hidden",children:o},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=o):a=kl(o,n,0,null),e=$n(e,n,s,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=fu(s),t.memoizedState=hu,e):_d(t,o));if(r=e.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return pb(e,t,o,n,l,r,s);if(a){a=n.fallback,o=t.mode,r=e.child,l=r.sibling;var c={mode:"hidden",children:n.children};return!(o&1)&&t.child!==r?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=mn(r,c),n.subtreeFlags=r.subtreeFlags&14680064),l!==null?a=mn(l,a):(a=$n(a,o,s,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,o=e.child.memoizedState,o=o===null?fu(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},a.memoizedState=o,a.childLanes=e.childLanes&~s,t.memoizedState=hu,n}return a=e.child,e=a.sibling,n=mn(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=s),n.return=t,n.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n}function _d(e,t){return t=kl({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ca(e,t,s,n){return n!==null&&cd(n),Ar(t,e.child,null,s),e=_d(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function pb(e,t,s,n,r,a,o){if(s)return t.flags&256?(t.flags&=-257,n=ic(Error(ee(422))),Ca(e,t,o,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,r=t.mode,n=kl({mode:"visible",children:n.children},r,0,null),a=$n(a,r,o,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Ar(t,e.child,null,o),t.child.memoizedState=fu(o),t.memoizedState=hu,a);if(!(t.mode&1))return Ca(e,t,o,null);if(r.data==="$!"){if(n=r.nextSibling&&r.nextSibling.dataset,n)var l=n.dgst;return n=l,a=Error(ee(419)),n=ic(a,n,void 0),Ca(e,t,o,n)}if(l=(o&e.childLanes)!==0,Tt||l){if(n=ct,n!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(n.suspendedLanes|o)?0:r,r!==0&&r!==a.retryLane&&(a.retryLane=r,Bs(e,r),ls(n,e,r,-1))}return Td(),n=ic(Error(ee(421))),Ca(e,t,o,n)}return r.data==="$?"?(t.flags|=128,t.child=e.child,t=Tb.bind(null,e),r._reactRetry=t,null):(e=a.treeContext,Dt=un(r.nextSibling),Ot=t,Ue=!0,ss=null,e!==null&&(Ut[Vt++]=Rs,Ut[Vt++]=Ds,Ut[Vt++]=Wn,Rs=e.id,Ds=e.overflow,Wn=t),t=_d(t,n.children),t.flags|=4096,t)}function of(e,t,s){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),au(e.return,t,s)}function ac(e,t,s,n,r){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:s,tailMode:r}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=s,a.tailMode=r)}function hx(e,t,s){var n=t.pendingProps,r=n.revealOrder,a=n.tail;if(bt(e,t,n.children,s),n=We.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&of(e,s,t);else if(e.tag===19)of(e,s,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Fe(We,n),!(t.mode&1))t.memoizedState=null;else switch(r){case"forwards":for(s=t.child,r=null;s!==null;)e=s.alternate,e!==null&&Bo(e)===null&&(r=s),s=s.sibling;s=r,s===null?(r=t.child,t.child=null):(r=s.sibling,s.sibling=null),ac(t,!1,r,s,a);break;case"backwards":for(s=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&Bo(e)===null){t.child=r;break}e=r.sibling,r.sibling=s,s=r,r=e}ac(t,!0,s,null,a);break;case"together":ac(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function uo(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Hs(e,t,s){if(e!==null&&(t.dependencies=e.dependencies),qn|=t.lanes,!(s&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ee(153));if(t.child!==null){for(e=t.child,s=mn(e,e.pendingProps),t.child=s,s.return=t;e.sibling!==null;)e=e.sibling,s=s.sibling=mn(e,e.pendingProps),s.return=t;s.sibling=null}return t.child}function xb(e,t,s){switch(t.tag){case 3:ux(t),Lr();break;case 5:zp(t);break;case 1:Mt(t.type)&&Do(t);break;case 4:gd(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,r=t.memoizedProps.value;Fe(zo,n._currentValue),n._currentValue=r;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(Fe(We,We.current&1),t.flags|=128,null):s&t.child.childLanes?dx(e,t,s):(Fe(We,We.current&1),e=Hs(e,t,s),e!==null?e.sibling:null);Fe(We,We.current&1);break;case 19:if(n=(s&t.childLanes)!==0,e.flags&128){if(n)return hx(e,t,s);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Fe(We,We.current),n)break;return null;case 22:case 23:return t.lanes=0,lx(e,t,s)}return Hs(e,t,s)}var fx,mu,mx,gx;fx=function(e,t){for(var s=t.child;s!==null;){if(s.tag===5||s.tag===6)e.appendChild(s.stateNode);else if(s.tag!==4&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}};mu=function(){};mx=function(e,t,s,n){var r=e.memoizedProps;if(r!==n){e=t.stateNode,On(js.current);var a=null;switch(s){case"input":r=Oc(e,r),n=Oc(e,n),a=[];break;case"select":r=qe({},r,{value:void 0}),n=qe({},n,{value:void 0}),a=[];break;case"textarea":r=Ic(e,r),n=Ic(e,n),a=[];break;default:typeof r.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Po)}Bc(s,n);var o;s=null;for(u in r)if(!n.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var l=r[u];for(o in l)l.hasOwnProperty(o)&&(s||(s={}),s[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Mi.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(l=r!=null?r[u]:void 0,n.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(s||(s={}),s[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(s||(s={}),s[o]=c[o])}else s||(a||(a=[]),a.push(u,s)),s=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Mi.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&$e("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}s&&(a=a||[]).push("style",s);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};gx=function(e,t,s,n){s!==n&&(t.flags|=4)};function ei(e,t){if(!Ue)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var n=null;s!==null;)s.alternate!==null&&(n=s),s=s.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function mt(e){var t=e.alternate!==null&&e.alternate.child===e.child,s=0,n=0;if(t)for(var r=e.child;r!==null;)s|=r.lanes|r.childLanes,n|=r.subtreeFlags&14680064,n|=r.flags&14680064,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)s|=r.lanes|r.childLanes,n|=r.subtreeFlags,n|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=n,e.childLanes=s,t}function yb(e,t,s){var n=t.pendingProps;switch(ld(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return mt(t),null;case 1:return Mt(t.type)&&Ro(),mt(t),null;case 3:return n=t.stateNode,Mr(),He(At),He(vt),xd(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(ka(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ss!==null&&(ju(ss),ss=null))),mu(e,t),mt(t),null;case 5:pd(t);var r=On(Vi.current);if(s=t.type,e!==null&&t.stateNode!=null)mx(e,t,s,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(ee(166));return mt(t),null}if(e=On(js.current),ka(t)){n=t.stateNode,s=t.type;var a=t.memoizedProps;switch(n[ys]=t,n[Hi]=a,e=(t.mode&1)!==0,s){case"dialog":$e("cancel",n),$e("close",n);break;case"iframe":case"object":case"embed":$e("load",n);break;case"video":case"audio":for(r=0;r<hi.length;r++)$e(hi[r],n);break;case"source":$e("error",n);break;case"img":case"image":case"link":$e("error",n),$e("load",n);break;case"details":$e("toggle",n);break;case"input":gh(n,a),$e("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},$e("invalid",n);break;case"textarea":xh(n,a),$e("invalid",n)}Bc(s,a),r=null;for(var o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="children"?typeof l=="string"?n.textContent!==l&&(a.suppressHydrationWarning!==!0&&Na(n.textContent,l,e),r=["children",l]):typeof l=="number"&&n.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Na(n.textContent,l,e),r=["children",""+l]):Mi.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&$e("scroll",n)}switch(s){case"input":pa(n),ph(n,a,!0);break;case"textarea":pa(n),yh(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Po)}n=r,t.updateQueue=n,n!==null&&(t.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Ug(s)),e==="http://www.w3.org/1999/xhtml"?s==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=o.createElement(s,{is:n.is}):(e=o.createElement(s),s==="select"&&(o=e,n.multiple?o.multiple=!0:n.size&&(o.size=n.size))):e=o.createElementNS(e,s),e[ys]=t,e[Hi]=n,fx(e,t,!1,!1),t.stateNode=e;e:{switch(o=Hc(s,n),s){case"dialog":$e("cancel",e),$e("close",e),r=n;break;case"iframe":case"object":case"embed":$e("load",e),r=n;break;case"video":case"audio":for(r=0;r<hi.length;r++)$e(hi[r],e);r=n;break;case"source":$e("error",e),r=n;break;case"img":case"image":case"link":$e("error",e),$e("load",e),r=n;break;case"details":$e("toggle",e),r=n;break;case"input":gh(e,n),r=Oc(e,n),$e("invalid",e);break;case"option":r=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},r=qe({},n,{value:void 0}),$e("invalid",e);break;case"textarea":xh(e,n),r=Ic(e,n),$e("invalid",e);break;default:r=n}Bc(s,r),l=r;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?Xg(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Vg(e,c)):a==="children"?typeof c=="string"?(s!=="textarea"||c!=="")&&Pi(e,c):typeof c=="number"&&Pi(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Mi.hasOwnProperty(a)?c!=null&&a==="onScroll"&&$e("scroll",e):c!=null&&qu(e,a,c,o))}switch(s){case"input":pa(e),ph(e,n,!1);break;case"textarea":pa(e),yh(e);break;case"option":n.value!=null&&e.setAttribute("value",""+yn(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?yr(e,!!n.multiple,a,!1):n.defaultValue!=null&&yr(e,!!n.multiple,n.defaultValue,!0);break;default:typeof r.onClick=="function"&&(e.onclick=Po)}switch(s){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return mt(t),null;case 6:if(e&&t.stateNode!=null)gx(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(ee(166));if(s=On(Vi.current),On(js.current),ka(t)){if(n=t.stateNode,s=t.memoizedProps,n[ys]=t,(a=n.nodeValue!==s)&&(e=Ot,e!==null))switch(e.tag){case 3:Na(n.nodeValue,s,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Na(n.nodeValue,s,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(s.nodeType===9?s:s.ownerDocument).createTextNode(n),n[ys]=t,t.stateNode=n}return mt(t),null;case 13:if(He(We),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ue&&Dt!==null&&t.mode&1&&!(t.flags&128))Pp(),Lr(),t.flags|=98560,a=!1;else if(a=ka(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(ee(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(ee(317));a[ys]=t}else Lr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;mt(t),a=!1}else ss!==null&&(ju(ss),ss=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=s,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||We.current&1?it===0&&(it=3):Td())),t.updateQueue!==null&&(t.flags|=4),mt(t),null);case 4:return Mr(),mu(e,t),e===null&&$i(t.stateNode.containerInfo),mt(t),null;case 10:return hd(t.type._context),mt(t),null;case 17:return Mt(t.type)&&Ro(),mt(t),null;case 19:if(He(We),a=t.memoizedState,a===null)return mt(t),null;if(n=(t.flags&128)!==0,o=a.rendering,o===null)if(n)ei(a,!1);else{if(it!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=Bo(e),o!==null){for(t.flags|=128,ei(a,!1),n=o.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=s,s=t.child;s!==null;)a=s,e=n,a.flags&=14680066,o=a.alternate,o===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=o.childLanes,a.lanes=o.lanes,a.child=o.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=o.memoizedProps,a.memoizedState=o.memoizedState,a.updateQueue=o.updateQueue,a.type=o.type,e=o.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Fe(We,We.current&1|2),t.child}e=e.sibling}a.tail!==null&&Ke()>Rr&&(t.flags|=128,n=!0,ei(a,!1),t.lanes=4194304)}else{if(!n)if(e=Bo(o),e!==null){if(t.flags|=128,n=!0,s=e.updateQueue,s!==null&&(t.updateQueue=s,t.flags|=4),ei(a,!0),a.tail===null&&a.tailMode==="hidden"&&!o.alternate&&!Ue)return mt(t),null}else 2*Ke()-a.renderingStartTime>Rr&&s!==1073741824&&(t.flags|=128,n=!0,ei(a,!1),t.lanes=4194304);a.isBackwards?(o.sibling=t.child,t.child=o):(s=a.last,s!==null?s.sibling=o:t.child=o,a.last=o)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Ke(),t.sibling=null,s=We.current,Fe(We,n?s&1|2:s&1),t):(mt(t),null);case 22:case 23:return Ed(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Rt&1073741824&&(mt(t),t.subtreeFlags&6&&(t.flags|=8192)):mt(t),null;case 24:return null;case 25:return null}throw Error(ee(156,t.tag))}function vb(e,t){switch(ld(t),t.tag){case 1:return Mt(t.type)&&Ro(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Mr(),He(At),He(vt),xd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return pd(t),null;case 13:if(He(We),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ee(340));Lr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return He(We),null;case 4:return Mr(),null;case 10:return hd(t.type._context),null;case 22:case 23:return Ed(),null;case 24:return null;default:return null}}var Ea=!1,pt=!1,bb=typeof WeakSet=="function"?WeakSet:Set,le=null;function gr(e,t){var s=e.ref;if(s!==null)if(typeof s=="function")try{s(null)}catch(n){Ye(e,t,n)}else s.current=null}function gu(e,t,s){try{s()}catch(n){Ye(e,t,n)}}var lf=!1;function wb(e,t){if(Jc=Lo,e=bp(),ad(e)){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{s=(s=e.ownerDocument)&&s.defaultView||window;var n=s.getSelection&&s.getSelection();if(n&&n.rangeCount!==0){s=n.anchorNode;var r=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{s.nodeType,a.nodeType}catch{s=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var m;h!==s||r!==0&&h.nodeType!==3||(l=o+r),h!==a||n!==0&&h.nodeType!==3||(c=o+n),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===e)break t;if(f===s&&++u===r&&(l=o),f===a&&++d===n&&(c=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}s=l===-1||c===-1?null:{start:l,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(Zc={focusedElem:e,selectionRange:s},Lo=!1,le=t;le!==null;)if(t=le,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,le=e;else for(;le!==null;){t=le;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var x=v.memoizedProps,y=v.memoizedState,g=t.stateNode,p=g.getSnapshotBeforeUpdate(t.elementType===t.type?x:es(t.type,x),y);g.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var w=t.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(b){Ye(t,t.return,b)}if(e=t.sibling,e!==null){e.return=t.return,le=e;break}le=t.return}return v=lf,lf=!1,v}function Ni(e,t,s){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var r=n=n.next;do{if((r.tag&e)===e){var a=r.destroy;r.destroy=void 0,a!==void 0&&gu(t,s,a)}r=r.next}while(r!==n)}}function _l(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var s=t=t.next;do{if((s.tag&e)===e){var n=s.create;s.destroy=n()}s=s.next}while(s!==t)}}function pu(e){var t=e.ref;if(t!==null){var s=e.stateNode;switch(e.tag){case 5:e=s;break;default:e=s}typeof t=="function"?t(e):t.current=e}}function px(e){var t=e.alternate;t!==null&&(e.alternate=null,px(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ys],delete t[Hi],delete t[su],delete t[nb],delete t[rb])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function xx(e){return e.tag===5||e.tag===3||e.tag===4}function cf(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||xx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function xu(e,t,s){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?s.nodeType===8?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(s.nodeType===8?(t=s.parentNode,t.insertBefore(e,s)):(t=s,t.appendChild(e)),s=s._reactRootContainer,s!=null||t.onclick!==null||(t.onclick=Po));else if(n!==4&&(e=e.child,e!==null))for(xu(e,t,s),e=e.sibling;e!==null;)xu(e,t,s),e=e.sibling}function yu(e,t,s){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(yu(e,t,s),e=e.sibling;e!==null;)yu(e,t,s),e=e.sibling}var ut=null,ts=!1;function Ys(e,t,s){for(s=s.child;s!==null;)yx(e,t,s),s=s.sibling}function yx(e,t,s){if(ws&&typeof ws.onCommitFiberUnmount=="function")try{ws.onCommitFiberUnmount(gl,s)}catch{}switch(s.tag){case 5:pt||gr(s,t);case 6:var n=ut,r=ts;ut=null,Ys(e,t,s),ut=n,ts=r,ut!==null&&(ts?(e=ut,s=s.stateNode,e.nodeType===8?e.parentNode.removeChild(s):e.removeChild(s)):ut.removeChild(s.stateNode));break;case 18:ut!==null&&(ts?(e=ut,s=s.stateNode,e.nodeType===8?Zl(e.parentNode,s):e.nodeType===1&&Zl(e,s),Fi(e)):Zl(ut,s.stateNode));break;case 4:n=ut,r=ts,ut=s.stateNode.containerInfo,ts=!0,Ys(e,t,s),ut=n,ts=r;break;case 0:case 11:case 14:case 15:if(!pt&&(n=s.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){r=n=n.next;do{var a=r,o=a.destroy;a=a.tag,o!==void 0&&(a&2||a&4)&&gu(s,t,o),r=r.next}while(r!==n)}Ys(e,t,s);break;case 1:if(!pt&&(gr(s,t),n=s.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=s.memoizedProps,n.state=s.memoizedState,n.componentWillUnmount()}catch(l){Ye(s,t,l)}Ys(e,t,s);break;case 21:Ys(e,t,s);break;case 22:s.mode&1?(pt=(n=pt)||s.memoizedState!==null,Ys(e,t,s),pt=n):Ys(e,t,s);break;default:Ys(e,t,s)}}function uf(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var s=e.stateNode;s===null&&(s=e.stateNode=new bb),t.forEach(function(n){var r=Lb.bind(null,e,n);s.has(n)||(s.add(n),n.then(r,r))})}}function Zt(e,t){var s=t.deletions;if(s!==null)for(var n=0;n<s.length;n++){var r=s[n];try{var a=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:ut=l.stateNode,ts=!1;break e;case 3:ut=l.stateNode.containerInfo,ts=!0;break e;case 4:ut=l.stateNode.containerInfo,ts=!0;break e}l=l.return}if(ut===null)throw Error(ee(160));yx(a,o,r),ut=null,ts=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(u){Ye(r,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)vx(t,e),t=t.sibling}function vx(e,t){var s=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Zt(t,e),fs(e),n&4){try{Ni(3,e,e.return),_l(3,e)}catch(x){Ye(e,e.return,x)}try{Ni(5,e,e.return)}catch(x){Ye(e,e.return,x)}}break;case 1:Zt(t,e),fs(e),n&512&&s!==null&&gr(s,s.return);break;case 5:if(Zt(t,e),fs(e),n&512&&s!==null&&gr(s,s.return),e.flags&32){var r=e.stateNode;try{Pi(r,"")}catch(x){Ye(e,e.return,x)}}if(n&4&&(r=e.stateNode,r!=null)){var a=e.memoizedProps,o=s!==null?s.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&Bg(r,a),Hc(l,o);var u=Hc(l,a);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?Xg(r,h):d==="dangerouslySetInnerHTML"?Vg(r,h):d==="children"?Pi(r,h):qu(r,d,h,u)}switch(l){case"input":Fc(r,a);break;case"textarea":Hg(r,a);break;case"select":var f=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!a.multiple;var m=a.value;m!=null?yr(r,!!a.multiple,m,!1):f!==!!a.multiple&&(a.defaultValue!=null?yr(r,!!a.multiple,a.defaultValue,!0):yr(r,!!a.multiple,a.multiple?[]:"",!1))}r[Hi]=a}catch(x){Ye(e,e.return,x)}}break;case 6:if(Zt(t,e),fs(e),n&4){if(e.stateNode===null)throw Error(ee(162));r=e.stateNode,a=e.memoizedProps;try{r.nodeValue=a}catch(x){Ye(e,e.return,x)}}break;case 3:if(Zt(t,e),fs(e),n&4&&s!==null&&s.memoizedState.isDehydrated)try{Fi(t.containerInfo)}catch(x){Ye(e,e.return,x)}break;case 4:Zt(t,e),fs(e);break;case 13:Zt(t,e),fs(e),r=e.child,r.flags&8192&&(a=r.memoizedState!==null,r.stateNode.isHidden=a,!a||r.alternate!==null&&r.alternate.memoizedState!==null||(Sd=Ke())),n&4&&uf(e);break;case 22:if(d=s!==null&&s.memoizedState!==null,e.mode&1?(pt=(u=pt)||d,Zt(t,e),pt=u):Zt(t,e),fs(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(le=e,d=e.child;d!==null;){for(h=le=d;le!==null;){switch(f=le,m=f.child,f.tag){case 0:case 11:case 14:case 15:Ni(4,f,f.return);break;case 1:gr(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){n=f,s=f.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(x){Ye(n,s,x)}}break;case 5:gr(f,f.return);break;case 22:if(f.memoizedState!==null){hf(h);continue}}m!==null?(m.return=f,le=m):hf(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{r=h.stateNode,u?(a=r.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Wg("display",o))}catch(x){Ye(e,e.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Ye(e,e.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Zt(t,e),fs(e),n&4&&uf(e);break;case 21:break;default:Zt(t,e),fs(e)}}function fs(e){var t=e.flags;if(t&2){try{e:{for(var s=e.return;s!==null;){if(xx(s)){var n=s;break e}s=s.return}throw Error(ee(160))}switch(n.tag){case 5:var r=n.stateNode;n.flags&32&&(Pi(r,""),n.flags&=-33);var a=cf(e);yu(e,a,r);break;case 3:case 4:var o=n.stateNode.containerInfo,l=cf(e);xu(e,l,o);break;default:throw Error(ee(161))}}catch(c){Ye(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function jb(e,t,s){le=e,bx(e)}function bx(e,t,s){for(var n=(e.mode&1)!==0;le!==null;){var r=le,a=r.child;if(r.tag===22&&n){var o=r.memoizedState!==null||Ea;if(!o){var l=r.alternate,c=l!==null&&l.memoizedState!==null||pt;l=Ea;var u=pt;if(Ea=o,(pt=c)&&!u)for(le=r;le!==null;)o=le,c=o.child,o.tag===22&&o.memoizedState!==null?ff(r):c!==null?(c.return=o,le=c):ff(r);for(;a!==null;)le=a,bx(a),a=a.sibling;le=r,Ea=l,pt=u}df(e)}else r.subtreeFlags&8772&&a!==null?(a.return=r,le=a):df(e)}}function df(e){for(;le!==null;){var t=le;if(t.flags&8772){var s=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:pt||_l(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!pt)if(s===null)n.componentDidMount();else{var r=t.elementType===t.type?s.memoizedProps:es(t.type,s.memoizedProps);n.componentDidUpdate(r,s.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Yh(t,a,n);break;case 3:var o=t.updateQueue;if(o!==null){if(s=null,t.child!==null)switch(t.child.tag){case 5:s=t.child.stateNode;break;case 1:s=t.child.stateNode}Yh(t,o,s)}break;case 5:var l=t.stateNode;if(s===null&&t.flags&4){s=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Fi(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}pt||t.flags&512&&pu(t)}catch(f){Ye(t,t.return,f)}}if(t===e){le=null;break}if(s=t.sibling,s!==null){s.return=t.return,le=s;break}le=t.return}}function hf(e){for(;le!==null;){var t=le;if(t===e){le=null;break}var s=t.sibling;if(s!==null){s.return=t.return,le=s;break}le=t.return}}function ff(e){for(;le!==null;){var t=le;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{_l(4,t)}catch(c){Ye(t,s,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var r=t.return;try{n.componentDidMount()}catch(c){Ye(t,r,c)}}var a=t.return;try{pu(t)}catch(c){Ye(t,a,c)}break;case 5:var o=t.return;try{pu(t)}catch(c){Ye(t,o,c)}}}catch(c){Ye(t,t.return,c)}if(t===e){le=null;break}var l=t.sibling;if(l!==null){l.return=t.return,le=l;break}le=t.return}}var _b=Math.ceil,Vo=Ws.ReactCurrentDispatcher,Nd=Ws.ReactCurrentOwner,qt=Ws.ReactCurrentBatchConfig,Se=0,ct=null,Ze=null,dt=0,Rt=0,pr=kn(0),it=0,Yi=null,qn=0,Nl=0,kd=0,ki=null,Ct=null,Sd=0,Rr=1/0,Ls=null,Wo=!1,vu=null,hn=null,Ta=!1,tn=null,Xo=0,Si=0,bu=null,ho=-1,fo=0;function jt(){return Se&6?Ke():ho!==-1?ho:ho=Ke()}function fn(e){return e.mode&1?Se&2&&dt!==0?dt&-dt:ab.transition!==null?(fo===0&&(fo=rp()),fo):(e=Ae,e!==0||(e=window.event,e=e===void 0?16:dp(e.type)),e):1}function ls(e,t,s,n){if(50<Si)throw Si=0,bu=null,Error(ee(185));ia(e,s,n),(!(Se&2)||e!==ct)&&(e===ct&&(!(Se&2)&&(Nl|=s),it===4&&Zs(e,dt)),Pt(e,n),s===1&&Se===0&&!(t.mode&1)&&(Rr=Ke()+500,bl&&Sn()))}function Pt(e,t){var s=e.callbackNode;av(e,t);var n=To(e,e===ct?dt:0);if(n===0)s!==null&&wh(s),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(s!=null&&wh(s),t===1)e.tag===0?ib(mf.bind(null,e)):Lp(mf.bind(null,e)),tb(function(){!(Se&6)&&Sn()}),s=null;else{switch(ip(n)){case 1:s=Ju;break;case 4:s=sp;break;case 16:s=Eo;break;case 536870912:s=np;break;default:s=Eo}s=Ex(s,wx.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function wx(e,t){if(ho=-1,fo=0,Se&6)throw Error(ee(327));var s=e.callbackNode;if(_r()&&e.callbackNode!==s)return null;var n=To(e,e===ct?dt:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=qo(e,n);else{t=n;var r=Se;Se|=2;var a=_x();(ct!==e||dt!==t)&&(Ls=null,Rr=Ke()+500,In(e,t));do try{Sb();break}catch(l){jx(e,l)}while(!0);dd(),Vo.current=a,Se=r,Ze!==null?t=0:(ct=null,dt=0,t=it)}if(t!==0){if(t===2&&(r=qc(e),r!==0&&(n=r,t=wu(e,r))),t===1)throw s=Yi,In(e,0),Zs(e,n),Pt(e,Ke()),s;if(t===6)Zs(e,n);else{if(r=e.current.alternate,!(n&30)&&!Nb(r)&&(t=qo(e,n),t===2&&(a=qc(e),a!==0&&(n=a,t=wu(e,a))),t===1))throw s=Yi,In(e,0),Zs(e,n),Pt(e,Ke()),s;switch(e.finishedWork=r,e.finishedLanes=n,t){case 0:case 1:throw Error(ee(345));case 2:Mn(e,Ct,Ls);break;case 3:if(Zs(e,n),(n&130023424)===n&&(t=Sd+500-Ke(),10<t)){if(To(e,0)!==0)break;if(r=e.suspendedLanes,(r&n)!==n){jt(),e.pingedLanes|=e.suspendedLanes&r;break}e.timeoutHandle=tu(Mn.bind(null,e,Ct,Ls),t);break}Mn(e,Ct,Ls);break;case 4:if(Zs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,r=-1;0<n;){var o=31-os(n);a=1<<o,o=t[o],o>r&&(r=o),n&=~a}if(n=r,n=Ke()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*_b(n/1960))-n,10<n){e.timeoutHandle=tu(Mn.bind(null,e,Ct,Ls),n);break}Mn(e,Ct,Ls);break;case 5:Mn(e,Ct,Ls);break;default:throw Error(ee(329))}}}return Pt(e,Ke()),e.callbackNode===s?wx.bind(null,e):null}function wu(e,t){var s=ki;return e.current.memoizedState.isDehydrated&&(In(e,t).flags|=256),e=qo(e,t),e!==2&&(t=Ct,Ct=s,t!==null&&ju(t)),e}function ju(e){Ct===null?Ct=e:Ct.push.apply(Ct,e)}function Nb(e){for(var t=e;;){if(t.flags&16384){var s=t.updateQueue;if(s!==null&&(s=s.stores,s!==null))for(var n=0;n<s.length;n++){var r=s[n],a=r.getSnapshot;r=r.value;try{if(!cs(a(),r))return!1}catch{return!1}}}if(s=t.child,t.subtreeFlags&16384&&s!==null)s.return=t,t=s;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Zs(e,t){for(t&=~kd,t&=~Nl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-os(t),n=1<<s;e[s]=-1,t&=~n}}function mf(e){if(Se&6)throw Error(ee(327));_r();var t=To(e,0);if(!(t&1))return Pt(e,Ke()),null;var s=qo(e,t);if(e.tag!==0&&s===2){var n=qc(e);n!==0&&(t=n,s=wu(e,n))}if(s===1)throw s=Yi,In(e,0),Zs(e,t),Pt(e,Ke()),s;if(s===6)throw Error(ee(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Mn(e,Ct,Ls),Pt(e,Ke()),null}function Cd(e,t){var s=Se;Se|=1;try{return e(t)}finally{Se=s,Se===0&&(Rr=Ke()+500,bl&&Sn())}}function Yn(e){tn!==null&&tn.tag===0&&!(Se&6)&&_r();var t=Se;Se|=1;var s=qt.transition,n=Ae;try{if(qt.transition=null,Ae=1,e)return e()}finally{Ae=n,qt.transition=s,Se=t,!(Se&6)&&Sn()}}function Ed(){Rt=pr.current,He(pr)}function In(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(s!==-1&&(e.timeoutHandle=-1,eb(s)),Ze!==null)for(s=Ze.return;s!==null;){var n=s;switch(ld(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Ro();break;case 3:Mr(),He(At),He(vt),xd();break;case 5:pd(n);break;case 4:Mr();break;case 13:He(We);break;case 19:He(We);break;case 10:hd(n.type._context);break;case 22:case 23:Ed()}s=s.return}if(ct=e,Ze=e=mn(e.current,null),dt=Rt=t,it=0,Yi=null,kd=Nl=qn=0,Ct=ki=null,Dn!==null){for(t=0;t<Dn.length;t++)if(s=Dn[t],n=s.interleaved,n!==null){s.interleaved=null;var r=n.next,a=s.pending;if(a!==null){var o=a.next;a.next=r,n.next=o}s.pending=n}Dn=null}return e}function jx(e,t){do{var s=Ze;try{if(dd(),lo.current=Uo,Ho){for(var n=Xe.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}Ho=!1}if(Xn=0,lt=nt=Xe=null,_i=!1,Wi=0,Nd.current=null,s===null||s.return===null){it=1,Yi=t,Ze=null;break}e:{var a=e,o=s.return,l=s,c=t;if(t=dt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=ef(o);if(m!==null){m.flags&=-257,tf(m,o,l,a,t),m.mode&1&&Zh(a,u,t),t=m,c=u;var v=t.updateQueue;if(v===null){var x=new Set;x.add(c),t.updateQueue=x}else v.add(c);break e}else{if(!(t&1)){Zh(a,u,t),Td();break e}c=Error(ee(426))}}else if(Ue&&l.mode&1){var y=ef(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),tf(y,o,l,a,t),cd(Pr(c,l));break e}}a=c=Pr(c,l),it!==4&&(it=2),ki===null?ki=[a]:ki.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var g=ix(a,c,t);qh(a,g);break e;case 1:l=c;var p=a.type,w=a.stateNode;if(!(a.flags&128)&&(typeof p.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(hn===null||!hn.has(w)))){a.flags|=65536,t&=-t,a.lanes|=t;var b=ax(a,l,t);qh(a,b);break e}}a=a.return}while(a!==null)}kx(s)}catch(k){t=k,Ze===s&&s!==null&&(Ze=s=s.return);continue}break}while(!0)}function _x(){var e=Vo.current;return Vo.current=Uo,e===null?Uo:e}function Td(){(it===0||it===3||it===2)&&(it=4),ct===null||!(qn&268435455)&&!(Nl&268435455)||Zs(ct,dt)}function qo(e,t){var s=Se;Se|=2;var n=_x();(ct!==e||dt!==t)&&(Ls=null,In(e,t));do try{kb();break}catch(r){jx(e,r)}while(!0);if(dd(),Se=s,Vo.current=n,Ze!==null)throw Error(ee(261));return ct=null,dt=0,it}function kb(){for(;Ze!==null;)Nx(Ze)}function Sb(){for(;Ze!==null&&!Qy();)Nx(Ze)}function Nx(e){var t=Cx(e.alternate,e,Rt);e.memoizedProps=e.pendingProps,t===null?kx(e):Ze=t,Nd.current=null}function kx(e){var t=e;do{var s=t.alternate;if(e=t.return,t.flags&32768){if(s=vb(s,t),s!==null){s.flags&=32767,Ze=s;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{it=6,Ze=null;return}}else if(s=yb(s,t,Rt),s!==null){Ze=s;return}if(t=t.sibling,t!==null){Ze=t;return}Ze=t=e}while(t!==null);it===0&&(it=5)}function Mn(e,t,s){var n=Ae,r=qt.transition;try{qt.transition=null,Ae=1,Cb(e,t,s,n)}finally{qt.transition=r,Ae=n}return null}function Cb(e,t,s,n){do _r();while(tn!==null);if(Se&6)throw Error(ee(327));s=e.finishedWork;var r=e.finishedLanes;if(s===null)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(ee(177));e.callbackNode=null,e.callbackPriority=0;var a=s.lanes|s.childLanes;if(ov(e,a),e===ct&&(Ze=ct=null,dt=0),!(s.subtreeFlags&2064)&&!(s.flags&2064)||Ta||(Ta=!0,Ex(Eo,function(){return _r(),null})),a=(s.flags&15990)!==0,s.subtreeFlags&15990||a){a=qt.transition,qt.transition=null;var o=Ae;Ae=1;var l=Se;Se|=4,Nd.current=null,wb(e,s),vx(s,e),qv(Zc),Lo=!!Jc,Zc=Jc=null,e.current=s,jb(s),Jy(),Se=l,Ae=o,qt.transition=a}else e.current=s;if(Ta&&(Ta=!1,tn=e,Xo=r),a=e.pendingLanes,a===0&&(hn=null),tv(s.stateNode),Pt(e,Ke()),t!==null)for(n=e.onRecoverableError,s=0;s<t.length;s++)r=t[s],n(r.value,{componentStack:r.stack,digest:r.digest});if(Wo)throw Wo=!1,e=vu,vu=null,e;return Xo&1&&e.tag!==0&&_r(),a=e.pendingLanes,a&1?e===bu?Si++:(Si=0,bu=e):Si=0,Sn(),null}function _r(){if(tn!==null){var e=ip(Xo),t=qt.transition,s=Ae;try{if(qt.transition=null,Ae=16>e?16:e,tn===null)var n=!1;else{if(e=tn,tn=null,Xo=0,Se&6)throw Error(ee(331));var r=Se;for(Se|=4,le=e.current;le!==null;){var a=le,o=a.child;if(le.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(le=u;le!==null;){var d=le;switch(d.tag){case 0:case 11:case 15:Ni(8,d,a)}var h=d.child;if(h!==null)h.return=d,le=h;else for(;le!==null;){d=le;var f=d.sibling,m=d.return;if(px(d),d===u){le=null;break}if(f!==null){f.return=m,le=f;break}le=m}}}var v=a.alternate;if(v!==null){var x=v.child;if(x!==null){v.child=null;do{var y=x.sibling;x.sibling=null,x=y}while(x!==null)}}le=a}}if(a.subtreeFlags&2064&&o!==null)o.return=a,le=o;else e:for(;le!==null;){if(a=le,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ni(9,a,a.return)}var g=a.sibling;if(g!==null){g.return=a.return,le=g;break e}le=a.return}}var p=e.current;for(le=p;le!==null;){o=le;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,le=w;else e:for(o=p;le!==null;){if(l=le,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:_l(9,l)}}catch(k){Ye(l,l.return,k)}if(l===o){le=null;break e}var b=l.sibling;if(b!==null){b.return=l.return,le=b;break e}le=l.return}}if(Se=r,Sn(),ws&&typeof ws.onPostCommitFiberRoot=="function")try{ws.onPostCommitFiberRoot(gl,e)}catch{}n=!0}return n}finally{Ae=s,qt.transition=t}}return!1}function gf(e,t,s){t=Pr(s,t),t=ix(e,t,1),e=dn(e,t,1),t=jt(),e!==null&&(ia(e,1,t),Pt(e,t))}function Ye(e,t,s){if(e.tag===3)gf(e,e,s);else for(;t!==null;){if(t.tag===3){gf(t,e,s);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(hn===null||!hn.has(n))){e=Pr(s,e),e=ax(t,e,1),t=dn(t,e,1),e=jt(),t!==null&&(ia(t,1,e),Pt(t,e));break}}t=t.return}}function Eb(e,t,s){var n=e.pingCache;n!==null&&n.delete(t),t=jt(),e.pingedLanes|=e.suspendedLanes&s,ct===e&&(dt&s)===s&&(it===4||it===3&&(dt&130023424)===dt&&500>Ke()-Sd?In(e,0):kd|=s),Pt(e,t)}function Sx(e,t){t===0&&(e.mode&1?(t=va,va<<=1,!(va&130023424)&&(va=4194304)):t=1);var s=jt();e=Bs(e,t),e!==null&&(ia(e,t,s),Pt(e,s))}function Tb(e){var t=e.memoizedState,s=0;t!==null&&(s=t.retryLane),Sx(e,s)}function Lb(e,t){var s=0;switch(e.tag){case 13:var n=e.stateNode,r=e.memoizedState;r!==null&&(s=r.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(ee(314))}n!==null&&n.delete(t),Sx(e,s)}var Cx;Cx=function(e,t,s){if(e!==null)if(e.memoizedProps!==t.pendingProps||At.current)Tt=!0;else{if(!(e.lanes&s)&&!(t.flags&128))return Tt=!1,xb(e,t,s);Tt=!!(e.flags&131072)}else Tt=!1,Ue&&t.flags&1048576&&Ap(t,Fo,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;uo(e,t),e=t.pendingProps;var r=Tr(t,vt.current);jr(t,s),r=vd(null,t,n,e,r,s);var a=bd();return t.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mt(n)?(a=!0,Do(t)):a=!1,t.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,md(t),r.updater=jl,t.stateNode=r,r._reactInternals=t,lu(t,n,e,s),t=du(null,t,n,!0,a,s)):(t.tag=0,Ue&&a&&od(t),bt(null,t,r,s),t=t.child),t;case 16:n=t.elementType;e:{switch(uo(e,t),e=t.pendingProps,r=n._init,n=r(n._payload),t.type=n,r=t.tag=Mb(n),e=es(n,e),r){case 0:t=uu(null,t,n,e,s);break e;case 1:t=rf(null,t,n,e,s);break e;case 11:t=sf(null,t,n,e,s);break e;case 14:t=nf(null,t,n,es(n.type,e),s);break e}throw Error(ee(306,n,""))}return t;case 0:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:es(n,r),uu(e,t,n,r,s);case 1:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:es(n,r),rf(e,t,n,r,s);case 3:e:{if(ux(t),e===null)throw Error(ee(387));n=t.pendingProps,a=t.memoizedState,r=a.element,Fp(e,t),$o(t,n,null,s);var o=t.memoizedState;if(n=o.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){r=Pr(Error(ee(423)),t),t=af(e,t,n,s,r);break e}else if(n!==r){r=Pr(Error(ee(424)),t),t=af(e,t,n,s,r);break e}else for(Dt=un(t.stateNode.containerInfo.firstChild),Ot=t,Ue=!0,ss=null,s=Dp(t,null,n,s),t.child=s;s;)s.flags=s.flags&-3|4096,s=s.sibling;else{if(Lr(),n===r){t=Hs(e,t,s);break e}bt(e,t,n,s)}t=t.child}return t;case 5:return zp(t),e===null&&iu(t),n=t.type,r=t.pendingProps,a=e!==null?e.memoizedProps:null,o=r.children,eu(n,r)?o=null:a!==null&&eu(n,a)&&(t.flags|=32),cx(e,t),bt(e,t,o,s),t.child;case 6:return e===null&&iu(t),null;case 13:return dx(e,t,s);case 4:return gd(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Ar(t,null,n,s):bt(e,t,n,s),t.child;case 11:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:es(n,r),sf(e,t,n,r,s);case 7:return bt(e,t,t.pendingProps,s),t.child;case 8:return bt(e,t,t.pendingProps.children,s),t.child;case 12:return bt(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(n=t.type._context,r=t.pendingProps,a=t.memoizedProps,o=r.value,Fe(zo,n._currentValue),n._currentValue=o,a!==null)if(cs(a.value,o)){if(a.children===r.children&&!At.current){t=Hs(e,t,s);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){o=a.child;for(var c=l.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=Fs(-1,s&-s),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=s,c=a.alternate,c!==null&&(c.lanes|=s),au(a.return,s,t),l.lanes|=s;break}c=c.next}}else if(a.tag===10)o=a.type===t.type?null:a.child;else if(a.tag===18){if(o=a.return,o===null)throw Error(ee(341));o.lanes|=s,l=o.alternate,l!==null&&(l.lanes|=s),au(o,s,t),o=a.sibling}else o=a.child;if(o!==null)o.return=a;else for(o=a;o!==null;){if(o===t){o=null;break}if(a=o.sibling,a!==null){a.return=o.return,o=a;break}o=o.return}a=o}bt(e,t,r.children,s),t=t.child}return t;case 9:return r=t.type,n=t.pendingProps.children,jr(t,s),r=Yt(r),n=n(r),t.flags|=1,bt(e,t,n,s),t.child;case 14:return n=t.type,r=es(n,t.pendingProps),r=es(n.type,r),nf(e,t,n,r,s);case 15:return ox(e,t,t.type,t.pendingProps,s);case 17:return n=t.type,r=t.pendingProps,r=t.elementType===n?r:es(n,r),uo(e,t),t.tag=1,Mt(n)?(e=!0,Do(t)):e=!1,jr(t,s),rx(t,n,r),lu(t,n,r,s),du(null,t,n,!0,e,s);case 19:return hx(e,t,s);case 22:return lx(e,t,s)}throw Error(ee(156,t.tag))};function Ex(e,t){return tp(e,t)}function Ab(e,t,s,n){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wt(e,t,s,n){return new Ab(e,t,s,n)}function Ld(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Mb(e){if(typeof e=="function")return Ld(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Gu)return 11;if(e===Ku)return 14}return 2}function mn(e,t){var s=e.alternate;return s===null?(s=Wt(e.tag,t,e.key,e.mode),s.elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=e.flags&14680064,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function mo(e,t,s,n,r,a){var o=2;if(n=e,typeof e=="function")Ld(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case ar:return $n(s.children,r,a,t);case Yu:o=8,r|=8;break;case Mc:return e=Wt(12,s,t,r|2),e.elementType=Mc,e.lanes=a,e;case Pc:return e=Wt(13,s,t,r),e.elementType=Pc,e.lanes=a,e;case Rc:return e=Wt(19,s,t,r),e.elementType=Rc,e.lanes=a,e;case zg:return kl(s,r,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Og:o=10;break e;case Fg:o=9;break e;case Gu:o=11;break e;case Ku:o=14;break e;case Ks:o=16,n=null;break e}throw Error(ee(130,e==null?e:typeof e,""))}return t=Wt(o,s,t,r),t.elementType=e,t.type=n,t.lanes=a,t}function $n(e,t,s,n){return e=Wt(7,e,n,t),e.lanes=s,e}function kl(e,t,s,n){return e=Wt(22,e,n,t),e.elementType=zg,e.lanes=s,e.stateNode={isHidden:!1},e}function oc(e,t,s){return e=Wt(6,e,null,t),e.lanes=s,e}function lc(e,t,s){return t=Wt(4,e.children!==null?e.children:[],e.key,t),t.lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Pb(e,t,s,n,r){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hl(0),this.expirationTimes=Hl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hl(0),this.identifierPrefix=n,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Ad(e,t,s,n,r,a,o,l,c){return e=new Pb(e,t,s,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Wt(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},md(a),e}function Rb(e,t,s){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ir,key:n==null?null:""+n,children:e,containerInfo:t,implementation:s}}function Tx(e){if(!e)return vn;e=e._reactInternals;e:{if(Zn(e)!==e||e.tag!==1)throw Error(ee(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ee(171))}if(e.tag===1){var s=e.type;if(Mt(s))return Tp(e,s,t)}return t}function Lx(e,t,s,n,r,a,o,l,c){return e=Ad(s,n,!0,e,r,a,o,l,c),e.context=Tx(null),s=e.current,n=jt(),r=fn(s),a=Fs(n,r),a.callback=t??null,dn(s,a,r),e.current.lanes=r,ia(e,r,n),Pt(e,n),e}function Sl(e,t,s,n){var r=t.current,a=jt(),o=fn(r);return s=Tx(s),t.context===null?t.context=s:t.pendingContext=s,t=Fs(a,o),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=dn(r,t,o),e!==null&&(ls(e,r,o,a),oo(e,r,o)),o}function Yo(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function pf(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var s=e.retryLane;e.retryLane=s!==0&&s<t?s:t}}function Md(e,t){pf(e,t),(e=e.alternate)&&pf(e,t)}function Db(){return null}var Ax=typeof reportError=="function"?reportError:function(e){console.error(e)};function Pd(e){this._internalRoot=e}Cl.prototype.render=Pd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ee(409));Sl(e,t,null,null)};Cl.prototype.unmount=Pd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Yn(function(){Sl(null,e,null,null)}),t[$s]=null}};function Cl(e){this._internalRoot=e}Cl.prototype.unstable_scheduleHydration=function(e){if(e){var t=lp();e={blockedOn:null,target:e,priority:t};for(var s=0;s<Js.length&&t!==0&&t<Js[s].priority;s++);Js.splice(s,0,e),s===0&&up(e)}};function Rd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function El(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function xf(){}function Ob(e,t,s,n,r){if(r){if(typeof n=="function"){var a=n;n=function(){var u=Yo(o);a.call(u)}}var o=Lx(t,n,e,0,null,!1,!1,"",xf);return e._reactRootContainer=o,e[$s]=o.current,$i(e.nodeType===8?e.parentNode:e),Yn(),o}for(;r=e.lastChild;)e.removeChild(r);if(typeof n=="function"){var l=n;n=function(){var u=Yo(c);l.call(u)}}var c=Ad(e,0,!1,null,null,!1,!1,"",xf);return e._reactRootContainer=c,e[$s]=c.current,$i(e.nodeType===8?e.parentNode:e),Yn(function(){Sl(t,c,s,n)}),c}function Tl(e,t,s,n,r){var a=s._reactRootContainer;if(a){var o=a;if(typeof r=="function"){var l=r;r=function(){var c=Yo(o);l.call(c)}}Sl(t,o,e,r)}else o=Ob(s,t,e,r,n);return Yo(o)}ap=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=di(t.pendingLanes);s!==0&&(Zu(t,s|1),Pt(t,Ke()),!(Se&6)&&(Rr=Ke()+500,Sn()))}break;case 13:Yn(function(){var n=Bs(e,1);if(n!==null){var r=jt();ls(n,e,1,r)}}),Md(e,1)}};ed=function(e){if(e.tag===13){var t=Bs(e,134217728);if(t!==null){var s=jt();ls(t,e,134217728,s)}Md(e,134217728)}};op=function(e){if(e.tag===13){var t=fn(e),s=Bs(e,t);if(s!==null){var n=jt();ls(s,e,t,n)}Md(e,t)}};lp=function(){return Ae};cp=function(e,t){var s=Ae;try{return Ae=e,t()}finally{Ae=s}};Vc=function(e,t,s){switch(t){case"input":if(Fc(e,s),t=s.name,s.type==="radio"&&t!=null){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var n=s[t];if(n!==e&&n.form===e.form){var r=vl(n);if(!r)throw Error(ee(90));$g(n),Fc(n,r)}}}break;case"textarea":Hg(e,s);break;case"select":t=s.value,t!=null&&yr(e,!!s.multiple,t,!1)}};Gg=Cd;Kg=Yn;var Fb={usingClientEntryPoint:!1,Events:[oa,ur,vl,qg,Yg,Cd]},ti={findFiberByHostInstance:Rn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zb={bundleType:ti.bundleType,version:ti.version,rendererPackageName:ti.rendererPackageName,rendererConfig:ti.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ws.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Zg(e),e===null?null:e.stateNode},findFiberByHostInstance:ti.findFiberByHostInstance||Db,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var La=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!La.isDisabled&&La.supportsFiber)try{gl=La.inject(zb),ws=La}catch{}}It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Fb;It.createPortal=function(e,t){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rd(t))throw Error(ee(200));return Rb(e,t,null,s)};It.createRoot=function(e,t){if(!Rd(e))throw Error(ee(299));var s=!1,n="",r=Ax;return t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(r=t.onRecoverableError)),t=Ad(e,1,!1,null,null,s,!1,n,r),e[$s]=t.current,$i(e.nodeType===8?e.parentNode:e),new Pd(t)};It.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ee(188)):(e=Object.keys(e).join(","),Error(ee(268,e)));return e=Zg(t),e=e===null?null:e.stateNode,e};It.flushSync=function(e){return Yn(e)};It.hydrate=function(e,t,s){if(!El(t))throw Error(ee(200));return Tl(null,e,t,!0,s)};It.hydrateRoot=function(e,t,s){if(!Rd(e))throw Error(ee(405));var n=s!=null&&s.hydratedSources||null,r=!1,a="",o=Ax;if(s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(a=s.identifierPrefix),s.onRecoverableError!==void 0&&(o=s.onRecoverableError)),t=Lx(t,null,e,1,s??null,r,!1,a,o),e[$s]=t.current,$i(e),n)for(e=0;e<n.length;e++)s=n[e],r=s._getVersion,r=r(s._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[s,r]:t.mutableSourceEagerHydrationData.push(s,r);return new Cl(t)};It.render=function(e,t,s){if(!El(t))throw Error(ee(200));return Tl(null,e,t,!1,s)};It.unmountComponentAtNode=function(e){if(!El(e))throw Error(ee(40));return e._reactRootContainer?(Yn(function(){Tl(null,null,e,!1,function(){e._reactRootContainer=null,e[$s]=null})}),!0):!1};It.unstable_batchedUpdates=Cd;It.unstable_renderSubtreeIntoContainer=function(e,t,s,n){if(!El(s))throw Error(ee(200));if(e==null||e._reactInternals===void 0)throw Error(ee(38));return Tl(e,t,s,!1,n)};It.version="18.3.1-next-f1338f8080-20240426";function Mx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Mx)}catch(e){console.error(e)}}Mx(),Mg.exports=It;var Ib=Mg.exports,yf=Ib;Lc.createRoot=yf.createRoot,Lc.hydrateRoot=yf.hydrateRoot;const Ns="/api",$b=async e=>(await fetch(`${Ns}/texts?language=${e}`)).json(),Bb=async e=>(await fetch(`${Ns}/authors?language=${e}`)).json(),Hb=async e=>(await fetch(`${Ns}/texts?author=${e}`)).json(),Ub=async(e,t)=>(await fetch(`${Ns}/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:t})).json(),Vb=async(e,t,s)=>{const n=await fetch(`${Ns}/search-stream`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:s});if(!n.ok)throw new Error(`Search failed: ${n.status}`);const r=n.body.getReader(),a=new TextDecoder;let o="",l=null;for(;;){const{done:c,value:u}=await r.read();if(c)break;o+=a.decode(u,{stream:!0});const d=o.split(`
`);o=d.pop()||"";for(const h of d)if(h.startsWith("data: "))try{const f=JSON.parse(h.slice(6));if(f.type==="progress")t&&t(f.step,f.detail,f.elapsed);else if(f.type==="complete")l=f;else if(f.type==="error")throw new Error(f.message)}catch(f){if(f.message&&!f.message.includes("JSON"))throw f}}return l||{results:[],total_matches:0}},Wb=async(e,t)=>(await fetch(`${Ns}/search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,match_type:"semantic_cross"}),signal:t})).json(),Xb=async(e,t)=>(await fetch(`${Ns}/hapax-search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:t})).json(),qb=async(e,t)=>(await fetch(`${Ns}/rare-bigram-search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:t})).json(),Yb=async()=>{const t=await(await fetch(`${Ns}/auth/user`)).json();if(t.user){const s=t.user.first_name||"",n=t.user.last_name||"";t.user.name=t.user.orcid_name||`${s} ${n}`.trim()||"Account",t.authenticated=!0}else t.authenticated=!1;return t},Gb=async(e,t)=>(await fetch(`${Ns}/wildcard-search`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),signal:t})).json(),Kb=({user:e,setUser:t})=>{const[s,n]=j.useState(!1),[r,a]=j.useState(!1),[o,l]=j.useState(""),[c,u]=j.useState(""),[d,h]=j.useState(!1),[f,m]=j.useState(null),v=j.useRef(null);j.useEffect(()=>{Yb().then(g=>{g.authenticated&&t(g.user)}).catch(()=>{})},[t]),j.useEffect(()=>{const g=p=>{v.current&&!v.current.contains(p.target)&&n(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const x=async()=>{if(!o.trim()){m("Please enter your ORCID");return}h(!0),m(null);try{const p=await(await fetch("/api/auth/orcid/link",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orcid:o.trim(),orcid_name:c.trim()})})).json();p.success?(t({...e,orcid:o.trim(),orcid_name:c.trim()}),a(!1),l(""),u("")):m(p.error||"Failed to link ORCID")}catch{m("Failed to link ORCID")}h(!1)},y=async()=>{if(confirm("Remove your ORCID from this account?"))try{(await(await fetch("/api/auth/orcid/unlink",{method:"POST"})).json()).success&&t({...e,orcid:null,orcid_name:null})}catch{alert("Failed to unlink ORCID")}};return i.jsxs(i.Fragment,{children:[i.jsx("header",{className:"bg-gradient-to-r from-red-800 via-red-700 to-orange-600 shadow-lg",children:i.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-6 py-3 sm:py-5 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-2 sm:gap-4",children:[i.jsx("img",{src:"/tesserae-icon.jpg",alt:"Tesserae",className:"h-10 w-10 sm:h-14 sm:w-14 rounded-full"}),i.jsxs("div",{children:[i.jsx("h1",{className:"tesserae-title text-2xl sm:text-4xl font-semibold text-white tracking-wide",children:"TESSERAE"}),i.jsx("p",{className:"text-orange-100 text-xs sm:text-sm mt-0.5 hidden sm:block",children:"Intertextual and Literary Discovery"})]})]}),i.jsx("div",{className:"flex items-center gap-2",children:e?i.jsxs("div",{className:"relative",ref:v,children:[i.jsxs("button",{onClick:()=>n(!s),className:"flex items-center gap-2 bg-white/10 hover:bg-white/20 px-3 py-2 rounded text-white text-sm",children:[i.jsxs("div",{className:"text-left",children:[i.jsx("div",{className:"font-medium",children:e.name||e.orcid_name||`${e.first_name||""} ${e.last_name||""}`.trim()||"Account"}),e.orcid&&i.jsxs("div",{className:"text-xs text-orange-200 flex items-center gap-1",children:[i.jsx("img",{src:"https://orcid.org/assets/vectors/orcid.logo.icon.svg",alt:"",className:"w-3 h-3"}),e.orcid]})]}),i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),s&&i.jsxs("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border z-50",children:[i.jsxs("div",{className:"p-3 border-b",children:[i.jsx("p",{className:"font-medium text-gray-900",children:e.name||e.orcid_name||`${e.first_name||""} ${e.last_name||""}`.trim()||"Account"}),i.jsx("p",{className:"text-xs text-gray-500",children:e.email||"Signed in with Replit"})]}),i.jsx("div",{className:"p-2",children:e.orcid?i.jsxs("div",{className:"px-3 py-2 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"ORCID:"}),i.jsx("a",{href:`https://orcid.org/${e.orcid}`,target:"_blank",rel:"noopener noreferrer",className:"text-green-600 hover:underline text-xs",children:e.orcid})]}),i.jsx("button",{onClick:y,className:"text-xs text-red-500 hover:text-red-700 mt-1",children:"Unlink ORCID"})]}):i.jsx("button",{onClick:()=>{a(!0),n(!1)},className:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:"Link ORCID for Attribution"})}),i.jsx("div",{className:"border-t p-2",children:i.jsx("a",{href:"/api/auth/logout",className:"block w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:"Sign out"})})]})]}):i.jsxs("a",{href:"/api/auth/login",className:"flex items-center gap-2 bg-white/10 hover:bg-white/20 text-white px-3 py-2 rounded text-sm",children:[i.jsx("span",{children:"Sign in"}),i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})})]})}),r&&i.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Link ORCID"}),i.jsx("button",{onClick:()=>{a(!1),m(null)},className:"text-gray-400 hover:text-gray-600",children:""})]}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Link your ORCID iD for proper attribution when you contribute parallels to the repository."}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ORCID iD"}),i.jsx("input",{type:"text",value:o,onChange:g=>l(g.target.value),placeholder:"0000-0002-1234-5678",className:"w-full border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name (as it appears on ORCID)"}),i.jsx("input",{type:"text",value:c,onChange:g=>u(g.target.value),placeholder:"Your name",className:"w-full border rounded px-3 py-2 text-sm"})]}),f&&i.jsx("p",{className:"text-sm text-red-600",children:f}),i.jsxs("div",{className:"flex gap-2 pt-2",children:[i.jsx("button",{onClick:()=>{a(!1),m(null)},className:"flex-1 px-4 py-2 border rounded text-gray-700 hover:bg-gray-50 text-sm",children:"Cancel"}),i.jsx("button",{onClick:x,disabled:d,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 text-sm",children:d?"Linking...":"Link ORCID"})]})]})]})})]})},Qb=[{code:"search",label:"Search"},{code:"browse",label:"Browse Corpus"},{code:"repository",label:"Repository"},{code:"downloads",label:"Downloads"},{code:"about",label:"About"},{code:"help",label:"Help & Support"},{code:"admin",label:"Admin"}],Jb=[{code:"la",label:"Latin"},{code:"grc",label:"Greek"},{code:"cross",label:"GreekLatin"},{code:"en",label:"English"}],Zb=({pageType:e,setPageType:t,activeTab:s,setActiveTab:n,onLanguageReset:r,showDownloads:a=!1,setShowDownloads:o})=>{const l=c=>{s===c&&r&&r(),n(c)};return i.jsx("nav",{className:"bg-gray-50 border-b sticky top-0 z-40",children:i.jsxs("div",{className:"max-w-7xl mx-auto px-3 sm:px-6",children:[i.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:i.jsxs("div",{className:"flex overflow-x-auto scrollbar-hide -mx-3 px-3 sm:mx-0 sm:px-0",children:[Qb.map(c=>i.jsx("button",{onClick:()=>t(c.code),className:`px-2 sm:px-4 py-2 sm:py-3 font-medium text-xs sm:text-sm border-b-2 whitespace-nowrap ${e===c.code?"border-red-700 text-red-700":"border-transparent text-gray-500 hover:text-red-600"}`,children:c.label},c.code)),a&&o&&i.jsx("button",{onClick:()=>o(!0),className:`px-2 sm:px-4 py-2 sm:py-3 font-medium text-xs sm:text-sm border-b-2 whitespace-nowrap hidden sm:block ${e==="downloads"?"border-red-700 text-red-700":"border-transparent text-gray-500 hover:text-red-600"}`,children:"Downloads"})]})}),e==="search"&&i.jsx("div",{className:"py-2 border-t",children:i.jsx("div",{className:"flex overflow-x-auto scrollbar-hide -mx-3 px-3 sm:mx-0 sm:px-0",children:Jb.map(c=>i.jsx("button",{onClick:()=>l(c.code),className:`px-3 sm:px-4 py-2 text-xs sm:text-sm font-medium rounded-t whitespace-nowrap ${s===c.code?"bg-white text-red-700 border-t border-l border-r border-gray-200":"text-gray-600 hover:text-red-600"}`,children:c.label},c.code))})})]})})},ew=({searchMode:e,setSearchMode:t})=>i.jsxs("div",{className:"flex flex-wrap items-center gap-1 bg-gray-100 p-1 rounded-lg",children:[i.jsx("button",{onClick:()=>t("parallel"),className:`px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm font-medium rounded ${e==="parallel"?"bg-white shadow text-red-700":"text-gray-600 hover:text-gray-800"}`,children:"Phrases"}),i.jsx("button",{onClick:()=>t("line"),className:`px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm font-medium rounded ${e==="line"?"bg-white shadow text-red-700":"text-gray-600 hover:text-gray-800"}`,children:"Lines"}),i.jsx("button",{onClick:()=>t("string"),className:`px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm font-medium rounded ${e==="string"?"bg-white shadow text-blue-700":"text-gray-600 hover:text-gray-800"}`,children:"String Search"}),i.jsx("button",{onClick:()=>t("bigram"),className:`px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm font-medium rounded ${e==="bigram"?"bg-white shadow text-purple-700":"text-gray-600 hover:text-gray-800"}`,children:"Rare Pairs"}),i.jsx("button",{onClick:()=>t("hapax"),className:`px-2 sm:px-3 py-1 sm:py-1.5 text-xs sm:text-sm font-medium rounded ${e==="hapax"?"bg-white shadow text-amber-700":"text-gray-600 hover:text-gray-800"}`,children:"Rare Words"})]}),_u=({value:e,onChange:t,authors:s,filter:n,setFilter:r,showDropdown:a,setShowDropdown:o})=>{const l=j.useRef(null),c=j.useRef(null),[u,d]=j.useState(""),[h,f]=j.useState(!1),[m,v]=j.useState(!1),x=n!==void 0?n:u,y=r||d,g=a!==void 0?a:h,p=o||f,w=Array.isArray(s)?s:[],b=j.useMemo(()=>w.filter(_=>_.author&&_.author.toLowerCase().includes(x.toLowerCase())),[w,x]),k=w.find(_=>_.author_key===e);j.useEffect(()=>{const _=N=>{c.current&&!c.current.contains(N.target)&&(p(!1),v(!1),y(""))};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[p,y]);const E=m?x:k?k.author:"";return i.jsxs("div",{ref:c,className:"relative",children:[i.jsx("input",{ref:l,type:"text",placeholder:"Type to search...",value:E,onChange:_=>{y(_.target.value),p(!0),v(!0)},onFocus:()=>{p(!0),v(!0),y("")},onBlur:()=>{g||(v(!1),y(""))},className:"w-full border rounded px-2 py-2 text-sm"}),g&&i.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border rounded shadow-lg max-h-48 overflow-y-auto",children:b.length>0?b.map(_=>i.jsx("div",{onMouseDown:N=>{N.preventDefault(),t(_.author_key),y(""),p(!1),v(!1)},className:`w-full text-left px-3 py-1.5 text-sm hover:bg-gray-100 cursor-pointer ${e===_.author_key?"bg-gray-50 font-medium":""}`,children:_.author},_.author_key)):i.jsx("div",{className:"px-3 py-2 text-sm text-gray-500",children:"No matches"})})]})},Gi=({isOpen:e,onClose:t,title:s,children:n,maxWidth:r="max-w-2xl"})=>e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:`bg-white rounded-lg shadow-xl ${r} w-full max-h-[90vh] overflow-hidden flex flex-col`,children:[i.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s}),i.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 text-2xl leading-none",children:""})]}),i.jsx("div",{className:"p-4 overflow-y-auto flex-1",children:n})]})}):null,vf={primary:"bg-red-700 text-white hover:bg-red-800",secondary:"bg-amber-600 text-white hover:bg-amber-700",tertiary:"bg-rose-100 text-rose-700 border border-rose-300 hover:bg-rose-200",neutral:"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200",danger:"bg-red-100 text-red-700 border border-red-300 hover:bg-red-200",success:"bg-green-600 text-white hover:bg-green-700"},bf={sm:"px-2 py-1 text-xs",md:"px-3 py-1.5 text-sm",lg:"px-4 py-2 text-base"},go=({children:e,variant:t="primary",size:s="md",disabled:n=!1,className:r="",...a})=>i.jsx("button",{disabled:n,className:`
        rounded font-medium transition-colors
        ${vf[t]||vf.primary}
        ${bf[s]||bf.md}
        ${n?"opacity-50 cursor-not-allowed":""}
        ${r}
      `,...a,children:e}),Kt=({size:e="md",text:t="Loading...",elapsedTime:s=null,step:n=null})=>{const r={sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8"},a=o=>{if(o<60)return`${o}s`;const l=Math.floor(o/60),c=o%60;return`${l}m ${c}s`};return i.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:`${r[e]} border-2 border-gray-200 border-t-red-700 rounded-full animate-spin`}),t&&i.jsx("span",{className:"text-gray-600",children:t})]}),(s!==null||n)&&i.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-500",children:[n&&i.jsx("span",{className:"font-medium",children:n}),s!==null&&s>0&&i.jsxs("span",{className:"tabular-nums",children:[a(s)," elapsed"]})]})]})},wf=({label:e,language:t,authors:s,selectedAuthor:n,setSelectedAuthor:r,selectedText:a,setSelectedText:o,hierarchy:l,fetchTexts:c})=>{const[u,d]=j.useState(""),[h,f]=j.useState(!1),[m,v]=j.useState([]);j.useEffect(()=>{n&&c(n).then(y=>{v(y.texts||[])})},[n,c]);const x=j.useMemo(()=>l?l.find(y=>y.author_key===n):null,[l,n]);return i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e," Author"]}),i.jsx(_u,{value:n,onChange:r,filter:u,setFilter:d,showDropdown:h,setShowDropdown:f,authors:s})]}),x&&x.works&&i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e," Work"]}),i.jsxs("select",{value:a,onChange:y=>o(y.target.value),className:"w-full border rounded px-2 py-2 text-sm",children:[i.jsx("option",{value:"",children:"Select a work..."}),x.works.map(y=>i.jsx("optgroup",{label:y.work,children:y.sections.map(g=>{let p;return g.label==="(Complete)"||g.label===y.work?p=`${y.work} (Complete)`:g.label.startsWith("Book ")||g.label.startsWith("Part ")?p=`${y.work}, ${g.label}`:p=g.label.includes(y.work)?g.label:`${y.work}, ${g.label}`,i.jsx("option",{value:g.file,children:p},g.file)})},y.work_key))]})]}),!x&&m.length>0&&i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e," Text"]}),i.jsxs("select",{value:a,onChange:y=>o(y.target.value),className:"w-full border rounded px-2 py-2 text-sm",children:[i.jsx("option",{value:"",children:"Select a text..."}),m.map(y=>i.jsx("option",{value:y.id,children:y.title},y.id))]})]})]})},tw=({settings:e,setSettings:t,showAdvanced:s,setShowAdvanced:n,language:r="la"})=>{const a={la:"pietas not pietate, bellum not bello",grc:" not ,  not ",en:"king not kings, speak not speaking"},o=(l,c)=>{const u={[l]:c};l==="match_type"&&((c==="edit_distance"||c==="sound")&&e.stoplist_size===0?u.stoplist_size=200:c==="exact"&&e.stoplist_size===0&&(u.stoplist_size=100)),t(d=>({...d,...u}))};return i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-3",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Search Settings"}),i.jsx("button",{onClick:()=>n(!s),className:"text-sm text-red-600 hover:text-red-800",children:s?"Hide Advanced":"Show Advanced"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Match Type"}),i.jsxs("select",{value:e.match_type,onChange:l=>o("match_type",l.target.value),className:"w-full border rounded px-2 py-2 text-sm",children:[i.jsx("option",{value:"lemma",children:"Dictionary Form (Lemma)"}),i.jsx("option",{value:"exact",children:"Exact Match"}),i.jsx("option",{value:"semantic",disabled:!0,children:"AI Semantic (Coming Soon)"}),i.jsx("option",{value:"sound",children:"Sound Matching (slower)"}),i.jsx("option",{value:"edit_distance",children:"Edit Distance (slower)"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Matches"}),i.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:e.min_matches,onChange:l=>{const c=l.target.value.replace(/[^0-9]/g,"");o("min_matches",c===""?"":Math.min(10,Math.max(1,parseInt(c))))},onBlur:l=>{(e.min_matches===""||e.min_matches<1)&&o("min_matches",2)},className:"w-full border rounded px-2 py-2 text-sm"})]})]}),s&&i.jsxs("div",{className:"mt-4 pt-4 border-t grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stoplist Basis"}),i.jsxs("select",{value:e.stoplist_basis,onChange:l=>o("stoplist_basis",l.target.value),className:"w-full border rounded px-2 py-2 text-sm",children:[i.jsx("option",{value:"source_target",children:"Source + Target"}),i.jsx("option",{value:"source",children:"Source Only"}),i.jsx("option",{value:"target",children:"Target Only"}),i.jsx("option",{value:"corpus",children:"Full Corpus"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stoplist Size"}),i.jsx("input",{type:"text",inputMode:"numeric",value:e.stoplist_size===0?"Default":e.stoplist_size,onChange:l=>{const c=l.target.value.replace(/[^0-9]/g,"");c===""||l.target.value.toLowerCase()==="default"?o("stoplist_size",0):o("stoplist_size",Math.min(500,parseInt(c)))},onBlur:()=>{(e.stoplist_size===""||e.stoplist_size==="Default")&&o("stoplist_size",0)},onFocus:l=>{e.stoplist_size===0&&l.target.select()},placeholder:"Default",className:"w-full border rounded px-2 py-2 text-sm"}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Default = curated list + high-frequency words"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Unit Type"}),i.jsxs("select",{value:e.source_unit_type,onChange:l=>o("source_unit_type",l.target.value),className:"w-full border rounded px-2 py-2 text-sm",children:[i.jsx("option",{value:"line",children:"Line"}),i.jsx("option",{value:"phrase",children:"Phrase"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Unit Type"}),i.jsxs("select",{value:e.target_unit_type,onChange:l=>o("target_unit_type",l.target.value),className:"w-full border rounded px-2 py-2 text-sm",children:[i.jsx("option",{value:"line",children:"Line"}),i.jsx("option",{value:"phrase",children:"Phrase"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Distance (words)"}),i.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",value:e.max_distance,onChange:l=>{const c=l.target.value.replace(/[^0-9]/g,"");o("max_distance",c===""?"":Math.min(999,Math.max(1,parseInt(c))))},onBlur:()=>{(e.max_distance===""||e.max_distance<1)&&o("max_distance",999)},className:"w-full border rounded px-2 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Results (0 = unlimited)"}),i.jsx("input",{type:"number",min:"0",value:e.max_results,onChange:l=>o("max_results",parseInt(l.target.value)||0),className:"w-full border rounded px-2 py-2 text-sm"})]}),i.jsxs("div",{className:"sm:col-span-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Custom Stopwords (comma-separated)"}),i.jsx("input",{type:"text",value:e.custom_stopwords,onChange:l=>o("custom_stopwords",l.target.value),className:"w-full border rounded px-2 py-2 text-sm"}),i.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Use dictionary forms (lemmata): ",a[r]||a.la]})]}),i.jsxs("div",{className:"sm:col-span-2 pt-2 border-t",children:[i.jsx("p",{className:"text-xs text-gray-500 mb-2",children:"Score boosting and matching features:"}),i.jsxs("div",{className:"flex flex-wrap gap-4",children:[i.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[i.jsx("input",{type:"checkbox",checked:e.bigram_boost||!1,onChange:l=>o("bigram_boost",l.target.checked),className:"rounded border-gray-300"}),i.jsx("span",{children:"Bigram frequency boost"}),i.jsx("span",{className:"text-xs text-gray-400",children:"(rare word pairs)"})]}),i.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[i.jsx("input",{type:"checkbox",checked:e.use_pos||!1,onChange:l=>o("use_pos",l.target.checked),className:"rounded border-gray-300"}),"Part-of-speech filtering"]}),i.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[i.jsx("input",{type:"checkbox",checked:e.use_meter||!1,onChange:l=>o("use_meter",l.target.checked),className:"rounded border-gray-300"}),"Metrical patterns"]}),i.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700 group relative",children:[i.jsx("input",{type:"checkbox",checked:e.use_syntax||!1,onChange:l=>o("use_syntax",l.target.checked),className:"rounded border-gray-300"}),i.jsxs("span",{children:["Syntax matching ",i.jsx("span",{className:"text-gray-400 text-xs",children:"(limited texts)"})]}),i.jsx("span",{className:"invisible group-hover:visible absolute left-0 top-6 z-10 bg-gray-800 text-white text-xs rounded px-2 py-1 whitespace-nowrap",children:"See User Guide for list of texts with syntax data"})]})]}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Note: Some features require pre-computed linguistic annotations for selected texts."})]})]})]})},sw={hamlet:{author:"Shakespeare",title:"Hamlet"},othello:{author:"Shakespeare",title:"Othello"},macbeth:{author:"Shakespeare",title:"Macbeth"},lear:{author:"Shakespeare",title:"King Lear"},tempest:{author:"Shakespeare",title:"The Tempest"},midsummer:{author:"Shakespeare",title:"A Midsummer Night's Dream"},romeo:{author:"Shakespeare",title:"Romeo and Juliet"},julius:{author:"Shakespeare",title:"Julius Caesar"},merchant:{author:"Shakespeare",title:"The Merchant of Venice"},twelfth:{author:"Shakespeare",title:"Twelfth Night"},task:{author:"Cowper",title:"The Task"},paradise_lost:{author:"Milton",title:"Paradise Lost"},paradise_regained:{author:"Milton",title:"Paradise Regained"},samson:{author:"Milton",title:"Samson Agonistes"},faerie:{author:"Spenser",title:"The Faerie Queene"},canterbury:{author:"Chaucer",title:"The Canterbury Tales"},beowulf:{author:"Anonymous",title:"Beowulf"},pentateuch:{author:"World English Bible",title:"Pentateuch"},prophets:{author:"World English Bible",title:"Prophets"},revelation:{author:"World English Bible",title:"Revelation"},writings:{author:"World English Bible",title:"Writings"},iliad:{author:"Homer (trans.)",title:"Iliad"},odyssey:{author:"Homer (trans.)",title:"Odyssey"},aeneid:{author:"Vergil (trans.)",title:"Aeneid"}},nw={a:{author:"Apollonius Rhodius",work:"Argonautica"},hom:{author:"Homer"},homer:{author:"Homer"},hes:{author:"Hesiod"},hesiod:{author:"Hesiod"},aesch:{author:"Aeschylus"},aeschylus:{author:"Aeschylus"},soph:{author:"Sophocles"},sophocles:{author:"Sophocles"},eur:{author:"Euripides"},euripides:{author:"Euripides"},ar:{author:"Aristophanes"},aristophanes:{author:"Aristophanes"},pind:{author:"Pindar"},pindar:{author:"Pindar"},theoc:{author:"Theocritus"},theocritus:{author:"Theocritus"},callim:{author:"Callimachus"},callimachus:{author:"Callimachus"},apoll:{author:"Apollonius Rhodius"},apollonius:{author:"Apollonius Rhodius"},apollonius_rhodius:{author:"Apollonius Rhodius"},plat:{author:"Plato"},plato:{author:"Plato"},arist:{author:"Aristotle"},aristotle:{author:"Aristotle"},thuc:{author:"Thucydides"},thucydides:{author:"Thucydides"},hdt:{author:"Herodotus"},herodotus:{author:"Herodotus"},xen:{author:"Xenophon"},xenophon:{author:"Xenophon"},plut:{author:"Plutarch"},plutarch:{author:"Plutarch"},verg:{author:"Vergil"},vergil:{author:"Vergil"},ov:{author:"Ovid"},ovid:{author:"Ovid"},hor:{author:"Horace"},horace:{author:"Horace"},luc:{author:"Lucan",work:"Bellum Civile"},lucan:{author:"Lucan",work:"Bellum Civile"},stat:{author:"Statius"},statius:{author:"Statius"},juv:{author:"Juvenal",work:"Satires"},iuv:{author:"Juvenal",work:"Satires"},juvenal:{author:"Juvenal",work:"Satires"},mart:{author:"Martial",work:"Epigrammata"},martial:{author:"Martial",work:"Epigrammata"},cat:{author:"Catullus",work:"Carmina"},catu:{author:"Catullus",work:"Carmina"},catullus:{author:"Catullus",work:"Carmina"},prop:{author:"Propertius",work:"Elegies"},propertius:{author:"Propertius",work:"Elegies"},tib:{author:"Tibullus",work:"Elegies"},tibullus:{author:"Tibullus",work:"Elegies"},lucr:{author:"Lucretius",work:"De Rerum Natura"},lucretius:{author:"Lucretius",work:"De Rerum Natura"},sil:{author:"Silius Italicus",work:"Punica"},sen:{author:"Seneca"},seneca:{author:"Seneca"},plaut:{author:"Plautus"},plautus:{author:"Plautus"},ter:{author:"Terence"},terence:{author:"Terence"},liv:{author:"Livy"},livy:{author:"Livy"},tac:{author:"Tacitus"},tacitus:{author:"Tacitus"},sall:{author:"Sallust"},sallust:{author:"Sallust"},caes:{author:"Caesar"},caesar:{author:"Caesar"},cic:{author:"Cicero"},cicero:{author:"Cicero"},val:{author:"Valerius Flaccus"},valerius:{author:"Valerius Flaccus"},silius:{author:"Silius Italicus",work:"Punica"},claud:{author:"Claudian"},claudian:{author:"Claudian"},apul:{author:"Apuleius"},apuleius:{author:"Apuleius"},aug:{author:"Augustine"},augustine:{author:"Augustine"},amm:{author:"Ammianus"},ammianus:{author:"Ammianus"}},jf={il:"Iliad",iliad:"Iliad",od:"Odyssey",odyssey:"Odyssey",aen:"Aeneid",aeneid:"Aeneid",ecl:"Eclogues",eclogues:"Eclogues",georg:"Georgics",georgics:"Georgics",met:"Metamorphoses",metamorphoses:"Metamorphoses",am:"Amores",amores:"Amores",ars:"Ars Amatoria",fast:"Fasti",fasti:"Fasti",her:"Heroides",heroides:"Heroides",tr:"Tristia",tristia:"Tristia",pont:"Epistulae ex Ponto",carm:"Odes",odes:"Odes",sat:"Satires",satires:"Satires",ep:"Epistles",epist:"Epistles",epistles:"Epistles",phars:"Pharsalia",pharsalia:"Pharsalia",bc:"Bellum Civile",theb:"Thebaid",thebaid:"Thebaid",ach:"Achilleid",achilleid:"Achilleid",silv:"Silvae",silvae:"Silvae",ag:"Agamemnon",agamemnon:"Agamemnon",cho:"Choephoroe",choephoroe:"Choephoroe",eum:"Eumenides",eumenides:"Eumenides",pers:"Persae",persae:"Persae",prom:"Prometheus Bound",prometheus:"Prometheus Bound",sept:"Seven Against Thebes",supp:"Suppliants",suppliants:"Suppliants",aj:"Ajax",ajax:"Ajax",ant:"Antigone",antigone:"Antigone",el:"Electra",electra:"Electra",ot:"Oedipus Tyrannus",oedipus:"Oedipus Tyrannus",oc:"Oedipus at Colonus",phil:"Philoctetes",philoctetes:"Philoctetes",trach:"Trachiniae",trachiniae:"Trachiniae",alc:"Alcestis",alcestis:"Alcestis",andr:"Andromache",andromache:"Andromache",ba:"Bacchae",bacchae:"Bacchae",cycl:"Cyclops",cyclops:"Cyclops",hec:"Hecuba",hecuba:"Hecuba",hel:"Helen",helen:"Helen",heracl:"Heraclidae",heraclidae:"Heraclidae",hf:"Heracles",heracles:"Heracles",hipp:"Hippolytus",hippolytus:"Hippolytus",ia:"Iphigenia at Aulis",it:"Iphigenia in Tauris",ion:"Ion",med:"Medea",medea:"Medea",or:"Orestes",orestes:"Orestes",phoen:"Phoenissae",phoenissae:"Phoenissae",rh:"Rhesus",rhesus:"Rhesus",tro:"Troades",troades:"Troades",theog:"Theogony",theogony:"Theogony",wad:"Works and Days",shield:"Shield of Heracles",arg:"Argonautica",argonautica:"Argonautica",id:"Idylls",idylls:"Idylls",hymn:"Hymns",hymns:"Hymns",aet:"Aetia",aitia:"Aetia",drn:"De Rerum Natura",rnr:"De Rerum Natura",nat:"De Rerum Natura"},sr=e=>e?e.trim().replace(/\s+/g,"."):"",_f=(e,t=null)=>{var n,r;if(!e)return"";const s=e.replace(/<\/?.*?>/g,"").trim();if(t==="en"||!t&&/^[a-z_]+\s+[IVX\d]/i.test(s)){const a=s.split(/\s+/);if(a.length>=2){const o=a[0].toLowerCase(),l=sr(a.slice(1).join(".")),c=sw[o];return c?`${c.author}, ${c.title} ${l}`:`${o.charAt(0).toUpperCase()+o.slice(1)} ${l}`}}if(t==="la"||t==="grc"||/^[a-z]+[\.\s]/i.test(s)){const a=s.split(/[\.\s]+/);if(a.length>=2){const o=a[0].toLowerCase().trim(),l=nw[o];if(l){const d=(n=a[1])==null?void 0:n.toLowerCase().trim(),h=jf[d];if(h){const m=sr(a.slice(2).join("."));return`${l.author}, ${h} ${m}`}if(l.work){const m=sr(a.slice(1).join("."));return`${l.author}, ${l.work} ${m}`}const f=sr(a.slice(1).join("."));return`${l.author} ${f}`}const c=(r=a[1])==null?void 0:r.toLowerCase().trim(),u=jf[c];if(u){const d=o.charAt(0).toUpperCase()+o.slice(1),h=sr(a.slice(2).join("."));return`${d}, ${u} ${h}`}}}return sr(s.replace(/\s+/g,"."))};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function ca(e){return e+.5|0}const sn=(e,t,s)=>Math.max(Math.min(e,s),t);function fi(e){return sn(ca(e*2.55),0,255)}function gn(e){return sn(ca(e*255),0,255)}function Ps(e){return sn(ca(e/2.55)/100,0,1)}function Nf(e){return sn(ca(e*100),0,100)}const Bt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Nu=[..."0123456789ABCDEF"],rw=e=>Nu[e&15],iw=e=>Nu[(e&240)>>4]+Nu[e&15],Aa=e=>(e&240)>>4===(e&15),aw=e=>Aa(e.r)&&Aa(e.g)&&Aa(e.b)&&Aa(e.a);function ow(e){var t=e.length,s;return e[0]==="#"&&(t===4||t===5?s={r:255&Bt[e[1]]*17,g:255&Bt[e[2]]*17,b:255&Bt[e[3]]*17,a:t===5?Bt[e[4]]*17:255}:(t===7||t===9)&&(s={r:Bt[e[1]]<<4|Bt[e[2]],g:Bt[e[3]]<<4|Bt[e[4]],b:Bt[e[5]]<<4|Bt[e[6]],a:t===9?Bt[e[7]]<<4|Bt[e[8]]:255})),s}const lw=(e,t)=>e<255?t(e):"";function cw(e){var t=aw(e)?rw:iw;return e?"#"+t(e.r)+t(e.g)+t(e.b)+lw(e.a,t):void 0}const uw=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Px(e,t,s){const n=t*Math.min(s,1-s),r=(a,o=(a+e/30)%12)=>s-n*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function dw(e,t,s){const n=(r,a=(r+e/60)%6)=>s-s*t*Math.max(Math.min(a,4-a,1),0);return[n(5),n(3),n(1)]}function hw(e,t,s){const n=Px(e,1,.5);let r;for(t+s>1&&(r=1/(t+s),t*=r,s*=r),r=0;r<3;r++)n[r]*=1-t-s,n[r]+=t;return n}function fw(e,t,s,n,r){return e===r?(t-s)/n+(t<s?6:0):t===r?(s-e)/n+2:(e-t)/n+4}function Dd(e){const s=e.r/255,n=e.g/255,r=e.b/255,a=Math.max(s,n,r),o=Math.min(s,n,r),l=(a+o)/2;let c,u,d;return a!==o&&(d=a-o,u=l>.5?d/(2-a-o):d/(a+o),c=fw(s,n,r,d,a),c=c*60+.5),[c|0,u||0,l]}function Od(e,t,s,n){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,s,n)).map(gn)}function Fd(e,t,s){return Od(Px,e,t,s)}function mw(e,t,s){return Od(hw,e,t,s)}function gw(e,t,s){return Od(dw,e,t,s)}function Rx(e){return(e%360+360)%360}function pw(e){const t=uw.exec(e);let s=255,n;if(!t)return;t[5]!==n&&(s=t[6]?fi(+t[5]):gn(+t[5]));const r=Rx(+t[2]),a=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?n=mw(r,a,o):t[1]==="hsv"?n=gw(r,a,o):n=Fd(r,a,o),{r:n[0],g:n[1],b:n[2],a:s}}function xw(e,t){var s=Dd(e);s[0]=Rx(s[0]+t),s=Fd(s),e.r=s[0],e.g=s[1],e.b=s[2]}function yw(e){if(!e)return;const t=Dd(e),s=t[0],n=Nf(t[1]),r=Nf(t[2]);return e.a<255?`hsla(${s}, ${n}%, ${r}%, ${Ps(e.a)})`:`hsl(${s}, ${n}%, ${r}%)`}const kf={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Sf={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function vw(){const e={},t=Object.keys(Sf),s=Object.keys(kf);let n,r,a,o,l;for(n=0;n<t.length;n++){for(o=l=t[n],r=0;r<s.length;r++)a=s[r],l=l.replace(a,kf[a]);a=parseInt(Sf[o],16),e[l]=[a>>16&255,a>>8&255,a&255]}return e}let Ma;function bw(e){Ma||(Ma=vw(),Ma.transparent=[0,0,0,0]);const t=Ma[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const ww=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function jw(e){const t=ww.exec(e);let s=255,n,r,a;if(t){if(t[7]!==n){const o=+t[7];s=t[8]?fi(o):sn(o*255,0,255)}return n=+t[1],r=+t[3],a=+t[5],n=255&(t[2]?fi(n):sn(n,0,255)),r=255&(t[4]?fi(r):sn(r,0,255)),a=255&(t[6]?fi(a):sn(a,0,255)),{r:n,g:r,b:a,a:s}}}function _w(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${Ps(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const cc=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,nr=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function Nw(e,t,s){const n=nr(Ps(e.r)),r=nr(Ps(e.g)),a=nr(Ps(e.b));return{r:gn(cc(n+s*(nr(Ps(t.r))-n))),g:gn(cc(r+s*(nr(Ps(t.g))-r))),b:gn(cc(a+s*(nr(Ps(t.b))-a))),a:e.a+s*(t.a-e.a)}}function Pa(e,t,s){if(e){let n=Dd(e);n[t]=Math.max(0,Math.min(n[t]+n[t]*s,t===0?360:1)),n=Fd(n),e.r=n[0],e.g=n[1],e.b=n[2]}}function Dx(e,t){return e&&Object.assign(t||{},e)}function Cf(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=gn(e[3]))):(t=Dx(e,{r:0,g:0,b:0,a:1}),t.a=gn(t.a)),t}function kw(e){return e.charAt(0)==="r"?jw(e):pw(e)}let Ox=class ku{constructor(t){if(t instanceof ku)return t;const s=typeof t;let n;s==="object"?n=Cf(t):s==="string"&&(n=ow(t)||bw(t)||kw(t)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var t=Dx(this._rgb);return t&&(t.a=Ps(t.a)),t}set rgb(t){this._rgb=Cf(t)}rgbString(){return this._valid?_w(this._rgb):void 0}hexString(){return this._valid?cw(this._rgb):void 0}hslString(){return this._valid?yw(this._rgb):void 0}mix(t,s){if(t){const n=this.rgb,r=t.rgb;let a;const o=s===a?.5:s,l=2*o-1,c=n.a-r.a,u=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;a=1-u,n.r=255&u*n.r+a*r.r+.5,n.g=255&u*n.g+a*r.g+.5,n.b=255&u*n.b+a*r.b+.5,n.a=o*n.a+(1-o)*r.a,this.rgb=n}return this}interpolate(t,s){return t&&(this._rgb=Nw(this._rgb,t._rgb,s)),this}clone(){return new ku(this.rgb)}alpha(t){return this._rgb.a=gn(t),this}clearer(t){const s=this._rgb;return s.a*=1-t,this}greyscale(){const t=this._rgb,s=ca(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=s,this}opaquer(t){const s=this._rgb;return s.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Pa(this._rgb,2,t),this}darken(t){return Pa(this._rgb,2,-t),this}saturate(t){return Pa(this._rgb,1,t),this}desaturate(t){return Pa(this._rgb,1,-t),this}rotate(t){return xw(this._rgb,t),this}};/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Ss(){}const Sw=(()=>{let e=0;return()=>e++})();function De(e){return e==null}function rt(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Ee(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}function Qt(e){return(typeof e=="number"||e instanceof Number)&&isFinite(+e)}function ms(e,t){return Qt(e)?e:t}function Te(e,t){return typeof e>"u"?t:e}const Cw=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Be(e,t,s){if(e&&typeof e.call=="function")return e.apply(s,t)}function Le(e,t,s,n){let r,a,o;if(rt(e))for(a=e.length,r=0;r<a;r++)t.call(s,e[r],r);else if(Ee(e))for(o=Object.keys(e),a=o.length,r=0;r<a;r++)t.call(s,e[o[r]],o[r])}function Go(e,t){let s,n,r,a;if(!e||!t||e.length!==t.length)return!1;for(s=0,n=e.length;s<n;++s)if(r=e[s],a=t[s],r.datasetIndex!==a.datasetIndex||r.index!==a.index)return!1;return!0}function Ko(e){if(rt(e))return e.map(Ko);if(Ee(e)){const t=Object.create(null),s=Object.keys(e),n=s.length;let r=0;for(;r<n;++r)t[s[r]]=Ko(e[s[r]]);return t}return e}function Fx(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function Ew(e,t,s,n){if(!Fx(e))return;const r=t[e],a=s[e];Ee(r)&&Ee(a)?Ki(r,a,n):t[e]=Ko(a)}function Ki(e,t,s){const n=rt(t)?t:[t],r=n.length;if(!Ee(e))return e;s=s||{};const a=s.merger||Ew;let o;for(let l=0;l<r;++l){if(o=n[l],!Ee(o))continue;const c=Object.keys(o);for(let u=0,d=c.length;u<d;++u)a(c[u],e,o,s)}return e}function Ci(e,t){return Ki(e,t,{merger:Tw})}function Tw(e,t,s){if(!Fx(e))return;const n=t[e],r=s[e];Ee(n)&&Ee(r)?Ci(n,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=Ko(r))}const Ef={"":e=>e,x:e=>e.x,y:e=>e.y};function Lw(e){const t=e.split("."),s=[];let n="";for(const r of t)n+=r,n.endsWith("\\")?n=n.slice(0,-1)+".":(s.push(n),n="");return s}function Aw(e){const t=Lw(e);return s=>{for(const n of t){if(n==="")break;s=s&&s[n]}return s}}function Dr(e,t){return(Ef[t]||(Ef[t]=Aw(t)))(e)}function zd(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Qi=e=>typeof e<"u",bn=e=>typeof e=="function",Tf=(e,t)=>{if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0};function Mw(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const yt=Math.PI,pn=2*yt,Qo=Number.POSITIVE_INFINITY,Pw=yt/180,is=yt/2,Cn=yt/4,Lf=yt*2/3,zx=Math.log10,xn=Math.sign;function po(e,t,s){return Math.abs(e-t)<s}function Af(e){const t=Math.round(e);e=po(e,t,e/1e3)?t:e;const s=Math.pow(10,Math.floor(zx(e))),n=e/s;return(n<=1?1:n<=2?2:n<=5?5:10)*s}function Rw(e){const t=[],s=Math.sqrt(e);let n;for(n=1;n<s;n++)e%n===0&&(t.push(n),t.push(e/n));return s===(s|0)&&t.push(s),t.sort((r,a)=>r-a).pop(),t}function Dw(e){return typeof e=="symbol"||typeof e=="object"&&e!==null&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}function Jo(e){return!Dw(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function Ow(e,t){const s=Math.round(e);return s-t<=e&&s+t>=e}function Fw(e,t,s){let n,r,a;for(n=0,r=e.length;n<r;n++)a=e[n][s],isNaN(a)||(t.min=Math.min(t.min,a),t.max=Math.max(t.max,a))}function Fn(e){return e*(yt/180)}function zw(e){return e*(180/yt)}function Mf(e){if(!Qt(e))return;let t=1,s=0;for(;Math.round(e*t)/t!==e;)t*=10,s++;return s}function Iw(e,t){const s=t.x-e.x,n=t.y-e.y,r=Math.sqrt(s*s+n*n);let a=Math.atan2(n,s);return a<-.5*yt&&(a+=pn),{angle:a,distance:r}}function $w(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function En(e){return(e%pn+pn)%pn}function Bw(e,t,s,n){const r=En(e),a=En(t),o=En(s),l=En(a-r),c=En(o-r),u=En(r-a),d=En(r-o);return r===a||r===o||n||l>c&&u<d}function as(e,t,s){return Math.max(t,Math.min(s,e))}function Hw(e){return as(e,-32768,32767)}function xr(e,t,s,n=1e-6){return e>=Math.min(t,s)-n&&e<=Math.max(t,s)+n}function Id(e,t,s){s=s||(o=>e[o]<t);let n=e.length-1,r=0,a;for(;n-r>1;)a=r+n>>1,s(a)?r=a:n=a;return{lo:r,hi:n}}const Su=(e,t,s,n)=>Id(e,s,n?r=>{const a=e[r][t];return a<s||a===s&&e[r+1][t]===s}:r=>e[r][t]<s),Uw=(e,t,s)=>Id(e,s,n=>e[n][t]>=s);function Vw(e,t,s){let n=0,r=e.length;for(;n<r&&e[n]<t;)n++;for(;r>n&&e[r-1]>s;)r--;return n>0||r<e.length?e.slice(n,r):e}const Ix=["push","pop","shift","splice","unshift"];function Ww(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Ix.forEach(s=>{const n="_onData"+zd(s),r=e[s];Object.defineProperty(e,s,{configurable:!0,enumerable:!1,value(...a){const o=r.apply(this,a);return e._chartjs.listeners.forEach(l=>{typeof l[n]=="function"&&l[n](...a)}),o}})})}function Pf(e,t){const s=e._chartjs;if(!s)return;const n=s.listeners,r=n.indexOf(t);r!==-1&&n.splice(r,1),!(n.length>0)&&(Ix.forEach(a=>{delete e[a]}),delete e._chartjs)}function $x(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const Bx=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function Hx(e,t){let s=[],n=!1;return function(...r){s=r,n||(n=!0,Bx.call(window,()=>{n=!1,e.apply(t,s)}))}}function Xw(e,t){let s;return function(...n){return t?(clearTimeout(s),s=setTimeout(e,t,n)):e.apply(this,n),t}}const $d=e=>e==="start"?"left":e==="end"?"right":"center",gt=(e,t,s)=>e==="start"?t:e==="end"?s:(t+s)/2,qw=(e,t,s,n)=>e===(n?"left":"right")?s:e==="center"?(t+s)/2:t,Ra=e=>e===0||e===1,Rf=(e,t,s)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*pn/s)),Df=(e,t,s)=>Math.pow(2,-10*e)*Math.sin((e-t)*pn/s)+1,Ei={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*is)+1,easeOutSine:e=>Math.sin(e*is),easeInOutSine:e=>-.5*(Math.cos(yt*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Ra(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Ra(e)?e:Rf(e,.075,.3),easeOutElastic:e=>Ra(e)?e:Df(e,.075,.3),easeInOutElastic(e){return Ra(e)?e:e<.5?.5*Rf(e*2,.1125,.45):.5+.5*Df(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-Ei.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Ei.easeInBounce(e*2)*.5:Ei.easeOutBounce(e*2-1)*.5+.5};function Ux(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Of(e){return Ux(e)?e:new Ox(e)}function uc(e){return Ux(e)?e:new Ox(e).saturate(.5).darken(.1).hexString()}const Yw=["x","y","borderWidth","radius","tension"],Gw=["color","borderColor","backgroundColor"];function Kw(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),e.set("animations",{colors:{type:"color",properties:Gw},numbers:{type:"number",properties:Yw}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function Qw(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Ff=new Map;function Jw(e,t){t=t||{};const s=e+JSON.stringify(t);let n=Ff.get(s);return n||(n=new Intl.NumberFormat(e,t),Ff.set(s,n)),n}function Vx(e,t,s){return Jw(t,s).format(e)}const Zw={values(e){return rt(e)?e:""+e},numeric(e,t,s){if(e===0)return"0";const n=this.chart.options.locale;let r,a=e;if(s.length>1){const u=Math.max(Math.abs(s[0].value),Math.abs(s[s.length-1].value));(u<1e-4||u>1e15)&&(r="scientific"),a=ej(e,s)}const o=zx(Math.abs(a)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:r,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),Vx(e,n,c)}};function ej(e,t){let s=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(s)>=1&&e!==Math.floor(e)&&(s=e-Math.floor(e)),s}var Wx={formatters:Zw};function tj(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,s)=>s.lineWidth,tickColor:(t,s)=>s.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Wx.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Gn=Object.create(null),Cu=Object.create(null);function Ti(e,t){if(!t)return e;const s=t.split(".");for(let n=0,r=s.length;n<r;++n){const a=s[n];e=e[a]||(e[a]=Object.create(null))}return e}function dc(e,t,s){return typeof t=="string"?Ki(Ti(e,t),s):Ki(Ti(e,""),t)}class sj{constructor(t,s){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,r)=>uc(r.backgroundColor),this.hoverBorderColor=(n,r)=>uc(r.borderColor),this.hoverColor=(n,r)=>uc(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(s)}set(t,s){return dc(this,t,s)}get(t){return Ti(this,t)}describe(t,s){return dc(Cu,t,s)}override(t,s){return dc(Gn,t,s)}route(t,s,n,r){const a=Ti(this,t),o=Ti(this,n),l="_"+s;Object.defineProperties(a,{[l]:{value:a[s],writable:!0},[s]:{enumerable:!0,get(){const c=this[l],u=o[r];return Ee(c)?Object.assign({},u,c):Te(c,u)},set(c){this[l]=c}}})}apply(t){t.forEach(s=>s(this))}}var Qe=new sj({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Kw,Qw,tj]);function nj(e){return!e||De(e.size)||De(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function zf(e,t,s,n,r){let a=t[r];return a||(a=t[r]=e.measureText(r).width,s.push(r)),a>n&&(n=a),n}function Tn(e,t,s){const n=e.currentDevicePixelRatio,r=s!==0?Math.max(s/2,.5):0;return Math.round((t-r)*n)/n+r}function If(e,t){!t&&!e||(t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function $f(e,t,s,n){Xx(e,t,s,n,null)}function Xx(e,t,s,n,r){let a,o,l,c,u,d,h,f;const m=t.pointStyle,v=t.rotation,x=t.radius;let y=(v||0)*Pw;if(m&&typeof m=="object"&&(a=m.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){e.save(),e.translate(s,n),e.rotate(y),e.drawImage(m,-m.width/2,-m.height/2,m.width,m.height),e.restore();return}if(!(isNaN(x)||x<=0)){switch(e.beginPath(),m){default:r?e.ellipse(s,n,r/2,x,0,0,pn):e.arc(s,n,x,0,pn),e.closePath();break;case"triangle":d=r?r/2:x,e.moveTo(s+Math.sin(y)*d,n-Math.cos(y)*x),y+=Lf,e.lineTo(s+Math.sin(y)*d,n-Math.cos(y)*x),y+=Lf,e.lineTo(s+Math.sin(y)*d,n-Math.cos(y)*x),e.closePath();break;case"rectRounded":u=x*.516,c=x-u,o=Math.cos(y+Cn)*c,h=Math.cos(y+Cn)*(r?r/2-u:c),l=Math.sin(y+Cn)*c,f=Math.sin(y+Cn)*(r?r/2-u:c),e.arc(s-h,n-l,u,y-yt,y-is),e.arc(s+f,n-o,u,y-is,y),e.arc(s+h,n+l,u,y,y+is),e.arc(s-f,n+o,u,y+is,y+yt),e.closePath();break;case"rect":if(!v){c=Math.SQRT1_2*x,d=r?r/2:c,e.rect(s-d,n-c,2*d,2*c);break}y+=Cn;case"rectRot":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,l=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),e.moveTo(s-h,n-l),e.lineTo(s+f,n-o),e.lineTo(s+h,n+l),e.lineTo(s-f,n+o),e.closePath();break;case"crossRot":y+=Cn;case"cross":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,l=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),e.moveTo(s-h,n-l),e.lineTo(s+h,n+l),e.moveTo(s+f,n-o),e.lineTo(s-f,n+o);break;case"star":h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,l=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),e.moveTo(s-h,n-l),e.lineTo(s+h,n+l),e.moveTo(s+f,n-o),e.lineTo(s-f,n+o),y+=Cn,h=Math.cos(y)*(r?r/2:x),o=Math.cos(y)*x,l=Math.sin(y)*x,f=Math.sin(y)*(r?r/2:x),e.moveTo(s-h,n-l),e.lineTo(s+h,n+l),e.moveTo(s+f,n-o),e.lineTo(s-f,n+o);break;case"line":o=r?r/2:Math.cos(y)*x,l=Math.sin(y)*x,e.moveTo(s-o,n-l),e.lineTo(s+o,n+l);break;case"dash":e.moveTo(s,n),e.lineTo(s+Math.cos(y)*(r?r/2:x),n+Math.sin(y)*x);break;case!1:e.closePath();break}e.fill(),t.borderWidth>0&&e.stroke()}}function qx(e,t,s){return s=s||.5,!t||e&&e.x>t.left-s&&e.x<t.right+s&&e.y>t.top-s&&e.y<t.bottom+s}function Bd(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Hd(e){e.restore()}function rj(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),De(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function ij(e,t,s,n,r){if(r.strikethrough||r.underline){const a=e.measureText(n),o=t-a.actualBoundingBoxLeft,l=t+a.actualBoundingBoxRight,c=s-a.actualBoundingBoxAscent,u=s+a.actualBoundingBoxDescent,d=r.strikethrough?(c+u)/2:u;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(o,d),e.lineTo(l,d),e.stroke()}}function aj(e,t){const s=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=s}function Ji(e,t,s,n,r,a={}){const o=rt(t)?t:[t],l=a.strokeWidth>0&&a.strokeColor!=="";let c,u;for(e.save(),e.font=r.string,rj(e,a),c=0;c<o.length;++c)u=o[c],a.backdrop&&aj(e,a.backdrop),l&&(a.strokeColor&&(e.strokeStyle=a.strokeColor),De(a.strokeWidth)||(e.lineWidth=a.strokeWidth),e.strokeText(u,s,n,a.maxWidth)),e.fillText(u,s,n,a.maxWidth),ij(e,s,n,u,a),n+=Number(r.lineHeight);e.restore()}function Zo(e,t){const{x:s,y:n,w:r,h:a,radius:o}=t;e.arc(s+o.topLeft,n+o.topLeft,o.topLeft,1.5*yt,yt,!0),e.lineTo(s,n+a-o.bottomLeft),e.arc(s+o.bottomLeft,n+a-o.bottomLeft,o.bottomLeft,yt,is,!0),e.lineTo(s+r-o.bottomRight,n+a),e.arc(s+r-o.bottomRight,n+a-o.bottomRight,o.bottomRight,is,0,!0),e.lineTo(s+r,n+o.topRight),e.arc(s+r-o.topRight,n+o.topRight,o.topRight,0,-is,!0),e.lineTo(s+o.topLeft,n)}const oj=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,lj=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function cj(e,t){const s=(""+e).match(oj);if(!s||s[1]==="normal")return t*1.2;switch(e=+s[2],s[3]){case"px":return e;case"%":e/=100;break}return t*e}const uj=e=>+e||0;function Yx(e,t){const s={},n=Ee(t),r=n?Object.keys(t):t,a=Ee(e)?n?o=>Te(e[o],e[t[o]]):o=>e[o]:()=>e;for(const o of r)s[o]=uj(a(o));return s}function Gx(e){return Yx(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Nr(e){return Yx(e,["topLeft","topRight","bottomLeft","bottomRight"])}function Jt(e){const t=Gx(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function xt(e,t){e=e||{},t=t||Qe.font;let s=Te(e.size,t.size);typeof s=="string"&&(s=parseInt(s,10));let n=Te(e.style,t.style);n&&!(""+n).match(lj)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const r={family:Te(e.family,t.family),lineHeight:cj(Te(e.lineHeight,t.lineHeight),s),size:s,style:n,weight:Te(e.weight,t.weight),string:""};return r.string=nj(r),r}function Da(e,t,s,n){let r,a,o;for(r=0,a=e.length;r<a;++r)if(o=e[r],o!==void 0&&o!==void 0)return o}function dj(e,t,s){const{min:n,max:r}=e,a=Cw(t,(r-n)/2),o=(l,c)=>s&&l===0?0:l+c;return{min:o(n,-Math.abs(a)),max:o(r,a)}}function Ur(e,t){return Object.assign(Object.create(e),t)}function Ud(e,t=[""],s,n,r=()=>e[0]){const a=s||e;typeof n>"u"&&(n=Zx("_fallback",e));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:a,_fallback:n,_getTarget:r,override:l=>Ud([l,...e],t,a,n)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete e[0][c],!0},get(l,c){return Qx(l,c,()=>vj(c,t,e,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(l,c){return Hf(l).includes(c)},ownKeys(l){return Hf(l)},set(l,c,u){const d=l._storage||(l._storage=r());return l[c]=d[c]=u,delete l._keys,!0}})}function Or(e,t,s,n){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:s,_stack:new Set,_descriptors:Kx(e,n),setContext:a=>Or(e,a,s,n),override:a=>Or(e.override(a),t,s,n)};return new Proxy(r,{deleteProperty(a,o){return delete a[o],delete e[o],!0},get(a,o,l){return Qx(a,o,()=>fj(a,o,l))},getOwnPropertyDescriptor(a,o){return a._descriptors.allKeys?Reflect.has(e,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,o)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(a,o){return Reflect.has(e,o)},ownKeys(){return Reflect.ownKeys(e)},set(a,o,l){return e[o]=l,delete a[o],!0}})}function Kx(e,t={scriptable:!0,indexable:!0}){const{_scriptable:s=t.scriptable,_indexable:n=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:s,indexable:n,isScriptable:bn(s)?s:()=>s,isIndexable:bn(n)?n:()=>n}}const hj=(e,t)=>e?e+zd(t):t,Vd=(e,t)=>Ee(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Qx(e,t,s){if(Object.prototype.hasOwnProperty.call(e,t)||t==="constructor")return e[t];const n=s();return e[t]=n,n}function fj(e,t,s){const{_proxy:n,_context:r,_subProxy:a,_descriptors:o}=e;let l=n[t];return bn(l)&&o.isScriptable(t)&&(l=mj(t,l,e,s)),rt(l)&&l.length&&(l=gj(t,l,e,o.isIndexable)),Vd(t,l)&&(l=Or(l,r,a&&a[t],o)),l}function mj(e,t,s,n){const{_proxy:r,_context:a,_subProxy:o,_stack:l}=s;if(l.has(e))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+e);l.add(e);let c=t(a,o||n);return l.delete(e),Vd(e,c)&&(c=Wd(r._scopes,r,e,c)),c}function gj(e,t,s,n){const{_proxy:r,_context:a,_subProxy:o,_descriptors:l}=s;if(typeof a.index<"u"&&n(e))return t[a.index%t.length];if(Ee(t[0])){const c=t,u=r._scopes.filter(d=>d!==c);t=[];for(const d of c){const h=Wd(u,r,e,d);t.push(Or(h,a,o&&o[e],l))}}return t}function Jx(e,t,s){return bn(e)?e(t,s):e}const pj=(e,t)=>e===!0?t:typeof e=="string"?Dr(t,e):void 0;function xj(e,t,s,n,r){for(const a of t){const o=pj(s,a);if(o){e.add(o);const l=Jx(o._fallback,s,r);if(typeof l<"u"&&l!==s&&l!==n)return l}else if(o===!1&&typeof n<"u"&&s!==n)return null}return!1}function Wd(e,t,s,n){const r=t._rootScopes,a=Jx(t._fallback,s,n),o=[...e,...r],l=new Set;l.add(n);let c=Bf(l,o,s,a||s,n);return c===null||typeof a<"u"&&a!==s&&(c=Bf(l,o,a,c,n),c===null)?!1:Ud(Array.from(l),[""],r,a,()=>yj(t,s,n))}function Bf(e,t,s,n,r){for(;s;)s=xj(e,t,s,n,r);return s}function yj(e,t,s){const n=e._getTarget();t in n||(n[t]={});const r=n[t];return rt(r)&&Ee(s)?s:r||{}}function vj(e,t,s,n){let r;for(const a of t)if(r=Zx(hj(a,e),s),typeof r<"u")return Vd(e,r)?Wd(s,n,e,r):r}function Zx(e,t){for(const s of t){if(!s)continue;const n=s[e];if(typeof n<"u")return n}}function Hf(e){let t=e._keys;return t||(t=e._keys=bj(e._scopes)),t}function bj(e){const t=new Set;for(const s of e)for(const n of Object.keys(s).filter(r=>!r.startsWith("_")))t.add(n);return Array.from(t)}function Xd(){return typeof window<"u"&&typeof document<"u"}function qd(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function el(e,t,s){let n;return typeof e=="string"?(n=parseInt(e,10),e.indexOf("%")!==-1&&(n=n/100*t.parentNode[s])):n=e,n}const Ll=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);function wj(e,t){return Ll(e).getPropertyValue(t)}const jj=["top","right","bottom","left"];function Bn(e,t,s){const n={};s=s?"-"+s:"";for(let r=0;r<4;r++){const a=jj[r];n[a]=parseFloat(e[t+"-"+a+s])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const _j=(e,t,s)=>(e>0||t>0)&&(!s||!s.shadowRoot);function Nj(e,t){const s=e.touches,n=s&&s.length?s[0]:e,{offsetX:r,offsetY:a}=n;let o=!1,l,c;if(_j(r,a,e.target))l=r,c=a;else{const u=t.getBoundingClientRect();l=n.clientX-u.left,c=n.clientY-u.top,o=!0}return{x:l,y:c,box:o}}function Pn(e,t){if("native"in e)return e;const{canvas:s,currentDevicePixelRatio:n}=t,r=Ll(s),a=r.boxSizing==="border-box",o=Bn(r,"padding"),l=Bn(r,"border","width"),{x:c,y:u,box:d}=Nj(e,s),h=o.left+(d&&l.left),f=o.top+(d&&l.top);let{width:m,height:v}=t;return a&&(m-=o.width+l.width,v-=o.height+l.height),{x:Math.round((c-h)/m*s.width/n),y:Math.round((u-f)/v*s.height/n)}}function kj(e,t,s){let n,r;if(t===void 0||s===void 0){const a=e&&qd(e);if(!a)t=e.clientWidth,s=e.clientHeight;else{const o=a.getBoundingClientRect(),l=Ll(a),c=Bn(l,"border","width"),u=Bn(l,"padding");t=o.width-u.width-c.width,s=o.height-u.height-c.height,n=el(l.maxWidth,a,"clientWidth"),r=el(l.maxHeight,a,"clientHeight")}}return{width:t,height:s,maxWidth:n||Qo,maxHeight:r||Qo}}const nn=e=>Math.round(e*10)/10;function Sj(e,t,s,n){const r=Ll(e),a=Bn(r,"margin"),o=el(r.maxWidth,e,"clientWidth")||Qo,l=el(r.maxHeight,e,"clientHeight")||Qo,c=kj(e,t,s);let{width:u,height:d}=c;if(r.boxSizing==="content-box"){const f=Bn(r,"border","width"),m=Bn(r,"padding");u-=m.width+f.width,d-=m.height+f.height}return u=Math.max(0,u-a.width),d=Math.max(0,n?u/n:d-a.height),u=nn(Math.min(u,o,c.maxWidth)),d=nn(Math.min(d,l,c.maxHeight)),u&&!d&&(d=nn(u/2)),(t!==void 0||s!==void 0)&&n&&c.height&&d>c.height&&(d=c.height,u=nn(Math.floor(d*n))),{width:u,height:d}}function Uf(e,t,s){const n=t||1,r=nn(e.height*n),a=nn(e.width*n);e.height=nn(e.height),e.width=nn(e.width);const o=e.canvas;return o.style&&(s||!o.style.height&&!o.style.width)&&(o.style.height=`${e.height}px`,o.style.width=`${e.width}px`),e.currentDevicePixelRatio!==n||o.height!==r||o.width!==a?(e.currentDevicePixelRatio=n,o.height=r,o.width=a,e.ctx.setTransform(n,0,0,n,0,0),!0):!1}const Cj=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};Xd()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return e}();function Vf(e,t){const s=wj(e,t),n=s&&s.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}const Ej=function(e,t){return{x(s){return e+e+t-s},setWidth(s){t=s},textAlign(s){return s==="center"?s:s==="right"?"left":"right"},xPlus(s,n){return s-n},leftForLtr(s,n){return s-n}}},Tj=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function kr(e,t,s){return e?Ej(t,s):Tj()}function e0(e,t){let s,n;(t==="ltr"||t==="rtl")&&(s=e.canvas.style,n=[s.getPropertyValue("direction"),s.getPropertyPriority("direction")],s.setProperty("direction",t,"important"),e.prevTextDirection=n)}function t0(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Oa(e,t,s){return e.options.clip?e[s]:t[s]}function Lj(e,t){const{xScale:s,yScale:n}=e;return s&&n?{left:Oa(s,t,"left"),right:Oa(s,t,"right"),top:Oa(n,t,"top"),bottom:Oa(n,t,"bottom")}:t}function Aj(e,t){const s=t._clip;if(s.disabled)return!1;const n=Lj(t,e.chartArea);return{left:s.left===!1?0:n.left-(s.left===!0?0:s.left),right:s.right===!1?e.width:n.right+(s.right===!0?0:s.right),top:s.top===!1?0:n.top-(s.top===!0?0:s.top),bottom:s.bottom===!1?e.height:n.bottom+(s.bottom===!0?0:s.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Mj{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,s,n,r){const a=s.listeners[r],o=s.duration;a.forEach(l=>l({chart:t,initial:s.initial,numSteps:o,currentStep:Math.min(n-s.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Bx.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let s=0;this._charts.forEach((n,r)=>{if(!n.running||!n.items.length)return;const a=n.items;let o=a.length-1,l=!1,c;for(;o>=0;--o)c=a[o],c._active?(c._total>n.duration&&(n.duration=c._total),c.tick(t),l=!0):(a[o]=a[a.length-1],a.pop());l&&(r.draw(),this._notify(r,n,t,"progress")),a.length||(n.running=!1,this._notify(r,n,t,"complete"),n.initial=!1),s+=a.length}),this._lastDate=t,s===0&&(this._running=!1)}_getAnims(t){const s=this._charts;let n=s.get(t);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},s.set(t,n)),n}listen(t,s,n){this._getAnims(t).listeners[s].push(n)}add(t,s){!s||!s.length||this._getAnims(t).items.push(...s)}has(t){return this._getAnims(t).items.length>0}start(t){const s=this._charts.get(t);s&&(s.running=!0,s.start=Date.now(),s.duration=s.items.reduce((n,r)=>Math.max(n,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const s=this._charts.get(t);return!(!s||!s.running||!s.items.length)}stop(t){const s=this._charts.get(t);if(!s||!s.items.length)return;const n=s.items;let r=n.length-1;for(;r>=0;--r)n[r].cancel();s.items=[],this._notify(t,s,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var Es=new Mj;const Wf="transparent",Pj={boolean(e,t,s){return s>.5?t:e},color(e,t,s){const n=Of(e||Wf),r=n.valid&&Of(t||Wf);return r&&r.valid?r.mix(n,s).hexString():t},number(e,t,s){return e+(t-e)*s}};class Rj{constructor(t,s,n,r){const a=s[n];r=Da([t.to,r,a,t.from]);const o=Da([t.from,a,r]);this._active=!0,this._fn=t.fn||Pj[t.type||typeof o],this._easing=Ei[t.easing]||Ei.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=s,this._prop=n,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(t,s,n){if(this._active){this._notify(!1);const r=this._target[this._prop],a=n-this._start,o=this._duration-a;this._start=n,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=a,this._loop=!!t.loop,this._to=Da([t.to,s,r,t.from]),this._from=Da([t.from,r,s])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const s=t-this._start,n=this._duration,r=this._prop,a=this._from,o=this._loop,l=this._to;let c;if(this._active=a!==l&&(o||s<n),!this._active){this._target[r]=l,this._notify(!0);return}if(s<0){this._target[r]=a;return}c=s/n%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[r]=this._fn(a,l,c)}wait(){const t=this._promises||(this._promises=[]);return new Promise((s,n)=>{t.push({res:s,rej:n})})}_notify(t){const s=t?"res":"rej",n=this._promises||[];for(let r=0;r<n.length;r++)n[r][s]()}}class s0{constructor(t,s){this._chart=t,this._properties=new Map,this.configure(s)}configure(t){if(!Ee(t))return;const s=Object.keys(Qe.animation),n=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{const a=t[r];if(!Ee(a))return;const o={};for(const l of s)o[l]=a[l];(rt(a.properties)&&a.properties||[r]).forEach(l=>{(l===r||!n.has(l))&&n.set(l,o)})})}_animateOptions(t,s){const n=s.options,r=Oj(t,n);if(!r)return[];const a=this._createAnimations(r,n);return n.$shared&&Dj(t.options.$animations,n).then(()=>{t.options=n},()=>{}),a}_createAnimations(t,s){const n=this._properties,r=[],a=t.$animations||(t.$animations={}),o=Object.keys(s),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const u=o[c];if(u.charAt(0)==="$")continue;if(u==="options"){r.push(...this._animateOptions(t,s));continue}const d=s[u];let h=a[u];const f=n.get(u);if(h)if(f&&h.active()){h.update(f,d,l);continue}else h.cancel();if(!f||!f.duration){t[u]=d;continue}a[u]=h=new Rj(f,t,u,d),r.push(h)}return r}update(t,s){if(this._properties.size===0){Object.assign(t,s);return}const n=this._createAnimations(t,s);if(n.length)return Es.add(this._chart,n),!0}}function Dj(e,t){const s=[],n=Object.keys(t);for(let r=0;r<n.length;r++){const a=e[n[r]];a&&a.active()&&s.push(a.wait())}return Promise.all(s)}function Oj(e,t){if(!t)return;let s=e.options;if(!s){e.options=t;return}return s.$shared&&(e.options=s=Object.assign({},s,{$shared:!1,$animations:{}})),s}function Xf(e,t){const s=e&&e.options||{},n=s.reverse,r=s.min===void 0?t:0,a=s.max===void 0?t:0;return{start:n?a:r,end:n?r:a}}function Fj(e,t,s){if(s===!1)return!1;const n=Xf(e,s),r=Xf(t,s);return{top:r.end,right:n.end,bottom:r.start,left:n.start}}function zj(e){let t,s,n,r;return Ee(e)?(t=e.top,s=e.right,n=e.bottom,r=e.left):t=s=n=r=e,{top:t,right:s,bottom:n,left:r,disabled:e===!1}}function n0(e,t){const s=[],n=e._getSortedDatasetMetas(t);let r,a;for(r=0,a=n.length;r<a;++r)s.push(n[r].index);return s}function qf(e,t,s,n={}){const r=e.keys,a=n.mode==="single";let o,l,c,u;if(t===null)return;let d=!1;for(o=0,l=r.length;o<l;++o){if(c=+r[o],c===s){if(d=!0,n.all)continue;break}u=e.values[c],Qt(u)&&(a||t===0||xn(t)===xn(u))&&(t+=u)}return!d&&!n.all?0:t}function Ij(e,t){const{iScale:s,vScale:n}=t,r=s.axis==="x"?"x":"y",a=n.axis==="x"?"x":"y",o=Object.keys(e),l=new Array(o.length);let c,u,d;for(c=0,u=o.length;c<u;++c)d=o[c],l[c]={[r]:d,[a]:e[d]};return l}function hc(e,t){const s=e&&e.options.stacked;return s||s===void 0&&t.stack!==void 0}function $j(e,t,s){return`${e.id}.${t.id}.${s.stack||s.type}`}function Bj(e){const{min:t,max:s,minDefined:n,maxDefined:r}=e.getUserBounds();return{min:n?t:Number.NEGATIVE_INFINITY,max:r?s:Number.POSITIVE_INFINITY}}function Hj(e,t,s){const n=e[t]||(e[t]={});return n[s]||(n[s]={})}function Yf(e,t,s,n){for(const r of t.getMatchingVisibleMetas(n).reverse()){const a=e[r.index];if(s&&a>0||!s&&a<0)return r.index}return null}function Gf(e,t){const{chart:s,_cachedMeta:n}=e,r=s._stacks||(s._stacks={}),{iScale:a,vScale:o,index:l}=n,c=a.axis,u=o.axis,d=$j(a,o,n),h=t.length;let f;for(let m=0;m<h;++m){const v=t[m],{[c]:x,[u]:y}=v,g=v._stacks||(v._stacks={});f=g[u]=Hj(r,d,x),f[l]=y,f._top=Yf(f,o,!0,n.type),f._bottom=Yf(f,o,!1,n.type);const p=f._visualValues||(f._visualValues={});p[l]=y}}function fc(e,t){const s=e.scales;return Object.keys(s).filter(n=>s[n].axis===t).shift()}function Uj(e,t){return Ur(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function Vj(e,t,s){return Ur(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:s,index:t,mode:"default",type:"data"})}function si(e,t){const s=e.controller.index,n=e.vScale&&e.vScale.axis;if(n){t=t||e._parsed;for(const r of t){const a=r._stacks;if(!a||a[n]===void 0||a[n][s]===void 0)return;delete a[n][s],a[n]._visualValues!==void 0&&a[n]._visualValues[s]!==void 0&&delete a[n]._visualValues[s]}}}const mc=e=>e==="reset"||e==="none",Kf=(e,t)=>t?e:Object.assign({},e),Wj=(e,t,s)=>e&&!t.hidden&&t._stacked&&{keys:n0(s,!0),values:null};class Li{constructor(t,s){this.chart=t,this._ctx=t.ctx,this.index=s,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=hc(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&si(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,s=this._cachedMeta,n=this.getDataset(),r=(h,f,m,v)=>h==="x"?f:h==="r"?v:m,a=s.xAxisID=Te(n.xAxisID,fc(t,"x")),o=s.yAxisID=Te(n.yAxisID,fc(t,"y")),l=s.rAxisID=Te(n.rAxisID,fc(t,"r")),c=s.indexAxis,u=s.iAxisID=r(c,a,o,l),d=s.vAxisID=r(c,o,a,l);s.xScale=this.getScaleForId(a),s.yScale=this.getScaleForId(o),s.rScale=this.getScaleForId(l),s.iScale=this.getScaleForId(u),s.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const s=this._cachedMeta;return t===s.iScale?s.vScale:s.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Pf(this._data,this),t._stacked&&si(t)}_dataCheck(){const t=this.getDataset(),s=t.data||(t.data=[]),n=this._data;if(Ee(s)){const r=this._cachedMeta;this._data=Ij(s,r)}else if(n!==s){if(n){Pf(n,this);const r=this._cachedMeta;si(r),r._parsed=[]}s&&Object.isExtensible(s)&&Ww(s,this),this._syncList=[],this._data=s}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const s=this._cachedMeta,n=this.getDataset();let r=!1;this._dataCheck();const a=s._stacked;s._stacked=hc(s.vScale,s),s.stack!==n.stack&&(r=!0,si(s),s.stack=n.stack),this._resyncElements(t),(r||a!==s._stacked)&&(Gf(this,s._parsed),s._stacked=hc(s.vScale,s))}configure(){const t=this.chart.config,s=t.datasetScopeKeys(this._type),n=t.getOptionScopes(this.getDataset(),s,!0);this.options=t.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,s){const{_cachedMeta:n,_data:r}=this,{iScale:a,_stacked:o}=n,l=a.axis;let c=t===0&&s===r.length?!0:n._sorted,u=t>0&&n._parsed[t-1],d,h,f;if(this._parsing===!1)n._parsed=r,n._sorted=!0,f=r;else{rt(r[t])?f=this.parseArrayData(n,r,t,s):Ee(r[t])?f=this.parseObjectData(n,r,t,s):f=this.parsePrimitiveData(n,r,t,s);const m=()=>h[l]===null||u&&h[l]<u[l];for(d=0;d<s;++d)n._parsed[d+t]=h=f[d],c&&(m()&&(c=!1),u=h);n._sorted=c}o&&Gf(this,f)}parsePrimitiveData(t,s,n,r){const{iScale:a,vScale:o}=t,l=a.axis,c=o.axis,u=a.getLabels(),d=a===o,h=new Array(r);let f,m,v;for(f=0,m=r;f<m;++f)v=f+n,h[f]={[l]:d||a.parse(u[v],v),[c]:o.parse(s[v],v)};return h}parseArrayData(t,s,n,r){const{xScale:a,yScale:o}=t,l=new Array(r);let c,u,d,h;for(c=0,u=r;c<u;++c)d=c+n,h=s[d],l[c]={x:a.parse(h[0],d),y:o.parse(h[1],d)};return l}parseObjectData(t,s,n,r){const{xScale:a,yScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=new Array(r);let d,h,f,m;for(d=0,h=r;d<h;++d)f=d+n,m=s[f],u[d]={x:a.parse(Dr(m,l),f),y:o.parse(Dr(m,c),f)};return u}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,s,n){const r=this.chart,a=this._cachedMeta,o=s[t.axis],l={keys:n0(r,!0),values:s._stacks[t.axis]._visualValues};return qf(l,o,a.index,{mode:n})}updateRangeFromParsed(t,s,n,r){const a=n[s.axis];let o=a===null?NaN:a;const l=r&&n._stacks[s.axis];r&&l&&(r.values=l,o=qf(r,a,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,s){const n=this._cachedMeta,r=n._parsed,a=n._sorted&&t===n.iScale,o=r.length,l=this._getOtherScale(t),c=Wj(s,n,this.chart),u={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:h}=Bj(l);let f,m;function v(){m=r[f];const x=m[l.axis];return!Qt(m[t.axis])||d>x||h<x}for(f=0;f<o&&!(!v()&&(this.updateRangeFromParsed(u,t,m,c),a));++f);if(a){for(f=o-1;f>=0;--f)if(!v()){this.updateRangeFromParsed(u,t,m,c);break}}return u}getAllParsedValues(t){const s=this._cachedMeta._parsed,n=[];let r,a,o;for(r=0,a=s.length;r<a;++r)o=s[r][t.axis],Qt(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(t){const s=this._cachedMeta,n=s.iScale,r=s.vScale,a=this.getParsed(t);return{label:n?""+n.getLabelForValue(a[n.axis]):"",value:r?""+r.getLabelForValue(a[r.axis]):""}}_update(t){const s=this._cachedMeta;this.update(t||"default"),s._clip=zj(Te(this.options.clip,Fj(s.xScale,s.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,s=this.chart,n=this._cachedMeta,r=n.data||[],a=s.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||r.length-l,u=this.options.drawActiveElementsOnTop;let d;for(n.dataset&&n.dataset.draw(t,a,l,c),d=l;d<l+c;++d){const h=r[d];h.hidden||(h.active&&u?o.push(h):h.draw(t,a))}for(d=0;d<o.length;++d)o[d].draw(t,a)}getStyle(t,s){const n=s?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(t||0,n)}getContext(t,s,n){const r=this.getDataset();let a;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];a=o.$context||(o.$context=Vj(this.getContext(),t,o)),a.parsed=this.getParsed(t),a.raw=r.data[t],a.index=a.dataIndex=t}else a=this.$context||(this.$context=Uj(this.chart.getContext(),this.index)),a.dataset=r,a.index=a.datasetIndex=this.index;return a.active=!!s,a.mode=n,a}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,s){return this._resolveElementOptions(this.dataElementType.id,s,t)}_resolveElementOptions(t,s="default",n){const r=s==="active",a=this._cachedDataOpts,o=t+"-"+s,l=a[o],c=this.enableOptionSharing&&Qi(n);if(l)return Kf(l,c);const u=this.chart.config,d=u.datasetElementScopeKeys(this._type,t),h=r?[`${t}Hover`,"hover",t,""]:[t,""],f=u.getOptionScopes(this.getDataset(),d),m=Object.keys(Qe.elements[t]),v=()=>this.getContext(n,r,s),x=u.resolveNamedOptions(f,m,v,h);return x.$shared&&(x.$shared=c,a[o]=Object.freeze(Kf(x,c))),x}_resolveAnimations(t,s,n){const r=this.chart,a=this._cachedDataOpts,o=`animation-${s}`,l=a[o];if(l)return l;let c;if(r.options.animation!==!1){const d=this.chart.config,h=d.datasetAnimationScopeKeys(this._type,s),f=d.getOptionScopes(this.getDataset(),h);c=d.createResolver(f,this.getContext(t,n,s))}const u=new s0(r,c&&c.animations);return c&&c._cacheable&&(a[o]=Object.freeze(u)),u}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,s){return!s||mc(t)||this.chart._animationsDisabled}_getSharedOptions(t,s){const n=this.resolveDataElementOptions(t,s),r=this._sharedOptions,a=this.getSharedOptions(n),o=this.includeOptions(s,a)||a!==r;return this.updateSharedOptions(a,s,n),{sharedOptions:a,includeOptions:o}}updateElement(t,s,n,r){mc(r)?Object.assign(t,n):this._resolveAnimations(s,r).update(t,n)}updateSharedOptions(t,s,n){t&&!mc(s)&&this._resolveAnimations(void 0,s).update(t,n)}_setStyle(t,s,n,r){t.active=r;const a=this.getStyle(s,r);this._resolveAnimations(s,n,r).update(t,{options:!r&&this.getSharedOptions(a)||a})}removeHoverStyle(t,s,n){this._setStyle(t,n,"active",!1)}setHoverStyle(t,s,n){this._setStyle(t,n,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const s=this._data,n=this._cachedMeta.data;for(const[l,c,u]of this._syncList)this[l](c,u);this._syncList=[];const r=n.length,a=s.length,o=Math.min(a,r);o&&this.parse(0,o),a>r?this._insertElements(r,a-r,t):a<r&&this._removeElements(a,r-a)}_insertElements(t,s,n=!0){const r=this._cachedMeta,a=r.data,o=t+s;let l;const c=u=>{for(u.length+=s,l=u.length-1;l>=o;l--)u[l]=u[l-s]};for(c(a),l=t;l<o;++l)a[l]=new this.dataElementType;this._parsing&&c(r._parsed),this.parse(t,s),n&&this.updateElements(a,t,s,"reset")}updateElements(t,s,n,r){}_removeElements(t,s){const n=this._cachedMeta;if(this._parsing){const r=n._parsed.splice(t,s);n._stacked&&si(n,r)}n.data.splice(t,s)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[s,n,r]=t;this[s](n,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,s){s&&this._sync(["_removeElements",t,s]);const n=arguments.length-2;n&&this._sync(["_insertElements",t,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ke(Li,"defaults",{}),ke(Li,"datasetElementType",null),ke(Li,"dataElementType",null);function Xj(e,t){if(!e._cache.$bar){const s=e.getMatchingVisibleMetas(t);let n=[];for(let r=0,a=s.length;r<a;r++)n=n.concat(s[r].controller.getAllParsedValues(e));e._cache.$bar=$x(n.sort((r,a)=>r-a))}return e._cache.$bar}function qj(e){const t=e.iScale,s=Xj(t,e.type);let n=t._length,r,a,o,l;const c=()=>{o===32767||o===-32768||(Qi(l)&&(n=Math.min(n,Math.abs(o-l)||n)),l=o)};for(r=0,a=s.length;r<a;++r)o=t.getPixelForValue(s[r]),c();for(l=void 0,r=0,a=t.ticks.length;r<a;++r)o=t.getPixelForTick(r),c();return n}function Yj(e,t,s,n){const r=s.barThickness;let a,o;return De(r)?(a=t.min*s.categoryPercentage,o=s.barPercentage):(a=r*n,o=1),{chunk:a/n,ratio:o,start:t.pixels[e]-a/2}}function Gj(e,t,s,n){const r=t.pixels,a=r[e];let o=e>0?r[e-1]:null,l=e<r.length-1?r[e+1]:null;const c=s.categoryPercentage;o===null&&(o=a-(l===null?t.end-t.start:l-a)),l===null&&(l=a+a-o);const u=a-(a-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/n,ratio:s.barPercentage,start:u}}function Kj(e,t,s,n){const r=s.parse(e[0],n),a=s.parse(e[1],n),o=Math.min(r,a),l=Math.max(r,a);let c=o,u=l;Math.abs(o)>Math.abs(l)&&(c=l,u=o),t[s.axis]=u,t._custom={barStart:c,barEnd:u,start:r,end:a,min:o,max:l}}function r0(e,t,s,n){return rt(e)?Kj(e,t,s,n):t[s.axis]=s.parse(e,n),t}function Qf(e,t,s,n){const r=e.iScale,a=e.vScale,o=r.getLabels(),l=r===a,c=[];let u,d,h,f;for(u=s,d=s+n;u<d;++u)f=t[u],h={},h[r.axis]=l||r.parse(o[u],u),c.push(r0(f,h,a,u));return c}function gc(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function Qj(e,t,s){return e!==0?xn(e):(t.isHorizontal()?1:-1)*(t.min>=s?1:-1)}function Jj(e){let t,s,n,r,a;return e.horizontal?(t=e.base>e.x,s="left",n="right"):(t=e.base<e.y,s="bottom",n="top"),t?(r="end",a="start"):(r="start",a="end"),{start:s,end:n,reverse:t,top:r,bottom:a}}function Zj(e,t,s,n){let r=t.borderSkipped;const a={};if(!r){e.borderSkipped=a;return}if(r===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:u,bottom:d}=Jj(e);r==="middle"&&s&&(e.enableBorderRadius=!0,(s._top||0)===n?r=u:(s._bottom||0)===n?r=d:(a[Jf(d,o,l,c)]=!0,r=u)),a[Jf(r,o,l,c)]=!0,e.borderSkipped=a}function Jf(e,t,s,n){return n?(e=e_(e,t,s),e=Zf(e,s,t)):e=Zf(e,t,s),e}function e_(e,t,s){return e===t?s:e===s?t:e}function Zf(e,t,s){return e==="start"?t:e==="end"?s:e}function t_(e,{inflateAmount:t},s){e.inflateAmount=t==="auto"?s===1?.33:0:t}class xo extends Li{parsePrimitiveData(t,s,n,r){return Qf(t,s,n,r)}parseArrayData(t,s,n,r){return Qf(t,s,n,r)}parseObjectData(t,s,n,r){const{iScale:a,vScale:o}=t,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,u=a.axis==="x"?l:c,d=o.axis==="x"?l:c,h=[];let f,m,v,x;for(f=n,m=n+r;f<m;++f)x=s[f],v={},v[a.axis]=a.parse(Dr(x,u),f),h.push(r0(Dr(x,d),v,o,f));return h}updateRangeFromParsed(t,s,n,r){super.updateRangeFromParsed(t,s,n,r);const a=n._custom;a&&s===this._cachedMeta.vScale&&(t.min=Math.min(t.min,a.min),t.max=Math.max(t.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const s=this._cachedMeta,{iScale:n,vScale:r}=s,a=this.getParsed(t),o=a._custom,l=gc(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(a[r.axis]);return{label:""+n.getLabelForValue(a[n.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const s=this._cachedMeta;this.updateElements(s.data,0,s.data.length,t)}updateElements(t,s,n,r){const a=r==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),u=l.isHorizontal(),d=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(s,r);for(let m=s;m<s+n;m++){const v=this.getParsed(m),x=a||De(v[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(m),y=this._calculateBarIndexPixels(m,d),g=(v._stacks||{})[l.axis],p={horizontal:u,base:x.base,enableBorderRadius:!g||gc(v._custom)||o===g._top||o===g._bottom,x:u?x.head:y.center,y:u?y.center:x.head,height:u?y.size:Math.abs(x.size),width:u?Math.abs(x.size):y.size};f&&(p.options=h||this.resolveDataElementOptions(m,t[m].active?"active":r));const w=p.options||t[m].options;Zj(p,w,g,o),t_(p,w,d.ratio),this.updateElement(t[m],m,p,r)}}_getStacks(t,s){const{iScale:n}=this._cachedMeta,r=n.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),a=n.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(s),c=l&&l[n.axis],u=d=>{const h=d._parsed.find(m=>m[n.axis]===c),f=h&&h[d.vScale.axis];if(De(f)||isNaN(f))return!0};for(const d of r)if(!(s!==void 0&&u(d))&&((a===!1||o.indexOf(d.stack)===-1||a===void 0&&d.stack===void 0)&&o.push(d.stack),d.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,s=this.chart.options.indexAxis;return Object.keys(t).filter(n=>t[n].axis===s).shift()}_getAxis(){const t={},s=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)t[Te(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,s)]=!0;return Object.keys(t)}_getStackIndex(t,s,n){const r=this._getStacks(t,n),a=s!==void 0?r.indexOf(s):-1;return a===-1?r.length-1:a}_getRuler(){const t=this.options,s=this._cachedMeta,n=s.iScale,r=[];let a,o;for(a=0,o=s.data.length;a<o;++a)r.push(n.getPixelForValue(this.getParsed(a)[n.axis],a));const l=t.barThickness;return{min:l||qj(s),pixels:r,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:t.grouped,ratio:l?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:s,_stacked:n,index:r},options:{base:a,minBarLength:o}}=this,l=a||0,c=this.getParsed(t),u=c._custom,d=gc(u);let h=c[s.axis],f=0,m=n?this.applyStack(s,c,n):h,v,x;m!==h&&(f=m-h,m=h),d&&(h=u.barStart,m=u.barEnd-u.barStart,h!==0&&xn(h)!==xn(u.barEnd)&&(f=0),f+=h);const y=!De(a)&&!d?a:f;let g=s.getPixelForValue(y);if(this.chart.getDataVisibility(t)?v=s.getPixelForValue(f+m):v=g,x=v-g,Math.abs(x)<o){x=Qj(x,s,l)*o,h===l&&(g-=x/2);const p=s.getPixelForDecimal(0),w=s.getPixelForDecimal(1),b=Math.min(p,w),k=Math.max(p,w);g=Math.max(Math.min(g,k),b),v=g+x,n&&!d&&(c._stacks[s.axis]._visualValues[r]=s.getValueForPixel(v)-s.getValueForPixel(g))}if(g===s.getPixelForValue(l)){const p=xn(x)*s.getLineWidthForValue(l)/2;g+=p,x-=p}return{size:x,base:g,head:v,center:v+x/2}}_calculateBarIndexPixels(t,s){const n=s.scale,r=this.options,a=r.skipNull,o=Te(r.maxBarThickness,1/0);let l,c;const u=this._getAxisCount();if(s.grouped){const d=a?this._getStackCount(t):s.stackCount,h=r.barThickness==="flex"?Gj(t,s,r,d*u):Yj(t,s,r,d*u),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,m=this._getAxis().indexOf(Te(f,this.getFirstScaleIdForIndexAxis())),v=this._getStackIndex(this.index,this._cachedMeta.stack,a?t:void 0)+m;l=h.start+h.chunk*v+h.chunk/2,c=Math.min(o,h.chunk*h.ratio)}else l=n.getPixelForValue(this.getParsed(t)[n.axis],t),c=Math.min(o,s.min*s.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const t=this._cachedMeta,s=t.vScale,n=t.data,r=n.length;let a=0;for(;a<r;++a)this.getParsed(a)[s.axis]!==null&&!n[a].hidden&&n[a].draw(this._ctx)}}ke(xo,"id","bar"),ke(xo,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),ke(xo,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function Ln(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Yd{constructor(t){ke(this,"options");this.options=t||{}}static override(t){Object.assign(Yd.prototype,t)}init(){}formats(){return Ln()}parse(){return Ln()}format(){return Ln()}add(){return Ln()}diff(){return Ln()}startOf(){return Ln()}endOf(){return Ln()}}var s_={_date:Yd};function n_(e,t,s,n){const{controller:r,data:a,_sorted:o}=e,l=r._cachedMeta.iScale,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(l&&t===l.axis&&t!=="r"&&o&&a.length){const u=l._reversePixels?Uw:Su;if(n){if(r._sharedOptions){const d=a[0],h=typeof d.getRange=="function"&&d.getRange(t);if(h){const f=u(a,t,s-h),m=u(a,t,s+h);return{lo:f.lo,hi:m.hi}}}}else{const d=u(a,t,s);if(c){const{vScale:h}=r._cachedMeta,{_parsed:f}=e,m=f.slice(0,d.lo+1).reverse().findIndex(x=>!De(x[h.axis]));d.lo-=Math.max(0,m);const v=f.slice(d.hi).findIndex(x=>!De(x[h.axis]));d.hi+=Math.max(0,v)}return d}}return{lo:0,hi:a.length-1}}function Al(e,t,s,n,r){const a=e.getSortedVisibleDatasetMetas(),o=s[t];for(let l=0,c=a.length;l<c;++l){const{index:u,data:d}=a[l],{lo:h,hi:f}=n_(a[l],t,o,r);for(let m=h;m<=f;++m){const v=d[m];v.skip||n(v,u,m)}}}function r_(e){const t=e.indexOf("x")!==-1,s=e.indexOf("y")!==-1;return function(n,r){const a=t?Math.abs(n.x-r.x):0,o=s?Math.abs(n.y-r.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(o,2))}}function pc(e,t,s,n,r){const a=[];return!r&&!e.isPointInArea(t)||Al(e,s,t,function(l,c,u){!r&&!qx(l,e.chartArea,0)||l.inRange(t.x,t.y,n)&&a.push({element:l,datasetIndex:c,index:u})},!0),a}function i_(e,t,s,n){let r=[];function a(o,l,c){const{startAngle:u,endAngle:d}=o.getProps(["startAngle","endAngle"],n),{angle:h}=Iw(o,{x:t.x,y:t.y});Bw(h,u,d)&&r.push({element:o,datasetIndex:l,index:c})}return Al(e,s,t,a),r}function a_(e,t,s,n,r,a){let o=[];const l=r_(s);let c=Number.POSITIVE_INFINITY;function u(d,h,f){const m=d.inRange(t.x,t.y,r);if(n&&!m)return;const v=d.getCenterPoint(r);if(!(!!a||e.isPointInArea(v))&&!m)return;const y=l(t,v);y<c?(o=[{element:d,datasetIndex:h,index:f}],c=y):y===c&&o.push({element:d,datasetIndex:h,index:f})}return Al(e,s,t,u),o}function xc(e,t,s,n,r,a){return!a&&!e.isPointInArea(t)?[]:s==="r"&&!n?i_(e,t,s,r):a_(e,t,s,n,r,a)}function em(e,t,s,n,r){const a=[],o=s==="x"?"inXRange":"inYRange";let l=!1;return Al(e,s,t,(c,u,d)=>{c[o]&&c[o](t[s],r)&&(a.push({element:c,datasetIndex:u,index:d}),l=l||c.inRange(t.x,t.y,r))}),n&&!l?[]:a}var o_={modes:{index(e,t,s,n){const r=Pn(t,e),a=s.axis||"x",o=s.includeInvisible||!1,l=s.intersect?pc(e,r,a,n,o):xc(e,r,a,!1,n,o),c=[];return l.length?(e.getSortedVisibleDatasetMetas().forEach(u=>{const d=l[0].index,h=u.data[d];h&&!h.skip&&c.push({element:h,datasetIndex:u.index,index:d})}),c):[]},dataset(e,t,s,n){const r=Pn(t,e),a=s.axis||"xy",o=s.includeInvisible||!1;let l=s.intersect?pc(e,r,a,n,o):xc(e,r,a,!1,n,o);if(l.length>0){const c=l[0].datasetIndex,u=e.getDatasetMeta(c).data;l=[];for(let d=0;d<u.length;++d)l.push({element:u[d],datasetIndex:c,index:d})}return l},point(e,t,s,n){const r=Pn(t,e),a=s.axis||"xy",o=s.includeInvisible||!1;return pc(e,r,a,n,o)},nearest(e,t,s,n){const r=Pn(t,e),a=s.axis||"xy",o=s.includeInvisible||!1;return xc(e,r,a,s.intersect,n,o)},x(e,t,s,n){const r=Pn(t,e);return em(e,r,"x",s.intersect,n)},y(e,t,s,n){const r=Pn(t,e);return em(e,r,"y",s.intersect,n)}}};const i0=["left","top","right","bottom"];function ni(e,t){return e.filter(s=>s.pos===t)}function tm(e,t){return e.filter(s=>i0.indexOf(s.pos)===-1&&s.box.axis===t)}function ri(e,t){return e.sort((s,n)=>{const r=t?n:s,a=t?s:n;return r.weight===a.weight?r.index-a.index:r.weight-a.weight})}function l_(e){const t=[];let s,n,r,a,o,l;for(s=0,n=(e||[]).length;s<n;++s)r=e[s],{position:a,options:{stack:o,stackWeight:l=1}}=r,t.push({index:s,box:r,pos:a,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&a+o,stackWeight:l});return t}function c_(e){const t={};for(const s of e){const{stack:n,pos:r,stackWeight:a}=s;if(!n||!i0.includes(r))continue;const o=t[n]||(t[n]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=a}return t}function u_(e,t){const s=c_(e),{vBoxMaxWidth:n,hBoxMaxHeight:r}=t;let a,o,l;for(a=0,o=e.length;a<o;++a){l=e[a];const{fullSize:c}=l.box,u=s[l.stack],d=u&&l.stackWeight/u.weight;l.horizontal?(l.width=d?d*n:c&&t.availableWidth,l.height=r):(l.width=n,l.height=d?d*r:c&&t.availableHeight)}return s}function d_(e){const t=l_(e),s=ri(t.filter(u=>u.box.fullSize),!0),n=ri(ni(t,"left"),!0),r=ri(ni(t,"right")),a=ri(ni(t,"top"),!0),o=ri(ni(t,"bottom")),l=tm(t,"x"),c=tm(t,"y");return{fullSize:s,leftAndTop:n.concat(a),rightAndBottom:r.concat(c).concat(o).concat(l),chartArea:ni(t,"chartArea"),vertical:n.concat(r).concat(c),horizontal:a.concat(o).concat(l)}}function sm(e,t,s,n){return Math.max(e[s],t[s])+Math.max(e[n],t[n])}function a0(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function h_(e,t,s,n){const{pos:r,box:a}=s,o=e.maxPadding;if(!Ee(r)){s.size&&(e[r]-=s.size);const h=n[s.stack]||{size:0,count:1};h.size=Math.max(h.size,s.horizontal?a.height:a.width),s.size=h.size/h.count,e[r]+=s.size}a.getPadding&&a0(o,a.getPadding());const l=Math.max(0,t.outerWidth-sm(o,e,"left","right")),c=Math.max(0,t.outerHeight-sm(o,e,"top","bottom")),u=l!==e.w,d=c!==e.h;return e.w=l,e.h=c,s.horizontal?{same:u,other:d}:{same:d,other:u}}function f_(e){const t=e.maxPadding;function s(n){const r=Math.max(t[n]-e[n],0);return e[n]+=r,r}e.y+=s("top"),e.x+=s("left"),s("right"),s("bottom")}function m_(e,t){const s=t.maxPadding;function n(r){const a={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{a[o]=Math.max(t[o],s[o])}),a}return n(e?["left","right"]:["top","bottom"])}function mi(e,t,s,n){const r=[];let a,o,l,c,u,d;for(a=0,o=e.length,u=0;a<o;++a){l=e[a],c=l.box,c.update(l.width||t.w,l.height||t.h,m_(l.horizontal,t));const{same:h,other:f}=h_(t,s,l,n);u|=h&&r.length,d=d||f,c.fullSize||r.push(l)}return u&&mi(r,t,s,n)||d}function Fa(e,t,s,n,r){e.top=s,e.left=t,e.right=t+n,e.bottom=s+r,e.width=n,e.height=r}function nm(e,t,s,n){const r=s.padding;let{x:a,y:o}=t;for(const l of e){const c=l.box,u=n[l.stack]||{placed:0,weight:1},d=l.stackWeight/u.weight||1;if(l.horizontal){const h=t.w*d,f=u.size||c.height;Qi(u.start)&&(o=u.start),c.fullSize?Fa(c,r.left,o,s.outerWidth-r.right-r.left,f):Fa(c,t.left+u.placed,o,h,f),u.start=o,u.placed+=h,o=c.bottom}else{const h=t.h*d,f=u.size||c.width;Qi(u.start)&&(a=u.start),c.fullSize?Fa(c,a,r.top,f,s.outerHeight-r.bottom-r.top):Fa(c,a,t.top+u.placed,f,h),u.start=a,u.placed+=h,a=c.right}}t.x=a,t.y=o}var Xt={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(s){t.draw(s)}}]},e.boxes.push(t)},removeBox(e,t){const s=e.boxes?e.boxes.indexOf(t):-1;s!==-1&&e.boxes.splice(s,1)},configure(e,t,s){t.fullSize=s.fullSize,t.position=s.position,t.weight=s.weight},update(e,t,s,n){if(!e)return;const r=Jt(e.options.layout.padding),a=Math.max(t-r.width,0),o=Math.max(s-r.height,0),l=d_(e.boxes),c=l.vertical,u=l.horizontal;Le(e.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const d=c.reduce((x,y)=>y.box.options&&y.box.options.display===!1?x:x+1,0)||1,h=Object.freeze({outerWidth:t,outerHeight:s,padding:r,availableWidth:a,availableHeight:o,vBoxMaxWidth:a/2/d,hBoxMaxHeight:o/2}),f=Object.assign({},r);a0(f,Jt(n));const m=Object.assign({maxPadding:f,w:a,h:o,x:r.left,y:r.top},r),v=u_(c.concat(u),h);mi(l.fullSize,m,h,v),mi(c,m,h,v),mi(u,m,h,v)&&mi(c,m,h,v),f_(m),nm(l.leftAndTop,m,h,v),m.x+=m.w,m.y+=m.h,nm(l.rightAndBottom,m,h,v),e.chartArea={left:m.left,top:m.top,right:m.left+m.w,bottom:m.top+m.h,height:m.h,width:m.w},Le(l.chartArea,x=>{const y=x.box;Object.assign(y,e.chartArea),y.update(m.w,m.h,{left:0,top:0,right:0,bottom:0})})}};class o0{acquireContext(t,s){}releaseContext(t){return!1}addEventListener(t,s,n){}removeEventListener(t,s,n){}getDevicePixelRatio(){return 1}getMaximumSize(t,s,n,r){return s=Math.max(0,s||t.width),n=n||t.height,{width:s,height:Math.max(0,r?Math.floor(s/r):n)}}isAttached(t){return!0}updateConfig(t){}}class g_ extends o0{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const yo="$chartjs",p_={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},rm=e=>e===null||e==="";function x_(e,t){const s=e.style,n=e.getAttribute("height"),r=e.getAttribute("width");if(e[yo]={initial:{height:n,width:r,style:{display:s.display,height:s.height,width:s.width}}},s.display=s.display||"block",s.boxSizing=s.boxSizing||"border-box",rm(r)){const a=Vf(e,"width");a!==void 0&&(e.width=a)}if(rm(n))if(e.style.height==="")e.height=e.width/(t||2);else{const a=Vf(e,"height");a!==void 0&&(e.height=a)}return e}const l0=Cj?{passive:!0}:!1;function y_(e,t,s){e&&e.addEventListener(t,s,l0)}function v_(e,t,s){e&&e.canvas&&e.canvas.removeEventListener(t,s,l0)}function b_(e,t){const s=p_[e.type]||e.type,{x:n,y:r}=Pn(e,t);return{type:s,chart:t,native:e,x:n!==void 0?n:null,y:r!==void 0?r:null}}function tl(e,t){for(const s of e)if(s===t||s.contains(t))return!0}function w_(e,t,s){const n=e.canvas,r=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||tl(l.addedNodes,n),o=o&&!tl(l.removedNodes,n);o&&s()});return r.observe(document,{childList:!0,subtree:!0}),r}function j_(e,t,s){const n=e.canvas,r=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||tl(l.removedNodes,n),o=o&&!tl(l.addedNodes,n);o&&s()});return r.observe(document,{childList:!0,subtree:!0}),r}const Zi=new Map;let im=0;function c0(){const e=window.devicePixelRatio;e!==im&&(im=e,Zi.forEach((t,s)=>{s.currentDevicePixelRatio!==e&&t()}))}function __(e,t){Zi.size||window.addEventListener("resize",c0),Zi.set(e,t)}function N_(e){Zi.delete(e),Zi.size||window.removeEventListener("resize",c0)}function k_(e,t,s){const n=e.canvas,r=n&&qd(n);if(!r)return;const a=Hx((l,c)=>{const u=r.clientWidth;s(l,c),u<r.clientWidth&&s()},window),o=new ResizeObserver(l=>{const c=l[0],u=c.contentRect.width,d=c.contentRect.height;u===0&&d===0||a(u,d)});return o.observe(r),__(e,a),o}function yc(e,t,s){s&&s.disconnect(),t==="resize"&&N_(e)}function S_(e,t,s){const n=e.canvas,r=Hx(a=>{e.ctx!==null&&s(b_(a,e))},e);return y_(n,t,r),r}class C_ extends o0{acquireContext(t,s){const n=t&&t.getContext&&t.getContext("2d");return n&&n.canvas===t?(x_(t,s),n):null}releaseContext(t){const s=t.canvas;if(!s[yo])return!1;const n=s[yo].initial;["height","width"].forEach(a=>{const o=n[a];De(o)?s.removeAttribute(a):s.setAttribute(a,o)});const r=n.style||{};return Object.keys(r).forEach(a=>{s.style[a]=r[a]}),s.width=s.width,delete s[yo],!0}addEventListener(t,s,n){this.removeEventListener(t,s);const r=t.$proxies||(t.$proxies={}),o={attach:w_,detach:j_,resize:k_}[s]||S_;r[s]=o(t,s,n)}removeEventListener(t,s){const n=t.$proxies||(t.$proxies={}),r=n[s];if(!r)return;({attach:yc,detach:yc,resize:yc}[s]||v_)(t,s,r),n[s]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,s,n,r){return Sj(t,s,n,r)}isAttached(t){const s=t&&qd(t);return!!(s&&s.isConnected)}}function E_(e){return!Xd()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?g_:C_}class wn{constructor(){ke(this,"x");ke(this,"y");ke(this,"active",!1);ke(this,"options");ke(this,"$animations")}tooltipPosition(t){const{x:s,y:n}=this.getProps(["x","y"],t);return{x:s,y:n}}hasValue(){return Jo(this.x)&&Jo(this.y)}getProps(t,s){const n=this.$animations;if(!s||!n)return this;const r={};return t.forEach(a=>{r[a]=n[a]&&n[a].active()?n[a]._to:this[a]}),r}}ke(wn,"defaults",{}),ke(wn,"defaultRoutes");function T_(e,t){const s=e.options.ticks,n=L_(e),r=Math.min(s.maxTicksLimit||n,n),a=s.major.enabled?M_(t):[],o=a.length,l=a[0],c=a[o-1],u=[];if(o>r)return P_(t,u,a,o/r),u;const d=A_(a,t,r);if(o>0){let h,f;const m=o>1?Math.round((c-l)/(o-1)):null;for(za(t,u,d,De(m)?0:l-m,l),h=0,f=o-1;h<f;h++)za(t,u,d,a[h],a[h+1]);return za(t,u,d,c,De(m)?t.length:c+m),u}return za(t,u,d),u}function L_(e){const t=e.options.offset,s=e._tickSize(),n=e._length/s+(t?0:1),r=e._maxLength/s;return Math.floor(Math.min(n,r))}function A_(e,t,s){const n=R_(e),r=t.length/s;if(!n)return Math.max(r,1);const a=Rw(n);for(let o=0,l=a.length-1;o<l;o++){const c=a[o];if(c>r)return c}return Math.max(r,1)}function M_(e){const t=[];let s,n;for(s=0,n=e.length;s<n;s++)e[s].major&&t.push(s);return t}function P_(e,t,s,n){let r=0,a=s[0],o;for(n=Math.ceil(n),o=0;o<e.length;o++)o===a&&(t.push(e[o]),r++,a=s[r*n])}function za(e,t,s,n,r){const a=Te(n,0),o=Math.min(Te(r,e.length),e.length);let l=0,c,u,d;for(s=Math.ceil(s),r&&(c=r-n,s=c/Math.floor(c/s)),d=a;d<0;)l++,d=Math.round(a+l*s);for(u=Math.max(a,0);u<o;u++)u===d&&(t.push(e[u]),l++,d=Math.round(a+l*s))}function R_(e){const t=e.length;let s,n;if(t<2)return!1;for(n=e[0],s=1;s<t;++s)if(e[s]-e[s-1]!==n)return!1;return n}const D_=e=>e==="left"?"right":e==="right"?"left":e,am=(e,t,s)=>t==="top"||t==="left"?e[t]+s:e[t]-s,om=(e,t)=>Math.min(t||e,e);function lm(e,t){const s=[],n=e.length/t,r=e.length;let a=0;for(;a<r;a+=n)s.push(e[Math.floor(a)]);return s}function O_(e,t,s){const n=e.ticks.length,r=Math.min(t,n-1),a=e._startPixel,o=e._endPixel,l=1e-6;let c=e.getPixelForTick(r),u;if(!(s&&(n===1?u=Math.max(c-a,o-c):t===0?u=(e.getPixelForTick(1)-c)/2:u=(c-e.getPixelForTick(r-1))/2,c+=r<t?u:-u,c<a-l||c>o+l)))return c}function F_(e,t){Le(e,s=>{const n=s.gc,r=n.length/2;let a;if(r>t){for(a=0;a<r;++a)delete s.data[n[a]];n.splice(0,r)}})}function ii(e){return e.drawTicks?e.tickLength:0}function cm(e,t){if(!e.display)return 0;const s=xt(e.font,t),n=Jt(e.padding);return(rt(e.text)?e.text.length:1)*s.lineHeight+n.height}function z_(e,t){return Ur(e,{scale:t,type:"scale"})}function I_(e,t,s){return Ur(e,{tick:s,index:t,type:"tick"})}function $_(e,t,s){let n=$d(e);return(s&&t!=="right"||!s&&t==="right")&&(n=D_(n)),n}function B_(e,t,s,n){const{top:r,left:a,bottom:o,right:l,chart:c}=e,{chartArea:u,scales:d}=c;let h=0,f,m,v;const x=o-r,y=l-a;if(e.isHorizontal()){if(m=gt(n,a,l),Ee(s)){const g=Object.keys(s)[0],p=s[g];v=d[g].getPixelForValue(p)+x-t}else s==="center"?v=(u.bottom+u.top)/2+x-t:v=am(e,s,t);f=l-a}else{if(Ee(s)){const g=Object.keys(s)[0],p=s[g];m=d[g].getPixelForValue(p)-y+t}else s==="center"?m=(u.left+u.right)/2-y+t:m=am(e,s,t);v=gt(n,o,r),h=s==="left"?-is:is}return{titleX:m,titleY:v,maxWidth:f,rotation:h}}class Vr extends wn{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,s){return t}getUserBounds(){let{_userMin:t,_userMax:s,_suggestedMin:n,_suggestedMax:r}=this;return t=ms(t,Number.POSITIVE_INFINITY),s=ms(s,Number.NEGATIVE_INFINITY),n=ms(n,Number.POSITIVE_INFINITY),r=ms(r,Number.NEGATIVE_INFINITY),{min:ms(t,n),max:ms(s,r),minDefined:Qt(t),maxDefined:Qt(s)}}getMinMax(t){let{min:s,max:n,minDefined:r,maxDefined:a}=this.getUserBounds(),o;if(r&&a)return{min:s,max:n};const l=this.getMatchingVisibleMetas();for(let c=0,u=l.length;c<u;++c)o=l[c].controller.getMinMax(this,t),r||(s=Math.min(s,o.min)),a||(n=Math.max(n,o.max));return s=a&&s>n?n:s,n=r&&s>n?s:n,{min:ms(s,ms(n,s)),max:ms(n,ms(s,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Be(this.options.beforeUpdate,[this])}update(t,s,n){const{beginAtZero:r,grace:a,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=s,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=dj(this,a,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?lm(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=T_(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,s,n;this.isHorizontal()?(s=this.left,n=this.right):(s=this.top,n=this.bottom,t=!t),this._startPixel=s,this._endPixel=n,this._reversePixels=t,this._length=n-s,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Be(this.options.afterUpdate,[this])}beforeSetDimensions(){Be(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Be(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Be(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Be(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const s=this.options.ticks;let n,r,a;for(n=0,r=t.length;n<r;n++)a=t[n],a.label=Be(s.callback,[a.value,n,t],this)}afterTickToLabelConversion(){Be(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Be(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,s=t.ticks,n=om(this.ticks.length,t.ticks.maxTicksLimit),r=s.minRotation||0,a=s.maxRotation;let o=r,l,c,u;if(!this._isVisible()||!s.display||r>=a||n<=1||!this.isHorizontal()){this.labelRotation=r;return}const d=this._getLabelSizes(),h=d.widest.width,f=d.highest.height,m=as(this.chart.width-h,0,this.maxWidth);l=t.offset?this.maxWidth/n:m/(n-1),h+6>l&&(l=m/(n-(t.offset?.5:1)),c=this.maxHeight-ii(t.grid)-s.padding-cm(t.title,this.chart.options.font),u=Math.sqrt(h*h+f*f),o=zw(Math.min(Math.asin(as((d.highest.height+6)/l,-1,1)),Math.asin(as(c/u,-1,1))-Math.asin(as(f/u,-1,1)))),o=Math.max(r,Math.min(a,o))),this.labelRotation=o}afterCalculateLabelRotation(){Be(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Be(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:s,options:{ticks:n,title:r,grid:a}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=cm(r,s.options.font);if(l?(t.width=this.maxWidth,t.height=ii(a)+c):(t.height=this.maxHeight,t.width=ii(a)+c),n.display&&this.ticks.length){const{first:u,last:d,widest:h,highest:f}=this._getLabelSizes(),m=n.padding*2,v=Fn(this.labelRotation),x=Math.cos(v),y=Math.sin(v);if(l){const g=n.mirror?0:y*h.width+x*f.height;t.height=Math.min(this.maxHeight,t.height+g+m)}else{const g=n.mirror?0:x*h.width+y*f.height;t.width=Math.min(this.maxWidth,t.width+g+m)}this._calculatePadding(u,d,y,x)}}this._handleMargins(),l?(this.width=this._length=s.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=s.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,s,n,r){const{ticks:{align:a,padding:o},position:l}=this.options,c=this.labelRotation!==0,u=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const d=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,m=0;c?u?(f=r*t.width,m=n*s.height):(f=n*t.height,m=r*s.width):a==="start"?m=s.width:a==="end"?f=t.width:a!=="inner"&&(f=t.width/2,m=s.width/2),this.paddingLeft=Math.max((f-d+o)*this.width/(this.width-d),0),this.paddingRight=Math.max((m-h+o)*this.width/(this.width-h),0)}else{let d=s.height/2,h=t.height/2;a==="start"?(d=0,h=t.height):a==="end"&&(d=s.height,h=0),this.paddingTop=d+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Be(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:s}=this.options;return s==="top"||s==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let s,n;for(s=0,n=t.length;s<n;s++)De(t[s].label)&&(t.splice(s,1),n--,s--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const s=this.options.ticks.sampleSize;let n=this.ticks;s<n.length&&(n=lm(n,s)),this._labelSizes=t=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,s,n){const{ctx:r,_longestTextCache:a}=this,o=[],l=[],c=Math.floor(s/om(s,n));let u=0,d=0,h,f,m,v,x,y,g,p,w,b,k;for(h=0;h<s;h+=c){if(v=t[h].label,x=this._resolveTickFontOptions(h),r.font=y=x.string,g=a[y]=a[y]||{data:{},gc:[]},p=x.lineHeight,w=b=0,!De(v)&&!rt(v))w=zf(r,g.data,g.gc,w,v),b=p;else if(rt(v))for(f=0,m=v.length;f<m;++f)k=v[f],!De(k)&&!rt(k)&&(w=zf(r,g.data,g.gc,w,k),b+=p);o.push(w),l.push(b),u=Math.max(w,u),d=Math.max(b,d)}F_(a,s);const E=o.indexOf(u),_=l.indexOf(d),N=U=>({width:o[U]||0,height:l[U]||0});return{first:N(0),last:N(s-1),widest:N(E),highest:N(_),widths:o,heights:l}}getLabelForValue(t){return t}getPixelForValue(t,s){return NaN}getValueForPixel(t){}getPixelForTick(t){const s=this.ticks;return t<0||t>s.length-1?null:this.getPixelForValue(s[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const s=this._startPixel+t*this._length;return Hw(this._alignToPixels?Tn(this.chart,s,0):s)}getDecimalForPixel(t){const s=(t-this._startPixel)/this._length;return this._reversePixels?1-s:s}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:s}=this;return t<0&&s<0?s:t>0&&s>0?t:0}getContext(t){const s=this.ticks||[];if(t>=0&&t<s.length){const n=s[t];return n.$context||(n.$context=I_(this.getContext(),t,n))}return this.$context||(this.$context=z_(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,s=Fn(this.labelRotation),n=Math.abs(Math.cos(s)),r=Math.abs(Math.sin(s)),a=this._getLabelSizes(),o=t.autoSkipPadding||0,l=a?a.widest.width+o:0,c=a?a.highest.height+o:0;return this.isHorizontal()?c*n>l*r?l/n:c/r:c*r<l*n?c/n:l/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const s=this.axis,n=this.chart,r=this.options,{grid:a,position:o,border:l}=r,c=a.offset,u=this.isHorizontal(),h=this.ticks.length+(c?1:0),f=ii(a),m=[],v=l.setContext(this.getContext()),x=v.display?v.width:0,y=x/2,g=function(S){return Tn(n,S,x)};let p,w,b,k,E,_,N,U,B,q,z,G;if(o==="top")p=g(this.bottom),_=this.bottom-f,U=p-y,q=g(t.top)+y,G=t.bottom;else if(o==="bottom")p=g(this.top),q=t.top,G=g(t.bottom)-y,_=p+y,U=this.top+f;else if(o==="left")p=g(this.right),E=this.right-f,N=p-y,B=g(t.left)+y,z=t.right;else if(o==="right")p=g(this.left),B=t.left,z=g(t.right)-y,E=p+y,N=this.left+f;else if(s==="x"){if(o==="center")p=g((t.top+t.bottom)/2+.5);else if(Ee(o)){const S=Object.keys(o)[0],V=o[S];p=g(this.chart.scales[S].getPixelForValue(V))}q=t.top,G=t.bottom,_=p+y,U=_+f}else if(s==="y"){if(o==="center")p=g((t.left+t.right)/2);else if(Ee(o)){const S=Object.keys(o)[0],V=o[S];p=g(this.chart.scales[S].getPixelForValue(V))}E=p-y,N=E-f,B=t.left,z=t.right}const C=Te(r.ticks.maxTicksLimit,h),W=Math.max(1,Math.ceil(h/C));for(w=0;w<h;w+=W){const S=this.getContext(w),V=a.setContext(S),P=l.setContext(S),O=V.lineWidth,A=V.color,L=P.dash||[],M=P.dashOffset,I=V.tickWidth,$=V.tickColor,Q=V.tickBorderDash||[],X=V.tickBorderDashOffset;b=O_(this,w,c),b!==void 0&&(k=Tn(n,b,O),u?E=N=B=z=k:_=U=q=G=k,m.push({tx1:E,ty1:_,tx2:N,ty2:U,x1:B,y1:q,x2:z,y2:G,width:O,color:A,borderDash:L,borderDashOffset:M,tickWidth:I,tickColor:$,tickBorderDash:Q,tickBorderDashOffset:X}))}return this._ticksLength=h,this._borderValue=p,m}_computeLabelItems(t){const s=this.axis,n=this.options,{position:r,ticks:a}=n,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:u,padding:d,mirror:h}=a,f=ii(n.grid),m=f+d,v=h?-d:m,x=-Fn(this.labelRotation),y=[];let g,p,w,b,k,E,_,N,U,B,q,z,G="middle";if(r==="top")E=this.bottom-v,_=this._getXAxisLabelAlignment();else if(r==="bottom")E=this.top+v,_=this._getXAxisLabelAlignment();else if(r==="left"){const W=this._getYAxisLabelAlignment(f);_=W.textAlign,k=W.x}else if(r==="right"){const W=this._getYAxisLabelAlignment(f);_=W.textAlign,k=W.x}else if(s==="x"){if(r==="center")E=(t.top+t.bottom)/2+m;else if(Ee(r)){const W=Object.keys(r)[0],S=r[W];E=this.chart.scales[W].getPixelForValue(S)+m}_=this._getXAxisLabelAlignment()}else if(s==="y"){if(r==="center")k=(t.left+t.right)/2-m;else if(Ee(r)){const W=Object.keys(r)[0],S=r[W];k=this.chart.scales[W].getPixelForValue(S)}_=this._getYAxisLabelAlignment(f).textAlign}s==="y"&&(c==="start"?G="top":c==="end"&&(G="bottom"));const C=this._getLabelSizes();for(g=0,p=l.length;g<p;++g){w=l[g],b=w.label;const W=a.setContext(this.getContext(g));N=this.getPixelForTick(g)+a.labelOffset,U=this._resolveTickFontOptions(g),B=U.lineHeight,q=rt(b)?b.length:1;const S=q/2,V=W.color,P=W.textStrokeColor,O=W.textStrokeWidth;let A=_;o?(k=N,_==="inner"&&(g===p-1?A=this.options.reverse?"left":"right":g===0?A=this.options.reverse?"right":"left":A="center"),r==="top"?u==="near"||x!==0?z=-q*B+B/2:u==="center"?z=-C.highest.height/2-S*B+B:z=-C.highest.height+B/2:u==="near"||x!==0?z=B/2:u==="center"?z=C.highest.height/2-S*B:z=C.highest.height-q*B,h&&(z*=-1),x!==0&&!W.showLabelBackdrop&&(k+=B/2*Math.sin(x))):(E=N,z=(1-q)*B/2);let L;if(W.showLabelBackdrop){const M=Jt(W.backdropPadding),I=C.heights[g],$=C.widths[g];let Q=z-M.top,X=0-M.left;switch(G){case"middle":Q-=I/2;break;case"bottom":Q-=I;break}switch(_){case"center":X-=$/2;break;case"right":X-=$;break;case"inner":g===p-1?X-=$:g>0&&(X-=$/2);break}L={left:X,top:Q,width:$+M.width,height:I+M.height,color:W.backdropColor}}y.push({label:b,font:U,textOffset:z,options:{rotation:x,color:V,strokeColor:P,strokeWidth:O,textAlign:A,textBaseline:G,translation:[k,E],backdrop:L}})}return y}_getXAxisLabelAlignment(){const{position:t,ticks:s}=this.options;if(-Fn(this.labelRotation))return t==="top"?"left":"right";let r="center";return s.align==="start"?r="left":s.align==="end"?r="right":s.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:s,ticks:{crossAlign:n,mirror:r,padding:a}}=this.options,o=this._getLabelSizes(),l=t+a,c=o.widest.width;let u,d;return s==="left"?r?(d=this.right+a,n==="near"?u="left":n==="center"?(u="center",d+=c/2):(u="right",d+=c)):(d=this.right-l,n==="near"?u="right":n==="center"?(u="center",d-=c/2):(u="left",d=this.left)):s==="right"?r?(d=this.left+a,n==="near"?u="right":n==="center"?(u="center",d-=c/2):(u="left",d-=c)):(d=this.left+l,n==="near"?u="left":n==="center"?(u="center",d+=c/2):(u="right",d=this.right)):u="right",{textAlign:u,x:d}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,s=this.options.position;if(s==="left"||s==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(s==="top"||s==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:s},left:n,top:r,width:a,height:o}=this;s&&(t.save(),t.fillStyle=s,t.fillRect(n,r,a,o),t.restore())}getLineWidthForValue(t){const s=this.options.grid;if(!this._isVisible()||!s.display)return 0;const r=this.ticks.findIndex(a=>a.value===t);return r>=0?s.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const s=this.options.grid,n=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let a,o;const l=(c,u,d)=>{!d.width||!d.color||(n.save(),n.lineWidth=d.width,n.strokeStyle=d.color,n.setLineDash(d.borderDash||[]),n.lineDashOffset=d.borderDashOffset,n.beginPath(),n.moveTo(c.x,c.y),n.lineTo(u.x,u.y),n.stroke(),n.restore())};if(s.display)for(a=0,o=r.length;a<o;++a){const c=r[a];s.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),s.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:s,options:{border:n,grid:r}}=this,a=n.setContext(this.getContext()),o=n.display?a.width:0;if(!o)return;const l=r.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let u,d,h,f;this.isHorizontal()?(u=Tn(t,this.left,o)-o/2,d=Tn(t,this.right,l)+l/2,h=f=c):(h=Tn(t,this.top,o)-o/2,f=Tn(t,this.bottom,l)+l/2,u=d=c),s.save(),s.lineWidth=a.width,s.strokeStyle=a.color,s.beginPath(),s.moveTo(u,h),s.lineTo(d,f),s.stroke(),s.restore()}drawLabels(t){if(!this.options.ticks.display)return;const n=this.ctx,r=this._computeLabelArea();r&&Bd(n,r);const a=this.getLabelItems(t);for(const o of a){const l=o.options,c=o.font,u=o.label,d=o.textOffset;Ji(n,u,0,d,c,l)}r&&Hd(n)}drawTitle(){const{ctx:t,options:{position:s,title:n,reverse:r}}=this;if(!n.display)return;const a=xt(n.font),o=Jt(n.padding),l=n.align;let c=a.lineHeight/2;s==="bottom"||s==="center"||Ee(s)?(c+=o.bottom,rt(n.text)&&(c+=a.lineHeight*(n.text.length-1))):c+=o.top;const{titleX:u,titleY:d,maxWidth:h,rotation:f}=B_(this,c,s,l);Ji(t,n.text,0,0,a,{color:n.color,maxWidth:h,rotation:f,textAlign:$_(l,s,r),textBaseline:"middle",translation:[u,d]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,s=t.ticks&&t.ticks.z||0,n=Te(t.grid&&t.grid.z,-1),r=Te(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==Vr.prototype.draw?[{z:s,draw:a=>{this.draw(a)}}]:[{z:n,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:s,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(t){const s=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",r=[];let a,o;for(a=0,o=s.length;a<o;++a){const l=s[a];l[n]===this.id&&(!t||l.type===t)&&r.push(l)}return r}_resolveTickFontOptions(t){const s=this.options.ticks.setContext(this.getContext(t));return xt(s.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Ia{constructor(t,s,n){this.type=t,this.scope=s,this.override=n,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const s=Object.getPrototypeOf(t);let n;V_(s)&&(n=this.register(s));const r=this.items,a=t.id,o=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+t);return a in r||(r[a]=t,H_(t,o,n),this.override&&Qe.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const s=this.items,n=t.id,r=this.scope;n in s&&delete s[n],r&&n in Qe[r]&&(delete Qe[r][n],this.override&&delete Gn[n])}}function H_(e,t,s){const n=Ki(Object.create(null),[s?Qe.get(s):{},Qe.get(t),e.defaults]);Qe.set(t,n),e.defaultRoutes&&U_(t,e.defaultRoutes),e.descriptors&&Qe.describe(t,e.descriptors)}function U_(e,t){Object.keys(t).forEach(s=>{const n=s.split("."),r=n.pop(),a=[e].concat(n).join("."),o=t[s].split("."),l=o.pop(),c=o.join(".");Qe.route(a,r,c,l)})}function V_(e){return"id"in e&&"defaults"in e}class W_{constructor(){this.controllers=new Ia(Li,"datasets",!0),this.elements=new Ia(wn,"elements"),this.plugins=new Ia(Object,"plugins"),this.scales=new Ia(Vr,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,s,n){[...s].forEach(r=>{const a=n||this._getRegistryForType(r);n||a.isForType(r)||a===this.plugins&&r.id?this._exec(t,a,r):Le(r,o=>{const l=n||this._getRegistryForType(o);this._exec(t,l,o)})})}_exec(t,s,n){const r=zd(t);Be(n["before"+r],[],n),s[t](n),Be(n["after"+r],[],n)}_getRegistryForType(t){for(let s=0;s<this._typedRegistries.length;s++){const n=this._typedRegistries[s];if(n.isForType(t))return n}return this.plugins}_get(t,s,n){const r=s.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+n+".");return r}}var xs=new W_;class X_{constructor(){this._init=void 0}notify(t,s,n,r){if(s==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const a=r?this._descriptors(t).filter(r):this._descriptors(t),o=this._notify(a,t,s,n);return s==="afterDestroy"&&(this._notify(a,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,s,n,r){r=r||{};for(const a of t){const o=a.plugin,l=o[n],c=[s,r,a.options];if(Be(l,c,o)===!1&&r.cancelable)return!1}return!0}invalidate(){De(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const s=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),s}_createDescriptors(t,s){const n=t&&t.config,r=Te(n.options&&n.options.plugins,{}),a=q_(n);return r===!1&&!s?[]:G_(t,a,r,s)}_notifyStateChanges(t){const s=this._oldCache||[],n=this._cache,r=(a,o)=>a.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(r(s,n),t,"stop"),this._notify(r(n,s),t,"start")}}function q_(e){const t={},s=[],n=Object.keys(xs.plugins.items);for(let a=0;a<n.length;a++)s.push(xs.getPlugin(n[a]));const r=e.plugins||[];for(let a=0;a<r.length;a++){const o=r[a];s.indexOf(o)===-1&&(s.push(o),t[o.id]=!0)}return{plugins:s,localIds:t}}function Y_(e,t){return!t&&e===!1?null:e===!0?{}:e}function G_(e,{plugins:t,localIds:s},n,r){const a=[],o=e.getContext();for(const l of t){const c=l.id,u=Y_(n[c],r);u!==null&&a.push({plugin:l,options:K_(e.config,{plugin:l,local:s[c]},u,o)})}return a}function K_(e,{plugin:t,local:s},n,r){const a=e.pluginScopeKeys(t),o=e.getOptionScopes(n,a);return s&&t.defaults&&o.push(t.defaults),e.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Eu(e,t){const s=Qe.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||s.indexAxis||"x"}function Q_(e,t){let s=e;return e==="_index_"?s=t:e==="_value_"&&(s=t==="x"?"y":"x"),s}function J_(e,t){return e===t?"_index_":"_value_"}function um(e){if(e==="x"||e==="y"||e==="r")return e}function Z_(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function Tu(e,...t){if(um(e))return e;for(const s of t){const n=s.axis||Z_(s.position)||e.length>1&&um(e[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${e}' axis. Please provide 'axis' or 'position' option.`)}function dm(e,t,s){if(s[t+"AxisID"]===e)return{axis:t}}function e1(e,t){if(t.data&&t.data.datasets){const s=t.data.datasets.filter(n=>n.xAxisID===e||n.yAxisID===e);if(s.length)return dm(e,"x",s[0])||dm(e,"y",s[0])}return{}}function t1(e,t){const s=Gn[e.type]||{scales:{}},n=t.scales||{},r=Eu(e.type,t),a=Object.create(null);return Object.keys(n).forEach(o=>{const l=n[o];if(!Ee(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=Tu(o,l,e1(o,e),Qe.scales[l.type]),u=J_(c,r),d=s.scales||{};a[o]=Ci(Object.create(null),[{axis:c},l,d[c],d[u]])}),e.data.datasets.forEach(o=>{const l=o.type||e.type,c=o.indexAxis||Eu(l,t),d=(Gn[l]||{}).scales||{};Object.keys(d).forEach(h=>{const f=Q_(h,c),m=o[f+"AxisID"]||f;a[m]=a[m]||Object.create(null),Ci(a[m],[{axis:f},n[m],d[h]])})}),Object.keys(a).forEach(o=>{const l=a[o];Ci(l,[Qe.scales[l.type],Qe.scale])}),a}function u0(e){const t=e.options||(e.options={});t.plugins=Te(t.plugins,{}),t.scales=t1(e,t)}function d0(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function s1(e){return e=e||{},e.data=d0(e.data),u0(e),e}const hm=new Map,h0=new Set;function $a(e,t){let s=hm.get(e);return s||(s=t(),hm.set(e,s),h0.add(s)),s}const ai=(e,t,s)=>{const n=Dr(t,s);n!==void 0&&e.add(n)};class n1{constructor(t){this._config=s1(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=d0(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),u0(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return $a(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,s){return $a(`${t}.transition.${s}`,()=>[[`datasets.${t}.transitions.${s}`,`transitions.${s}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,s){return $a(`${t}-${s}`,()=>[[`datasets.${t}.elements.${s}`,`datasets.${t}`,`elements.${s}`,""]])}pluginScopeKeys(t){const s=t.id,n=this.type;return $a(`${n}-plugin-${s}`,()=>[[`plugins.${s}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,s){const n=this._scopeCache;let r=n.get(t);return(!r||s)&&(r=new Map,n.set(t,r)),r}getOptionScopes(t,s,n){const{options:r,type:a}=this,o=this._cachedScopes(t,n),l=o.get(s);if(l)return l;const c=new Set;s.forEach(d=>{t&&(c.add(t),d.forEach(h=>ai(c,t,h))),d.forEach(h=>ai(c,r,h)),d.forEach(h=>ai(c,Gn[a]||{},h)),d.forEach(h=>ai(c,Qe,h)),d.forEach(h=>ai(c,Cu,h))});const u=Array.from(c);return u.length===0&&u.push(Object.create(null)),h0.has(s)&&o.set(s,u),u}chartOptionScopes(){const{options:t,type:s}=this;return[t,Gn[s]||{},Qe.datasets[s]||{},{type:s},Qe,Cu]}resolveNamedOptions(t,s,n,r=[""]){const a={$shared:!0},{resolver:o,subPrefixes:l}=fm(this._resolverCache,t,r);let c=o;if(i1(o,s)){a.$shared=!1,n=bn(n)?n():n;const u=this.createResolver(t,n,l);c=Or(o,n,u)}for(const u of s)a[u]=c[u];return a}createResolver(t,s,n=[""],r){const{resolver:a}=fm(this._resolverCache,t,n);return Ee(s)?Or(a,s,void 0,r):a}}function fm(e,t,s){let n=e.get(t);n||(n=new Map,e.set(t,n));const r=s.join();let a=n.get(r);return a||(a={resolver:Ud(t,s),subPrefixes:s.filter(l=>!l.toLowerCase().includes("hover"))},n.set(r,a)),a}const r1=e=>Ee(e)&&Object.getOwnPropertyNames(e).some(t=>bn(e[t]));function i1(e,t){const{isScriptable:s,isIndexable:n}=Kx(e);for(const r of t){const a=s(r),o=n(r),l=(o||a)&&e[r];if(a&&(bn(l)||r1(l))||o&&rt(l))return!0}return!1}var a1="4.5.1";const o1=["top","bottom","left","right","chartArea"];function mm(e,t){return e==="top"||e==="bottom"||o1.indexOf(e)===-1&&t==="x"}function gm(e,t){return function(s,n){return s[e]===n[e]?s[t]-n[t]:s[e]-n[e]}}function pm(e){const t=e.chart,s=t.options.animation;t.notifyPlugins("afterRender"),Be(s&&s.onComplete,[e],t)}function l1(e){const t=e.chart,s=t.options.animation;Be(s&&s.onProgress,[e],t)}function f0(e){return Xd()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const vo={},xm=e=>{const t=f0(e);return Object.values(vo).filter(s=>s.canvas===t).pop()};function c1(e,t,s){const n=Object.keys(e);for(const r of n){const a=+r;if(a>=t){const o=e[r];delete e[r],(s>0||a>t)&&(e[a+s]=o)}}}function u1(e,t,s,n){return!s||e.type==="mouseout"?null:n?t:e}var Gs;let Xs=(Gs=class{static register(...t){xs.add(...t),ym()}static unregister(...t){xs.remove(...t),ym()}constructor(t,s){const n=this.config=new n1(s),r=f0(t),a=xm(r);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||E_(r)),this.platform.updateConfig(n);const l=this.platform.acquireContext(r,o.aspectRatio),c=l&&l.canvas,u=c&&c.height,d=c&&c.width;if(this.id=Sw(),this.ctx=l,this.canvas=c,this.width=d,this.height=u,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new X_,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Xw(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],vo[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Es.listen(this,"complete",pm),Es.listen(this,"progress",l1),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:s},width:n,height:r,_aspectRatio:a}=this;return De(t)?s&&a?a:r?n/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return xs}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Uf(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return If(this.canvas,this.ctx),this}stop(){return Es.stop(this),this}resize(t,s){Es.running(this)?this._resizeBeforeDraw={width:t,height:s}:this._resize(t,s)}_resize(t,s){const n=this.options,r=this.canvas,a=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,t,s,a),l=n.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Uf(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),Be(n.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const s=this.options.scales||{};Le(s,(n,r)=>{n.id=r})}buildOrUpdateScales(){const t=this.options,s=t.scales,n=this.scales,r=Object.keys(n).reduce((o,l)=>(o[l]=!1,o),{});let a=[];s&&(a=a.concat(Object.keys(s).map(o=>{const l=s[o],c=Tu(o,l),u=c==="r",d=c==="x";return{options:l,dposition:u?"chartArea":d?"bottom":"left",dtype:u?"radialLinear":d?"category":"linear"}}))),Le(a,o=>{const l=o.options,c=l.id,u=Tu(c,l),d=Te(l.type,o.dtype);(l.position===void 0||mm(l.position,u)!==mm(o.dposition))&&(l.position=o.dposition),r[c]=!0;let h=null;if(c in n&&n[c].type===d)h=n[c];else{const f=xs.getScale(d);h=new f({id:c,type:d,ctx:this.ctx,chart:this}),n[h.id]=h}h.init(l,t)}),Le(r,(o,l)=>{o||delete n[l]}),Le(n,o=>{Xt.configure(this,o,o.options),Xt.addBox(this,o)})}_updateMetasets(){const t=this._metasets,s=this.data.datasets.length,n=t.length;if(t.sort((r,a)=>r.index-a.index),n>s){for(let r=s;r<n;++r)this._destroyDatasetMeta(r);t.splice(s,n-s)}this._sortedMetasets=t.slice(0).sort(gm("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:s}}=this;t.length>s.length&&delete this._stacks,t.forEach((n,r)=>{s.filter(a=>a===n._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],s=this.data.datasets;let n,r;for(this._removeUnreferencedMetasets(),n=0,r=s.length;n<r;n++){const a=s[n];let o=this.getDatasetMeta(n);const l=a.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(n),o=this.getDatasetMeta(n)),o.type=l,o.indexAxis=a.indexAxis||Eu(l,this.options),o.order=a.order||0,o.index=n,o.label=""+a.label,o.visible=this.isDatasetVisible(n),o.controller)o.controller.updateIndex(n),o.controller.linkScales();else{const c=xs.getController(l),{datasetElementType:u,dataElementType:d}=Qe.datasets[l];Object.assign(c,{dataElementType:xs.getElement(d),datasetElementType:u&&xs.getElement(u)}),o.controller=new c(this,n),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){Le(this.data.datasets,(t,s)=>{this.getDatasetMeta(s).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const s=this.config;s.update();const n=this._options=s.createResolver(s.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let u=0,d=this.data.datasets.length;u<d;u++){const{controller:h}=this.getDatasetMeta(u),f=!r&&a.indexOf(h)===-1;h.buildOrUpdateElements(f),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),r||Le(a,u=>{u.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(gm("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){Le(this.scales,t=>{Xt.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,s=new Set(Object.keys(this._listeners)),n=new Set(t.events);(!Tf(s,n)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,s=this._getUniformDataChanges()||[];for(const{method:n,start:r,count:a}of s){const o=n==="_removeElements"?-a:a;c1(t,r,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const s=this.data.datasets.length,n=a=>new Set(t.filter(o=>o[0]===a).map((o,l)=>l+","+o.splice(1).join(","))),r=n(0);for(let a=1;a<s;a++)if(!Tf(r,n(a)))return;return Array.from(r).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Xt.update(this,this.width,this.height,t);const s=this.chartArea,n=s.width<=0||s.height<=0;this._layers=[],Le(this.boxes,r=>{n&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,a)=>{r._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let s=0,n=this.data.datasets.length;s<n;++s)this.getDatasetMeta(s).controller.configure();for(let s=0,n=this.data.datasets.length;s<n;++s)this._updateDataset(s,bn(t)?t({datasetIndex:s}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,s){const n=this.getDatasetMeta(t),r={meta:n,index:t,mode:s,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(n.controller._update(s),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Es.has(this)?this.attached&&!Es.running(this)&&Es.start(this):(this.draw(),pm({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:n,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const s=this._layers;for(t=0;t<s.length&&s[t].z<=0;++t)s[t].draw(this.chartArea);for(this._drawDatasets();t<s.length;++t)s[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const s=this._sortedMetasets,n=[];let r,a;for(r=0,a=s.length;r<a;++r){const o=s[r];(!t||o.visible)&&n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let s=t.length-1;s>=0;--s)this._drawDataset(t[s]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const s=this.ctx,n={meta:t,index:t.index,cancelable:!0},r=Aj(this,t);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(r&&Bd(s,r),t.controller.draw(),r&&Hd(s),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(t){return qx(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,s,n,r){const a=o_.modes[s];return typeof a=="function"?a(this,t,n,r):[]}getDatasetMeta(t){const s=this.data.datasets[t],n=this._metasets;let r=n.filter(a=>a&&a._dataset===s).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:s&&s.order||0,index:t,_dataset:s,_parsed:[],_sorted:!1},n.push(r)),r}getContext(){return this.$context||(this.$context=Ur(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const s=this.data.datasets[t];if(!s)return!1;const n=this.getDatasetMeta(t);return typeof n.hidden=="boolean"?!n.hidden:!s.hidden}setDatasetVisibility(t,s){const n=this.getDatasetMeta(t);n.hidden=!s}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,s,n){const r=n?"show":"hide",a=this.getDatasetMeta(t),o=a.controller._resolveAnimations(void 0,r);Qi(s)?(a.data[s].hidden=!n,this.update()):(this.setDatasetVisibility(t,n),o.update(a,{visible:n}),this.update(l=>l.datasetIndex===t?r:void 0))}hide(t,s){this._updateVisibility(t,s,!1)}show(t,s){this._updateVisibility(t,s,!0)}_destroyDatasetMeta(t){const s=this._metasets[t];s&&s.controller&&s.controller._destroy(),delete this._metasets[t]}_stop(){let t,s;for(this.stop(),Es.remove(this),t=0,s=this.data.datasets.length;t<s;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:s}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),If(t,s),this.platform.releaseContext(s),this.canvas=null,this.ctx=null),delete vo[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,s=this.platform,n=(a,o)=>{s.addEventListener(this,a,o),t[a]=o},r=(a,o,l)=>{a.offsetX=o,a.offsetY=l,this._eventHandler(a)};Le(this.options.events,a=>n(a,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,s=this.platform,n=(c,u)=>{s.addEventListener(this,c,u),t[c]=u},r=(c,u)=>{t[c]&&(s.removeEventListener(this,c,u),delete t[c])},a=(c,u)=>{this.canvas&&this.resize(c,u)};let o;const l=()=>{r("attach",l),this.attached=!0,this.resize(),n("resize",a),n("detach",o)};o=()=>{this.attached=!1,r("resize",a),this._stop(),this._resize(0,0),n("attach",l)},s.isAttached(this.canvas)?l():o()}unbindEvents(){Le(this._listeners,(t,s)=>{this.platform.removeEventListener(this,s,t)}),this._listeners={},Le(this._responsiveListeners,(t,s)=>{this.platform.removeEventListener(this,s,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,s,n){const r=n?"set":"remove";let a,o,l,c;for(s==="dataset"&&(a=this.getDatasetMeta(t[0].datasetIndex),a.controller["_"+r+"DatasetHoverStyle"]()),l=0,c=t.length;l<c;++l){o=t[l];const u=o&&this.getDatasetMeta(o.datasetIndex).controller;u&&u[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const s=this._active||[],n=t.map(({datasetIndex:a,index:o})=>{const l=this.getDatasetMeta(a);if(!l)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:l.data[o],index:o}});!Go(n,s)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,s))}notifyPlugins(t,s,n){return this._plugins.notify(this,t,s,n)}isPluginEnabled(t){return this._plugins._cache.filter(s=>s.plugin.id===t).length===1}_updateHoverStyles(t,s,n){const r=this.options.hover,a=(c,u)=>c.filter(d=>!u.some(h=>d.datasetIndex===h.datasetIndex&&d.index===h.index)),o=a(s,t),l=n?t:a(t,s);o.length&&this.updateHoverStyle(o,r.mode,!1),l.length&&r.mode&&this.updateHoverStyle(l,r.mode,!0)}_eventHandler(t,s){const n={event:t,replay:s,cancelable:!0,inChartArea:this.isPointInArea(t)},r=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",n,r)===!1)return;const a=this._handleEvent(t,s,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,r),(a||n.changed)&&this.render(),this}_handleEvent(t,s,n){const{_active:r=[],options:a}=this,o=s,l=this._getActiveElements(t,r,n,o),c=Mw(t),u=u1(t,this._lastEvent,n,c);n&&(this._lastEvent=null,Be(a.onHover,[t,l,this],this),c&&Be(a.onClick,[t,l,this],this));const d=!Go(l,r);return(d||s)&&(this._active=l,this._updateHoverStyles(l,r,s)),this._lastEvent=u,d}_getActiveElements(t,s,n,r){if(t.type==="mouseout")return[];if(!n)return s;const a=this.options.hover;return this.getElementsAtEventForMode(t,a.mode,a,r)}},ke(Gs,"defaults",Qe),ke(Gs,"instances",vo),ke(Gs,"overrides",Gn),ke(Gs,"registry",xs),ke(Gs,"version",a1),ke(Gs,"getChart",xm),Gs);function ym(){return Le(Xs.instances,e=>e._plugins.invalidate())}function m0(e,t){const{x:s,y:n,base:r,width:a,height:o}=e.getProps(["x","y","base","width","height"],t);let l,c,u,d,h;return e.horizontal?(h=o/2,l=Math.min(s,r),c=Math.max(s,r),u=n-h,d=n+h):(h=a/2,l=s-h,c=s+h,u=Math.min(n,r),d=Math.max(n,r)),{left:l,top:u,right:c,bottom:d}}function rn(e,t,s,n){return e?0:as(t,s,n)}function d1(e,t,s){const n=e.options.borderWidth,r=e.borderSkipped,a=Gx(n);return{t:rn(r.top,a.top,0,s),r:rn(r.right,a.right,0,t),b:rn(r.bottom,a.bottom,0,s),l:rn(r.left,a.left,0,t)}}function h1(e,t,s){const{enableBorderRadius:n}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,a=Nr(r),o=Math.min(t,s),l=e.borderSkipped,c=n||Ee(r);return{topLeft:rn(!c||l.top||l.left,a.topLeft,0,o),topRight:rn(!c||l.top||l.right,a.topRight,0,o),bottomLeft:rn(!c||l.bottom||l.left,a.bottomLeft,0,o),bottomRight:rn(!c||l.bottom||l.right,a.bottomRight,0,o)}}function f1(e){const t=m0(e),s=t.right-t.left,n=t.bottom-t.top,r=d1(e,s/2,n/2),a=h1(e,s/2,n/2);return{outer:{x:t.left,y:t.top,w:s,h:n,radius:a},inner:{x:t.left+r.l,y:t.top+r.t,w:s-r.l-r.r,h:n-r.t-r.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,a.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(r.b,r.r))}}}}function vc(e,t,s,n){const r=t===null,a=s===null,l=e&&!(r&&a)&&m0(e,n);return l&&(r||xr(t,l.left,l.right))&&(a||xr(s,l.top,l.bottom))}function m1(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function g1(e,t){e.rect(t.x,t.y,t.w,t.h)}function bc(e,t,s={}){const n=e.x!==s.x?-t:0,r=e.y!==s.y?-t:0,a=(e.x+e.w!==s.x+s.w?t:0)-n,o=(e.y+e.h!==s.y+s.h?t:0)-r;return{x:e.x+n,y:e.y+r,w:e.w+a,h:e.h+o,radius:e.radius}}class zs extends wn{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:s,options:{borderColor:n,backgroundColor:r}}=this,{inner:a,outer:o}=f1(this),l=m1(o.radius)?Zo:g1;t.save(),(o.w!==a.w||o.h!==a.h)&&(t.beginPath(),l(t,bc(o,s,a)),t.clip(),l(t,bc(a,-s,o)),t.fillStyle=n,t.fill("evenodd")),t.beginPath(),l(t,bc(a,s)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,s,n){return vc(this,t,s,n)}inXRange(t,s){return vc(this,t,null,s)}inYRange(t,s){return vc(this,null,t,s)}getCenterPoint(t){const{x:s,y:n,base:r,horizontal:a}=this.getProps(["x","y","base","horizontal"],t);return{x:a?(s+r)/2:s,y:a?n:(n+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}ke(zs,"id","bar"),ke(zs,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),ke(zs,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const vm=(e,t)=>{let{boxHeight:s=t,boxWidth:n=t}=e;return e.usePointStyle&&(s=Math.min(s,t),n=e.pointStyleWidth||Math.min(n,t)),{boxWidth:n,boxHeight:s,itemHeight:Math.max(t,s)}},p1=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class bm extends wn{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,s,n){this.maxWidth=t,this.maxHeight=s,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let s=Be(t.generateLabels,[this.chart],this)||[];t.filter&&(s=s.filter(n=>t.filter(n,this.chart.data))),t.sort&&(s=s.sort((n,r)=>t.sort(n,r,this.chart.data))),this.options.reverse&&s.reverse(),this.legendItems=s}fit(){const{options:t,ctx:s}=this;if(!t.display){this.width=this.height=0;return}const n=t.labels,r=xt(n.font),a=r.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=vm(n,a);let u,d;s.font=r.string,this.isHorizontal()?(u=this.maxWidth,d=this._fitRows(o,a,l,c)+10):(d=this.maxHeight,u=this._fitCols(o,r,l,c)+10),this.width=Math.min(u,t.maxWidth||this.maxWidth),this.height=Math.min(d,t.maxHeight||this.maxHeight)}_fitRows(t,s,n,r){const{ctx:a,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.lineWidths=[0],d=r+l;let h=t;a.textAlign="left",a.textBaseline="middle";let f=-1,m=-d;return this.legendItems.forEach((v,x)=>{const y=n+s/2+a.measureText(v.text).width;(x===0||u[u.length-1]+y+2*l>o)&&(h+=d,u[u.length-(x>0?0:1)]=0,m+=d,f++),c[x]={left:0,top:m,row:f,width:y,height:r},u[u.length-1]+=y+l}),h}_fitCols(t,s,n,r){const{ctx:a,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],u=this.columnSizes=[],d=o-t;let h=l,f=0,m=0,v=0,x=0;return this.legendItems.forEach((y,g)=>{const{itemWidth:p,itemHeight:w}=x1(n,s,a,y,r);g>0&&m+w+2*l>d&&(h+=f+l,u.push({width:f,height:m}),v+=f+l,x++,f=m=0),c[g]={left:v,top:m,col:x,width:p,height:w},f=Math.max(f,p),m+=w+l}),h+=f,u.push({width:f,height:m}),h}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:s,options:{align:n,labels:{padding:r},rtl:a}}=this,o=kr(a,this.left,this.width);if(this.isHorizontal()){let l=0,c=gt(n,this.left+r,this.right-this.lineWidths[l]);for(const u of s)l!==u.row&&(l=u.row,c=gt(n,this.left+r,this.right-this.lineWidths[l])),u.top+=this.top+t+r,u.left=o.leftForLtr(o.x(c),u.width),c+=u.width+r}else{let l=0,c=gt(n,this.top+t+r,this.bottom-this.columnSizes[l].height);for(const u of s)u.col!==l&&(l=u.col,c=gt(n,this.top+t+r,this.bottom-this.columnSizes[l].height)),u.top=c,u.left+=this.left+r,u.left=o.leftForLtr(o.x(u.left),u.width),c+=u.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Bd(t,this),this._draw(),Hd(t)}}_draw(){const{options:t,columnSizes:s,lineWidths:n,ctx:r}=this,{align:a,labels:o}=t,l=Qe.color,c=kr(t.rtl,this.left,this.width),u=xt(o.font),{padding:d}=o,h=u.size,f=h/2;let m;this.drawTitle(),r.textAlign=c.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=u.string;const{boxWidth:v,boxHeight:x,itemHeight:y}=vm(o,h),g=function(E,_,N){if(isNaN(v)||v<=0||isNaN(x)||x<0)return;r.save();const U=Te(N.lineWidth,1);if(r.fillStyle=Te(N.fillStyle,l),r.lineCap=Te(N.lineCap,"butt"),r.lineDashOffset=Te(N.lineDashOffset,0),r.lineJoin=Te(N.lineJoin,"miter"),r.lineWidth=U,r.strokeStyle=Te(N.strokeStyle,l),r.setLineDash(Te(N.lineDash,[])),o.usePointStyle){const B={radius:x*Math.SQRT2/2,pointStyle:N.pointStyle,rotation:N.rotation,borderWidth:U},q=c.xPlus(E,v/2),z=_+f;Xx(r,B,q,z,o.pointStyleWidth&&v)}else{const B=_+Math.max((h-x)/2,0),q=c.leftForLtr(E,v),z=Nr(N.borderRadius);r.beginPath(),Object.values(z).some(G=>G!==0)?Zo(r,{x:q,y:B,w:v,h:x,radius:z}):r.rect(q,B,v,x),r.fill(),U!==0&&r.stroke()}r.restore()},p=function(E,_,N){Ji(r,N.text,E,_+y/2,u,{strikethrough:N.hidden,textAlign:c.textAlign(N.textAlign)})},w=this.isHorizontal(),b=this._computeTitleHeight();w?m={x:gt(a,this.left+d,this.right-n[0]),y:this.top+d+b,line:0}:m={x:this.left+d,y:gt(a,this.top+b+d,this.bottom-s[0].height),line:0},e0(this.ctx,t.textDirection);const k=y+d;this.legendItems.forEach((E,_)=>{r.strokeStyle=E.fontColor,r.fillStyle=E.fontColor;const N=r.measureText(E.text).width,U=c.textAlign(E.textAlign||(E.textAlign=o.textAlign)),B=v+f+N;let q=m.x,z=m.y;c.setWidth(this.width),w?_>0&&q+B+d>this.right&&(z=m.y+=k,m.line++,q=m.x=gt(a,this.left+d,this.right-n[m.line])):_>0&&z+k>this.bottom&&(q=m.x=q+s[m.line].width+d,m.line++,z=m.y=gt(a,this.top+b+d,this.bottom-s[m.line].height));const G=c.x(q);if(g(G,z,E),q=qw(U,q+v+f,w?q+B:this.right,t.rtl),p(c.x(q),z,E),w)m.x+=B+d;else if(typeof E.text!="string"){const C=u.lineHeight;m.y+=g0(E,C)+d}else m.y+=k}),t0(this.ctx,t.textDirection)}drawTitle(){const t=this.options,s=t.title,n=xt(s.font),r=Jt(s.padding);if(!s.display)return;const a=kr(t.rtl,this.left,this.width),o=this.ctx,l=s.position,c=n.size/2,u=r.top+c;let d,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),d=this.top+u,h=gt(t.align,h,this.right-f);else{const v=this.columnSizes.reduce((x,y)=>Math.max(x,y.height),0);d=u+gt(t.align,this.top,this.bottom-v-t.labels.padding-this._computeTitleHeight())}const m=gt(l,h,h+f);o.textAlign=a.textAlign($d(l)),o.textBaseline="middle",o.strokeStyle=s.color,o.fillStyle=s.color,o.font=n.string,Ji(o,s.text,m,d,n)}_computeTitleHeight(){const t=this.options.title,s=xt(t.font),n=Jt(t.padding);return t.display?s.lineHeight+n.height:0}_getLegendItemAt(t,s){let n,r,a;if(xr(t,this.left,this.right)&&xr(s,this.top,this.bottom)){for(a=this.legendHitBoxes,n=0;n<a.length;++n)if(r=a[n],xr(t,r.left,r.left+r.width)&&xr(s,r.top,r.top+r.height))return this.legendItems[n]}return null}handleEvent(t){const s=this.options;if(!b1(t.type,s))return;const n=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,a=p1(r,n);r&&!a&&Be(s.onLeave,[t,r,this],this),this._hoveredItem=n,n&&!a&&Be(s.onHover,[t,n,this],this)}else n&&Be(s.onClick,[t,n,this],this)}}function x1(e,t,s,n,r){const a=y1(n,e,t,s),o=v1(r,n,t.lineHeight);return{itemWidth:a,itemHeight:o}}function y1(e,t,s,n){let r=e.text;return r&&typeof r!="string"&&(r=r.reduce((a,o)=>a.length>o.length?a:o)),t+s.size/2+n.measureText(r).width}function v1(e,t,s){let n=e;return typeof t.text!="string"&&(n=g0(t,s)),n}function g0(e,t){const s=e.text?e.text.length:0;return t*s}function b1(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var Wr={id:"legend",_element:bm,start(e,t,s){const n=e.legend=new bm({ctx:e.ctx,options:s,chart:e});Xt.configure(e,n,s),Xt.addBox(e,n)},stop(e){Xt.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,s){const n=e.legend;Xt.configure(e,n,s),n.options=s},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,s){const n=t.datasetIndex,r=s.chart;r.isDatasetVisible(n)?(r.hide(n),t.hidden=!0):(r.show(n),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:s,pointStyle:n,textAlign:r,color:a,useBorderRadius:o,borderRadius:l}}=e.legend.options;return e._getSortedDatasetMetas().map(c=>{const u=c.controller.getStyle(s?0:void 0),d=Jt(u.borderWidth);return{text:t[c.index].label,fillStyle:u.backgroundColor,fontColor:a,hidden:!c.visible,lineCap:u.borderCapStyle,lineDash:u.borderDash,lineDashOffset:u.borderDashOffset,lineJoin:u.borderJoinStyle,lineWidth:(d.width+d.height)/4,strokeStyle:u.borderColor,pointStyle:n||u.pointStyle,rotation:u.rotation,textAlign:r||u.textAlign,borderRadius:o&&(l||u.borderRadius),datasetIndex:c.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class p0 extends wn{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,s){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=s;const r=rt(n.text)?n.text.length:1;this._padding=Jt(n.padding);const a=r*xt(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=a:this.width=a}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:s,left:n,bottom:r,right:a,options:o}=this,l=o.align;let c=0,u,d,h;return this.isHorizontal()?(d=gt(l,n,a),h=s+t,u=a-n):(o.position==="left"?(d=n+t,h=gt(l,r,s),c=yt*-.5):(d=a-t,h=gt(l,s,r),c=yt*.5),u=r-s),{titleX:d,titleY:h,maxWidth:u,rotation:c}}draw(){const t=this.ctx,s=this.options;if(!s.display)return;const n=xt(s.font),a=n.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:c,rotation:u}=this._drawArgs(a);Ji(t,s.text,0,0,n,{color:s.color,maxWidth:c,rotation:u,textAlign:$d(s.align),textBaseline:"middle",translation:[o,l]})}}function w1(e,t){const s=new p0({ctx:e.ctx,options:t,chart:e});Xt.configure(e,s,t),Xt.addBox(e,s),e.titleBlock=s}var Xr={id:"title",_element:p0,start(e,t,s){w1(e,s)},stop(e){const t=e.titleBlock;Xt.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,s){const n=e.titleBlock;Xt.configure(e,n,s),n.options=s},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const gi={average(e){if(!e.length)return!1;let t,s,n=new Set,r=0,a=0;for(t=0,s=e.length;t<s;++t){const l=e[t].element;if(l&&l.hasValue()){const c=l.tooltipPosition();n.add(c.x),r+=c.y,++a}}return a===0||n.size===0?!1:{x:[...n].reduce((l,c)=>l+c)/n.size,y:r/a}},nearest(e,t){if(!e.length)return!1;let s=t.x,n=t.y,r=Number.POSITIVE_INFINITY,a,o,l;for(a=0,o=e.length;a<o;++a){const c=e[a].element;if(c&&c.hasValue()){const u=c.getCenterPoint(),d=$w(t,u);d<r&&(r=d,l=c)}}if(l){const c=l.tooltipPosition();s=c.x,n=c.y}return{x:s,y:n}}};function gs(e,t){return t&&(rt(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Ts(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function j1(e,t){const{element:s,datasetIndex:n,index:r}=t,a=e.getDatasetMeta(n).controller,{label:o,value:l}=a.getLabelAndValue(r);return{chart:e,label:o,parsed:a.getParsed(r),raw:e.data.datasets[n].data[r],formattedValue:l,dataset:a.getDataset(),dataIndex:r,datasetIndex:n,element:s}}function wm(e,t){const s=e.chart.ctx,{body:n,footer:r,title:a}=e,{boxWidth:o,boxHeight:l}=t,c=xt(t.bodyFont),u=xt(t.titleFont),d=xt(t.footerFont),h=a.length,f=r.length,m=n.length,v=Jt(t.padding);let x=v.height,y=0,g=n.reduce((b,k)=>b+k.before.length+k.lines.length+k.after.length,0);if(g+=e.beforeBody.length+e.afterBody.length,h&&(x+=h*u.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),g){const b=t.displayColors?Math.max(l,c.lineHeight):c.lineHeight;x+=m*b+(g-m)*c.lineHeight+(g-1)*t.bodySpacing}f&&(x+=t.footerMarginTop+f*d.lineHeight+(f-1)*t.footerSpacing);let p=0;const w=function(b){y=Math.max(y,s.measureText(b).width+p)};return s.save(),s.font=u.string,Le(e.title,w),s.font=c.string,Le(e.beforeBody.concat(e.afterBody),w),p=t.displayColors?o+2+t.boxPadding:0,Le(n,b=>{Le(b.before,w),Le(b.lines,w),Le(b.after,w)}),p=0,s.font=d.string,Le(e.footer,w),s.restore(),y+=v.width,{width:y,height:x}}function _1(e,t){const{y:s,height:n}=t;return s<n/2?"top":s>e.height-n/2?"bottom":"center"}function N1(e,t,s,n){const{x:r,width:a}=n,o=s.caretSize+s.caretPadding;if(e==="left"&&r+a+o>t.width||e==="right"&&r-a-o<0)return!0}function k1(e,t,s,n){const{x:r,width:a}=s,{width:o,chartArea:{left:l,right:c}}=e;let u="center";return n==="center"?u=r<=(l+c)/2?"left":"right":r<=a/2?u="left":r>=o-a/2&&(u="right"),N1(u,e,t,s)&&(u="center"),u}function jm(e,t,s){const n=s.yAlign||t.yAlign||_1(e,s);return{xAlign:s.xAlign||t.xAlign||k1(e,t,s,n),yAlign:n}}function S1(e,t){let{x:s,width:n}=e;return t==="right"?s-=n:t==="center"&&(s-=n/2),s}function C1(e,t,s){let{y:n,height:r}=e;return t==="top"?n+=s:t==="bottom"?n-=r+s:n-=r/2,n}function _m(e,t,s,n){const{caretSize:r,caretPadding:a,cornerRadius:o}=e,{xAlign:l,yAlign:c}=s,u=r+a,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:m}=Nr(o);let v=S1(t,l);const x=C1(t,c,u);return c==="center"?l==="left"?v+=u:l==="right"&&(v-=u):l==="left"?v-=Math.max(d,f)+r:l==="right"&&(v+=Math.max(h,m)+r),{x:as(v,0,n.width-t.width),y:as(x,0,n.height-t.height)}}function Ba(e,t,s){const n=Jt(s.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-n.right:e.x+n.left}function Nm(e){return gs([],Ts(e))}function E1(e,t,s){return Ur(e,{tooltip:t,tooltipItems:s,type:"tooltip"})}function km(e,t){const s=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return s?e.override(s):e}const x0={beforeTitle:Ss,title(e){if(e.length>0){const t=e[0],s=t.chart.data.labels,n=s?s.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(n>0&&t.dataIndex<n)return s[t.dataIndex]}return""},afterTitle:Ss,beforeBody:Ss,beforeLabel:Ss,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const s=e.formattedValue;return De(s)||(t+=s),t},labelColor(e){const s=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:s.borderColor,backgroundColor:s.backgroundColor,borderWidth:s.borderWidth,borderDash:s.borderDash,borderDashOffset:s.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const s=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:s.pointStyle,rotation:s.rotation}},afterLabel:Ss,afterBody:Ss,beforeFooter:Ss,footer:Ss,afterFooter:Ss};function St(e,t,s,n){const r=e[t].call(s,n);return typeof r>"u"?x0[t].call(s,n):r}class Lu extends wn{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const s=this.chart,n=this.options.setContext(this.getContext()),r=n.enabled&&s.options.animation&&n.animations,a=new s0(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=E1(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,s){const{callbacks:n}=s,r=St(n,"beforeTitle",this,t),a=St(n,"title",this,t),o=St(n,"afterTitle",this,t);let l=[];return l=gs(l,Ts(r)),l=gs(l,Ts(a)),l=gs(l,Ts(o)),l}getBeforeBody(t,s){return Nm(St(s.callbacks,"beforeBody",this,t))}getBody(t,s){const{callbacks:n}=s,r=[];return Le(t,a=>{const o={before:[],lines:[],after:[]},l=km(n,a);gs(o.before,Ts(St(l,"beforeLabel",this,a))),gs(o.lines,St(l,"label",this,a)),gs(o.after,Ts(St(l,"afterLabel",this,a))),r.push(o)}),r}getAfterBody(t,s){return Nm(St(s.callbacks,"afterBody",this,t))}getFooter(t,s){const{callbacks:n}=s,r=St(n,"beforeFooter",this,t),a=St(n,"footer",this,t),o=St(n,"afterFooter",this,t);let l=[];return l=gs(l,Ts(r)),l=gs(l,Ts(a)),l=gs(l,Ts(o)),l}_createItems(t){const s=this._active,n=this.chart.data,r=[],a=[],o=[];let l=[],c,u;for(c=0,u=s.length;c<u;++c)l.push(j1(this.chart,s[c]));return t.filter&&(l=l.filter((d,h,f)=>t.filter(d,h,f,n))),t.itemSort&&(l=l.sort((d,h)=>t.itemSort(d,h,n))),Le(l,d=>{const h=km(t.callbacks,d);r.push(St(h,"labelColor",this,d)),a.push(St(h,"labelPointStyle",this,d)),o.push(St(h,"labelTextColor",this,d))}),this.labelColors=r,this.labelPointStyles=a,this.labelTextColors=o,this.dataPoints=l,l}update(t,s){const n=this.options.setContext(this.getContext()),r=this._active;let a,o=[];if(!r.length)this.opacity!==0&&(a={opacity:0});else{const l=gi[n.position].call(this,r,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const c=this._size=wm(this,n),u=Object.assign({},l,c),d=jm(this.chart,n,u),h=_m(n,u,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,a={opacity:1,x:h.x,y:h.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,a&&this._resolveAnimations().update(this,a),t&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:s})}drawCaret(t,s,n,r){const a=this.getCaretPosition(t,n,r);s.lineTo(a.x1,a.y1),s.lineTo(a.x2,a.y2),s.lineTo(a.x3,a.y3)}getCaretPosition(t,s,n){const{xAlign:r,yAlign:a}=this,{caretSize:o,cornerRadius:l}=n,{topLeft:c,topRight:u,bottomLeft:d,bottomRight:h}=Nr(l),{x:f,y:m}=t,{width:v,height:x}=s;let y,g,p,w,b,k;return a==="center"?(b=m+x/2,r==="left"?(y=f,g=y-o,w=b+o,k=b-o):(y=f+v,g=y+o,w=b-o,k=b+o),p=y):(r==="left"?g=f+Math.max(c,d)+o:r==="right"?g=f+v-Math.max(u,h)-o:g=this.caretX,a==="top"?(w=m,b=w-o,y=g-o,p=g+o):(w=m+x,b=w+o,y=g+o,p=g-o),k=w),{x1:y,x2:g,x3:p,y1:w,y2:b,y3:k}}drawTitle(t,s,n){const r=this.title,a=r.length;let o,l,c;if(a){const u=kr(n.rtl,this.x,this.width);for(t.x=Ba(this,n.titleAlign,n),s.textAlign=u.textAlign(n.titleAlign),s.textBaseline="middle",o=xt(n.titleFont),l=n.titleSpacing,s.fillStyle=n.titleColor,s.font=o.string,c=0;c<a;++c)s.fillText(r[c],u.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+l,c+1===a&&(t.y+=n.titleMarginBottom-l)}}_drawColorBox(t,s,n,r,a){const o=this.labelColors[n],l=this.labelPointStyles[n],{boxHeight:c,boxWidth:u}=a,d=xt(a.bodyFont),h=Ba(this,"left",a),f=r.x(h),m=c<d.lineHeight?(d.lineHeight-c)/2:0,v=s.y+m;if(a.usePointStyle){const x={radius:Math.min(u,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},y=r.leftForLtr(f,u)+u/2,g=v+c/2;t.strokeStyle=a.multiKeyBackground,t.fillStyle=a.multiKeyBackground,$f(t,x,y,g),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,$f(t,x,y,g)}else{t.lineWidth=Ee(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const x=r.leftForLtr(f,u),y=r.leftForLtr(r.xPlus(f,1),u-2),g=Nr(o.borderRadius);Object.values(g).some(p=>p!==0)?(t.beginPath(),t.fillStyle=a.multiKeyBackground,Zo(t,{x,y:v,w:u,h:c,radius:g}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),Zo(t,{x:y,y:v+1,w:u-2,h:c-2,radius:g}),t.fill()):(t.fillStyle=a.multiKeyBackground,t.fillRect(x,v,u,c),t.strokeRect(x,v,u,c),t.fillStyle=o.backgroundColor,t.fillRect(y,v+1,u-2,c-2))}t.fillStyle=this.labelTextColors[n]}drawBody(t,s,n){const{body:r}=this,{bodySpacing:a,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:u,boxPadding:d}=n,h=xt(n.bodyFont);let f=h.lineHeight,m=0;const v=kr(n.rtl,this.x,this.width),x=function(N){s.fillText(N,v.x(t.x+m),t.y+f/2),t.y+=f+a},y=v.textAlign(o);let g,p,w,b,k,E,_;for(s.textAlign=o,s.textBaseline="middle",s.font=h.string,t.x=Ba(this,y,n),s.fillStyle=n.bodyColor,Le(this.beforeBody,x),m=l&&y!=="right"?o==="center"?u/2+d:u+2+d:0,b=0,E=r.length;b<E;++b){for(g=r[b],p=this.labelTextColors[b],s.fillStyle=p,Le(g.before,x),w=g.lines,l&&w.length&&(this._drawColorBox(s,t,b,v,n),f=Math.max(h.lineHeight,c)),k=0,_=w.length;k<_;++k)x(w[k]),f=h.lineHeight;Le(g.after,x)}m=0,f=h.lineHeight,Le(this.afterBody,x),t.y-=a}drawFooter(t,s,n){const r=this.footer,a=r.length;let o,l;if(a){const c=kr(n.rtl,this.x,this.width);for(t.x=Ba(this,n.footerAlign,n),t.y+=n.footerMarginTop,s.textAlign=c.textAlign(n.footerAlign),s.textBaseline="middle",o=xt(n.footerFont),s.fillStyle=n.footerColor,s.font=o.string,l=0;l<a;++l)s.fillText(r[l],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+n.footerSpacing}}drawBackground(t,s,n,r){const{xAlign:a,yAlign:o}=this,{x:l,y:c}=t,{width:u,height:d}=n,{topLeft:h,topRight:f,bottomLeft:m,bottomRight:v}=Nr(r.cornerRadius);s.fillStyle=r.backgroundColor,s.strokeStyle=r.borderColor,s.lineWidth=r.borderWidth,s.beginPath(),s.moveTo(l+h,c),o==="top"&&this.drawCaret(t,s,n,r),s.lineTo(l+u-f,c),s.quadraticCurveTo(l+u,c,l+u,c+f),o==="center"&&a==="right"&&this.drawCaret(t,s,n,r),s.lineTo(l+u,c+d-v),s.quadraticCurveTo(l+u,c+d,l+u-v,c+d),o==="bottom"&&this.drawCaret(t,s,n,r),s.lineTo(l+m,c+d),s.quadraticCurveTo(l,c+d,l,c+d-m),o==="center"&&a==="left"&&this.drawCaret(t,s,n,r),s.lineTo(l,c+h),s.quadraticCurveTo(l,c,l+h,c),s.closePath(),s.fill(),r.borderWidth>0&&s.stroke()}_updateAnimationTarget(t){const s=this.chart,n=this.$animations,r=n&&n.x,a=n&&n.y;if(r||a){const o=gi[t.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=wm(this,t),c=Object.assign({},o,this._size),u=jm(s,t,c),d=_m(t,c,u,s);(r._to!==d.x||a._to!==d.y)&&(this.xAlign=u.xAlign,this.yAlign=u.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(t){const s=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(s);const r={width:this.width,height:this.height},a={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=Jt(s.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;s.enabled&&l&&(t.save(),t.globalAlpha=n,this.drawBackground(a,t,r,s),e0(t,s.textDirection),a.y+=o.top,this.drawTitle(a,t,s),this.drawBody(a,t,s),this.drawFooter(a,t,s),t0(t,s.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,s){const n=this._active,r=t.map(({datasetIndex:l,index:c})=>{const u=this.chart.getDatasetMeta(l);if(!u)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:u.data[c],index:c}}),a=!Go(n,r),o=this._positionChanged(r,s);(a||o)&&(this._active=r,this._eventPosition=s,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,s,n=!0){if(s&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,a=this._active||[],o=this._getActiveElements(t,a,s,n),l=this._positionChanged(o,t),c=s||!Go(o,a)||l;return c&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,s))),c}_getActiveElements(t,s,n,r){const a=this.options;if(t.type==="mouseout")return[];if(!r)return s.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,a.mode,a,n);return a.reverse&&o.reverse(),o}_positionChanged(t,s){const{caretX:n,caretY:r,options:a}=this,o=gi[a.position].call(this,t,s);return o!==!1&&(n!==o.x||r!==o.y)}}ke(Lu,"positioners",gi);var qr={id:"tooltip",_element:Lu,positioners:gi,afterInit(e,t,s){s&&(e.tooltip=new Lu({chart:e,options:s}))},beforeUpdate(e,t,s){e.tooltip&&e.tooltip.initialize(s)},reset(e,t,s){e.tooltip&&e.tooltip.initialize(s)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const s={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",{...s,cancelable:!0})===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",s)}},afterEvent(e,t){if(e.tooltip){const s=t.replay;e.tooltip.handleEvent(t.event,s,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:x0},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const T1=(e,t,s,n)=>(typeof t=="string"?(s=e.push(t)-1,n.unshift({index:s,label:t})):isNaN(t)&&(s=null),s);function L1(e,t,s,n){const r=e.indexOf(t);if(r===-1)return T1(e,t,s,n);const a=e.lastIndexOf(t);return r!==a?s:r}const A1=(e,t)=>e===null?null:as(Math.round(e),0,t);function Sm(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class jn extends Vr{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const s=this._addedLabels;if(s.length){const n=this.getLabels();for(const{index:r,label:a}of s)n[r]===a&&n.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,s){if(De(t))return null;const n=this.getLabels();return s=isFinite(s)&&n[s]===t?s:L1(n,t,Te(s,t),this._addedLabels),A1(s,n.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:s}=this.getUserBounds();let{min:n,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(n=0),s||(r=this.getLabels().length-1)),this.min=n,this.max=r}buildTicks(){const t=this.min,s=this.max,n=this.options.offset,r=[];let a=this.getLabels();a=t===0&&s===a.length-1?a:a.slice(t,s+1),this._valueRange=Math.max(a.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=t;o<=s;o++)r.push({value:o});return r}getLabelForValue(t){return Sm.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const s=this.ticks;return t<0||t>s.length-1?null:this.getPixelForValue(s[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}ke(jn,"id","category"),ke(jn,"defaults",{ticks:{callback:Sm}});function M1(e,t){const s=[],{bounds:r,step:a,min:o,max:l,precision:c,count:u,maxTicks:d,maxDigits:h,includeBounds:f}=e,m=a||1,v=d-1,{min:x,max:y}=t,g=!De(o),p=!De(l),w=!De(u),b=(y-x)/(h+1);let k=Af((y-x)/v/m)*m,E,_,N,U;if(k<1e-14&&!g&&!p)return[{value:x},{value:y}];U=Math.ceil(y/k)-Math.floor(x/k),U>v&&(k=Af(U*k/v/m)*m),De(c)||(E=Math.pow(10,c),k=Math.ceil(k*E)/E),r==="ticks"?(_=Math.floor(x/k)*k,N=Math.ceil(y/k)*k):(_=x,N=y),g&&p&&a&&Ow((l-o)/a,k/1e3)?(U=Math.round(Math.min((l-o)/k,d)),k=(l-o)/U,_=o,N=l):w?(_=g?o:_,N=p?l:N,U=u-1,k=(N-_)/U):(U=(N-_)/k,po(U,Math.round(U),k/1e3)?U=Math.round(U):U=Math.ceil(U));const B=Math.max(Mf(k),Mf(_));E=Math.pow(10,De(c)?B:c),_=Math.round(_*E)/E,N=Math.round(N*E)/E;let q=0;for(g&&(f&&_!==o?(s.push({value:o}),_<o&&q++,po(Math.round((_+q*k)*E)/E,o,Cm(o,b,e))&&q++):_<o&&q++);q<U;++q){const z=Math.round((_+q*k)*E)/E;if(p&&z>l)break;s.push({value:z})}return p&&f&&N!==l?s.length&&po(s[s.length-1].value,l,Cm(l,b,e))?s[s.length-1].value=l:s.push({value:l}):(!p||N===l)&&s.push({value:N}),s}function Cm(e,t,{horizontal:s,minRotation:n}){const r=Fn(n),a=(s?Math.sin(r):Math.cos(r))||.001,o=.75*t*(""+e).length;return Math.min(t/a,o)}class P1 extends Vr{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,s){return De(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:s,maxDefined:n}=this.getUserBounds();let{min:r,max:a}=this;const o=c=>r=s?r:c,l=c=>a=n?a:c;if(t){const c=xn(r),u=xn(a);c<0&&u<0?l(0):c>0&&u>0&&o(0)}if(r===a){let c=a===0?1:Math.abs(a*.05);l(a+c),t||o(r-c)}this.min=r,this.max=a}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:s,stepSize:n}=t,r;return n?(r=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),s=s||11),s&&(r=Math.min(s,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,s=t.ticks;let n=this.getTickLimit();n=Math.max(2,n);const r={maxTicks:n,bounds:t.bounds,min:t.min,max:t.max,precision:s.precision,step:s.stepSize,count:s.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:s.minRotation||0,includeBounds:s.includeBounds!==!1},a=this._range||this,o=M1(r,a);return t.bounds==="ticks"&&Fw(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let s=this.min,n=this.max;if(super.configure(),this.options.offset&&t.length){const r=(n-s)/Math.max(t.length-1,1)/2;s-=r,n+=r}this._startValue=s,this._endValue=n,this._valueRange=n-s}getLabelForValue(t){return Vx(t,this.chart.options.locale,this.options.ticks.format)}}class _n extends P1{determineDataLimits(){const{min:t,max:s}=this.getMinMax(!0);this.min=Qt(t)?t:0,this.max=Qt(s)?s:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),s=t?this.width:this.height,n=Fn(this.options.ticks.minRotation),r=(t?Math.sin(n):Math.cos(n))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(s/Math.min(40,a.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}ke(_n,"id","linear"),ke(_n,"defaults",{ticks:{callback:Wx.formatters.numeric}});const Ml={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Et=Object.keys(Ml);function Em(e,t){return e-t}function Tm(e,t){if(De(t))return null;const s=e._adapter,{parser:n,round:r,isoWeekday:a}=e._parseOpts;let o=t;return typeof n=="function"&&(o=n(o)),Qt(o)||(o=typeof n=="string"?s.parse(o,n):s.parse(o)),o===null?null:(r&&(o=r==="week"&&(Jo(a)||a===!0)?s.startOf(o,"isoWeek",a):s.startOf(o,r)),+o)}function Lm(e,t,s,n){const r=Et.length;for(let a=Et.indexOf(e);a<r-1;++a){const o=Ml[Et[a]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((s-t)/(l*o.size))<=n)return Et[a]}return Et[r-1]}function R1(e,t,s,n,r){for(let a=Et.length-1;a>=Et.indexOf(s);a--){const o=Et[a];if(Ml[o].common&&e._adapter.diff(r,n,o)>=t-1)return o}return Et[s?Et.indexOf(s):0]}function D1(e){for(let t=Et.indexOf(e)+1,s=Et.length;t<s;++t)if(Ml[Et[t]].common)return Et[t]}function Am(e,t,s){if(!s)e[t]=!0;else if(s.length){const{lo:n,hi:r}=Id(s,t),a=s[n]>=t?s[n]:s[r];e[a]=!0}}function O1(e,t,s,n){const r=e._adapter,a=+r.startOf(t[0].value,n),o=t[t.length-1].value;let l,c;for(l=a;l<=o;l=+r.add(l,1,n))c=s[l],c>=0&&(t[c].major=!0);return t}function Mm(e,t,s){const n=[],r={},a=t.length;let o,l;for(o=0;o<a;++o)l=t[o],r[l]=o,n.push({value:l,major:!1});return a===0||!s?n:O1(e,n,r,s)}class sl extends Vr{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,s={}){const n=t.time||(t.time={}),r=this._adapter=new s_._date(t.adapters.date);r.init(s),Ci(n.displayFormats,r.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(t),this._normalized=s.normalized}parse(t,s){return t===void 0?null:Tm(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,s=this._adapter,n=t.time.unit||"day";let{min:r,max:a,minDefined:o,maxDefined:l}=this.getUserBounds();function c(u){!o&&!isNaN(u.min)&&(r=Math.min(r,u.min)),!l&&!isNaN(u.max)&&(a=Math.max(a,u.max))}(!o||!l)&&(c(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&c(this.getMinMax(!1))),r=Qt(r)&&!isNaN(r)?r:+s.startOf(Date.now(),n),a=Qt(a)&&!isNaN(a)?a:+s.endOf(Date.now(),n)+1,this.min=Math.min(r,a-1),this.max=Math.max(r+1,a)}_getLabelBounds(){const t=this.getLabelTimestamps();let s=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return t.length&&(s=t[0],n=t[t.length-1]),{min:s,max:n}}buildTicks(){const t=this.options,s=t.time,n=t.ticks,r=n.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const a=this.min,o=this.max,l=Vw(r,a,o);return this._unit=s.unit||(n.autoSkip?Lm(s.minUnit,this.min,this.max,this._getLabelCapacity(a)):R1(this,l.length,s.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:D1(this._unit),this.initOffsets(r),t.reverse&&l.reverse(),Mm(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let s=0,n=0,r,a;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?s=1-r:s=(this.getDecimalForValue(t[1])-r)/2,a=this.getDecimalForValue(t[t.length-1]),t.length===1?n=a:n=(a-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;s=as(s,0,o),n=as(n,0,o),this._offsets={start:s,end:n,factor:1/(s+1+n)}}_generate(){const t=this._adapter,s=this.min,n=this.max,r=this.options,a=r.time,o=a.unit||Lm(a.minUnit,s,n,this._getLabelCapacity(s)),l=Te(r.ticks.stepSize,1),c=o==="week"?a.isoWeekday:!1,u=Jo(c)||c===!0,d={};let h=s,f,m;if(u&&(h=+t.startOf(h,"isoWeek",c)),h=+t.startOf(h,u?"day":o),t.diff(n,s,o)>1e5*l)throw new Error(s+" and "+n+" are too far apart with stepSize of "+l+" "+o);const v=r.ticks.source==="data"&&this.getDataTimestamps();for(f=h,m=0;f<n;f=+t.add(f,l,o),m++)Am(d,f,v);return(f===n||r.bounds==="ticks"||m===1)&&Am(d,f,v),Object.keys(d).sort(Em).map(x=>+x)}getLabelForValue(t){const s=this._adapter,n=this.options.time;return n.tooltipFormat?s.format(t,n.tooltipFormat):s.format(t,n.displayFormats.datetime)}format(t,s){const r=this.options.time.displayFormats,a=this._unit,o=s||r[a];return this._adapter.format(t,o)}_tickFormatFunction(t,s,n,r){const a=this.options,o=a.ticks.callback;if(o)return Be(o,[t,s,n],this);const l=a.time.displayFormats,c=this._unit,u=this._majorUnit,d=c&&l[c],h=u&&l[u],f=n[s],m=u&&h&&f&&f.major;return this._adapter.format(t,r||(m?h:d))}generateTickLabels(t){let s,n,r;for(s=0,n=t.length;s<n;++s)r=t[s],r.label=this._tickFormatFunction(r.value,s,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const s=this._offsets,n=this.getDecimalForValue(t);return this.getPixelForDecimal((s.start+n)*s.factor)}getValueForPixel(t){const s=this._offsets,n=this.getDecimalForPixel(t)/s.factor-s.end;return this.min+n*(this.max-this.min)}_getLabelSize(t){const s=this.options.ticks,n=this.ctx.measureText(t).width,r=Fn(this.isHorizontal()?s.maxRotation:s.minRotation),a=Math.cos(r),o=Math.sin(r),l=this._resolveTickFontOptions(0).size;return{w:n*a+l*o,h:n*o+l*a}}_getLabelCapacity(t){const s=this.options.time,n=s.displayFormats,r=n[s.unit]||n.millisecond,a=this._tickFormatFunction(t,0,Mm(this,[t],this._majorUnit),r),o=this._getLabelSize(a),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let t=this._cache.data||[],s,n;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(s=0,n=r.length;s<n;++s)t=t.concat(r[s].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let s,n;if(t.length)return t;const r=this.getLabels();for(s=0,n=r.length;s<n;++s)t.push(Tm(this,r[s]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return $x(t.sort(Em))}}ke(sl,"id","time"),ke(sl,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Ha(e,t,s){let n=0,r=e.length-1,a,o,l,c;s?(t>=e[n].pos&&t<=e[r].pos&&({lo:n,hi:r}=Su(e,"pos",t)),{pos:a,time:l}=e[n],{pos:o,time:c}=e[r]):(t>=e[n].time&&t<=e[r].time&&({lo:n,hi:r}=Su(e,"time",t)),{time:a,pos:l}=e[n],{time:o,pos:c}=e[r]);const u=o-a;return u?l+(c-l)*(t-a)/u:l}class Pm extends sl{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),s=this._table=this.buildLookupTable(t);this._minPos=Ha(s,this.min),this._tableRange=Ha(s,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:s,max:n}=this,r=[],a=[];let o,l,c,u,d;for(o=0,l=t.length;o<l;++o)u=t[o],u>=s&&u<=n&&r.push(u);if(r.length<2)return[{time:s,pos:0},{time:n,pos:1}];for(o=0,l=r.length;o<l;++o)d=r[o+1],c=r[o-1],u=r[o],Math.round((d+c)/2)!==u&&a.push({time:u,pos:o/(l-1)});return a}_generate(){const t=this.min,s=this.max;let n=super.getDataTimestamps();return(!n.includes(t)||!n.length)&&n.splice(0,0,t),(!n.includes(s)||n.length===1)&&n.push(s),n.sort((r,a)=>r-a)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const s=this.getDataTimestamps(),n=this.getLabelTimestamps();return s.length&&n.length?t=this.normalize(s.concat(n)):t=s.length?s:n,t=this._cache.all=t,t}getDecimalForValue(t){return(Ha(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const s=this._offsets,n=this.getDecimalForPixel(t)/s.factor-s.end;return Ha(this._table,n*this._tableRange+this._minPos,!0)}}ke(Pm,"id","timeseries"),ke(Pm,"defaults",sl.defaults);const y0="label";function Rm(e,t){typeof e=="function"?e(t):e&&(e.current=t)}function F1(e,t){const s=e.options;s&&t&&Object.assign(s,t)}function v0(e,t){e.labels=t}function b0(e,t,s=y0){const n=[];e.datasets=t.map(r=>{const a=e.datasets.find(o=>o[s]===r[s]);return!a||!r.data||n.includes(a)?{...r}:(n.push(a),Object.assign(a,r),a)})}function z1(e,t=y0){const s={labels:[],datasets:[]};return v0(s,e.labels),b0(s,e.datasets,t),s}function I1(e,t){const{height:s=150,width:n=300,redraw:r=!1,datasetIdKey:a,type:o,data:l,options:c,plugins:u=[],fallbackContent:d,updateMode:h,...f}=e,m=j.useRef(null),v=j.useRef(null),x=()=>{m.current&&(v.current=new Xs(m.current,{type:o,data:z1(l,a),options:c&&{...c},plugins:u}),Rm(t,v.current))},y=()=>{Rm(t,null),v.current&&(v.current.destroy(),v.current=null)};return j.useEffect(()=>{!r&&v.current&&c&&F1(v.current,c)},[r,c]),j.useEffect(()=>{!r&&v.current&&v0(v.current.config.data,l.labels)},[r,l.labels]),j.useEffect(()=>{!r&&v.current&&l.datasets&&b0(v.current.config.data,l.datasets,a)},[r,l.datasets]),j.useEffect(()=>{v.current&&(r?(y(),setTimeout(x)):v.current.update(h))},[r,c,l.labels,l.datasets,h]),j.useEffect(()=>{v.current&&(y(),setTimeout(x))},[o]),j.useEffect(()=>(x(),()=>y()),[]),i.jsx("canvas",{ref:m,role:"img",height:s,width:n,...f,children:d})}const $1=j.forwardRef(I1);function B1(e,t){return Xs.register(t),j.forwardRef((s,n)=>i.jsx($1,{...s,ref:n,type:e}))}const Us=B1("bar",xo);Xs.register(jn,_n,zs,Xr,qr,Wr);const H1=e=>e&&e.replace(/(?=\s|$|[,.;:!?])/g,""),U1=({results:e,loading:t,error:s,displayLimit:n,setDisplayLimit:r,onRegister:a,onCorpusSearch:o,sortBy:l,setSortBy:c,searchStats:u,sourceTextInfo:d,targetTextInfo:h,elapsedTime:f=0,progressText:m="",matchType:v="lemma"})=>{const[x,y]=j.useState({}),[g,p]=j.useState(!1),[w,b]=j.useState("target"),[k,E]=j.useState(null),_=j.useRef(null),N=j.useCallback(()=>{if(!e||e.length===0)return;const S=["Source Locus","Source Text","Target Locus","Target Text","Score","Matched Words"],V=e.map(M=>{var I,$,Q,X,F;return[M.source_locus||((I=M.source)==null?void 0:I.ref)||"",(M.source_text||M.source_snippet||(($=M.source)==null?void 0:$.text)||"").replace(/<[^>]*>/g,"").replace(/"/g,'""'),M.target_locus||((Q=M.target)==null?void 0:Q.ref)||"",(M.target_text||M.target_snippet||((X=M.target)==null?void 0:X.text)||"").replace(/<[^>]*>/g,"").replace(/"/g,'""'),((F=M.score??M.overall_score)==null?void 0:F.toFixed(3))||"",(M.matched_words||[]).map(ne=>typeof ne=="object"?ne.lemma||ne.word||"":ne).join("; ")]}),P=[S.join(","),...V.map(M=>M.map(I=>`"${I}"`).join(","))].join(`
`),O=new Blob([P],{type:"text/csv"}),A=URL.createObjectURL(O),L=document.createElement("a");L.href=A,L.download=`tesserae_results_${new Date().toISOString().slice(0,10)}.csv`,L.click(),URL.revokeObjectURL(A)},[e]),U=()=>{if(!_.current)return;const S=_.current.canvas;if(!S)return;const V=document.createElement("a"),O=w==="source"?d:h,A=((O==null?void 0:O.author)||"author").replace(/[^a-zA-Z0-9]/g,"_"),L=((O==null?void 0:O.title)||"work").replace(/[^a-zA-Z0-9]/g,"_");V.download=`tesserae_${A}_${L}_${w}_${new Date().toISOString().slice(0,10)}.png`,V.href=S.toDataURL("image/png"),V.click()},B=j.useCallback(()=>{if(!e||e.length===0)return null;const S={},V=w==="source";e.forEach(O=>{var $,Q;const A=V?O.source_locus||(($=O.source)==null?void 0:$.ref)||"":O.target_locus||((Q=O.target)==null?void 0:Q.ref)||"",L=A.match(/book\s*(\d+)/i)||A.match(/(\d+)\.\d+/)||A.match(/^([^.]+)/),I=`Book ${L?L[1]:"Other"}`;S[I]||(S[I]={count:0,totalScore:0}),S[I].count++,S[I].totalScore+=O.score??O.overall_score??0});const P=Object.keys(S).sort((O,A)=>{const L=parseInt(O.replace(/\D/g,""))||0,M=parseInt(A.replace(/\D/g,""))||0;return L-M});return{labels:P,datasets:[{label:"Parallels",data:P.map(O=>S[O].count),backgroundColor:V?"rgba(185, 28, 28, 0.7)":"rgba(217, 119, 6, 0.7)",borderColor:V?"rgb(185, 28, 28)":"rgb(217, 119, 6)",borderWidth:1}]}},[e,w]),q={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:`Distribution of Parallels from ${(d==null?void 0:d.title)||"Source"} in ${(h==null?void 0:h.title)||"Target"}`},tooltip:{callbacks:{label:S=>`${S.parsed.y} parallel${S.parsed.y!==1?"s":""}`}}},scales:{x:{title:{display:!0,text:w==="source"?(d==null?void 0:d.title)||"Source":(h==null?void 0:h.title)||"Target",font:{size:12}}},y:{beginAtZero:!0,ticks:{stepSize:1},title:{display:!0,text:"Parallels",font:{size:12}}}},onClick:(S,V)=>{if(V.length>0){const P=V[0].index,O=B();if(O){const A=O.labels[P];E({book:A,view:w})}}}},z=(S,V=null,P=[],O=!0,A=null)=>{if(!S)return"";if(typeof S=="string")return S;const{text:L,tokens:M,highlight_indices:I}=S;if(!L)return"";const $=new Set,Q=new Set;if(M&&I&&I.length>0&&I.forEach(ie=>{var R;const D=(R=M[ie])==null?void 0:R.toLowerCase();D&&$.add(D)}),P&&P.length>0&&P.forEach(ie=>{const D=O?ie.source_word:ie.target_word;if(D&&$.add(D.toLowerCase()),ie.lemma&&!ie.lemma.includes("")&&ie.lemma!=="semantic"){const R=String(ie.lemma);R.includes("[")||R.includes("~")?R.split(/[\[\],~\s]+/).filter(K=>K.length>=2).forEach(K=>Q.add(K.toLowerCase())):$.add(R.toLowerCase())}if(ie.display){const R=String(ie.display);(R.includes("[")||R.includes("~"))&&R.split(/[\[\],~\s]+/).filter(K=>K.length>=2).forEach(K=>Q.add(K.toLowerCase()))}}),(P==null?void 0:P.some(ie=>ie.similarity!==void 0||ie.lemma==="semantic"))&&A&&A.tokens&&M){const ie=new Set(M.map(R=>R==null?void 0:R.toLowerCase()).filter(Boolean)),D=new Set(A.tokens.map(R=>R==null?void 0:R.toLowerCase()).filter(Boolean));ie.forEach(R=>{if(R.length>=4){const Y=R.slice(0,Math.min(R.length-1,5));D.forEach(K=>{K.length>=4&&K.startsWith(Y)&&$.add(R)})}})}const F=ie=>{const D=ie.toLowerCase().replace(/[.,;:!?'"()-]+$/,"").replace(/^[.,;:!?'"()-]+/,"");if($.has(D))return!0;if(Q.size>0)for(const R of Q){if(D.includes(R))return!0;const Y=D.normalize("NFD").replace(/[\u0300-\u036f]/g,""),K=R.normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(Y.includes(K))return!0}if(V==="la"){const R=D.replace(/[uv]/g,"u");for(const Y of $)if(Y.replace(/[uv]/g,"u")===R)return!0}return!1};return $.size===0&&Q.size===0?L:L.split(/(\s+)/).map(ie=>/^\s+$/.test(ie)?ie:F(ie)?`<mark class="bg-yellow-200 px-0.5 rounded">${ie}</mark>`:ie).join("")},G=S=>{var P;if(!S||!S.raw)return null;const V={hexameter:"Hx",pentameter:"P",hendecasyllable:"Hn",elegiac:"E"};return i.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[i.jsx("span",{className:"font-mono text-xs text-gray-500",children:S.raw}),i.jsx("span",{className:"text-xs px-1.5 py-0.5 rounded font-medium bg-gray-100 text-gray-600",title:S.meter,children:V[S.meter]||((P=S.meter)==null?void 0:P.charAt(0).toUpperCase())||"?"})]})};if(t){const S=v==="sound"||v==="edit_distance";return i.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[S&&i.jsx("div",{className:"text-sm text-gray-600 mb-4 text-center",children:"Initial sound or edit distance searches on large texts typically take several minutes."}),i.jsx(Kt,{size:"lg",text:"Searching for parallels...",elapsedTime:f})]})}if(s)return i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700",children:s});if(!e||e.length===0)return null;const C=k?e.filter(S=>{var A,L;const V=k.view==="source"?S.source_locus||((A=S.source)==null?void 0:A.ref)||"":S.target_locus||((L=S.target)==null?void 0:L.ref)||"",P=V.match(/book\s*(\d+)/i)||V.match(/(\d+)\.\d+/)||V.match(/^([^.]+)/);return(P?`Book ${P[1]}`:"Other")===k.book}):e,W=C.slice(0,n);return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[e.length," Parallel",e.length!==1?"s":""," Found",k&&` (${C.length} in ${k.book})`]}),u&&i.jsxs("p",{className:"text-sm text-gray-500",children:[u.elapsed_time&&`Search completed in ${u.elapsed_time.toFixed(2)}s`,u.source_lines&&` | ${u.source_lines} source lines`,u.target_lines&&` | ${u.target_lines} target lines`]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>p(!g),className:`text-xs px-3 py-1.5 rounded whitespace-nowrap ${g?"bg-amber-600 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"}`,children:g?"Hide Chart":"Distribution"}),i.jsx("button",{onClick:N,className:"text-xs bg-green-600 text-white px-3 py-1.5 rounded hover:bg-green-700 whitespace-nowrap",children:"Export CSV"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Sort:"}),i.jsxs("select",{value:l,onChange:S=>c(S.target.value),className:"border rounded px-2 py-1 text-sm",children:[i.jsx("option",{value:"score",children:"Score"}),i.jsx("option",{value:"source_locus",children:"Source Location"}),i.jsx("option",{value:"target_locus",children:"Target Location"})]})]})]})]}),g&&e.length>0&&i.jsxs("div",{className:"bg-white border rounded-lg p-4 mb-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"View:"}),i.jsx("button",{onClick:()=>{b("source"),E(null)},className:`text-xs px-3 py-1 rounded ${w==="source"?"bg-red-700 text-white":"bg-red-100 text-red-600 hover:bg-red-200"}`,children:"Source"}),i.jsx("button",{onClick:()=>{b("target"),E(null)},className:`text-xs px-3 py-1 rounded ${w==="target"?"bg-amber-600 text-white":"bg-amber-100 text-amber-600 hover:bg-amber-200"}`,children:"Target"})]}),i.jsx("button",{onClick:U,className:"text-xs text-gray-600 hover:text-gray-900",title:"Export chart as PNG",children:"Export PNG"})]}),i.jsx("div",{style:{height:"200px"},children:i.jsx(Us,{ref:_,data:B()||{labels:[],datasets:[]},options:q})}),k&&i.jsxs("div",{className:"mt-3 flex items-center justify-between bg-amber-50 border border-amber-200 rounded px-3 py-2",children:[i.jsxs("span",{className:"text-sm text-amber-800",children:["Filtering to ",k.book," (",C.length," result",C.length!==1?"s":"",")"]}),i.jsx("button",{onClick:()=>E(null),className:"text-xs text-amber-600 hover:text-amber-800 font-medium",children:"Clear Filter"})]}),i.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Click a bar to filter results to that book/section"})]}),i.jsx("div",{className:"space-y-3",children:W.map((S,V)=>{var P,O,A,L,M,I;return i.jsxs("div",{className:"bg-white border rounded-lg p-4 hover:shadow-md transition-shadow",children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Source"}),i.jsx("div",{className:"font-medium text-gray-900",children:_f(S.source_locus||((P=S.source)==null?void 0:P.ref),d==null?void 0:d.language)}),i.jsx("div",{className:"text-gray-700 mt-1",dangerouslySetInnerHTML:{__html:S.source_text||S.source_snippet||z(S.source,d==null?void 0:d.language,S.matched_words,!0,S.target)}}),((O=S.features)==null?void 0:O.source_scansion)&&G(S.features.source_scansion)]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Target"}),i.jsx("div",{className:"font-medium text-gray-900",children:_f(S.target_locus||((A=S.target)==null?void 0:A.ref),h==null?void 0:h.language)}),i.jsx("div",{className:"text-gray-700 mt-1",dangerouslySetInnerHTML:{__html:S.target_text||S.target_snippet||z(S.target,h==null?void 0:h.language,S.matched_words,!1,S.source)}}),((L=S.features)==null?void 0:L.target_scansion)&&G(S.features.target_scansion)]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2 mt-3 pt-3 border-t",children:[i.jsxs("span",{className:"text-sm text-gray-600",children:["Score: ",i.jsx("span",{className:"font-medium",children:((M=S.score??S.overall_score)==null?void 0:M.toFixed(2))||"-"})]}),((I=S.features)==null?void 0:I.meter_score)>0&&i.jsxs("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded",children:["Metrical: ",(S.features.meter_score*100).toFixed(0),"%"]}),S.matched_words&&S.matched_words.length>0&&i.jsxs("span",{className:"text-sm text-gray-600",children:["Matches: ",i.jsx("span",{className:"font-medium",children:S.matched_words.map($=>{const Q=typeof $=="object"?$.lemma||$.word||$.display||JSON.stringify($):$;return H1(Q)}).join(", ")})]}),i.jsx("div",{className:"flex-1"}),S.match_basis!=="semantic"&&o&&i.jsx(go,{variant:"tertiary",size:"sm",onClick:()=>o(S),title:"Find these words together in other texts",children:"Search Corpus"}),a&&i.jsx(go,{variant:"secondary",size:"sm",onClick:()=>a(S),title:"Save this parallel to the Repository",children:"Register"})]})]},V)})}),C.length>n&&i.jsx("div",{className:"text-center mt-4",children:i.jsxs(go,{variant:"neutral",onClick:()=>r(S=>S+50),children:["Show More (",C.length-n," remaining)"]})})]})};Xs.register(jn,_n,zs,Xr,qr,Wr);const V1=["Archaic","Classical","Hellenistic","Republic","Augustan","Early Imperial","Later Imperial","Late Antique","Early Medieval","Unknown"],Ua={Archaic:"rgba(155, 35, 53, 0.7)",Classical:"rgba(224, 123, 0, 0.7)",Hellenistic:"rgba(197, 179, 88, 0.7)",Republic:"rgba(0, 105, 148, 0.7)",Augustan:"rgba(120, 81, 169, 0.7)","Early Imperial":"rgba(34, 139, 34, 0.7)","Later Imperial":"rgba(30, 144, 255, 0.7)","Late Antique":"rgba(139, 69, 19, 0.7)","Early Medieval":"rgba(112, 128, 144, 0.7)",Unknown:"rgba(128, 128, 128, 0.7)"};function Dm({language:e}){const[t,s]=j.useState("browse"),[n,r]=j.useState(""),[a,o]=j.useState([]),[l,c]=j.useState(!1),[u,d]=j.useState(null),[h,f]=j.useState("lemma"),[m,v]=j.useState(50),[x,y]=j.useState(!1),[g,p]=j.useState(null),[w,b]=j.useState(null),[k,E]=j.useState(!0),[_,N]=j.useState(!0),[U,B]=j.useState("chronological"),q=j.useRef(null),z=j.useRef(null),[G,C]=j.useState([]),[W,S]=j.useState([]),[V,P]=j.useState([]),[O,A]=j.useState(""),[L,M]=j.useState(""),[I,$]=j.useState(""),[Q,X]=j.useState(""),[F,ne]=j.useState(""),[ue,ie]=j.useState(!0),[D,R]=j.useState([]),[Y,K]=j.useState(!1),[te,ce]=j.useState(0),de=j.useRef(null);j.useEffect(()=>{if(l){const H=Date.now();ce(0),de.current=setInterval(()=>{ce(Math.floor((Date.now()-H)/1e3))},1e3)}else de.current&&(clearInterval(de.current),de.current=null);return()=>{de.current&&clearInterval(de.current)}},[l]);const[he,re]=j.useState(100),[fe,ye]=j.useState(!1),[ae,xe]=j.useState(!1),[be,Ne]=j.useState(null);j.useEffect(()=>{Ce(),A(""),M(""),$(""),R([]),r(""),o([]),d(null),Ne(null)},[e]),j.useEffect(()=>{const H=sessionStorage.getItem("tesserae_goto_query"),se=sessionStorage.getItem("tesserae_goto_text");if((H||se)&&(sessionStorage.removeItem("tesserae_goto_query"),sessionStorage.removeItem("tesserae_goto_text"),H&&(r(H),s("search")),se&&G.length>0)){const oe=G.find(me=>me.id===se);oe&&(A(oe.author),M(oe.id),$(oe.title||oe.work||oe.display_name))}},[G]),j.useEffect(()=>{if(O){const H=G.filter(se=>se.author===O).map(se=>({id:se.id,label:se.title||se.work||se.display_name,display:se.display_name||`${se.author}, ${se.title||se.work}`})).sort((se,oe)=>{const me=_e=>{const T=_e.match(/(\d+)/);return T?parseInt(T[1],10):0},je=se.label.replace(/,?\s*(Book|Part)?\s*\d+$/,""),Ie=oe.label.replace(/,?\s*(Book|Part)?\s*\d+$/,"");return je!==Ie?je.localeCompare(Ie):me(se.label)-me(oe.label)});P(H),H.find(se=>se.id===L)||(M(""),$(""))}else P([]),M(""),$("")},[O,G]);const Ce=async()=>{ie(!0);try{const se=await(await fetch(`/api/texts?language=${e}`)).json(),oe=Array.isArray(se)?se:se.texts||[];C(oe);const me=[...new Set(oe.map(je=>je.author))].filter(Boolean).sort();S(me)}catch(H){console.error("Failed to load texts:",H)}ie(!1)},ve=async()=>{if(n.trim()){c(!0),d(null),p(null);try{const H={query:n.trim(),language:e,search_type:h};O&&(H.author=O),L&&(H.work=L),Q&&(H.line_start=parseInt(Q)),F&&(H.line_end=parseInt(F));const oe=await(await fetch("/api/line-search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(H)})).json();oe.error?(d(oe.error),o([])):o(oe.results||[])}catch{d("Search failed. Please try again."),o([])}c(!1)}},Me=async()=>{if(!(!O||!L)){K(!0),R([]);try{const se=await(await fetch(`/api/text/${L}/lines`)).json();se.lines&&R(se.lines)}catch(H){console.error("Failed to load lines:",H)}K(!1)}},Pe=async H=>{const se=H.text||"";r(se),s("search");const oe=V.find(je=>je.id===L),me={author:O,work:(oe==null?void 0:oe.label)||L,text_id:L,locus:H.locus||H.ref||"",text:se};if(Ne(me),!!se.trim()){c(!0),d(null),p(null);try{const je={query:se.trim(),language:e,search_type:h,exclude_text_id:L,exclude_locus:H.locus||H.ref||""},_e=await(await fetch("/api/line-search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(je)})).json();_e.error?(d(_e.error),o([])):o(_e.results||[])}catch{d("Search failed. Please try again."),o([])}c(!1)}},et=()=>{A(""),M(""),X(""),ne("")},Re=j.useMemo(()=>a.filter((H,se,oe)=>n&&H.text===n?!1:se===oe.findIndex(me=>me.text===H.text&&me.locus===H.locus)),[a,n]),qs=j.useCallback(()=>{const H=["Author","Work","Locus","Text","Era"],se=a.map(_e=>{var T;return[_e.author||"",_e.work||"",_e.locus||"",((T=_e.text)==null?void 0:T.replace(/"/g,'""'))||"",_e.era||""]}),oe=[H,...se].map(_e=>_e.map(T=>`"${T}"`).join(",")).join(`
`),me=new Blob([oe],{type:"text/csv"}),je=URL.createObjectURL(me),Ie=document.createElement("a");Ie.href=je,Ie.download=`line_search_${n}.csv`,Ie.click(),URL.revokeObjectURL(je)},[a,n]),Z=()=>{if(!q.current)return;const H=q.current.canvas;if(!H)return;const se=document.createElement("a");se.download=`tesserae_timeline_${n}_${new Date().toISOString().slice(0,10)}.png`,se.href=H.toDataURL("image/png"),se.click()},ge=j.useCallback(()=>{if(!Re||Re.length===0)return null;const H={};Re.forEach(oe=>{const me=oe.era||"Unknown";H[me]=(H[me]||0)+1});const se=V1.filter(oe=>H[oe]>0);return{labels:se,datasets:[{label:"Matches",data:se.map(oe=>H[oe]),backgroundColor:se.map(oe=>Ua[oe]||Ua.Unknown),borderColor:se.map(oe=>(Ua[oe]||Ua.Unknown).replace("0.7","1")),borderWidth:1}]}},[Re]),ze=j.useCallback(()=>{if(!Re||Re.length===0)return null;const H={};Re.forEach(oe=>{const me=oe.author||"Unknown";H[me]=(H[me]||0)+1});const se=Object.keys(H).sort((oe,me)=>{const je=Re.find(J=>J.author===oe),Ie=Re.find(J=>J.author===me),_e=(je==null?void 0:je.year)||9999,T=(Ie==null?void 0:Ie.year)||9999;return _e!==T?_e-T:oe.localeCompare(me)});return{labels:se,datasets:[{label:"Matches",data:se.map(oe=>H[oe]),backgroundColor:"rgba(120, 81, 169, 0.7)",borderColor:"rgba(120, 81, 169, 1)",borderWidth:1}]}},[Re]),tt={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:g?`Showing matches from ${g} (click to clear)`:"Period Timeline (click bar to filter)"},tooltip:{callbacks:{label:H=>`${H.parsed.y} match${H.parsed.y!==1?"es":""}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}},onClick:(H,se)=>{if(se.length>0){const oe=se[0].index,me=ge();if(me){const je=me.labels[oe];p(g===je?null:je),b(null)}}}},st={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:w?`Showing matches from ${w} (click to clear)`:"Author Timeline (click bar to filter)"},tooltip:{callbacks:{label:H=>`${H.parsed.y} match${H.parsed.y!==1?"es":""}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}},x:{ticks:{maxRotation:45,minRotation:45}}},onClick:(H,se)=>{if(se.length>0){const oe=se[0].index,me=ze();if(me){const je=me.labels[oe];b(w===je?null:je),p(null)}}}},Je=H=>{if(!H)return"";const se=H.match(/[\d]+(?:[.\-:]+[\d\w]+)*$/);return se?se[0]:H.trim().split(/\s+/).pop()||H},Ge=(H,se)=>{if(!H)return H;const oe=Je(se);if(!oe)return H;const me=H.match(/^(.+?)\s+(\d+)$/);if(me){const[,je,Ie]=me;if(oe.startsWith(Ie+".")||oe.startsWith(Ie+":"))return je}return H},Ve=(H,se)=>{if(!H||!se||se.length===0)return H;const oe=_e=>_e?_e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,""):"",me=_e=>{if(!_e)return"";let T=_e.toLowerCase();return e==="la"?T=T.replace(/v/g,"u").replace(/j/g,"i"):e==="grc"&&(T=oe(_e)),T},je=new Set(se.map(_e=>me(_e)));return H.split(/(\s+)/).map((_e,T)=>{if(/^\s+$/.test(_e))return i.jsx("span",{children:_e},T);let J;e==="grc"?J=_e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\u0370-\u03FF\u1F00-\u1FFFa-zA-Z]/g,""):J=_e.replace(/[^a-zA-Z\u0370-\u03FF\u1F00-\u1FFF]/g,"");const pe=me(J);return pe&&je.has(pe)?i.jsx("mark",{className:"bg-amber-200 px-0.5 rounded",children:_e},T):i.jsx("span",{children:_e},T)})},Oe=j.useMemo(()=>{const H=Re.filter(se=>{if(g&&(se.era||"Unknown")!==g||w&&se.author!==w)return!1;const oe=se.is_poetry!==!1;return!(!k&&oe||!_&&!oe)});return U==="alphabetical"?[...H].sort((se,oe)=>{const me=(se.author||"").localeCompare(oe.author||"");return me!==0?me:(se.work||"").localeCompare(oe.work||"")}):[...H].sort((se,oe)=>{const me=se.year||9999,je=oe.year||9999;return me!==je?me-je:(se.author||"").localeCompare(oe.author||"")})},[Re,g,w,k,_,U]);return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 p-1 rounded-lg inline-flex",children:[i.jsx("button",{onClick:()=>s("browse"),className:`px-3 py-1.5 text-sm font-medium rounded ${t==="browse"?"bg-white shadow text-red-700":"text-gray-600 hover:text-gray-800"}`,children:"Find Text to Search"}),i.jsx("button",{onClick:()=>s("search"),className:`px-3 py-1.5 text-sm font-medium rounded ${t==="search"?"bg-white shadow text-red-700":"text-gray-600 hover:text-gray-800"}`,children:"Input Search Text"})]}),t==="search"?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6 space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Terms"}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[i.jsx("input",{type:"text",value:n,onChange:H=>r(H.target.value),onKeyDown:H=>H.key==="Enter"&&ve(),placeholder:"Enter word or phrase...",className:"flex-1 border rounded px-4 py-2"}),i.jsxs("select",{value:h,onChange:H=>f(H.target.value),className:"border rounded px-3 py-2 text-sm",children:[i.jsx("option",{value:"lemma",children:"Lemma (dictionary form)"}),i.jsx("option",{value:"exact",children:"Exact match"}),i.jsx("option",{value:"regex",children:"Regular expression"})]})]}),be&&i.jsxs("div",{className:"mt-2 flex items-center justify-between text-sm text-gray-600 bg-gray-50 rounded px-3 py-2",children:[i.jsxs("span",{children:[i.jsx("span",{className:"font-medium",children:be.author}),be.work&&i.jsxs("span",{className:"italic",children:[", ",Ge(be.work,be.locus)]}),be.locus&&i.jsxs("span",{children:[", ",Je(be.locus)]})]}),i.jsx("button",{onClick:()=>Ne(null),className:"text-gray-400 hover:text-gray-600 ml-2",children:"Clear"})]})]}),i.jsxs("div",{className:"border-t pt-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Filter by Text (Optional)"}),(O||L||Q||F)&&i.jsx("button",{onClick:et,className:"text-xs text-red-600 hover:text-red-800",children:"Clear Filters"})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Author"}),i.jsxs("select",{value:O,onChange:H=>A(H.target.value),className:"w-full border rounded px-3 py-2 text-sm",disabled:ue,children:[i.jsx("option",{value:"",children:"All Authors"}),W.map(H=>i.jsx("option",{value:H,children:H},H))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Work"}),i.jsxs("select",{value:L,onChange:H=>M(H.target.value),className:"w-full border rounded px-3 py-2 text-sm",disabled:!O||ue,children:[i.jsx("option",{value:"",children:"All Works"}),V.map(H=>i.jsx("option",{value:H.id,children:H.label},H.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Line Start"}),i.jsx("input",{type:"number",value:Q,onChange:H=>X(H.target.value),placeholder:"e.g., 1",className:"w-full border rounded px-3 py-2 text-sm",min:"1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Line End"}),i.jsx("input",{type:"number",value:F,onChange:H=>ne(H.target.value),placeholder:"e.g., 100",className:"w-full border rounded px-3 py-2 text-sm",min:"1"})]})]})]}),i.jsx("div",{className:"border-t pt-4 flex justify-end",children:i.jsx("button",{onClick:ve,disabled:!n.trim()||l,className:"px-6 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:opacity-50",children:l?"Searching...":"Search Lines"})})]}),l&&i.jsx(Kt,{text:"Searching corpus...",elapsedTime:te,step:"Finding matching lines"}),u&&i.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:u}),a.length>0&&i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsxs("div",{className:"px-4 py-3 bg-gray-50 flex flex-wrap items-center justify-between gap-2",children:[i.jsxs("span",{className:"text-sm text-gray-600",children:["Found ",a.length," parallel lines",Oe.length!==a.length&&i.jsxs("span",{className:"text-amber-600",children:[" (showing ",Oe.length," after filters)"]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("label",{className:"flex items-center gap-1 text-sm text-gray-600",children:[i.jsx("input",{type:"checkbox",checked:k,onChange:H=>E(H.target.checked),className:"rounded"}),"Poetry"]}),i.jsxs("label",{className:"flex items-center gap-1 text-sm text-gray-600",children:[i.jsx("input",{type:"checkbox",checked:_,onChange:H=>N(H.target.checked),className:"rounded"}),"Prose"]}),i.jsxs("select",{value:U,onChange:H=>B(H.target.value),className:"text-sm border rounded px-2 py-1",children:[i.jsx("option",{value:"chronological",children:"By Era"}),i.jsx("option",{value:"alphabetical",children:"A-Z"})]}),i.jsx("button",{onClick:()=>y(!x),className:`text-sm px-3 py-1 rounded ${x?"bg-amber-700 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"}`,children:x?"Hide Timelines":"Show Timelines"}),i.jsx("button",{onClick:qs,className:"text-sm text-amber-600 hover:text-amber-800",children:"Export CSV"})]})]}),x&&Re.some(H=>H.era)&&i.jsxs("div",{className:"p-4 border-b bg-gray-50 space-y-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Period Timeline"}),i.jsx("div",{style:{height:"180px"},children:i.jsx(Us,{ref:q,data:ge()||{labels:[],datasets:[]},options:tt})})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Author Timeline"}),i.jsx("div",{style:{height:"180px"},children:i.jsx(Us,{ref:z,data:ze()||{labels:[],datasets:[]},options:st})})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{onClick:Z,className:"text-xs text-gray-600 hover:text-gray-900",children:"Export PNG"})})]}),(g||w)&&i.jsxs("div",{className:"px-4 py-2 bg-amber-50 border-b flex items-center justify-between",children:[i.jsxs("span",{className:"text-sm text-amber-800",children:["Showing ",Oe.length," matches from ",g||w]}),i.jsx("button",{onClick:()=>{p(null),b(null)},className:"text-xs text-amber-600 hover:text-amber-800 font-medium",children:"Clear Filter"})]}),i.jsx("div",{className:"divide-y divide-gray-200",children:Oe.slice(0,m).map((H,se)=>i.jsx("div",{className:"p-4 hover:bg-gray-50",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-2",children:[i.jsxs("div",{className:"sm:w-48 flex-shrink-0",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:H.author}),i.jsxs("div",{className:"text-xs text-gray-500",children:[H.work,", ",H.locus]}),H.era&&i.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded mt-1 inline-block",children:H.era})]}),i.jsx("div",{className:"flex-1 text-gray-700",children:Ve(H.text,H.matched_words||n.split(/\s+/))})]})},se))}),Oe.length>m&&i.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center",children:i.jsxs("button",{onClick:()=>v(m+50),className:"text-amber-600 hover:text-amber-800 text-sm",children:["Show more (",m," of ",Oe.length,")"]})})]})]}):i.jsxs("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6 space-y-4",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Find Text to Search"}),i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Select an author and work to view all lines. Click any line to use it as a search term."})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Author"}),i.jsx("input",{type:"text",value:O,onChange:H=>{A(H.target.value),M(""),$(""),R([]),ye(!0)},onFocus:()=>ye(!0),onBlur:()=>setTimeout(()=>ye(!1),200),placeholder:"Type to search authors...",className:"w-full border rounded px-3 py-2",disabled:ue}),fe&&O!==""&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[W.filter(H=>H.toLowerCase().includes(O.toLowerCase())).slice(0,20).map(H=>i.jsx("div",{className:"px-3 py-2 hover:bg-amber-50 cursor-pointer text-sm",onMouseDown:()=>{A(H),ye(!1)},children:H},H)),W.filter(H=>H.toLowerCase().includes(O.toLowerCase())).length===0&&i.jsx("div",{className:"px-3 py-2 text-gray-500 text-sm",children:"No authors found"})]}),fe&&O===""&&i.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:W.slice(0,20).map(H=>i.jsx("div",{className:"px-3 py-2 hover:bg-amber-50 cursor-pointer text-sm",onMouseDown:()=>{A(H),ye(!1)},children:H},H))})]}),i.jsxs("div",{className:"relative",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Work"}),i.jsx("input",{type:"text",value:I,onChange:H=>{$(H.target.value),M(""),R([]),xe(!0)},onFocus:()=>xe(!0),onBlur:()=>setTimeout(()=>xe(!1),200),placeholder:O?"Type to search works...":"Select author first",className:"w-full border rounded px-3 py-2",disabled:!O||ue}),ae&&O&&i.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[V.filter(H=>H.label.toLowerCase().includes(I.toLowerCase())).map(H=>i.jsx("div",{className:"px-3 py-2 hover:bg-amber-50 cursor-pointer text-sm",onMouseDown:()=>{M(H.id),$(H.label),xe(!1)},children:H.label},H.id)),V.filter(H=>H.label.toLowerCase().includes(I.toLowerCase())).length===0&&i.jsx("div",{className:"px-3 py-2 text-gray-500 text-sm",children:"No works found"})]})]})]}),i.jsx("div",{className:"flex justify-end",children:i.jsx("button",{onClick:Me,disabled:!O||!L||Y,className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:opacity-50",children:Y?"Loading...":"Load Lines"})}),Y&&i.jsx(Kt,{text:"Loading lines..."}),D.length>0&&i.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[i.jsx("div",{className:"px-4 py-2 bg-gray-50 border-b flex justify-between items-center",children:i.jsxs("span",{className:"text-sm text-gray-600",children:[D.length," lines found"]})}),i.jsx("div",{className:"max-h-96 overflow-y-auto divide-y",children:D.slice(0,he).map((H,se)=>i.jsxs("div",{className:"p-3 hover:bg-amber-50 cursor-pointer flex gap-3",onClick:()=>Pe(H),children:[i.jsx("span",{className:"text-xs text-gray-400 w-16 flex-shrink-0 text-right",children:H.locus}),i.jsx("span",{className:"text-sm text-gray-700 flex-1",children:H.text})]},se))}),D.length>he&&i.jsx("div",{className:"px-4 py-2 bg-gray-50 border-t text-center",children:i.jsxs("button",{onClick:()=>re(he+100),className:"text-amber-600 hover:text-amber-800 text-sm",children:["Show more (",he," of ",D.length,")"]})})]})]})]})}Xs.register(jn,_n,zs,Xr,qr,Wr);const Om=(e,t)=>{if(!e||e.length===0)return"";const s=new Set(t||[]);return e.map((n,r)=>s.has(r)?`<mark class="bg-yellow-200 px-0.5 rounded">${n}</mark>`:n).join(" ")};function W1(){const[e,t]=j.useState({grc:[],la:[]}),[s,n]=j.useState(!0),[r,a]=j.useState(!1),[o,l]=j.useState([]),[c,u]=j.useState(null),[d,h]=j.useState(""),[f,m]=j.useState(""),[v,x]=j.useState(""),[y,g]=j.useState(""),[p,w]=j.useState(""),[b,k]=j.useState(""),[E,_]=j.useState("ai"),[N,U]=j.useState(2),[B,q]=j.useState(50),[z,G]=j.useState("score"),[C,W]=j.useState(!1),[S,V]=j.useState("target"),[P,O]=j.useState(null),A=j.useRef(null),L=j.useRef(!1),M=j.useRef(E),I=j.useCallback(async R=>{if(!v||!b){u("Please select both source and target texts");return}a(!0),u(null);try{const te=await(await fetch("/api/search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:v,target:b,source_language:"grc",target_language:"la",match_type:R==="ai"?"semantic_cross":"dictionary_cross",min_matches:N})})).json();te.error?(u(te.error),l([])):l(te.results||[])}catch{u("Search failed. Please try again.")}a(!1)},[v,b,N]);j.useEffect(()=>{$()},[]),j.useEffect(()=>{M.current!==E&&(M.current=E,L.current&&v&&b&&!r&&I(E))},[E,v,b,r,I]);const $=async()=>{var R,Y,K,te,ce,de,he,re,fe,ye;n(!0);try{const[ae,xe]=await Promise.all([fetch("/api/texts/hierarchy?language=grc"),fetch("/api/texts/hierarchy?language=la")]),be=await ae.json(),Ne=await xe.json();if(t({grc:be.authors||[],la:Ne.authors||[]}),((R=be.authors)==null?void 0:R.length)>0){const Ce=be.authors.find(ve=>ve.author_key==="homer")||be.authors[0];if(h(Ce.author_key),((Y=Ce.works)==null?void 0:Y.length)>0){const ve=Ce.works.find(Pe=>Pe.work_key==="iliad")||Ce.works[0];m(ve.work_key);const Me=(K=ve.parts)==null?void 0:K.find(Pe=>{var et,Re;return((et=Pe.id)==null?void 0:et.includes(".part.1."))||((Re=Pe.id)==null?void 0:Re.endsWith(".1.tess"))});x((Me==null?void 0:Me.id)||ve.whole_text||((ce=(te=ve.parts)==null?void 0:te[0])==null?void 0:ce.id)||"")}}if(((de=Ne.authors)==null?void 0:de.length)>0){const Ce=Ne.authors.find(ve=>ve.author_key==="vergil")||Ne.authors[0];if(g(Ce.author_key),((he=Ce.works)==null?void 0:he.length)>0){const ve=Ce.works.find(Pe=>Pe.work_key==="aeneid")||Ce.works[0];w(ve.work_key);const Me=(re=ve.parts)==null?void 0:re.find(Pe=>{var et,Re;return((et=Pe.id)==null?void 0:et.includes(".part.1."))||((Re=Pe.id)==null?void 0:Re.endsWith(".1.tess"))});k((Me==null?void 0:Me.id)||ve.whole_text||((ye=(fe=ve.parts)==null?void 0:fe[0])==null?void 0:ye.id)||"")}}}catch(ae){console.error("Failed to load text hierarchies:",ae)}n(!1)},Q=(R,Y)=>{const K=R.find(te=>te.author_key===Y);return K?K.works:[]},X=(R,Y,K)=>{const ce=Q(R,Y).find(de=>de.work_key===K);return ce?{wholeText:ce.whole_text,parts:ce.parts||[],workName:ce.work}:{wholeText:null,parts:[],workName:""}},F=()=>{L.current=!0,I(E)},ne=j.useCallback(()=>{const R=["Score","Greek Locus","Greek Text","Latin Locus","Latin Text","Similarity","Matched Words"],Y=o.map(he=>{var re,fe,ye,ae,xe,be,Ne;return[((re=he.overall_score||he.score)==null?void 0:re.toFixed(3))||"",((fe=he.source)==null?void 0:fe.ref)||he.source_locus||"",(((ye=he.source)==null?void 0:ye.text)||he.source_text||"").replace(/"/g,'""'),((ae=he.target)==null?void 0:ae.ref)||he.target_locus||"",(((xe=he.target)==null?void 0:xe.text)||he.target_text||"").replace(/"/g,'""'),((Ne=((be=he.features)==null?void 0:be.semantic_score)||he.similarity)==null?void 0:Ne.toFixed(3))||"",(he.matched_words||[]).map(Ce=>Ce.display||`${Ce.greek_word}${Ce.latin_word}`).join("; ")]}),K=[R,...Y].map(he=>he.map(re=>`"${re}"`).join(",")).join(`
`),te=new Blob([K],{type:"text/csv"}),ce=URL.createObjectURL(te),de=document.createElement("a");de.href=ce,de.download="cross_lingual_results.csv",de.click(),URL.revokeObjectURL(ce)},[o]),ue=j.useMemo(()=>{if(!o||o.length===0)return[];let R=P?o.filter(Y=>{var de,he;const K=P.view==="source"?((de=Y.source)==null?void 0:de.ref)||Y.source_locus||"":((he=Y.target)==null?void 0:he.ref)||Y.target_locus||"",te=K.match(/(\d+)\.\d+/)||K.match(/book\s*(\d+)/i);return(te?`Book ${te[1]}`:"Other")===P.book}):o;return z==="score"?[...R].sort((Y,K)=>(K.overall_score||K.score||0)-(Y.overall_score||Y.score||0)):z==="source"?[...R].sort((Y,K)=>{var te,ce;return(((te=Y.source)==null?void 0:te.ref)||Y.source_locus||"").localeCompare(((ce=K.source)==null?void 0:ce.ref)||K.source_locus||"")}):[...R].sort((Y,K)=>{var te,ce;return(((te=Y.target)==null?void 0:te.ref)||Y.target_locus||"").localeCompare(((ce=K.target)==null?void 0:ce.ref)||K.target_locus||"")})},[o,z,P]),ie=j.useCallback(()=>{if(!o||o.length===0)return null;const R={},Y=S==="source";o.forEach(te=>{var fe,ye;const ce=Y?((fe=te.source)==null?void 0:fe.ref)||te.source_locus||"":((ye=te.target)==null?void 0:ye.ref)||te.target_locus||"",de=ce.match(/(\d+)\.\d+/)||ce.match(/book\s*(\d+)/i),re=`Book ${de?de[1]:"Other"}`;R[re]||(R[re]={count:0,totalScore:0}),R[re].count++,R[re].totalScore+=te.overall_score||te.score||0});const K=Object.keys(R).sort((te,ce)=>{const de=parseInt(te.replace("Book ",""))||999,he=parseInt(ce.replace("Book ",""))||999;return de-he});return{labels:K,datasets:[{label:"Parallels",data:K.map(te=>R[te].count),backgroundColor:Y?"rgba(217, 119, 6, 0.7)":"rgba(185, 28, 28, 0.7)"}]}},[o,S]),D={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1}},scales:{x:{title:{display:!0,text:S==="source"?"Greek Source":"Latin Target"}},y:{beginAtZero:!0,ticks:{precision:0}}},onClick:(R,Y)=>{if(Y.length>0){const K=ie();if(K){const te=K.labels[Y[0].index];O((P==null?void 0:P.book)===te?null:{book:te,view:S})}}}};return s?i.jsx(Kt,{text:"Loading text data..."}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Cross-Lingual Search (Greek  Latin)"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Find semantic parallels between Greek and Latin texts using AI-powered matching"})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[i.jsx("h3",{className:"text-lg font-medium text-amber-700 mb-4",children:"Greek Source"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Author"}),i.jsx(_u,{value:d,onChange:R=>{var K,te;h(R);const Y=Q(e.grc,R);Y.length>0&&(m(Y[0].work_key),x(Y[0].whole_text||((te=(K=Y[0].parts)==null?void 0:K[0])==null?void 0:te.id)||""))},authors:e.grc})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Work"}),i.jsx("select",{value:f,onChange:R=>{var te;m(R.target.value);const{wholeText:Y,parts:K}=X(e.grc,d,R.target.value);x(Y||((te=K[0])==null?void 0:te.id)||"")},className:"w-full border rounded px-3 py-2",children:Q(e.grc,d).map(R=>i.jsx("option",{value:R.work_key,children:R.work},R.work_key))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Section"}),i.jsx("select",{value:v,onChange:R=>x(R.target.value),className:"w-full border rounded px-3 py-2",children:(()=>{const{wholeText:R,parts:Y,workName:K}=X(e.grc,d,f);return i.jsxs(i.Fragment,{children:[R&&i.jsxs("option",{value:R,children:[K," (Complete)"]}),Y.map(te=>i.jsx("option",{value:te.id,children:te.display},te.id))]})})()})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[i.jsx("h3",{className:"text-lg font-medium text-red-700 mb-4",children:"Latin Target"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Author"}),i.jsx(_u,{value:y,onChange:R=>{var K,te;g(R);const Y=Q(e.la,R);Y.length>0&&(w(Y[0].work_key),k(Y[0].whole_text||((te=(K=Y[0].parts)==null?void 0:K[0])==null?void 0:te.id)||""))},authors:e.la})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Work"}),i.jsx("select",{value:p,onChange:R=>{var te;w(R.target.value);const{wholeText:Y,parts:K}=X(e.la,y,R.target.value);k(Y||((te=K[0])==null?void 0:te.id)||"")},className:"w-full border rounded px-3 py-2",children:Q(e.la,y).map(R=>i.jsx("option",{value:R.work_key,children:R.work},R.work_key))})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Section"}),i.jsx("select",{value:b,onChange:R=>k(R.target.value),className:"w-full border rounded px-3 py-2",children:(()=>{const{wholeText:R,parts:Y,workName:K}=X(e.la,y,p);return i.jsxs(i.Fragment,{children:[R&&i.jsxs("option",{value:R,children:[K," (Complete)"]}),Y.map(te=>i.jsx("option",{value:te.id,children:te.display},te.id))]})})()})]})]})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("label",{className:"text-sm text-gray-600",children:"Match Mode:"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>{E!=="ai"&&(_("ai"),L.current&&v&&b&&I("ai"))},disabled:!0,title:"Coming soon - AI semantic matching will be available in a future update",className:"px-4 py-2 rounded text-sm bg-gray-100 text-gray-400 cursor-not-allowed",children:"AI Semantic (Coming Soon)"}),i.jsx("button",{onClick:()=>{E!=="dictionary"&&(_("dictionary"),L.current&&v&&b&&I("dictionary"))},disabled:r,className:`px-4 py-2 rounded text-sm ${E==="dictionary"?"bg-red-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"} disabled:opacity-50`,children:"Dictionary"})]}),i.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[i.jsx("label",{className:"text-sm text-gray-600",children:"Min Word Matches:"}),i.jsxs("select",{value:N,onChange:R=>U(parseInt(R.target.value)),className:"px-2 py-1 border rounded text-sm",children:[i.jsx("option",{value:2,children:"2"}),i.jsx("option",{value:3,children:"3"}),i.jsx("option",{value:4,children:"4"}),i.jsx("option",{value:5,children:"5"})]})]})]}),i.jsx("button",{onClick:F,disabled:r||!v||!b,className:"px-6 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:opacity-50",children:r?"Searching...":"Find Cross-Lingual Parallels"})]}),c&&i.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:c}),r&&i.jsx(Kt,{text:"Searching for cross-lingual parallels..."}),o.length>0&&i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsxs("div",{className:"px-4 py-3 bg-gray-50 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[i.jsxs("span",{className:"text-sm text-gray-600",children:["Found ",o.length," cross-lingual parallels",P&&` (${ue.length} in ${P.book})`]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[i.jsx("button",{onClick:()=>W(!C),className:`text-xs px-3 py-1.5 rounded ${C?"bg-amber-600 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"}`,children:C?"Hide Chart":"Distribution"}),i.jsx("button",{onClick:ne,className:"text-xs bg-red-700 text-white px-3 py-1.5 rounded hover:bg-red-800",children:"Export CSV"}),i.jsx("span",{className:"text-xs text-gray-500",children:"Sort:"}),i.jsxs("select",{value:z,onChange:R=>G(R.target.value),className:"text-xs border rounded px-2 py-1",children:[i.jsx("option",{value:"score",children:"Score"}),i.jsx("option",{value:"source",children:"Greek Locus"}),i.jsx("option",{value:"target",children:"Latin Locus"})]})]})]}),C&&i.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"View:"}),i.jsx("button",{onClick:()=>{V("source"),O(null)},className:`text-xs px-3 py-1 rounded ${S==="source"?"bg-amber-600 text-white":"bg-gray-200"}`,children:"Greek Source"}),i.jsx("button",{onClick:()=>{V("target"),O(null)},className:`text-xs px-3 py-1 rounded ${S==="target"?"bg-red-700 text-white":"bg-gray-200"}`,children:"Latin Target"}),P&&i.jsx("button",{onClick:()=>O(null),className:"text-xs text-red-600 hover:text-red-800",children:"Clear Filter"})]}),i.jsx("div",{style:{height:"200px"},children:i.jsx(Us,{ref:A,data:ie()||{labels:[],datasets:[]},options:D})})]}),i.jsx("div",{className:"divide-y divide-gray-200",children:ue.slice(0,B).map((R,Y)=>{var K,te,ce,de,he,re,fe,ye,ae,xe,be,Ne,Ce,ve;return i.jsxs("div",{className:"p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("span",{className:"text-sm font-medium text-gray-500",children:["Score: ",(K=R.overall_score||R.score)==null?void 0:K.toFixed(3)]}),(((te=R.features)==null?void 0:te.semantic_score)||R.similarity)&&i.jsxs("span",{className:"text-xs bg-amber-100 text-amber-700 px-2 py-1 rounded",children:["Similarity: ",((((ce=R.features)==null?void 0:ce.semantic_score)||R.similarity)*100).toFixed(1),"%"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-amber-50 p-3 rounded",children:[i.jsx("div",{className:"text-xs text-amber-600 mb-1",children:((de=R.source)==null?void 0:de.ref)||R.source_locus}),(he=R.source)!=null&&he.tokens&&((fe=(re=R.source)==null?void 0:re.highlight_indices)==null?void 0:fe.length)>0?i.jsx("div",{className:"text-gray-800",dangerouslySetInnerHTML:{__html:Om(R.source.tokens,R.source.highlight_indices)}}):i.jsx("div",{className:"text-gray-800",children:((ye=R.source)==null?void 0:ye.text)||R.source_text||""})]}),i.jsxs("div",{className:"bg-red-50 p-3 rounded",children:[i.jsx("div",{className:"text-xs text-red-600 mb-1",children:((ae=R.target)==null?void 0:ae.ref)||R.target_locus}),(xe=R.target)!=null&&xe.tokens&&((Ne=(be=R.target)==null?void 0:be.highlight_indices)==null?void 0:Ne.length)>0?i.jsx("div",{className:"text-gray-800",dangerouslySetInnerHTML:{__html:Om(R.target.tokens,R.target.highlight_indices)}}):i.jsx("div",{className:"text-gray-800",children:((Ce=R.target)==null?void 0:Ce.text)||R.target_text||""})]})]}),((ve=R.matched_words)==null?void 0:ve.length)>0&&i.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Matched: ",R.matched_words.map(Me=>Me.display||`${Me.greek_word}  ${Me.latin_word}`).join(", ")]})]},Y)})}),ue.length>B&&i.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center",children:i.jsxs("button",{onClick:()=>q(B+50),className:"text-amber-600 hover:text-amber-800 text-sm",children:["Show more (",B," of ",ue.length,")"]})})]})]})}Xs.register(jn,_n,zs,Xr,qr,Wr);const X1=["Archaic","Classical","Hellenistic","Republic","Augustan","Early Imperial","Later Imperial","Late Antique","Early Medieval","Unknown"],q1={Archaic:"rgba(155, 35, 53, 0.7)",Classical:"rgba(224, 123, 0, 0.7)",Hellenistic:"rgba(197, 179, 88, 0.7)",Republic:"rgba(0, 105, 148, 0.7)",Augustan:"rgba(120, 81, 169, 0.7)","Early Imperial":"rgba(34, 139, 34, 0.7)","Later Imperial":"rgba(30, 144, 255, 0.7)","Late Antique":"rgba(139, 69, 19, 0.7)","Early Medieval":"rgba(112, 128, 144, 0.7)",Unknown:"rgba(128, 128, 128, 0.7)"},Fm=({language:e})=>{var $,Q;const[t,s]=j.useState(()=>{const X=sessionStorage.getItem("tesserae_goto_query");return X?(sessionStorage.removeItem("tesserae_goto_query"),X):""}),[n,r]=j.useState(null),[a,o]=j.useState(!1),[l,c]=j.useState(null),[u,d]=j.useState(!1),[h,f]=j.useState(200),[m,v]=j.useState(""),[x,y]=j.useState(!0),[g,p]=j.useState(!0),[w,b]=j.useState(!1),[k,E]=j.useState("chronological"),[_,N]=j.useState(null),[U,B]=j.useState(null),[q,z]=j.useState(50),G=j.useRef(null),C=j.useRef(null);j.useEffect(()=>{r(null),c(null),N(null),B(null)},[e]);const W=async()=>{if(t.trim()){o(!0),c(null),N(null),B(null),z(50);try{const X=await Gb({query:t.trim(),language:e,target_text:m||null,case_sensitive:u,max_results:h});X.error?c(X.error):r(X)}catch(X){c("Search failed: "+X.message)}o(!1)}},S=j.useMemo(()=>{if(!(n!=null&&n.results))return[];let X=n.results.filter(F=>{if(_&&(F.era||"Unknown")!==_||U&&F.author!==U)return!1;const ne=F.is_poetry!==!1;return!(!x&&ne||!g&&!ne)});return k==="alphabetical"?[...X].sort((F,ne)=>{const ue=(F.author||"").localeCompare(ne.author||"");return ue!==0?ue:(F.title||"").localeCompare(ne.title||"")}):[...X].sort((F,ne)=>{const ue=F.year||9999,ie=ne.year||9999;return ue!==ie?ue-ie:(F.author||"").localeCompare(ne.author||"")})},[n,_,U,x,g,k]),V=(n==null?void 0:n.results)||[],P=j.useCallback(()=>{if(!V||V.length===0)return null;const X={};V.forEach(ne=>{const ue=ne.era||"Unknown";X[ue]=(X[ue]||0)+1});const F=X1.filter(ne=>X[ne]);return{labels:F,datasets:[{label:"Matches by Era",data:F.map(ne=>X[ne]||0),backgroundColor:F.map(ne=>q1[ne]||"rgba(128,128,128,0.7)")}]}},[V]),O=j.useCallback(()=>{if(!V||V.length===0)return null;const X={};V.forEach(ne=>{const ue=ne.author||"Unknown";X[ue]=(X[ue]||0)+1});const F=Object.keys(X).sort((ne,ue)=>{const ie=V.find(K=>K.author===ne),D=V.find(K=>K.author===ue),R=(ie==null?void 0:ie.year)||9999,Y=(D==null?void 0:D.year)||9999;return R!==Y?R-Y:ne.localeCompare(ue)});return{labels:F,datasets:[{label:"Matches by Author",data:F.map(ne=>X[ne]||0),backgroundColor:"rgba(155, 35, 53, 0.7)"}]}},[V]),A=j.useCallback(()=>{if(!S||S.length===0)return;const X=["Author","Title","Era","Locus","Text","Poetry/Prose"],F=S.map(R=>[R.author||"",R.title||"",R.era||"Unknown",R.locus||"",(R.text||"").replace(/<[^>]*>/g,"").replace(/"/g,'""'),R.is_poetry!==!1?"Poetry":"Prose"]),ne=[X.join(","),...F.map(R=>R.map(Y=>`"${Y}"`).join(","))].join(`
`),ue=new Blob([ne],{type:"text/csv"}),ie=URL.createObjectURL(ue),D=document.createElement("a");D.href=ie,D.download=`tesserae_wildcard_${t.replace(/[^a-zA-Z0-9]/g,"_")}_${new Date().toISOString().slice(0,10)}.csv`,D.click(),URL.revokeObjectURL(ie)},[S,t]),L={responsive:!0,maintainAspectRatio:!1,onClick:(X,F)=>{if(F.length>0){const ne=P();if(ne){const ue=F[0].index,ie=ne.labels[ue];N(_===ie?null:ie),B(null)}}},plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{precision:0}}}},M={responsive:!0,maintainAspectRatio:!1,onClick:(X,F)=>{if(F.length>0){const ne=O();if(ne){const ue=F[0].index,ie=ne.labels[ue];B(U===ie?null:ie),N(null)}}},plugins:{legend:{display:!1}},scales:{y:{beginAtZero:!0,ticks:{precision:0}}}},I=e==="la"?"Latin":e==="grc"?"Greek":"English";return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold mb-2",children:"String Search"}),i.jsxs("p",{className:"text-gray-600 text-sm",children:["Search for words and patterns across the entire ",I," corpus using wildcards and boolean operators."]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-sm",children:[i.jsx("h4",{className:"font-medium mb-2",children:"Search Syntax"}),i.jsxs("ul",{className:"space-y-1 text-gray-600",children:[i.jsxs("li",{children:[i.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"*"})," matches any characters (e.g., ",i.jsx("code",{children:"am*"})," finds amor, amicus, etc.)"]}),i.jsxs("li",{children:[i.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"?"})," matches single character (e.g., ",i.jsx("code",{children:"am?r"})," finds amor, amer)"]}),i.jsxs("li",{children:[i.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"AND"})," both terms required (e.g., ",i.jsx("code",{children:"amor AND bellum"}),")"]}),i.jsxs("li",{children:[i.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"OR"})," either term (e.g., ",i.jsx("code",{children:"rex OR regina"}),")"]}),i.jsxs("li",{children:[i.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"~"})," proximity search (e.g., ",i.jsx("code",{children:"amor ~ dolor"})," finds words within ~100 characters)"]}),i.jsxs("li",{children:[i.jsx("code",{className:"bg-gray-200 px-1 rounded",children:'"..."'})," exact phrase (e.g., ",i.jsx("code",{children:'"arma virumque"'}),")"]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:t,onChange:X=>s(X.target.value),onKeyDown:X=>X.key==="Enter"&&t.trim()&&W(),placeholder:"Enter search query...",className:"flex-1 border rounded px-3 py-2"}),i.jsx("button",{onClick:W,disabled:a||!t.trim(),className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:opacity-50",children:a?"Searching...":"Search"})]}),i.jsxs("div",{className:"flex flex-wrap gap-4 text-sm",children:[i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:u,onChange:X=>d(X.target.checked),className:"rounded"}),"Case sensitive"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-600",children:"Max results:"}),i.jsx("input",{type:"number",value:h,onChange:X=>f(parseInt(X.target.value)||200),className:"w-20 border rounded px-2 py-1"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-600",children:"Limit to text:"}),i.jsx("input",{type:"text",value:m,onChange:X=>v(X.target.value),placeholder:"e.g., vergil.aeneid",className:"w-40 border rounded px-2 py-1"})]})]})]}),l&&i.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded",children:l}),a&&i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-red-700"}),i.jsx("span",{className:"ml-3 text-gray-600",children:"Searching corpus..."})]}),!a&&n&&i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsxs("div",{className:"px-4 py-3 bg-gray-50 flex flex-wrap items-center justify-between gap-2",children:[i.jsxs("span",{className:"text-sm text-gray-600",children:["Found ",n.total_matches," match",n.total_matches!==1?"es":"",n.truncated&&i.jsxs("span",{className:"text-amber-600 ml-1",children:["(showing first ",($=n.results)==null?void 0:$.length,")"]}),S.length!==((Q=n.results)==null?void 0:Q.length)&&i.jsxs("span",{className:"text-amber-600 ml-1",children:["(showing ",S.length," after filters)"]}),i.jsxs("span",{className:"text-gray-400 ml-2",children:["(",n.texts_searched,"/",n.total_texts," texts in ",n.search_time,"s)"]})]}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("label",{className:"flex items-center gap-1 text-sm text-gray-600",children:[i.jsx("input",{type:"checkbox",checked:x,onChange:X=>y(X.target.checked),className:"rounded"}),"Poetry"]}),i.jsxs("label",{className:"flex items-center gap-1 text-sm text-gray-600",children:[i.jsx("input",{type:"checkbox",checked:g,onChange:X=>p(X.target.checked),className:"rounded"}),"Prose"]}),i.jsxs("select",{value:k,onChange:X=>E(X.target.value),className:"text-sm border rounded px-2 py-1",children:[i.jsx("option",{value:"chronological",children:"By Era"}),i.jsx("option",{value:"alphabetical",children:"A-Z"})]}),i.jsx("button",{onClick:()=>b(!w),className:`text-sm px-3 py-1 rounded ${w?"bg-amber-700 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"}`,children:w?"Hide Timelines":"Show Timelines"}),i.jsx("button",{onClick:A,className:"text-sm bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700",children:"Export CSV"})]})]}),w&&V.some(X=>X.era)&&i.jsxs("div",{className:"p-4 border-b bg-gray-50 space-y-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Period Timeline"}),i.jsx("div",{style:{height:"180px"},children:i.jsx(Us,{ref:G,data:P()||{labels:[],datasets:[]},options:L})})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Author Timeline"}),i.jsx("div",{style:{height:"180px"},children:i.jsx(Us,{ref:C,data:O()||{labels:[],datasets:[]},options:M})})]})]}),(_||U)&&i.jsxs("div",{className:"px-4 py-2 bg-amber-50 border-b flex items-center justify-between",children:[i.jsxs("span",{className:"text-sm text-amber-800",children:["Showing ",S.length," matches from ",_||U]}),i.jsx("button",{onClick:()=>{N(null),B(null)},className:"text-xs text-amber-600 hover:text-amber-800 font-medium",children:"Clear Filter"})]}),i.jsx("div",{className:"divide-y divide-gray-200 max-h-[600px] overflow-y-auto",children:S.slice(0,q).map((X,F)=>{var ie;const ne=((ie=X.reference)==null?void 0:ie.split(/\s+/))||[],ue=ne[ne.length-1]||X.reference||"";return i.jsx("div",{className:"p-4 hover:bg-gray-50",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-2",children:[i.jsxs("div",{className:"sm:w-48 flex-shrink-0",children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:X.author||X.display_name}),i.jsxs("div",{className:"text-xs text-gray-500",children:[X.title&&i.jsx("span",{className:"italic",children:X.title}),ue&&i.jsxs("span",{children:[", ",ue]})]}),X.era&&i.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded mt-1 inline-block",children:X.era})]}),i.jsx("div",{className:"flex-1 text-gray-700",dangerouslySetInnerHTML:{__html:X.highlighted_text||X.text}})]})},F)})}),S.length>q&&i.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center",children:i.jsxs("button",{onClick:()=>z(q+50),className:"text-amber-600 hover:text-amber-800 text-sm",children:["Show more (",q," of ",S.length,")"]})})]})]})},Y1=({sourceAuthor:e,sourceText:t,targetAuthor:s,targetText:n,settings:r,activeTab:a,onLoad:o})=>{const[l,c]=j.useState(!1),[u,d]=j.useState(()=>{try{return JSON.parse(localStorage.getItem("tesserae_saved_searches")||"[]")}catch{return[]}}),[h,f]=j.useState(""),m=()=>{if(!h.trim())return;const g={id:Date.now(),name:h.trim(),created_at:new Date().toISOString(),language:a,sourceAuthor:e,sourceText:t,targetAuthor:s,targetText:n,settings:r},p=[...u,g];d(p),localStorage.setItem("tesserae_saved_searches",JSON.stringify(p)),f(""),c(!1)},v=g=>{o(g),c(!1)},x=g=>{const p=u.filter(w=>w.id!==g);d(p),localStorage.setItem("tesserae_saved_searches",JSON.stringify(p))},y=e&&t&&s&&n;return i.jsxs(i.Fragment,{children:[i.jsxs("button",{onClick:()=>c(!0),className:"text-sm text-gray-600 hover:text-red-700 underline",children:["Saved Searches (",u.length,")"]}),l&&i.jsx(Gi,{onClose:()=>c(!1),title:"Saved Searches",children:i.jsxs("div",{className:"space-y-4",children:[y&&i.jsxs("div",{className:"bg-gray-50 p-4 rounded border",children:[i.jsx("h4",{className:"font-medium text-sm mb-2",children:"Save Current Search"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:h,onChange:g=>f(g.target.value),placeholder:"Enter search name...",className:"flex-1 border rounded px-3 py-2 text-sm"}),i.jsx("button",{onClick:m,disabled:!h.trim(),className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:opacity-50 text-sm",children:"Save"})]}),i.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Current: ",e," vs ",s]})]}),u.length===0?i.jsx("p",{className:"text-gray-500 text-center py-4",children:"No saved searches yet."}):i.jsx("div",{className:"divide-y max-h-80 overflow-y-auto",children:u.map(g=>i.jsxs("div",{className:"py-3 flex items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("div",{className:"font-medium text-gray-900 truncate",children:g.name}),i.jsxs("div",{className:"text-xs text-gray-500",children:[g.sourceAuthor," vs ",g.targetAuthor," | ",g.language==="la"?"Latin":g.language==="grc"?"Greek":"English"]}),i.jsxs("div",{className:"text-xs text-gray-400",children:["Saved ",new Date(g.created_at).toLocaleDateString()]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>v(g),className:"px-3 py-1.5 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-sm",children:"Load"}),i.jsx("button",{onClick:()=>x(g.id),className:"px-3 py-1.5 bg-red-100 text-red-700 rounded hover:bg-red-200 text-sm",children:"Delete"})]})]},g.id))})]})})]})},zm={hom:{author:"Homer"},homer:{author:"Homer"},hes:{author:"Hesiod"},hesiod:{author:"Hesiod"},aesch:{author:"Aeschylus"},aeschylus:{author:"Aeschylus"},soph:{author:"Sophocles"},sophocles:{author:"Sophocles"},eur:{author:"Euripides"},euripides:{author:"Euripides"},ar:{author:"Aristophanes"},aristophanes:{author:"Aristophanes"},pind:{author:"Pindar"},pindar:{author:"Pindar"},theoc:{author:"Theocritus"},theocritus:{author:"Theocritus"},callim:{author:"Callimachus"},callimachus:{author:"Callimachus"},apoll:{author:"Apollonius"},apollonius:{author:"Apollonius"},plat:{author:"Plato"},plato:{author:"Plato"},arist:{author:"Aristotle"},aristotle:{author:"Aristotle"},thuc:{author:"Thucydides"},thucydides:{author:"Thucydides"},hdt:{author:"Herodotus"},herodotus:{author:"Herodotus"},xen:{author:"Xenophon"},xenophon:{author:"Xenophon"},plut:{author:"Plutarch"},plutarch:{author:"Plutarch"},verg:{author:"Vergil",work:"Aeneid"},aen:{work:"Aeneid"},ecl:{work:"Eclogues"},georg:{work:"Georgics"},luc:{author:"Lucan",work:"Bellum Civile"},ov:{author:"Ovid"},ovid:{author:"Ovid"},met:{work:"Metamorphoses"},am:{work:"Amores"},ars:{work:"Ars Amatoria"},fast:{work:"Fasti"},trist:{work:"Tristia"},her:{work:"Heroides"},pont:{work:"Epistulae ex Ponto"},rem:{work:"Remedia Amoris"},ib:{work:"Ibis"},stat:{author:"Statius"},theb:{work:"Thebaid"},ach:{work:"Achilleid"},silv:{work:"Silvae"},sil:{author:"Silius Italicus",work:"Punica"},val:{author:"Valerius Flaccus"},flac:{work:"Argonautica"},lucr:{author:"Lucretius",work:"De Rerum Natura"},cat:{author:"Catullus",work:"Carmina"},catu:{author:"Catullus",work:"Carmina"},tib:{author:"Tibullus",work:"Elegies"},prop:{author:"Propertius",work:"Elegies"},hor:{author:"Horace"},horat:{author:"Horace"},carm:{work:"Carmina"},sat:{work:"Satires"},epist:{work:"Epistles"},ars_poet:{work:"Ars Poetica"},epod:{work:"Epodes"},pers:{author:"Persius",work:"Satires"},juv:{author:"Juvenal",work:"Satires"},iuv:{author:"Juvenal",work:"Satires"},mart:{author:"Martial",work:"Epigrammata"},phaedr:{author:"Phaedrus",work:"Fabulae"},manil:{author:"Manilius",work:"Astronomica"},sen:{author:"Seneca"},med:{work:"Medea"},herc:{work:"Hercules Furens"},troad:{work:"Troades"},phoen:{work:"Phoenissae"},phaed:{work:"Phaedra"},oed:{work:"Oedipus"},agam:{work:"Agamemnon"},thy:{work:"Thyestes"},oct:{work:"Octavia"},plaut:{author:"Plautus"},ter:{author:"Terence"},enn:{author:"Ennius",work:"Annales"},cic:{author:"Cicero"},caes:{author:"Caesar"},liv:{author:"Livy",work:"Ab Urbe Condita"},sall:{author:"Sallust"},tac:{author:"Tacitus"},suet:{author:"Suetonius"},nep:{author:"Cornelius Nepos"},quint:{author:"Quintilian",work:"Institutio Oratoria"},plin:{author:"Pliny"},apul:{author:"Apuleius"},petron:{author:"Petronius",work:"Satyricon"},gell:{author:"Aulus Gellius",work:"Noctes Atticae"},macr:{author:"Macrobius",work:"Saturnalia"},boeth:{author:"Boethius"},claud:{author:"Claudian"},prud:{author:"Prudentius"},auson:{author:"Ausonius"},drac:{author:"Dracontius"},sidon:{author:"Sidonius Apollinaris"},ven:{author:"Venantius Fortunatus"},fort:{author:"Venantius Fortunatus"},corip:{author:"Corippus"},sedul:{author:"Sedulius"},juven:{author:"Juvencus"},alcim:{author:"Alcimus Avitus"},ambr:{author:"Ambrose"},hier:{author:"Jerome"},aug:{author:"Augustine"},hrab:{author:"Hrabanus Maurus"},hildeb:{author:"Hildebert of Lavardin"},alan:{author:"Alan of Lille"},bern:{author:"Bernard Silvestris"},walt:{author:"Walter of Chtillon"}},Im={il:"Iliad",iliad:"Iliad",od:"Odyssey",odyssey:"Odyssey",theog:"Theogony",theogony:"Theogony",wd:"Works and Days",works:"Works and Days",ag:"Agamemnon",agamemnon:"Agamemnon",cho:"Choephoroe",lib:"Libation Bearers",eum:"Eumenides",pers:"Persae",prom:"Prometheus Bound",sept:"Seven Against Thebes",supp:"Suppliants",aj:"Ajax",ant:"Antigone",el:"Electra",ot:"Oedipus Tyrannus",oc:"Oedipus at Colonus",phil:"Philoctetes",trach:"Trachiniae",alc:"Alcestis",andr:"Andromache",ba:"Bacchae",cycl:"Cyclops",hec:"Hecuba",hel:"Helen",heracl:"Heraclidae",hf:"Heracles",hipp:"Hippolytus",ion:"Ion",ia:"Iphigenia in Aulis",it:"Iphigenia in Tauris",med:"Medea",or:"Orestes",phoen:"Phoenissae",rhes:"Rhesus",tro:"Troades",aeneid:"Aeneid",aen:"Aeneid",eclogues:"Eclogues",ecl:"Eclogues",georgics:"Georgics",georg:"Georgics",bellum_civile:"Bellum Civile",pharsalia:"Bellum Civile",metamorphoses:"Metamorphoses",met:"Metamorphoses",amores:"Amores",ars_amatoria:"Ars Amatoria",fasti:"Fasti",tristia:"Tristia",heroides:"Heroides",thebaid:"Thebaid",theb:"Thebaid",achilleid:"Achilleid",silvae:"Silvae",punica:"Punica",argonautica:"Argonautica",de_rerum_natura:"De Rerum Natura",carmina:"Carmina",satires:"Satires",epistles:"Epistles",epigrammata:"Epigrammata",fabulae:"Fabulae",astronomica:"Astronomica",annales:"Annales",de_bello_gallico:"De Bello Gallico",de_bello_civili:"De Bello Civili",ab_urbe_condita:"Ab Urbe Condita",satyricon:"Satyricon",noctes_atticae:"Noctes Atticae",saturnalia:"Saturnalia",institutio_oratoria:"Institutio Oratoria",confessiones:"Confessiones",de_civitate_dei:"De Civitate Dei",consolatio:"Consolation of Philosophy"};function G1(e){if(!e)return{work:"",reference:e||""};const t=e.toLowerCase().split(/[\s.]+/);let s=null,n=null,r="";for(let a=0;a<t.length;a++){const o=t[a].replace(/[.,]/g,"");if(zm[o]){const l=zm[o];l.author&&!s&&(s=l.author),l.work&&!n&&(n=l.work)}else if(Im[o]&&!n)n=Im[o];else if(/^\d/.test(o)){r=t.slice(a).join(".");break}}return{author:s,work:n,reference:r}}function wc(e,t){const s=G1(t),n=e||s.author||"Unknown",r=s.work||"",a=s.reference||t;return r?{author:n,work:r,reference:a}:{author:n,work:"",reference:a}}Xs.register(jn,_n,zs,Xr,qr,Wr);const $m=e=>e&&e.replace(/(?=\s|$|[,.;:!?])/g,""),Bm=e=>e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(//g,""):"",jc=(e,t)=>{if(!e||!t||t.length===0)return e;const s=t.map(r=>Bm(r));return e.split(/(\s+)/).map((r,a)=>{if(/^\s+$/.test(r))return i.jsx("span",{children:r},a);const o=Bm(r.replace(/[,.;:!?'"()]/g,""));return o.length<2?i.jsx("span",{children:r},a):s.some(c=>!!(o===c||o.startsWith(c)&&o.length<=c.length+3||c.startsWith(o)&&c.length<=o.length+3))?i.jsx("mark",{className:"bg-yellow-200 px-0.5 rounded",children:r},a):i.jsx("span",{children:r},a)})},K1=(e,t,s)=>{if(!t||!s||s.length===0)return e;new Set(s);const n=new Set(s.map(a=>{var o;return(o=t[a])==null?void 0:o.toLowerCase()}).filter(Boolean));return e.split(/(\s+)/).map((a,o)=>{if(/^\s+$/.test(a))return i.jsx("span",{children:a},o);const l=a.replace(/[,.;:!?'"()\[\]<>]/g,"").toLowerCase();return n.has(l)?i.jsx("mark",{className:"bg-yellow-200 px-0.5 rounded",children:a},o):i.jsx("span",{children:a},o)})},Q1=["Archaic","Classical","Hellenistic","Republic","Augustan","Early Imperial","Later Imperial","Late Antique","Early Medieval","Unknown"],Va={Archaic:"rgba(155, 35, 53, 0.7)",Classical:"rgba(224, 123, 0, 0.7)",Hellenistic:"rgba(197, 179, 88, 0.7)",Republic:"rgba(0, 105, 148, 0.7)",Augustan:"rgba(120, 81, 169, 0.7)","Early Imperial":"rgba(34, 139, 34, 0.7)","Later Imperial":"rgba(30, 144, 255, 0.7)","Late Antique":"rgba(139, 69, 19, 0.7)","Early Medieval":"rgba(112, 128, 144, 0.7)",Unknown:"rgba(128, 128, 128, 0.7)"};function J1({results:e,loading:t,error:s,query:n,onBack:r,elapsedTime:a}){var z,G,C,W,S,V,P,O;const[o,l]=j.useState(50),[c,u]=j.useState(!1),[d,h]=j.useState(null),[f,m]=j.useState(null),[v,x]=j.useState(!0),[y,g]=j.useState(!0),p=j.useRef(null),w=j.useRef(null),b=(e||[]).filter(A=>!(!v&&A.is_poetry||!y&&!A.is_poetry)),k=j.useCallback(()=>{if(!b||b.length===0)return null;const A={};b.forEach(M=>{const I=M.era||"Unknown";A[I]=(A[I]||0)+1});const L=Q1.filter(M=>A[M]>0);return{labels:L,datasets:[{label:"Matches",data:L.map(M=>A[M]),backgroundColor:L.map(M=>Va[M]||Va.Unknown),borderColor:L.map(M=>(Va[M]||Va.Unknown).replace("0.7","1")),borderWidth:1}]}},[b]),E={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:d?`Showing matches from ${d} (click to clear)`:"Chronological Distribution (click bar to filter)"}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}},onClick:(A,L)=>{if(L.length>0){const M=L[0].index,I=k();if(I){const $=I.labels[M];h(d===$?null:$),m(null)}}}},_=j.useCallback(()=>{if(!b||b.length===0)return null;const A={};b.forEach(M=>{const I=M.author||"Unknown";A[I]=(A[I]||0)+1});const L=Object.keys(A).sort((M,I)=>{const $=b.find(ne=>ne.author===M),Q=b.find(ne=>ne.author===I),X=($==null?void 0:$.year)||9999,F=(Q==null?void 0:Q.year)||9999;return X!==F?X-F:M.localeCompare(I)});return{labels:L,datasets:[{label:"Matches",data:L.map(M=>A[M]),backgroundColor:"rgba(120, 81, 169, 0.7)",borderColor:"rgba(120, 81, 169, 1)",borderWidth:1}]}},[b]),N={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:f?`Showing matches from ${f} (click to clear)`:"Author Timeline (click bar to filter)"},tooltip:{callbacks:{label:A=>`${A.parsed.y} match${A.parsed.y!==1?"es":""}`}}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}},x:{ticks:{maxRotation:45,minRotation:45}}},onClick:(A,L)=>{if(L.length>0){const M=L[0].index,I=_();if(I){const $=I.labels[M];m(f===$?null:$),h(null)}}}},U=j.useCallback(()=>{var X;if(!e||e.length===0)return;const A=["Author","Work","Locus","Text","Era","Year"],L=e.map(F=>[F.author||"",F.work||"",F.locus||"",(F.text||"").replace(/"/g,'""'),F.era||"",F.year||""]),M=[A,...L].map(F=>F.map(ne=>`"${ne}"`).join(",")).join(`
`),I=new Blob([M],{type:"text/csv"}),$=URL.createObjectURL(I),Q=document.createElement("a");Q.href=$,Q.download=`tesserae_corpus_${((X=n==null?void 0:n.lemmas)==null?void 0:X.join("_"))||"search"}.csv`,Q.click(),URL.revokeObjectURL($)},[e,n]),B=()=>{if(!p.current)return;const A=p.current.canvas;if(!A)return;const L=document.createElement("a");L.download=`tesserae_corpus_timeline_${new Date().toISOString().slice(0,10)}.png`,L.href=A.toDataURL("image/png"),L.click()},q=b.filter(A=>!(d&&(A.era||"Unknown")!==d||f&&(A.author||"Unknown")!==f));return t?i.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:i.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[i.jsx("div",{className:"w-10 h-10 border-4 border-gray-200 border-t-amber-600 rounded-full animate-spin mb-4"}),i.jsx("p",{className:"text-gray-600",children:"Searching corpus for matching word combinations..."}),a>0&&i.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:["Elapsed: ",a,"s"]})]})}):i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"p-4 border-b bg-gray-50",children:i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[i.jsx("button",{onClick:r,className:"text-amber-600 hover:text-amber-800 text-sm flex items-center gap-1",children:" Back to Search"}),i.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Corpus-Wide Search"})]})}),n&&i.jsx("div",{className:"p-4 border-b bg-amber-50",children:(G=(z=n.source)==null?void 0:z.ref)!=null&&G.includes("Rare Word")||(W=(C=n.source)==null?void 0:C.ref)!=null&&W.includes("Rare Pair")?i.jsxs("div",{className:"mb-3",children:[i.jsx("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Searching corpus for occurrences of:"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:(S=n.lemmas)==null?void 0:S.map((A,L)=>i.jsx("span",{className:"text-lg font-semibold bg-amber-200 text-amber-800 px-3 py-1 rounded",children:$m(A)},L))})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mb-3",children:[i.jsxs("div",{children:[(()=>{var L;const A=wc(null,(L=n.source)==null?void 0:L.ref);return i.jsxs("div",{className:"text-xs font-bold text-green-700 mb-1",children:["Source: ",A.author,", ",i.jsx("span",{className:"italic",children:A.work})," ",A.reference]})})(),i.jsx("div",{className:"text-sm text-gray-700",children:jc((V=n.source)==null?void 0:V.text,n.lemmas)})]}),i.jsxs("div",{children:[(()=>{var L;const A=wc(null,(L=n.target)==null?void 0:L.ref);return i.jsxs("div",{className:"text-xs font-bold text-red-700 mb-1",children:["Target: ",A.author,", ",i.jsx("span",{className:"italic",children:A.work})," ",A.reference]})})(),i.jsx("div",{className:"text-sm text-gray-700",children:jc((P=n.target)==null?void 0:P.text,n.lemmas)})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-1 mt-2",children:[i.jsx("span",{className:"text-xs text-gray-600",children:"Searching for:"}),(O=n.lemmas)==null?void 0:O.map((A,L)=>i.jsx("span",{className:"text-xs bg-amber-200 text-amber-800 px-2 py-0.5 rounded font-medium",children:$m(A)},L))]})]})}),s&&i.jsx("div",{className:"p-4 bg-red-50 text-red-700",children:s}),!t&&!s&&e&&i.jsxs("div",{className:"p-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-4",children:[i.jsxs("span",{className:"text-sm text-gray-600",children:["Found ",i.jsx("strong",{children:e.length})," occurrences across the corpus",e.length>500&&" (showing first 500)",(d||!v||!y)&&q.length!==e.length&&i.jsxs("span",{className:"text-amber-700",children:[" (showing ",q.length," after filters)"]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[i.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:v,onChange:A=>x(A.target.checked),className:"w-4 h-4 text-amber-600 rounded border-gray-300 focus:ring-amber-500"}),i.jsx("span",{className:"text-gray-700",children:"Poetry"})]}),i.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:y,onChange:A=>g(A.target.checked),className:"w-4 h-4 text-amber-600 rounded border-gray-300 focus:ring-amber-500"}),i.jsx("span",{className:"text-gray-700",children:"Prose"})]})]}),i.jsx("button",{onClick:()=>u(!c),className:`text-sm px-3 py-1 rounded ${c?"bg-amber-700 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"}`,children:c?"Hide Timeline":"Timeline"}),i.jsx("button",{onClick:U,className:"text-sm text-green-600 hover:text-green-800",children:"Export CSV"})]})]}),c&&e.some(A=>A.era)&&i.jsxs("div",{className:"p-4 border rounded bg-gray-50 mb-4",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Period Timeline"}),i.jsx("div",{style:{height:"180px"},children:i.jsx(Us,{ref:p,data:k()||{labels:[],datasets:[]},options:E})})]}),i.jsxs("div",{className:"mb-2",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Author Timeline"}),i.jsx("div",{style:{height:"180px"},children:i.jsx(Us,{ref:w,data:_()||{labels:[],datasets:[]},options:N})})]}),i.jsx("div",{className:"flex justify-end mt-2",children:i.jsx("button",{onClick:B,className:"text-xs text-gray-600 hover:text-gray-900",children:"Export PNG"})})]}),(d||f)&&i.jsxs("div",{className:"px-4 py-2 bg-amber-50 border border-amber-200 rounded mb-4 flex items-center justify-between",children:[i.jsxs("span",{className:"text-sm text-amber-800",children:["Showing ",q.length," matches from ",d||f]}),i.jsx("button",{onClick:()=>{h(null),m(null)},className:"text-xs text-amber-600 hover:text-amber-800 font-medium",children:"Clear Filter"})]}),i.jsx("div",{className:"divide-y border rounded",children:q.slice(0,o).map((A,L)=>i.jsx("div",{className:"p-3 hover:bg-gray-50",children:i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start gap-2",children:[i.jsxs("div",{className:"sm:w-48 flex-shrink-0",children:[(()=>{const M=wc(A.author,A.locus);return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"text-sm font-medium text-gray-900",children:M.author}),i.jsxs("div",{className:"text-xs text-gray-500",children:[M.work&&i.jsx("span",{className:"italic",children:M.work}),M.work&&M.reference&&" ",M.reference]})]})})(),A.era&&i.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-gray-100 text-gray-600 rounded mt-1 inline-block",children:A.era})]}),i.jsx("div",{className:"flex-1 text-sm text-gray-700",children:A.tokens&&A.highlight_indices&&A.highlight_indices.length>0?K1(A.text,A.tokens,A.highlight_indices):jc(A.text,(n==null?void 0:n.lemmas)||A.matched_lemmas||[])})]})},L))}),q.length>o&&i.jsx("div",{className:"text-center mt-4",children:i.jsxs(go,{variant:"neutral",onClick:()=>l(A=>A+50),children:["Show More (",q.length-o," remaining)"]})})]})]})}Xs.register(jn,_n,zs,Xr,qr,Wr);const _c=e=>e&&e.replace(/(?=\s|$|[,.;:!?])/g,""),Hm=(e,t,s,n)=>{if(!e||!(t!=null&&t.length)&&!s&&!n)return e;const r=new Set;if(s){const o=s.toLowerCase();r.add(o),r.add(o.replace(/u/g,"v")),r.add(o.replace(/v/g,"u"))}if(n){const o=n.toLowerCase();r.add(o),r.add(o.replace(/u/g,"v")),r.add(o.replace(/v/g,"u"))}return t&&t.forEach(o=>{if(o){const l=o.toLowerCase();r.add(l),r.add(l.replace(/u/g,"v")),r.add(l.replace(/v/g,"u"))}}),r.size===0?e:e.split(/(\s+)/).map((o,l)=>{const c=o.match(/^([^\w]*)(\w+)([^\w]*)$/);if(!c)return o;const[,u,d,h]=c,f=d.toLowerCase(),m=f.replace(/v/g,"u");f.replace(/u/g,"v");let v=!1;for(const x of r){const y=x.replace(/v/g,"u");if(x.length<=3){if(m===y||m.startsWith(y)&&m.length<=y.length+4){v=!0;break}}else if(m===y||m.startsWith(y)||y.startsWith(m)){v=!0;break}}return v?i.jsxs("span",{children:[u,i.jsx("span",{className:"bg-yellow-200 px-0.5 rounded font-medium",children:d}),h]},l):o})},Um=e=>{var a;if(!e)return"";const s=e.replace(".tess","").split("."),n=((a=s[0])==null?void 0:a.replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase()))||"";let r="";return s.length>1&&(s[1]==="part"&&s[2]?r=`Book ${s[2]}`:(r=s[1].replace(/_/g," ").replace(/\b\w/g,o=>o.toUpperCase()),s[2]==="part"&&s[3]&&(r+=`, Book ${s[3]}`))),r?`${n}, ${r}`:n},Vm=(e,t)=>{if(!e)return"";const s=e.match(/(\d+(?:\.\d+)?(?:\s*\([^)]*\))?)$/),n=s?s[1]:e;return`${t} ${n}`},Z1=({results:e,loading:t,error:s,displayLimit:n,setDisplayLimit:r,searchMode:a,sourceText:o,targetText:l,onRegister:c,onCorpusSearch:u,elapsedTime:d=0})=>{const[h,f]=j.useState(!1),[m,v]=j.useState("target"),x=j.useRef(null),y=a==="hapax",g=y?"Shared Rare Words":"Shared Rare Pairs",p=j.useCallback(()=>{if(!e||e.length===0)return;const _=y?["Lemma","Display Form","Corpus Frequency","Source Occurrences","Target Occurrences","Source Locations","Target Locations"]:["Word Pair","Rarity %","Source Occurrences","Target Occurrences","Source Locations","Target Locations"],N=e.map(G=>{var S;const C=(G.source_locations||[]).map(V=>V.ref).join("; "),W=(G.target_locations||[]).map(V=>V.ref).join("; ");return y?[G.lemma||"",G.display_form||"",G.corpus_count||G.corpus_frequency||"",G.source_occurrences||0,G.target_occurrences||0,C,W]:[G.bigram||`${G.word1} + ${G.word2}`||"",((S=G.rarity_percent)==null?void 0:S.toFixed(1))||"",G.source_occurrences||0,G.target_occurrences||0,C,W]}),U=[_.join(","),...N.map(G=>G.map(C=>`"${String(C).replace(/"/g,'""')}"`).join(","))].join(`
`),B=new Blob([U],{type:"text/csv"}),q=URL.createObjectURL(B),z=document.createElement("a");z.href=q,z.download=`tesserae_${y?"rare_words":"rare_pairs"}_${new Date().toISOString().slice(0,10)}.csv`,z.click(),URL.revokeObjectURL(q)},[e,y]),w=()=>{if(!x.current)return;const _=x.current.canvas;if(!_)return;const N=document.createElement("a");N.download=`tesserae_${y?"rare_words":"rare_pairs"}_timeline_${new Date().toISOString().slice(0,10)}.png`,N.href=_.toDataURL("image/png"),N.click()},b=j.useCallback(()=>{if(!e||e.length===0)return null;const _={},N=m==="source";e.forEach(B=>{const q=N?B.source_locations:B.target_locations;q&&q.forEach(z=>{const G=z.ref||"",C=G.match(/book\s*(\d+)/i)||G.match(/(\d+)\.\d+/)||G.match(/^([^.]+)/),W=C?C[1]:"Other",S=isNaN(parseInt(W))?W:`Book ${W}`;_[S]||(_[S]=0),_[S]++})});const U=Object.keys(_).sort((B,q)=>{const z=parseInt(B.replace(/\D/g,""))||999,G=parseInt(q.replace(/\D/g,""))||999;return z-G});return{labels:U,datasets:[{label:`${y?"Rare Words":"Rare Pairs"} by Location`,data:U.map(B=>_[B]),backgroundColor:y?"rgba(217, 119, 6, 0.7)":"rgba(126, 34, 206, 0.7)",borderColor:y?"rgb(217, 119, 6)":"rgb(126, 34, 206)",borderWidth:1}]}},[e,m,y]),k=_=>{if(!u)return;const N=y?_.lemma||_.display_form:_.bigram||`${_.word1} ${_.word2}`;u(N)};if(t)return i.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-700 mb-4"}),i.jsxs("p",{className:"text-gray-600",children:["Searching for ",y?"rare words":"rare pairs","..."]}),d>0&&i.jsxs("p",{className:"text-sm text-gray-500 mt-2",children:[d.toFixed(1),"s"]})]});if(s)return i.jsxs("div",{className:"text-red-600 p-4 bg-red-50 rounded-lg",children:[i.jsx("p",{className:"font-medium",children:"Search Error"}),i.jsx("p",{className:"text-sm mt-1",children:s})]});if(!e||e.length===0)return i.jsxs("div",{className:"text-center py-8 text-gray-500",children:["No shared ",y?"rare words":"rare pairs"," found between these texts."]});const E=b();return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 mb-4",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:[e.length," ",g.replace("Shared ","")," Found"]}),d>0&&i.jsxs("p",{className:"text-sm text-gray-500",children:["Search completed in ",d.toFixed(2),"s"]})]}),i.jsx("div",{className:"flex flex-col sm:flex-row gap-2",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>f(!h),className:`text-xs px-3 py-1.5 rounded whitespace-nowrap ${h?"bg-amber-600 text-white":"bg-amber-100 text-amber-700 hover:bg-amber-200"}`,children:h?"Hide Chart":"Distribution"}),i.jsx("button",{onClick:p,className:"text-xs bg-amber-600 text-white px-3 py-1.5 rounded hover:bg-amber-700 whitespace-nowrap",children:"Export CSV"})]})})]}),h&&E&&i.jsxs("div",{className:"bg-white border rounded-lg p-4 mb-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-3",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm font-medium text-gray-700",children:"View:"}),i.jsx("button",{onClick:()=>v("source"),className:`text-xs px-3 py-1 rounded ${m==="source"?"bg-red-700 text-white":"bg-red-100 text-red-600 hover:bg-red-200"}`,children:"Source"}),i.jsx("button",{onClick:()=>v("target"),className:`text-xs px-3 py-1 rounded ${m==="target"?"bg-amber-600 text-white":"bg-amber-100 text-amber-600 hover:bg-amber-200"}`,children:"Target"})]}),i.jsx("button",{onClick:w,className:"text-xs text-gray-600 hover:text-gray-900",title:"Export chart as PNG",children:"Export PNG"})]}),i.jsx("div",{style:{height:"200px"},children:i.jsx(Us,{ref:x,data:E,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:`Distribution of ${g.replace("Shared ","")} by Location`}},scales:{x:{title:{display:!0,text:m==="source"?"Source":"Target",font:{size:12}}},y:{beginAtZero:!0,ticks:{stepSize:1},title:{display:!0,text:y?"Rare Words":"Rare Pairs",font:{size:12}}}}}})})]}),i.jsx("div",{className:"space-y-3",children:e.slice(0,n).map((_,N)=>{var B,q,z,G;let U=_.display_form||_.lemma||_.bigram;if(!U&&_.word1&&_.word2){const C=((q=(B=_.source_locations)==null?void 0:B[0])==null?void 0:q.text)||"",W=((G=(z=_.target_locations)==null?void 0:z[0])==null?void 0:G.text)||"";(C+" "+W).toLowerCase(),U=`${_.word1} + ${_.word2}`}return U=_c(U||"-"),i.jsxs("div",{className:"bg-white border rounded-lg p-4 hover:shadow-md transition-shadow",children:[i.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-3",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[i.jsx("span",{className:"font-semibold text-lg text-amber-700",children:U}),i.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-amber-100 text-amber-700",children:_.rarity_percent?`${_.rarity_percent.toFixed(1)}% rare`:_.corpus_count?`${_.corpus_count} in corpus`:y?"rare":""}),i.jsxs("span",{className:"text-sm text-gray-500",children:["Source: ",_.source_occurrences||0," | Target: ",_.target_occurrences||0]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[c&&i.jsx("button",{onClick:()=>c(_),className:"text-xs border border-gray-300 text-gray-600 px-2 py-1 rounded hover:bg-gray-50",children:"Register"}),u&&i.jsx("button",{onClick:()=>k(_),className:"text-xs border border-amber-300 text-amber-700 px-2 py-1 rounded hover:bg-amber-50",children:"Corpus"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Source"}),_.source_locations&&_.source_locations.length>0?i.jsxs("div",{className:"space-y-2",children:[_.source_locations.slice(0,3).map((C,W)=>i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"font-medium text-red-700",children:Vm(C.ref,Um(o))}),C.text&&i.jsx("div",{className:"text-gray-700",children:Hm(_c(C.text),_.matched_words,_.word1,_.word2)})]},W)),_.source_locations.length>3&&i.jsxs("div",{className:"text-xs text-gray-500",children:["+",_.source_locations.length-3," more"]})]}):i.jsx("div",{className:"text-sm text-gray-400",children:"No locations"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Target"}),_.target_locations&&_.target_locations.length>0?i.jsxs("div",{className:"space-y-2",children:[_.target_locations.slice(0,3).map((C,W)=>i.jsxs("div",{className:"text-sm",children:[i.jsx("div",{className:"font-medium text-amber-700",children:Vm(C.ref,Um(l))}),C.text&&i.jsx("div",{className:"text-gray-700",children:Hm(_c(C.text),_.matched_words,_.word1,_.word2)})]},W)),_.target_locations.length>3&&i.jsxs("div",{className:"text-xs text-gray-500",children:["+",_.target_locations.length-3," more"]})]}):i.jsx("div",{className:"text-sm text-gray-400",children:"No locations"})]})]})]},N)})}),e.length>n&&i.jsxs("button",{onClick:()=>r(_=>_+50),className:"mt-4 px-4 py-2 text-sm text-amber-700 hover:text-amber-800",children:["Show more (",e.length-n," remaining)"]})]})};function eN(){var A;const[e,t]=j.useState("la"),[s,n]=j.useState([]),[r,a]=j.useState(!0),[o,l]=j.useState(""),[c,u]=j.useState("all"),[d,h]=j.useState("chronological"),[f,m]=j.useState(new Set),[v,x]=j.useState(null),[y,g]=j.useState(null),[p,w]=j.useState(null),b=[{code:"la",label:"Latin"},{code:"grc",label:"Greek"},{code:"en",label:"English"}],k={la:[{id:"all",label:"All Eras"},{id:"republic",label:"Republic"},{id:"augustan",label:"Augustan"},{id:"early_imperial",label:"Early Imperial"},{id:"later_imperial",label:"Later Imperial"},{id:"late_antique",label:"Late Antique"},{id:"early_medieval",label:"Early Medieval"},{id:"carolingian",label:"Carolingian"},{id:"unknown",label:"Unknown"}],grc:[{id:"all",label:"All Eras"},{id:"archaic",label:"Archaic"},{id:"classical",label:"Classical"},{id:"hellenistic",label:"Hellenistic"},{id:"early_imperial",label:"Early Imperial"},{id:"later_imperial",label:"Later Imperial"},{id:"late_antique",label:"Late Antique"},{id:"unknown",label:"Unknown"}],en:[{id:"all",label:"All Eras"},{id:"medieval",label:"Medieval"},{id:"renaissance",label:"Renaissance"},{id:"early_modern",label:"Early Modern"},{id:"restoration",label:"Restoration"},{id:"eighteenth_century",label:"18th Century"},{id:"romantic",label:"Romantic"},{id:"victorian",label:"Victorian"},{id:"unknown",label:"Unknown"}]},E=k[e]||k.la,_=L=>!L||L==="unknown"?"":L.split("_").map(M=>M.charAt(0).toUpperCase()+M.slice(1)).join(" ");j.useEffect(()=>{N()},[e]),j.useEffect(()=>{U()},[]);const N=async()=>{a(!0),m(new Set);try{const M=await(await fetch(`/api/texts?language=${e}`)).json();n(M||[])}catch(L){console.error("Failed to load corpus:",L)}a(!1)},U=async()=>{try{const M=await(await fetch("/api/stats")).json();x(M)}catch(L){console.error("Failed to load stats:",L)}},B=j.useMemo(()=>{const L={};return s.forEach(M=>{const I=M.author||"Unknown";L[I]||(L[I]={author:I,author_key:M.author_key,era:M.era||"unknown",year:M.year,texts:[]}),L[I].texts.push(M)}),Object.values(L)},[s]),q=["archaic","classical","hellenistic","republic","augustan","early_imperial","later_imperial","late_antique","early_medieval","carolingian","medieval","renaissance","early_modern","restoration","eighteenth_century","romantic","victorian","unknown"],z=j.useMemo(()=>{const L=[...B];return d==="alphabetical"?L.sort((M,I)=>M.author.localeCompare(I.author)):L.sort((M,I)=>{const $=q.indexOf(M.era),Q=q.indexOf(I.era);if($!==Q)return $-Q;const X=M.year??9999,F=I.year??9999;return X!==F?X-F:M.author.localeCompare(I.author)})},[B,d]),G=L=>L?L.toLowerCase().replace(/\s+/g,"_"):"unknown",C=j.useMemo(()=>z.filter(L=>{const M=!o||L.author.toLowerCase().includes(o.toLowerCase())||L.texts.some($=>{var Q;return(Q=$.title)==null?void 0:Q.toLowerCase().includes(o.toLowerCase())}),I=c==="all"||G(L.era)===c;return M&&I}),[z,o,c]),W=L=>{const M=new Set(f);M.has(L)?M.delete(L):M.add(L),m(M)},S=(L,M)=>{var I;(y==null?void 0:y.text.id)===L.id?g(null):(g({text:L,author:M,language:e}),sessionStorage.setItem("tesserae_compareSource",JSON.stringify({textId:L.id,authorKey:M.author_key||((I=M.author)==null?void 0:I.toLowerCase().replace(/\s+/g,"_")),language:e})))},V=(L,M)=>{var I;(p==null?void 0:p.text.id)===L.id?w(null):(w({text:L,author:M,language:e}),sessionStorage.setItem("tesserae_compareTarget",JSON.stringify({textId:L.id,authorKey:M.author_key||((I=M.author)==null?void 0:I.toLowerCase().replace(/\s+/g,"_")),language:e})))},P=()=>{y&&p&&(sessionStorage.setItem("tesserae_activeTab",e),sessionStorage.setItem("tesserae_sourceAuthor",y.author.author_key||""),sessionStorage.setItem("tesserae_sourceText",y.text.id),sessionStorage.setItem("tesserae_targetAuthor",p.author.author_key||""),sessionStorage.setItem("tesserae_targetText",p.text.id),window.location.href="/")},O=L=>({la:"Latin",grc:"Greek",en:"English"})[L]||L;return i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"flex overflow-x-auto scrollbar-hide border-b",children:b.map(L=>i.jsx("button",{onClick:()=>{t(L.code),u("all")},className:`px-4 py-2 text-sm font-medium whitespace-nowrap ${e===L.code?"text-red-700 border-b-2 border-red-700":"text-gray-600 hover:text-red-600"}`,children:L.label},L.code))}),(y||p)&&i.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded p-3 text-sm",children:i.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2",children:[i.jsx("span",{className:"font-medium text-amber-800",children:"Compare:"}),i.jsxs("span",{children:[i.jsx("span",{className:"text-gray-500",children:"Source:"})," ",y?i.jsxs("span",{className:"font-medium",children:[y.author.author,", ",y.text.title]}):i.jsx("span",{className:"text-gray-400",children:"none"})]}),i.jsxs("span",{children:[i.jsx("span",{className:"text-gray-500",children:"Target:"})," ",p?i.jsxs("span",{className:"font-medium",children:[p.author.author,", ",p.text.title]}):i.jsx("span",{className:"text-gray-400",children:"none"})]}),i.jsxs("div",{className:"flex gap-2 ml-auto",children:[i.jsx("button",{onClick:()=>{g(null),w(null)},className:"text-gray-500 hover:text-gray-700 text-xs",children:"Clear"}),i.jsx("button",{onClick:P,disabled:!y||!p,className:"px-3 py-1 bg-red-700 text-white text-xs rounded hover:bg-red-800 disabled:opacity-50",children:"Search"})]})]})}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[O(e)," Corpus"]}),i.jsxs("p",{className:"text-sm text-gray-500",children:[((A=v==null?void 0:v[e])==null?void 0:A.texts)||s.length," texts"]})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto",children:[i.jsx("input",{type:"text",placeholder:"Filter...",value:o,onChange:L=>l(L.target.value),className:"border rounded px-2 py-1.5 text-sm flex-1 sm:flex-none sm:w-48"}),i.jsx("select",{value:c,onChange:L=>u(L.target.value),className:"border rounded px-2 py-1.5 text-sm",children:E.map(L=>i.jsx("option",{value:L.id,children:L.label},L.id))}),i.jsxs("select",{value:d,onChange:L=>h(L.target.value),className:"border rounded px-2 py-1.5 text-sm",children:[i.jsx("option",{value:"alphabetical",children:"A-Z"}),i.jsx("option",{value:"chronological",children:"By Era"})]})]})]}),i.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Click author to expand works. Use checkboxes to select Source (S) or Target (T)."}),r?i.jsx(Kt,{text:"Loading corpus..."}):i.jsxs("div",{className:"border rounded bg-white divide-y max-h-[600px] overflow-y-auto",children:[C.map(L=>i.jsxs("div",{children:[i.jsxs("div",{onClick:()=>W(L.author),className:"flex items-center gap-2 px-3 py-2 hover:bg-gray-50 cursor-pointer",children:[i.jsx("span",{className:"text-gray-400 text-xs w-4",children:f.has(L.author)?"":""}),i.jsx("span",{className:"font-medium text-gray-900 flex-1",children:L.author}),i.jsxs("span",{className:"text-xs text-gray-400",children:[L.texts.length," ",L.texts.length===1?"work":"works"]}),L.era&&L.era!=="unknown"&&i.jsx("span",{className:"text-xs text-gray-400 bg-gray-100 px-1.5 py-0.5 rounded",children:_(L.era)})]}),f.has(L.author)&&i.jsx("div",{className:"bg-gray-50 border-t",children:L.texts.map(M=>{const I=(y==null?void 0:y.text.id)===M.id,$=(p==null?void 0:p.text.id)===M.id;return i.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 pl-8 text-sm border-b border-gray-100 last:border-b-0 ${I?"bg-amber-50":$?"bg-red-50":""}`,children:[i.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",title:"Set as Source",children:[i.jsx("input",{type:"checkbox",checked:I,onChange:()=>S(M,L),className:"w-3.5 h-3.5 accent-amber-600"}),i.jsx("span",{className:"text-xs text-amber-700 font-medium",children:"S"})]}),i.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",title:"Set as Target",children:[i.jsx("input",{type:"checkbox",checked:$,onChange:()=>V(M,L),className:"w-3.5 h-3.5 accent-red-600"}),i.jsx("span",{className:"text-xs text-red-700 font-medium",children:"T"})]}),i.jsx("span",{className:"text-gray-700 flex-1",children:M.title}),M.line_count&&i.jsxs("span",{className:"text-xs text-gray-400",children:[M.line_count," lines"]})]},M.id)})})]},L.author)),C.length===0&&i.jsx("div",{className:"text-center py-6 text-gray-500 text-sm",children:"No texts match your filter."})]})]})}function Ai(e){return e?e.split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()).join(" "):""}function Nc(e,t){if(!e)return"";const s=e.toLowerCase(),n=(t||"").toLowerCase();return n&&s.startsWith(n+" ")?Ai(e.slice(n.length+1)):Ai(e)}function Wa(e){if(!e)return"";const t=e.match(/(\d+[\d.]*\d*)$/);return t?t[1]:e}function tN(){const[e,t]=j.useState("la"),[s,n]=j.useState([]),[r,a]=j.useState(!0),[o,l]=j.useState(3),[c,u]=j.useState("frequency"),[d,h]=j.useState("asc"),[f,m]=j.useState(null),[v,x]=j.useState({}),[y,g]=j.useState(!1),[p,w]=j.useState(!1),[b,k]=j.useState([]),[E,_]=j.useState(""),[N,U]=j.useState([]),[B,q]=j.useState(""),[z,G]=j.useState(""),C=j.useRef(null),W=async(I,$,Q,X,F)=>{_($),q(`${Ai(X)} - ${Nc(F,X)}`),G(Q),g(!0),w(!0),U([$.toLowerCase()]);try{const[ne,ue]=await Promise.all([fetch(`/api/text/${I}/lines?language=${e}`),fetch(`/api/lemma-forms/${encodeURIComponent($)}?language=${e}`)]),ie=await ne.json();k(ie.lines||[]);const D=await ue.json();U(D.forms||[$.toLowerCase()])}catch(ne){console.error("Failed to load text:",ne),k([])}w(!1)};j.useEffect(()=>{y&&!p&&C.current&&C.current.scrollIntoView({behavior:"smooth",block:"center"})},[y,p,b]);const S=[{code:"la",label:"Latin"},{code:"grc",label:"Greek"},{code:"en",label:"English"}];j.useEffect(()=>{let I=!1;const $=e;return n([]),a(!0),m(null),x({}),(async()=>{try{const X=`/api/rare-lemmata-full?language=${$}&max_occurrences=${o}&limit=50000&_t=${Date.now()}`,ne=await(await fetch(X,{cache:"no-store",headers:{"Cache-Control":"no-cache"}})).json();!I&&ne.language===$&&e===$&&(n(ne.words||[]),a(!1))}catch(X){console.error("Failed to load rare words:",X),I||a(!1)}})(),()=>{I=!0}},[e,o]);const V=async I=>{if(f===I){m(null);return}if(m(I),!v[I])try{const Q=await(await fetch(`/api/rare-word-locations/${encodeURIComponent(I)}?language=${e}`)).json();x(X=>({...X,[I]:{locations:Q.locations||[],definition:Q.definition,count:Q.corpus_count}}))}catch($){console.error("Failed to load word details:",$)}},P=[...s].sort((I,$)=>{let Q=0;return c==="frequency"?Q=(I.count||0)-($.count||0):c==="lemma"?Q=(I.lemma||"").toLowerCase().localeCompare(($.lemma||"").toLowerCase()):c==="author"&&(Q=(I.first_author||"").localeCompare($.first_author||"")),d==="asc"?Q:-Q}),O=I=>{c===I?h(d==="asc"?"desc":"asc"):(u(I),h("asc"))},A=j.useCallback(()=>{const I=["Lemma","Frequency","First Author","First Work"],$=s.map(ue=>[ue.lemma,ue.count,ue.first_author||"",ue.first_work||""]),Q=[I,...$].map(ue=>ue.map(ie=>`"${ie}"`).join(",")).join(`
`),X=new Blob([Q],{type:"text/csv"}),F=URL.createObjectURL(X),ne=document.createElement("a");ne.href=F,ne.download=`rare_words_${e}.csv`,ne.click(),URL.revokeObjectURL(F)},[s,e]),L=I=>({la:"Latin",grc:"Greek",en:"English"})[I]||I,M=({field:I})=>c!==I?i.jsx("span",{className:"text-gray-300 ml-1",children:""}):i.jsx("span",{className:"text-red-600 ml-1",children:d==="asc"?"":""});return i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"flex overflow-x-auto scrollbar-hide border-b mb-4",children:S.map(I=>i.jsx("button",{onClick:()=>{t(I.code),n([]),m(null),x({})},className:`px-4 py-2 text-sm font-medium whitespace-nowrap ${e===I.code?"text-red-700 border-b-2 border-red-700":"text-gray-600 hover:text-red-600"}`,children:I.label},I.code))}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Rare Words Explorer (",L(e),")"]}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Find rare vocabulary across the corpus"})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs("select",{value:o,onChange:I=>l(parseInt(I.target.value)),className:"border rounded px-3 py-2 text-sm",children:[i.jsx("option",{value:"1",children:"Hapax only (1 occurrence)"}),i.jsx("option",{value:"2",children:"Up to 2 occurrences"}),i.jsx("option",{value:"3",children:"Up to 3 occurrences"}),i.jsx("option",{value:"5",children:"Up to 5 occurrences"}),i.jsx("option",{value:"10",children:"Up to 10 occurrences"})]}),i.jsx("button",{onClick:A,className:"px-3 py-2 bg-gray-100 text-gray-700 border rounded hover:bg-gray-200 text-sm",children:"Export CSV"})]})]}),r?i.jsx(Kt,{text:"Loading rare words..."}):i.jsxs("div",{className:"bg-white border rounded-lg",children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsxs("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-700 cursor-pointer hover:bg-gray-100",onClick:()=>O("lemma"),children:["Lemma ",i.jsx(M,{field:"lemma"})]}),i.jsxs("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-700 cursor-pointer hover:bg-gray-100 whitespace-nowrap",onClick:()=>O("frequency"),children:[i.jsx("span",{className:"hidden sm:inline",children:"Frequency"}),i.jsx("span",{className:"sm:hidden",children:"Freq"})," ",i.jsx(M,{field:"frequency"})]}),i.jsxs("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-700 cursor-pointer hover:bg-gray-100",onClick:()=>O("author"),children:[i.jsx("span",{className:"hidden sm:inline",children:"First Author"}),i.jsx("span",{className:"sm:hidden",children:"Author"})," ",i.jsx(M,{field:"author"})]}),i.jsx("th",{className:"px-2 sm:px-4 py-2 sm:py-3 text-left text-xs sm:text-sm font-medium text-gray-700 hidden sm:table-cell",children:"First Work"})]})}),i.jsx("tbody",{className:"divide-y divide-gray-200",children:P.map(I=>i.jsxs(i.Fragment,{children:[i.jsxs("tr",{className:`hover:bg-gray-50 cursor-pointer ${f===I.lemma?"bg-amber-50":""}`,onClick:()=>V(I.lemma),children:[i.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm font-medium text-amber-700 hover:text-amber-900",children:i.jsxs("span",{className:"flex items-center gap-1",children:[I.lemma,i.jsx("span",{className:"text-gray-400 text-xs",children:f===I.lemma?"":""})]})}),i.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm text-gray-600",children:I.count}),i.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm text-gray-600",children:Ai(I.first_author)}),i.jsx("td",{className:"px-2 sm:px-4 py-2 sm:py-3 text-xs sm:text-sm text-gray-600 hidden sm:table-cell",children:Nc(I.first_work,I.first_author)})]},I.lemma),f===I.lemma&&v[I.lemma]&&i.jsx("tr",{children:i.jsx("td",{colSpan:"100",className:"px-4 py-3 bg-gray-50",children:i.jsxs("div",{className:"space-y-2",children:[v[I.lemma].definition&&i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-medium",children:"Definition: "}),v[I.lemma].definition]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-medium",children:"Locations: "}),i.jsx("ul",{className:"mt-1 space-y-1",children:v[I.lemma].locations.map(($,Q)=>i.jsxs("li",{className:"text-gray-600 flex items-center gap-2",children:[i.jsxs("span",{children:[Ai($.author)," - ",Nc($.work,$.author)," ",Wa($.ref)]}),$.text_id&&i.jsx("button",{className:"text-amber-600 hover:text-amber-800 text-xs underline",onClick:X=>{X.stopPropagation(),W($.text_id,I.lemma,$.ref,$.author,$.work)},children:"view in text"})]},Q))})]})]})})},`${I.lemma}-details`)]}))})]})}),i.jsxs("div",{className:"px-4 py-3 bg-gray-50 text-sm text-gray-500",children:["Showing ",P.length," words"]})]}),i.jsx(Gi,{isOpen:y,onClose:()=>g(!1),title:B,maxWidth:"max-w-4xl",children:p?i.jsx(Kt,{text:"Loading text..."}):b.length===0?i.jsx("p",{className:"text-gray-500",children:"No lines found in this text."}):i.jsx("div",{className:"space-y-1 font-mono text-sm",children:b.map((I,$)=>{const Q=I.locus===z||Wa(I.locus)===Wa(z),X=N.map(ie=>ie.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|"),ne=new RegExp(`\\b(${X})\\b`,"gi").test(I.text),ue=ie=>{const D=new RegExp(`\\b(${X})\\b`,"gi");return ie.replace(D,'<mark class="bg-amber-300 px-0.5 rounded font-semibold">$1</mark>')};return i.jsxs("div",{ref:Q?C:null,className:`flex gap-3 py-1 px-2 rounded ${Q?"bg-amber-100 border-l-4 border-amber-500":ne?"bg-yellow-50":""}`,children:[i.jsx("span",{className:"text-gray-400 w-16 flex-shrink-0 text-right",children:Wa(I.locus)}),i.jsx("span",{className:"text-gray-800",dangerouslySetInnerHTML:{__html:ue(I.text)}})]},$)})})})]})}function sN(e){return e.toLowerCase().replace(/v/g,"u")}function Xa(e,t,s="la"){if(!e||!t||t.size===0)return e;const n=s==="la"||s==="latin";return e.split(/(\s+|[,.:;!?'"()-])/).map((a,o)=>{const l=a.toLowerCase().replace(/[,.:;!?'"()-]/g,"");if(!l||l.length<2)return a;const c=n?sN(l):l;return(t.has(l)||t.has(c))&&a.trim()?i.jsx("span",{className:"bg-amber-200 text-amber-900 font-medium px-0.5 rounded",children:a},o):a})}const nN={verg:"Vergil",vergil:"Vergil",luc:"Lucan",lucan:"Lucan",ov:"Ovid",ovid:"Ovid",quint:"Quintilian",quintilian:"Quintilian",cic:"Cicero",cicero:"Cicero",hor:"Horace",horace:"Horace",sen:"Seneca",seneca:"Seneca",stat:"Statius",statius:"Statius",val:"Valerius Flaccus",sil:"Silius Italicus",prop:"Propertius",tib:"Tibullus",cat:"Catullus",juv:"Juvenal",pers:"Persius",mart:"Martial"},rN={aen:"Aeneid",aeneid:"Aeneid",met:"Metamorphoses",georg:"Georgics",ecl:"Eclogues",inst:"Institutio Oratoria",theb:"Thebaid",phars:"Pharsalia",pun:"Punica",arg:"Argonautica",att:"Letters to Atticus",fam:"Letters to Friends"},Wm={luc:"Bellum Civile",lucan:"Bellum Civile"};function qa(e,t,s){if(e&&t)return`${e}, ${t} ${s||""}`.trim();if(s){const n=s.toLowerCase().split(/[\s.]+/).filter(r=>r);if(n.length>=2){const r=n[0],a=nN[r]||r;if(/^\d+$/.test(n[1])&&Wm[r]){const u=Wm[r],d=n.slice(1).join(".");return`${a}, ${u} ${d}`.trim()}const l=rN[n[1]]||n[1],c=n.slice(2).join(".");return`${a}, ${l} ${c}`.trim()}}return s||""}function iN({user:e}){const[t,s]=j.useState([]),[n,r]=j.useState(!0),[a,o]=j.useState({language:"all",status:"all"}),[l,c]=j.useState("created_at"),[u,d]=j.useState("desc"),[h,f]=j.useState(50),[m,v]=j.useState(null),[x,y]=j.useState("browse"),[g,p]=j.useState([]),[w,b]=j.useState(!1),[k,E]=j.useState(null),[_,N]=j.useState({source_locus:"",source_text:"",target_locus:"",target_text:"",language:"la",notes:"",scholar_score:0,is_public:!0,matched_words:""}),[U,B]=j.useState({}),[q,z]=j.useState({}),[G,C]=j.useState({}),W=j.useCallback(async D=>{const R=new Map;D.forEach(te=>{const ce=te.matched_lemmas||[];if(ce.length>0){const de=[...ce].sort().join(",");R.has(de)||R.set(de,ce)}});const Y={...G},K=[...R.keys()].filter(te=>!Y[te]);if(K.length!==0){for(const te of K)try{const ce=R.get(te),de=await fetch("/api/intertexts/expand-lemmas",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lemmas:ce})});if(de.ok){const he=await de.json();Y[te]=new Set(he.forms||[])}}catch(ce){console.error("Failed to expand lemmas:",ce)}C(Y)}},[G]);j.useEffect(()=>{S(),P()},[]),j.useEffect(()=>{e&&x==="my"?V():(x==="browse"||x==="byWork")&&S()},[e,x]);const S=async()=>{r(!0);try{const Y=(await(await fetch("/api/intertexts")).json()).intertexts||[];s(Y),await W(Y)}catch(D){console.error("Failed to load intertexts:",D)}r(!1)},V=async()=>{try{const R=await(await fetch("/api/intertexts/my")).json();p(R.intertexts||[])}catch(D){console.error("Failed to load my intertexts:",D)}},P=async()=>{try{const R=await(await fetch("/api/intertexts/stats")).json();v(R)}catch(D){console.error("Failed to load repository stats:",D)}},O=D=>{const R=D.matched_lemmas||[];if(R.length===0)return new Set;const Y=[...R].sort().join(",");return G[Y]||new Set(R)},A=async()=>{try{const D={..._,matched_tokens:_.matched_words?_.matched_words.split(",").map(Y=>Y.trim()).filter(Boolean):[]};if(delete D.matched_words,!(await fetch("/api/intertexts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)})).ok)throw new Error("Failed to add intertext");b(!1),N({source_locus:"",source_text:"",target_locus:"",target_text:"",language:"la",notes:"",scholar_score:0,is_public:!0,matched_words:""}),S(),e&&V(),P()}catch(D){alert("Failed to add intertext: "+D.message)}},L=async(D,R)=>{try{if(!(await fetch(`/api/intertexts/${D}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).ok)throw new Error("Failed to update");x==="my"?V():S()}catch(Y){alert("Update failed: "+Y.message)}},M=async D=>{if(confirm("Delete this intertext?"))try{await fetch(`/api/intertexts/${D}`,{method:"DELETE"}),x==="my"?V():S(),P()}catch{alert("Delete failed")}},I=(x==="my"?g:t).filter(D=>!(a.language!=="all"&&D.language!==a.language||a.status!=="all"&&D.status!==a.status)),$=[...I].sort((D,R)=>{let Y=0;return l==="created_at"?Y=new Date(D.created_at||0)-new Date(R.created_at||0):l==="score"?Y=(D.score||0)-(R.score||0):l==="scholar_score"&&(Y=(D.scholar_score||0)-(R.scholar_score||0)),u==="desc"?-Y:Y}),Q=(()=>{const D={};return I.forEach(R=>{var ce,de,he,re;const Y=R.language||"la",K=R.source_author||((de=(ce=R.source_locus)==null?void 0:ce.split(",")[0])==null?void 0:de.trim())||"Unknown",te=R.source_work||((re=(he=R.source_locus)==null?void 0:he.split(",")[1])==null?void 0:re.trim())||"Unknown";D[Y]||(D[Y]={}),D[Y][K]||(D[Y][K]={}),D[Y][K][te]||(D[Y][K][te]=[]),D[Y][K][te].push(R)}),D})(),X=(D,R)=>{const Y=`${D}:${R}`;B(K=>({...K,[Y]:!K[Y]}))},F=(D,R,Y)=>{const K=`${D}:${R}:${Y}`;z(te=>({...te,[K]:!te[K]}))},ne={la:"Latin",grc:"Greek",en:"English",cross:"Greek-Latin"},ue=j.useCallback(()=>{const D=["Source","Target","Language","Score","Scholar Score","Status","Notes","Created"],R=$.map(de=>[de.source_locus||"",de.target_locus||"",de.language||"",de.score||"",de.scholar_score||"",de.status||"",(de.notes||"").replace(/"/g,'""'),de.created_at||""]),Y=[D,...R].map(de=>de.map(he=>`"${he}"`).join(",")).join(`
`),K=new Blob([Y],{type:"text/csv"}),te=URL.createObjectURL(K),ce=document.createElement("a");ce.href=te,ce.download="intertexts.csv",ce.click(),URL.revokeObjectURL(te)},[$]),ie=({value:D,onChange:R,readOnly:Y})=>i.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(K=>i.jsx("button",{type:"button",disabled:Y,onClick:()=>R&&R(K),className:`text-lg ${K<=D?"text-yellow-500":"text-gray-300"} ${!Y&&"hover:text-yellow-400 cursor-pointer"}`,children:""},K))});return n?i.jsx(Kt,{text:"Loading repository..."}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Intertext Repository"}),i.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Browse and manage discovered textual parallels"})]}),m&&i.jsxs("div",{className:"flex gap-4 text-sm",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-red-700",children:m.total||0}),i.jsx("div",{className:"text-gray-500",children:"Total"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-amber-600",children:m.flagged||0}),i.jsx("div",{className:"text-gray-500",children:"Flagged"})]})]})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:i.jsxs("div",{className:"flex flex-wrap gap-4 items-center justify-between",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>y("browse"),className:`px-4 py-2 rounded text-sm ${x==="browse"?"bg-red-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"List View"}),i.jsx("button",{onClick:()=>y("byWork"),className:`px-4 py-2 rounded text-sm ${x==="byWork"?"bg-red-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"By Work"}),e&&i.jsx("button",{onClick:()=>y("my"),className:`px-4 py-2 rounded text-sm ${x==="my"?"bg-red-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"My Intertexts"})]}),i.jsxs("div",{className:"flex gap-3 flex-wrap",children:[i.jsxs("select",{value:a.language,onChange:D=>o({...a,language:D.target.value}),className:"border rounded px-3 py-2 text-sm",children:[i.jsx("option",{value:"all",children:"All Languages"}),i.jsx("option",{value:"la",children:"Latin"}),i.jsx("option",{value:"grc",children:"Greek"}),i.jsx("option",{value:"en",children:"English"}),i.jsx("option",{value:"cross",children:"Greek-Latin"})]}),i.jsxs("select",{value:a.status,onChange:D=>o({...a,status:D.target.value}),className:"border rounded px-3 py-2 text-sm",children:[i.jsx("option",{value:"all",children:"All Entries"}),i.jsx("option",{value:"flagged",children:"Flagged Only"})]}),i.jsxs("select",{value:l,onChange:D=>c(D.target.value),className:"border rounded px-3 py-2 text-sm",children:[i.jsx("option",{value:"created_at",children:"Date"}),i.jsx("option",{value:"score",children:"Match Score"}),i.jsx("option",{value:"scholar_score",children:"Scholar Score"})]}),i.jsx("button",{onClick:ue,className:"px-3 py-2 bg-gray-100 text-gray-700 border rounded hover:bg-gray-200 text-sm",children:"Export CSV"}),e&&i.jsx("button",{onClick:()=>b(!0),className:"px-3 py-2 bg-red-700 text-white rounded hover:bg-red-800 text-sm",children:"+ Add Intertext"})]})]})}),I.length===0?i.jsx("div",{className:"bg-white rounded-lg shadow p-8 text-center text-gray-500",children:x==="my"?"You haven't saved any intertexts yet. Run a search and click 'Register' to save parallels.":"No intertexts found matching your filters."}):x==="byWork"?i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"p-4 border-b bg-gray-50",children:i.jsxs("span",{className:"text-sm text-gray-600",children:[I.length," intertexts organized by source work"]})}),i.jsx("div",{className:"divide-y divide-gray-100",children:Object.entries(Q).sort().map(([D,R])=>i.jsxs("div",{className:"border-b",children:[i.jsxs("div",{className:"px-4 py-2 bg-gray-100 font-medium text-sm text-gray-700",children:[ne[D]||D," (",Object.values(R).flatMap(Y=>Object.values(Y)).flat().length,")"]}),Object.entries(R).sort().map(([Y,K])=>{const te=`${D}:${Y}`,ce=U[te],de=Object.values(K).flat().length;return i.jsxs("div",{className:"border-l-4 border-gray-200",children:[i.jsxs("button",{onClick:()=>X(D,Y),className:"w-full text-left px-6 py-2 hover:bg-gray-50 flex items-center justify-between",children:[i.jsx("span",{className:"font-medium text-gray-800",children:Y}),i.jsxs("span",{className:"text-xs text-gray-500",children:[de," ",de===1?"intertext":"intertexts"," ",ce?"":""]})]}),ce&&Object.entries(K).sort().map(([he,re])=>{const fe=`${D}:${Y}:${he}`,ye=q[fe];return i.jsxs("div",{className:"border-l-4 border-gray-100 ml-4",children:[i.jsxs("button",{onClick:()=>F(D,Y,he),className:"w-full text-left px-6 py-2 hover:bg-gray-50 flex items-center justify-between text-sm",children:[i.jsx("span",{className:"text-gray-700 italic",children:he}),i.jsxs("span",{className:"text-xs text-gray-500",children:[re.length," ",ye?"":""]})]}),ye&&i.jsx("div",{className:"ml-4 border-l border-gray-200",children:re.map((ae,xe)=>{var be,Ne,Ce,ve,Me,Pe,et,Re,qs,Z,ge,ze,tt,st,Je,Ge,Ve;return i.jsxs("div",{className:"px-4 py-3 bg-white hover:bg-gray-50 border-b border-gray-100",children:[i.jsxs("div",{className:"flex items-start justify-between gap-2 mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[ae.status==="flagged"&&i.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-amber-100 text-amber-700",children:"flagged"}),i.jsxs("span",{className:"text-xs text-gray-400",children:["Score: ",((Ne=(be=ae.score)==null?void 0:be.toFixed)==null?void 0:Ne.call(be,2))||ae.score||"-"]}),ae.scholar_score>0&&i.jsx("span",{className:"text-xs text-amber-600",children:"".repeat(ae.scholar_score)})]}),e&&i.jsx("button",{onClick:()=>L(ae.id,{status:ae.status==="flagged"?"confirmed":"flagged"}),className:`text-xs px-2 py-0.5 rounded ${ae.status==="flagged"?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-500"}`,children:ae.status==="flagged"?"":""})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[i.jsx("div",{className:"text-xs text-red-600 font-medium mb-1",children:qa((Ce=ae.source)==null?void 0:Ce.author,(ve=ae.source)==null?void 0:ve.work,((Me=ae.source)==null?void 0:Me.reference)||ae.source_locus)}),i.jsx("div",{className:"text-gray-700",children:Xa(ae.source_text||((Pe=ae.source)==null?void 0:Pe.snippet)||"",O(ae),ae.language||((et=ae.source)==null?void 0:et.language)||"la")})]}),i.jsxs("div",{className:"bg-gray-50 p-2 rounded",children:[i.jsx("div",{className:"text-xs text-amber-600 font-medium mb-1",children:qa((Re=ae.target)==null?void 0:Re.author,(qs=ae.target)==null?void 0:qs.work,((Z=ae.target)==null?void 0:Z.reference)||ae.target_locus)}),i.jsx("div",{className:"text-gray-700",children:Xa(ae.target_text||((ge=ae.target)==null?void 0:ge.snippet)||"",O(ae),ae.language||((ze=ae.target)==null?void 0:ze.language)||"la")})]})]}),ae.notes&&i.jsx("div",{className:"mt-2 text-xs text-gray-500 italic",children:ae.notes}),(((tt=ae.submitter)==null?void 0:tt.name)||((st=ae.submitter)==null?void 0:st.orcid))&&i.jsxs("div",{className:"mt-1 text-xs text-gray-400",children:["Added by ",(Je=ae.submitter)!=null&&Je.name&&((Ge=ae.submitter)!=null&&Ge.orcid)?`${ae.submitter.name} (ORCID: ${ae.submitter.orcid})`:((Ve=ae.submitter)==null?void 0:Ve.name)||`ORCID: ${ae.submitter.orcid}`]})]},ae.id||xe)})})]},he)})]},Y)})]},D))})]}):i.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[i.jsx("div",{className:"divide-y divide-gray-200",children:$.slice(0,h).map((D,R)=>{var Y,K,te,ce,de,he,re,fe,ye,ae,xe,be,Ne,Ce,ve,Me;return i.jsxs("div",{className:"p-4 hover:bg-gray-50",children:[i.jsxs("div",{className:"flex items-start justify-between gap-4 mb-2",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[D.status==="flagged"&&i.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-amber-100 text-amber-700",children:"flagged"}),i.jsx("span",{className:"text-xs text-gray-500",children:(()=>{var et;const Pe=D.language||((et=D.source)==null?void 0:et.language)||"en";return Pe==="la"?"Latin":Pe==="grc"?"Greek":Pe==="cross"?"Greek-Latin":"English"})()}),D.score&&i.jsxs("span",{className:"text-xs text-gray-500",children:["Match: ",D.score.toFixed(3)]}),D.scholar_score>0&&i.jsx(ie,{value:D.scholar_score,readOnly:!0}),D.is_public===!1&&i.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-gray-200 text-gray-600",children:"Private"})]})}),i.jsxs("div",{className:"flex items-center gap-2",children:[D.created_at&&i.jsx("span",{className:"text-xs text-gray-400",children:new Date(D.created_at).toLocaleDateString()}),e&&i.jsx("button",{onClick:()=>L(D.id,{status:D.status==="flagged"?"confirmed":"flagged"}),className:`text-xs px-2 py-1 rounded ${D.status==="flagged"?"bg-amber-100 text-amber-700 hover:bg-amber-200":"bg-gray-100 text-gray-500 hover:bg-gray-200"}`,title:D.status==="flagged"?"Remove flag":"Flag as problematic",children:D.status==="flagged"?" Unflag":" Flag"}),x==="my"&&e&&i.jsxs("div",{className:"flex gap-1",children:[i.jsx("button",{onClick:()=>E(D),className:"text-xs px-2 py-1 bg-gray-100 rounded hover:bg-gray-200",children:"Edit"}),i.jsx("button",{onClick:()=>M(D.id),className:"text-xs px-2 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200",children:"Delete"})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[i.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[i.jsx("div",{className:"text-xs text-red-600 mb-1 font-medium",children:qa((Y=D.source)==null?void 0:Y.author,(K=D.source)==null?void 0:K.work,((te=D.source)==null?void 0:te.reference)||D.source_locus)}),i.jsx("div",{className:"text-sm text-gray-700",children:Xa(((ce=D.source)==null?void 0:ce.snippet)||D.source_text||"",O(D),D.language||((de=D.source)==null?void 0:de.language)||"la")})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[i.jsx("div",{className:"text-xs text-amber-600 mb-1 font-medium",children:qa((he=D.target)==null?void 0:he.author,(re=D.target)==null?void 0:re.work,((fe=D.target)==null?void 0:fe.reference)||D.target_locus)}),i.jsx("div",{className:"text-sm text-gray-700",children:Xa(((ye=D.target)==null?void 0:ye.snippet)||D.target_text||"",O(D),D.language||((ae=D.target)==null?void 0:ae.language)||"la")})]})]}),D.notes&&i.jsxs("div",{className:"mt-2 text-sm text-gray-600 italic",children:["Note: ",D.notes]}),(((xe=D.submitter)==null?void 0:xe.name)||((be=D.submitter)==null?void 0:be.orcid)||D.contributor_name)&&i.jsxs("div",{className:"mt-1 text-xs text-gray-400",children:["Added by ",(Ne=D.submitter)!=null&&Ne.name&&((Ce=D.submitter)!=null&&Ce.orcid)?`${D.submitter.name} (ORCID: ${D.submitter.orcid})`:((ve=D.submitter)==null?void 0:ve.name)||D.contributor_name||((Me=D.submitter)!=null&&Me.orcid?`ORCID: ${D.submitter.orcid}`:"Anonymous")]})]},D.id||R)})}),$.length>h&&i.jsx("div",{className:"px-4 py-3 bg-gray-50 text-center",children:i.jsxs("button",{onClick:()=>f(h+50),className:"text-amber-600 hover:text-amber-800 text-sm",children:["Show more (",h," of ",$.length,")"]})})]}),w&&i.jsx(Gi,{onClose:()=>b(!1),title:"Add Manual Intertext",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Locus"}),i.jsx("input",{type:"text",value:_.source_locus,onChange:D=>N({..._,source_locus:D.target.value}),placeholder:"e.g., Vergil, Aeneid 1.1",className:"w-full border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Locus"}),i.jsx("input",{type:"text",value:_.target_locus,onChange:D=>N({..._,target_locus:D.target.value}),placeholder:"e.g., Homer, Iliad 1.1",className:"w-full border rounded px-3 py-2 text-sm"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source Text"}),i.jsx("textarea",{value:_.source_text,onChange:D=>N({..._,source_text:D.target.value}),rows:2,className:"w-full border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Target Text"}),i.jsx("textarea",{value:_.target_text,onChange:D=>N({..._,target_text:D.target.value}),rows:2,className:"w-full border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Language"}),i.jsxs("select",{value:_.language,onChange:D=>N({..._,language:D.target.value}),className:"w-full border rounded px-3 py-2 text-sm",children:[i.jsx("option",{value:"la",children:"Latin"}),i.jsx("option",{value:"grc",children:"Greek"}),i.jsx("option",{value:"en",children:"English"}),i.jsx("option",{value:"cross",children:"Greek-Latin"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scholar Score"}),i.jsx(ie,{value:_.scholar_score,onChange:D=>N({..._,scholar_score:D})})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Matched Words (comma-separated)"}),i.jsx("input",{type:"text",value:_.matched_words||"",onChange:D=>N({..._,matched_words:D.target.value}),placeholder:"e.g., arma, virum, fato",className:"w-full border rounded px-3 py-2 text-sm"}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Words to highlight in both passages"})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Notes ",i.jsxs("span",{className:"text-gray-400",children:["(",(_.notes||"").length,"/500)"]})]}),i.jsx("textarea",{value:_.notes,onChange:D=>{D.target.value.length<=500&&N({..._,notes:D.target.value})},placeholder:"Scholarly commentary or observations...",rows:2,maxLength:500,className:"w-full border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",id:"is_public",checked:_.is_public,onChange:D=>N({..._,is_public:D.target.checked})}),i.jsx("label",{htmlFor:"is_public",className:"text-sm text-gray-700",children:"Make this intertext public"})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[i.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),i.jsx("button",{onClick:A,disabled:!_.source_locus||!_.target_locus,className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:opacity-50",children:"Add Intertext"})]})]})}),k&&i.jsx(Gi,{onClose:()=>E(null),title:"Edit Intertext",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scholar Score"}),i.jsx(ie,{value:k.scholar_score||0,onChange:D=>{L(k.id,{scholar_score:D}),E({...k,scholar_score:D})}})]}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Notes ",i.jsxs("span",{className:"text-gray-400",children:["(",(k.notes||"").length,"/500)"]})]}),i.jsx("textarea",{value:k.notes||"",onChange:D=>{D.target.value.length<=500&&E({...k,notes:D.target.value})},rows:3,maxLength:500,className:"w-full border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",id:"edit_is_public",checked:k.is_public!==!1,onChange:D=>{L(k.id,{is_public:D.target.checked}),E({...k,is_public:D.target.checked})}}),i.jsx("label",{htmlFor:"edit_is_public",className:"text-sm text-gray-700",children:"Public (visible to others)"})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[i.jsx("button",{onClick:()=>E(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),i.jsx("button",{onClick:()=>{L(k.id,{notes:k.notes}),E(null)},className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800",children:"Save Changes"})]})]})})]})}const rr={la:"Latin",grc:"Greek",en:"English"},aN={search:{title:"Search Results Cache",description:"Stores results of recent text comparisons",impact:["Previously cached search results will need to be recomputed","Next searches between the same texts may be slower initially","Does NOT affect lemma data, frequencies, or corpus structure"],severity:"low",rebuildTime:"Rebuilds automatically as users run searches"},lemma:{title:"Lemma Cache",description:"Stores lemmatized (dictionary form) versions of all texts",impact:["ALL text processing will need to be redone on next search","First searches after clearing will be VERY slow (minutes per text)","Each text must be re-processed before its words can be matched","Consider rebuilding cache before heavy usage"],severity:"high",rebuildTime:"Rebuilds automatically but slowly when texts are searched. For faster recovery, manually rebuild for each language."},frequency:{title:"Frequency Cache",description:"Stores word frequency statistics for IDF scoring",impact:["Search scoring will use default weights until recalculated","Stoplist generation may be less accurate","Rare word detection will be affected","Results may be less relevant until frequencies are recalculated"],severity:"medium",rebuildTime:'Use "Recalculate Corpus Frequencies" button to rebuild'}};function oN(){var st,Je,Ge,Ve,Oe,H,se,oe,me,je,Ie,_e;const[e,t]=j.useState(!1),[s,n]=j.useState(""),[r,a]=j.useState(""),[o,l]=j.useState(!1),[c,u]=j.useState(""),[d,h]=j.useState("requests"),[f,m]=j.useState(!1),[v,x]=j.useState([]),[y,g]=j.useState([]),[p,w]=j.useState(null),[b,k]=j.useState(null),[E,_]=j.useState(null),[N,U]=j.useState(""),[B,q]=j.useState(!1),[z,G]=j.useState(null),[C,W]=j.useState(null),[S,V]=j.useState(null),[P,O]=j.useState(null),[A,L]=j.useState(null),[M,I]=j.useState(null),[$,Q]=j.useState(null),[X,F]=j.useState(!1),[ne,ue]=j.useState(""),[ie,D]=j.useState([]),[R,Y]=j.useState(!1),[K,te]=j.useState({}),[ce,de]=j.useState(null),[he,re]=j.useState(null),[fe,ye]=j.useState(null),ae=async()=>{if(u(""),!s.trim()){u("Please enter your username");return}try{(await(await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:r,username:s})})).json()).success?(t(!0),xe()):u("Invalid password")}catch{u("Authentication failed")}},xe=async()=>{var T;m(!0),L(null);try{const J={"X-Admin-Password":r,"X-Admin-Username":s},[pe,at,ot,ds,hs,er,fa,oh]=await Promise.all([fetch("/api/admin/requests",{headers:J}),fetch("/api/admin/feedback",{headers:J}),fetch("/api/corpus-status"),fetch("/api/admin/analytics",{headers:J}),fetch("/api/admin/lemma-cache/stats",{headers:J}),fetch("/api/admin/search-cache/stats",{headers:J}),fetch("/api/admin/frequency-cache/stats",{headers:J}),fetch("/api/admin/bigram-cache/stats",{headers:J})]),ry=await pe.json(),lh=at.ok?await at.json():[],Ol=ot.ok?await ot.json():null,iy=ds.ok?await ds.json():null,ay=hs.ok?await hs.json():{},oy=er.ok?await er.json():{},ly=fa.ok?await fa.json():{},cy=oh.ok?await oh.json():{};x(ry.requests||[]),g(Array.isArray(lh)?lh:[]),w(((T=Ol==null?void 0:Ol.summary)==null?void 0:T.total_texts)||null),k(iy),_({lemma_cache_size:ay.total_count||0,search_cache_size:oy.cached_searches||0,frequency_cache_size:ly.total_entries||0}),te(cy)}catch(J){console.error("Failed to load admin data:",J),L("Failed to load some admin data. Some statistics may be unavailable.")}m(!1)},be=async()=>{Y(!0);try{const T=await fetch("/api/admin/audit-log?limit=100",{headers:{"X-Admin-Password":r,"X-Admin-Username":s}});if(T.ok){const J=await T.json();D(J.entries||[])}}catch(T){console.error("Failed to load audit log:",T)}Y(!1)},Ne=async T=>{if(window.confirm("Are you sure you want to delete this text request? This cannot be undone."))try{await fetch(`/api/admin/requests/${T}`,{method:"DELETE",headers:{"X-Admin-Password":r,"X-Admin-Username":s}}),xe(),I(null)}catch(J){console.error("Failed to delete request:",J)}},Ce=T=>{I(T),Q({official_author:T.official_author||T.author||"",official_work:T.official_work||T.work||"",approved_filename:T.approved_filename||T.suggested_filename||"",text_date:T.text_date||"",admin_notes:T.admin_notes||"",content:T.content||""}),ve(T.content||"",T.official_author||T.author,T.official_work||T.work)},ve=(T,J,pe)=>{if(!T||!J||!pe){ue("");return}const at=J.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9._-]/g,""),ot=pe.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9._-]/g,""),ds=T.split(`
`).filter(er=>er.trim()),hs=ds.slice(0,10).map((er,fa)=>`<${at}.${ot}.${fa+1}> ${er.trim()}`);ds.length>10&&hs.push(`... and ${ds.length-10} more lines`),ue(hs.join(`
`))},Me=async()=>{if(!(!M||!$)){F(!0);try{await fetch(`/api/admin/requests/${M.id}`,{method:"PUT",headers:{"Content-Type":"application/json","X-Admin-Password":r,"X-Admin-Username":s},body:JSON.stringify($)}),xe(),I(null)}catch(T){console.error("Failed to save request changes:",T)}F(!1)}},Pe=async()=>{if(!(!M||!$)){F(!0);try{await fetch(`/api/admin/requests/${M.id}`,{method:"PUT",headers:{"Content-Type":"application/json","X-Admin-Password":r,"X-Admin-Username":s},body:JSON.stringify({...$,status:"approved"})}),await fetch(`/api/admin/requests/${M.id}/approve`,{method:"POST",headers:{"Content-Type":"application/json","X-Admin-Password":r,"X-Admin-Username":s},body:JSON.stringify({content:$.content})}),xe(),I(null)}catch(T){console.error("Failed to approve request:",T)}F(!1)}},et=()=>{if(!$)return;const T=$.official_author||"",J=$.official_work||"",pe=T.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9._-]/g,""),at=J.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9._-]/g,"");Q(ot=>({...ot,approved_filename:`${pe}.${at}.tess`}))},Re=T=>{const J=aN[T];if(!J)return;const pe=T==="search"?E==null?void 0:E.search_cache_size:T==="lemma"?E==null?void 0:E.lemma_cache_size:E==null?void 0:E.frequency_cache_size;O(null),W({cacheType:T,...J,entryCount:pe||0})},qs=async T=>{V(T),O(null);try{let J;switch(T){case"search":J="/api/admin/search-cache/clear";break;case"lemma":J="/api/admin/lemma-cache/clear";break;case"frequency":J="/api/admin/frequency-cache/clear";break;default:J="/api/admin/lemma-cache/clear"}const pe=await fetch(J,{method:"POST",headers:{"Content-Type":"application/json","X-Admin-Password":r,"X-Admin-Username":s},body:JSON.stringify({})});if(!pe.ok){const at=await pe.json().catch(()=>({}));throw new Error(at.error||`Failed to clear ${T} cache`)}await xe(),W(null)}catch(J){console.error("Failed to clear cache:",J),O(`Failed to clear ${T} cache: ${J.message}`)}V(null)},Z=async()=>{try{await fetch("/api/frequencies/recalculate",{method:"POST",headers:{"X-Admin-Password":r,"X-Admin-Username":s}}),alert("Frequency recalculation started")}catch(T){console.error("Failed to recalculate frequencies:",T)}},ge=async T=>{var J;de(T),re(null),ye(null);try{const pe=await fetch("/api/admin/bigram-cache/build",{method:"POST",headers:{"Content-Type":"application/json","X-Admin-Password":r,"X-Admin-Username":s},body:JSON.stringify({language:T})}),at=await pe.json();if(pe.ok){ye(`${rr[T]} bigram index built: ${((J=at.unique_bigrams)==null?void 0:J.toLocaleString())||0} unique pairs`);const ot=await fetch("/api/admin/bigram-cache/stats",{headers:{"X-Admin-Password":r,"X-Admin-Username":s}});ot.ok&&te(await ot.json())}else re(at.error||"Failed to build bigram index")}catch(pe){console.error("Failed to build bigram index:",pe),re("Failed to build bigram index: "+pe.message)}de(null)},ze=async()=>{try{const J=await(await fetch("/api/admin/settings",{headers:{"X-Admin-Password":r,"X-Admin-Username":s}})).json();U(J.notification_emails||"")}catch(T){console.error("Failed to load settings:",T)}},tt=async()=>{q(!0),G(null);try{const J=await(await fetch("/api/admin/settings",{method:"POST",headers:{"Content-Type":"application/json","X-Admin-Password":r,"X-Admin-Username":s},body:JSON.stringify({notification_emails:N})})).json();J.success?G({type:"success",text:"Notification emails saved successfully!"}):G({type:"error",text:J.error||"Failed to save settings"})}catch{G({type:"error",text:"Failed to save settings"})}q(!1)};return j.useEffect(()=>{e&&d==="settings"&&ze()},[e,d]),j.useEffect(()=>{e&&d==="audit"&&be()},[e,d]),e?f?i.jsx(Kt,{text:"Loading admin data..."}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Admin Panel"}),i.jsx("button",{onClick:()=>t(!1),className:"text-sm text-gray-500 hover:text-gray-700",children:"Logout"})]}),A&&i.jsxs("div",{className:"bg-amber-50 border border-amber-300 rounded-lg p-4 flex items-start gap-3",children:[i.jsx("span",{className:"text-amber-600",children:""}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-amber-800",children:"Warning"}),i.jsx("p",{className:"text-sm text-amber-700",children:A})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow",children:[i.jsx("div",{className:"border-b",children:i.jsx("nav",{className:"flex flex-wrap",children:["requests","feedback","cache","stats","analytics","audit","settings"].map(T=>i.jsx("button",{onClick:()=>h(T),className:`px-4 py-3 text-sm font-medium border-b-2 ${d===T?"border-red-700 text-red-700":"border-transparent text-gray-500 hover:text-gray-700"}`,children:T==="requests"?"Text Requests":T==="feedback"?"Feedback":T==="cache"?"Cache Management":T==="stats"?"Corpus Stats":T==="analytics"?"User Analytics":T==="audit"?"Audit Log":"Settings"},T))})}),i.jsxs("div",{className:"p-4",children:[d==="requests"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h3",{className:"font-medium text-gray-900",children:"Text Requests"}),i.jsxs("div",{className:"text-sm text-gray-500",children:[v.filter(T=>T.status==="pending").length," pending"]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[i.jsx("thead",{className:"bg-gray-50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Author"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Work"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Language"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Date Submitted"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Last Edit"}),i.jsx("th",{className:"px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:"7",className:"px-3 py-8 text-center text-sm text-gray-500",children:"No text requests"})}):v.map(T=>i.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>Ce(T),children:[i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${T.status==="approved"?"bg-green-100 text-green-700":T.status==="rejected"?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:T.status||"pending"})}),i.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:T.author}),i.jsx("td",{className:"px-3 py-2 text-sm text-gray-900",children:T.work}),i.jsx("td",{className:"px-3 py-2 text-sm text-gray-500",children:rr[T.language]||T.language}),i.jsx("td",{className:"px-3 py-2 text-sm text-gray-500",children:T.created_at?new Date(T.created_at).toLocaleString():"-"}),i.jsx("td",{className:"px-3 py-2 text-sm text-gray-500",children:T.admin_updated_at?new Date(T.admin_updated_at).toLocaleString():"-"}),i.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:i.jsx("button",{onClick:J=>{J.stopPropagation(),Ce(T)},className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200",children:"Review"})})]},T.id))})]})})]}),d==="feedback"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"font-medium text-gray-900",children:"User Feedback"}),y.length===0?i.jsx("p",{className:"text-gray-500 text-sm",children:"No feedback submissions"}):i.jsx("div",{className:"divide-y",children:y.map(T=>i.jsx("div",{className:"py-3",children:i.jsx("div",{className:"flex items-start justify-between",children:i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${T.type==="bug"?"bg-red-100 text-red-700":T.type==="feature"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:T.type||"suggestion"}),i.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${T.status==="resolved"?"bg-green-100 text-green-700":T.status==="in_progress"?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-600"}`,children:T.status||"pending"})]}),i.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["From: ",T.name||"Anonymous"," ",T.email&&`<${T.email}>`]}),i.jsx("p",{className:"text-gray-800 mt-2 whitespace-pre-wrap",children:T.message}),i.jsx("div",{className:"text-xs text-gray-400 mt-1",children:T.created_at&&new Date(T.created_at).toLocaleString()})]})})},T.id))})]}),d==="cache"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"font-medium text-gray-900",children:"Cache Management"}),i.jsx("p",{className:"text-sm text-gray-500",children:'Click "Clear" to see what will be affected before confirming.'}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"bg-green-50 border border-green-200 p-4 rounded",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Search Cache"}),i.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-green-100 text-green-700 rounded",children:"Low Risk"})]}),i.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[(E==null?void 0:E.search_cache_size)||0," entries"]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1 mb-2",children:"Cached search results"}),i.jsx("button",{onClick:()=>Re("search"),className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Clear..."})]}),i.jsxs("div",{className:"bg-red-50 border border-red-200 p-4 rounded",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Lemma Cache"}),i.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-red-100 text-red-700 rounded",children:"High Risk"})]}),i.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[(E==null?void 0:E.lemma_cache_size)||0," entries"]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1 mb-2",children:"Lemmatized text data"}),i.jsx("button",{onClick:()=>Re("lemma"),className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Clear..."})]}),i.jsxs("div",{className:"bg-amber-50 border border-amber-200 p-4 rounded",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[i.jsx("span",{className:"text-sm text-gray-600",children:"Frequency Cache"}),i.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-amber-100 text-amber-700 rounded",children:"Medium Risk"})]}),i.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[(E==null?void 0:E.frequency_cache_size)||0," entries"]}),i.jsx("p",{className:"text-xs text-gray-500 mt-1 mb-2",children:"Word frequency data"}),i.jsx("button",{onClick:()=>Re("frequency"),className:"text-sm text-red-600 hover:text-red-800 font-medium",children:"Clear..."})]})]}),i.jsx("div",{className:"pt-4",children:i.jsx("button",{onClick:Z,className:"px-4 py-2 bg-amber-100 text-amber-700 rounded hover:bg-amber-200",children:"Recalculate Corpus Frequencies"})}),i.jsxs("div",{className:"pt-6 border-t mt-6",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Bigram Index (for Rare Pairs Search)"}),i.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Build bigram indexes to enable the Rare Pairs search feature. This may take several minutes per language."}),he&&i.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm",children:he}),fe&&i.jsx("div",{className:"mb-4 p-3 bg-green-50 border border-green-200 rounded text-green-700 text-sm",children:fe}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["la","grc","en"].map(T=>{var J;return i.jsxs("div",{className:`p-4 rounded border ${K[T]?"bg-green-50 border-green-200":"bg-gray-50 border-gray-200"}`,children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"font-medium text-gray-900",children:rr[T]}),K[T]&&i.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-green-100 text-green-700 rounded",children:"Built"})]}),K[T]?i.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[((J=K[T].unique_bigrams)==null?void 0:J.toLocaleString())||0," unique pairs"]}):i.jsx("div",{className:"text-sm text-gray-500 mb-2",children:"Not built yet"}),i.jsx("button",{onClick:()=>ge(T),disabled:ce!==null,className:`w-full px-3 py-1.5 text-sm rounded ${ce===T?"bg-blue-100 text-blue-700 cursor-wait":K[T]?"bg-green-100 text-green-700 hover:bg-green-200":"bg-blue-100 text-blue-700 hover:bg-blue-200"} ${ce!==null&&ce!==T?"opacity-50 cursor-not-allowed":""}`,children:ce===T?"Building...":K[T]?"Rebuild":"Build Index"})]},T)})})]})]}),d==="stats"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"font-medium text-gray-900",children:"Corpus Statistics"}),p?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:["la","grc","en"].map(T=>i.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[i.jsx("div",{className:"text-lg font-medium text-gray-900 mb-2",children:rr[T]}),i.jsx("div",{className:"space-y-1 text-sm",children:i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-600",children:"Texts:"}),i.jsx("span",{className:"font-medium",children:(p[T]||0).toLocaleString()})]})})]},T))}):i.jsx("p",{className:"text-gray-500 text-sm",children:"Loading corpus statistics..."})]}),d==="analytics"&&i.jsxs("div",{className:"space-y-6",children:[i.jsx("h3",{className:"font-medium text-gray-900",children:"User Analytics"}),b?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"bg-blue-50 p-4 rounded",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Total Searches"}),i.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(b.total_searches||0).toLocaleString()})]}),i.jsxs("div",{className:"bg-green-50 p-4 rounded",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Searches Today"}),i.jsx("div",{className:"text-2xl font-bold text-gray-900",children:((Je=(st=b.per_day)==null?void 0:st.find(T=>T.date===new Date().toISOString().split("T")[0]))==null?void 0:Je.count)||0})]}),i.jsxs("div",{className:"bg-amber-50 p-4 rounded",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"Unique Users"}),i.jsx("div",{className:"text-2xl font-bold text-gray-900",children:b.unique_users||"N/A"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Searches by Type"}),i.jsx("div",{className:"bg-gray-50 rounded p-3 space-y-2",children:((Ge=b.by_type)==null?void 0:Ge.map(T=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:T.type}),i.jsx("span",{className:"font-medium",children:T.count})]},T.type)))||i.jsx("p",{className:"text-gray-500 text-sm",children:"No data"})})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Searches by Language"}),i.jsx("div",{className:"bg-gray-50 rounded p-3 space-y-2",children:((Ve=b.by_language)==null?void 0:Ve.map(T=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:rr[T.language]||T.language}),i.jsx("span",{className:"font-medium",children:T.count})]},T.language)))||i.jsx("p",{className:"text-gray-500 text-sm",children:"No data"})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Top Source Texts"}),i.jsx("div",{className:"bg-gray-50 rounded p-3 space-y-2 max-h-48 overflow-y-auto",children:((Oe=b.top_sources)==null?void 0:Oe.map((T,J)=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600 truncate max-w-[200px]",title:T.text,children:T.text}),i.jsx("span",{className:"font-medium",children:T.count})]},J)))||i.jsx("p",{className:"text-gray-500 text-sm",children:"No data"})})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Top Target Texts"}),i.jsx("div",{className:"bg-gray-50 rounded p-3 space-y-2 max-h-48 overflow-y-auto",children:((H=b.top_targets)==null?void 0:H.map((T,J)=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600 truncate max-w-[200px]",title:T.text,children:T.text}),i.jsx("span",{className:"font-medium",children:T.count})]},J)))||i.jsx("p",{className:"text-gray-500 text-sm",children:"No data"})})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Daily Search Activity (Last 30 Days)"}),i.jsx("div",{className:"bg-gray-50 rounded p-3 max-h-48 overflow-y-auto",children:((se=b.per_day)==null?void 0:se.length)>0?i.jsx("div",{className:"space-y-1",children:b.per_day.slice(0,14).map(T=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:T.date}),i.jsx("span",{className:"font-medium",children:T.count})]},T.date))}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No recent searches"})})]}),i.jsxs("div",{className:"border-t pt-6",children:[i.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-4",children:"Geographic Distribution"}),((oe=b.top_cities)==null?void 0:oe.length)>0||((me=b.top_countries)==null?void 0:me.length)>0?i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"text-xs font-medium text-gray-500 uppercase mb-2",children:"Top Countries"}),i.jsx("div",{className:"bg-gray-50 rounded p-3 space-y-2",children:((je=b.top_countries)==null?void 0:je.map((T,J)=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{className:"text-gray-600",children:T.country}),i.jsx("span",{className:"font-medium",children:T.count})]},J)))||i.jsx("p",{className:"text-gray-500 text-sm",children:"No data"})})]}),i.jsxs("div",{children:[i.jsx("h5",{className:"text-xs font-medium text-gray-500 uppercase mb-2",children:"Top Cities"}),i.jsx("div",{className:"bg-gray-50 rounded p-3 space-y-2 max-h-48 overflow-y-auto",children:((Ie=b.top_cities)==null?void 0:Ie.map((T,J)=>i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsxs("span",{className:"text-gray-600",children:[T.city,T.country?`, ${T.country}`:""]}),i.jsx("span",{className:"font-medium",children:T.count})]},J)))||i.jsx("p",{className:"text-gray-500 text-sm",children:"No data"})})]})]}),i.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-4 border border-blue-100",children:[i.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-3",children:"User Distribution Map"}),i.jsx("div",{className:"relative bg-white rounded p-4 min-h-[200px] flex flex-col items-center justify-center",children:((_e=b.top_cities)==null?void 0:_e.length)>0?i.jsxs("div",{className:"w-full",children:[i.jsx("div",{className:"flex flex-wrap gap-2 justify-center",children:b.top_cities.slice(0,10).map((T,J)=>{const pe=Math.max(...b.top_cities.map(ds=>ds.count)),at=Math.max(24,Math.min(80,T.count/pe*80)),ot=.4+T.count/pe*.6;return i.jsxs("div",{className:"flex flex-col items-center group cursor-pointer",title:`${T.city}, ${T.country}: ${T.count} searches`,children:[i.jsx("div",{className:"rounded-full bg-red-500 flex items-center justify-center text-white text-xs font-bold shadow-lg transition-transform hover:scale-110",style:{width:at,height:at,opacity:ot},children:T.count}),i.jsx("span",{className:"text-xs text-gray-600 mt-1 max-w-[60px] truncate text-center",children:T.city})]},J)})}),i.jsx("p",{className:"text-xs text-gray-500 text-center mt-4",children:"Circle size indicates relative search volume. Hover for details."})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"No geographic data available yet"})})]})]}):i.jsxs("div",{className:"bg-gray-50 rounded p-4 text-center",children:[i.jsx("p",{className:"text-gray-500 text-sm",children:"No geographic data available yet."}),i.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"User locations are tracked via IP geolocation when searches are performed."})]})]})]}):i.jsx("p",{className:"text-gray-500 text-sm",children:"Loading analytics..."})]}),d==="audit"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h3",{className:"font-medium text-gray-900",children:"Admin Activity Log"}),i.jsx("button",{onClick:be,disabled:R,className:"text-sm px-3 py-1 text-red-700 border border-red-700 rounded hover:bg-red-50 disabled:opacity-50",children:R?"Refreshing...":"Refresh"})]}),R?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx(Kt,{})}):ie.length===0?i.jsx("div",{className:"bg-gray-50 rounded p-8 text-center",children:i.jsx("p",{className:"text-gray-500",children:"No admin activity recorded yet."})}):i.jsx("div",{className:"space-y-4",children:(()=>{const T={};return ie.forEach(J=>{const pe=J.admin_username||"unknown";T[pe]||(T[pe]=[]),T[pe].push(J)}),Object.keys(T).sort().map(J=>i.jsxs("div",{className:"bg-gray-50 rounded-lg overflow-hidden",children:[i.jsxs("div",{className:"bg-gray-100 px-4 py-2 border-b",children:[i.jsx("h4",{className:"font-medium text-gray-800",children:J}),i.jsxs("span",{className:"text-sm text-gray-500",children:[T[J].length," actions"]})]}),i.jsxs("div",{className:"divide-y",children:[T[J].slice(0,20).map(pe=>i.jsxs("div",{className:"px-4 py-2 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("span",{className:`text-xs font-medium px-2 py-0.5 rounded ${pe.action==="login"?"bg-blue-100 text-blue-700":pe.action==="approve"?"bg-green-100 text-green-700":pe.action==="delete"?"bg-red-100 text-red-700":pe.action==="update"?"bg-amber-100 text-amber-700":"bg-gray-100 text-gray-700"}`,children:pe.action}),pe.target_type&&i.jsxs("span",{className:"text-sm text-gray-600",children:[pe.target_type," #",pe.target_id]})]}),i.jsx("span",{className:"text-xs text-gray-400",children:pe.created_at?new Date(pe.created_at).toLocaleString():""})]},pe.id)),T[J].length>20&&i.jsxs("div",{className:"px-4 py-2 text-sm text-gray-500 text-center",children:["+ ",T[J].length-20," more actions"]})]})]},J))})()}),i.jsxs("div",{className:"mt-6",children:[i.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Summary by Action Type"}),i.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3",children:(()=>{const T={};return ie.forEach(J=>{T[J.action]=(T[J.action]||0)+1}),Object.entries(T).sort((J,pe)=>pe[1]-J[1]).map(([J,pe])=>i.jsxs("div",{className:"bg-white border rounded p-3 text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-gray-800",children:pe}),i.jsx("div",{className:`text-sm font-medium ${J==="login"?"text-blue-600":J==="approve"?"text-green-600":J==="delete"?"text-red-600":J==="update"?"text-amber-600":"text-gray-600"}`,children:J})]},J))})()})]})]}),d==="settings"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Email Notifications"}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notification Email Addresses"}),i.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Enter email addresses to receive notifications when users submit text requests or feedback. Separate multiple addresses with commas."}),i.jsx("textarea",{value:N,onChange:T=>U(T.target.value),placeholder:"admin@example.com, scholar@university.edu",className:"w-full border rounded px-3 py-2 text-sm",rows:3})]}),z&&i.jsx("div",{className:`text-sm p-2 rounded ${z.type==="success"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:z.text}),i.jsx("button",{onClick:tt,disabled:B,className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:opacity-50",children:B?"Saving...":"Save Email Settings"})]})]}),i.jsxs("div",{className:"text-sm text-gray-500 bg-amber-50 p-4 rounded",children:[i.jsx("strong",{children:"Note:"})," Email notifications will be sent when:",i.jsxs("ul",{className:"list-disc ml-5 mt-2 space-y-1",children:[i.jsx("li",{children:"A user submits a request for a new text to be added"}),i.jsx("li",{children:"A user submits feedback through the Help page"})]})]})]})]})]}),C&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[i.jsxs("div",{className:`px-6 py-4 border-b ${C.severity==="high"?"bg-red-50 border-red-200":C.severity==="medium"?"bg-amber-50 border-amber-200":"bg-green-50 border-green-200"}`,children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[C.severity==="high"&&i.jsx("span",{className:"text-red-600",children:""}),C.severity==="medium"&&i.jsx("span",{className:"text-amber-600",children:""}),"Clear ",C.title,"?"]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:C.description})]}),i.jsxs("div",{className:"px-6 py-4 space-y-4",children:[i.jsxs("div",{className:"bg-gray-50 rounded p-3",children:[i.jsx("div",{className:"text-sm font-medium text-gray-700 mb-1",children:"Current Size"}),i.jsxs("div",{className:"text-2xl font-bold text-gray-900",children:[C.entryCount.toLocaleString()," entries"]})]}),i.jsxs("div",{children:[i.jsx("div",{className:`text-sm font-medium mb-2 ${C.severity==="high"?"text-red-700":C.severity==="medium"?"text-amber-700":"text-gray-700"}`,children:"What will happen if you clear this cache:"}),i.jsx("ul",{className:"space-y-2",children:C.impact.map((T,J)=>i.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-700",children:[i.jsx("span",{className:`mt-1 flex-shrink-0 ${C.severity==="high"?"text-red-500":C.severity==="medium"?"text-amber-500":"text-gray-400"}`,children:""}),T]},J))})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded p-3",children:[i.jsx("div",{className:"text-sm font-medium text-blue-800 mb-1",children:"How to Rebuild"}),i.jsx("p",{className:"text-sm text-blue-700",children:C.rebuildTime})]}),P&&i.jsxs("div",{className:"bg-red-50 border border-red-300 rounded p-3",children:[i.jsx("div",{className:"text-sm font-medium text-red-800",children:"Error"}),i.jsx("p",{className:"text-sm text-red-700",children:P})]})]}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t flex justify-end gap-3",children:[i.jsx("button",{onClick:()=>W(null),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50",disabled:S,children:"Cancel"}),i.jsx("button",{onClick:()=>qs(C.cacheType),disabled:S,className:`px-4 py-2 text-white rounded disabled:opacity-50 ${C.severity==="high"?"bg-red-600 hover:bg-red-700":C.severity==="medium"?"bg-amber-600 hover:bg-amber-700":"bg-gray-600 hover:bg-gray-700"}`,children:S?"Clearing...":"Yes, Clear Cache"})]})]})}),M&&$&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[i.jsxs("div",{className:"px-6 py-4 border-b bg-gray-50 flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Review Text Request"}),i.jsxs("p",{className:"text-sm text-gray-500",children:["Submitted by ",M.name||"Anonymous",M.email&&` (${M.email})`]})]}),i.jsx("button",{onClick:()=>I(null),className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),i.jsxs("div",{className:"p-6 overflow-y-auto flex-1 space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Official Author Name"}),i.jsx("input",{type:"text",value:$.official_author,onChange:T=>{Q(J=>({...J,official_author:T.target.value})),ve($.content,T.target.value,$.official_work)},className:"w-full border rounded px-3 py-2 text-sm",placeholder:"e.g., Vergil"}),i.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Original: ",M.author]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Official Work Title"}),i.jsx("input",{type:"text",value:$.official_work,onChange:T=>{Q(J=>({...J,official_work:T.target.value})),ve($.content,$.official_author,T.target.value)},className:"w-full border rounded px-3 py-2 text-sm",placeholder:"e.g., Aeneid"}),i.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Original: ",M.work]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Language"}),i.jsx("div",{className:"px-3 py-2 bg-gray-100 rounded text-sm",children:rr[M.language]||M.language})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Text Date / Era"}),i.jsx("input",{type:"text",value:$.text_date,onChange:T=>Q(J=>({...J,text_date:T.target.value})),className:"w-full border rounded px-3 py-2 text-sm",placeholder:"e.g., 19 BCE, 1st century CE"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:".tess Filename"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"text",value:$.approved_filename,onChange:T=>Q(J=>({...J,approved_filename:T.target.value})),className:"flex-1 border rounded px-3 py-2 text-sm font-mono"}),i.jsx("button",{onClick:et,className:"px-2 py-1 bg-gray-100 text-gray-600 rounded text-xs hover:bg-gray-200",title:"Auto-generate from author/work",children:"Auto"})]})]})]}),M.notes&&i.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded p-3",children:[i.jsx("div",{className:"text-sm font-medium text-amber-800",children:"Submitter Notes"}),i.jsx("p",{className:"text-sm text-amber-700 mt-1",children:M.notes})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Admin Notes"}),i.jsx("textarea",{value:$.admin_notes,onChange:T=>Q(J=>({...J,admin_notes:T.target.value})),className:"w-full border rounded px-3 py-2 text-sm",rows:2,placeholder:"Internal notes about this request..."})]}),i.jsxs("div",{className:"border-t pt-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Text Content (Raw)"}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("button",{onClick:()=>{if(!$.content||!$.official_author||!$.official_work)return;const T=$.official_author.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9._-]/g,""),J=$.official_work.toLowerCase().replace(/\s+/g,"_").replace(/[^a-z0-9._-]/g,""),at=$.content.split(`
`).filter(ot=>ot.trim()).map((ot,ds)=>{const hs=ot.trim();return hs.startsWith("<")&&hs.includes(">")?hs:`<${T}.${J}.${ds+1}> ${hs}`}).join(`
`);Q(ot=>({...ot,content:at})),ve(at,$.official_author,$.official_work)},className:"px-2 py-1 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200",title:"Add .tess tags to each line",children:"Add .tess Tags"}),i.jsxs("span",{className:"text-xs text-gray-500",children:[$.content?$.content.split(`
`).filter(T=>T.trim()).length:0," lines"]})]})]}),i.jsx("textarea",{value:$.content,onChange:T=>{Q(J=>({...J,content:T.target.value})),ve(T.target.value,$.official_author,$.official_work)},className:"w-full border rounded px-3 py-2 text-sm font-mono",rows:8,placeholder:"Paste or edit the text content here..."})]}),i.jsxs("div",{className:"bg-gray-900 rounded p-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("span",{className:"text-xs font-medium text-gray-400 uppercase",children:".tess Preview"}),i.jsx("span",{className:"text-xs text-gray-500",children:"First 10 lines"})]}),i.jsx("pre",{className:"text-green-400 text-sm font-mono whitespace-pre-wrap overflow-x-auto",children:ne||"Enter author, work, and content to see preview..."})]})]}),i.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t flex justify-between",children:[i.jsx("div",{className:"flex gap-2",children:i.jsx("button",{onClick:()=>Ne(M.id),disabled:X,className:"px-4 py-2 bg-red-100 text-red-700 rounded hover:bg-red-200 disabled:opacity-50",children:"Delete"})}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>I(null),className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded hover:bg-gray-50",children:"Cancel"}),i.jsx("button",{onClick:Me,disabled:X,className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:opacity-50",children:X?"Saving...":"Save Changes"}),i.jsx("button",{onClick:Pe,disabled:X||!$.content,className:"px-4 py-2 bg-red-800 text-white rounded hover:bg-red-900 disabled:opacity-50",children:X?"Processing...":"Approve & Add to Corpus"})]})]})]})})]}):i.jsx("div",{className:"max-w-md mx-auto mt-12",children:i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Admin Login"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Username"}),i.jsx("input",{type:"text",value:s,onChange:T=>n(T.target.value),className:"w-full border rounded px-3 py-2",placeholder:"Enter your admin username"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Password"}),i.jsxs("div",{className:"relative",children:[i.jsx("input",{type:o?"text":"password",value:r,onChange:T=>a(T.target.value),onKeyDown:T=>T.key==="Enter"&&ae(),className:"w-full border rounded px-3 py-2 pr-10",placeholder:"Enter admin password"}),i.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-700 text-sm",children:o?"Hide":"Show"})]})]}),c&&i.jsx("div",{className:"text-red-600 text-sm",children:c}),i.jsx("button",{onClick:ae,className:"w-full px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800",children:"Login"})]})]})})}function lN(){const[e,t]=j.useState({version:"6.0",last_updated:null});return j.useEffect(()=>{fetch("/api/version").then(s=>s.json()).then(s=>t(s)).catch(s=>console.error("Failed to fetch version info:",s))},[]),i.jsxs("div",{className:"bg-white rounded-lg shadow p-4 sm:p-8",children:[i.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"About Tesserae"}),i.jsxs("div",{className:"prose max-w-none space-y-8",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"What is Tesserae?"}),i.jsx("p",{className:"text-gray-700 leading-relaxed mb-3",children:"Tesserae is an intertextual analysis tool for discovering textual parallels in classical literature. It helps scholars find passages where one author may have been influenced by, alluding to, or directly quoting another text. Founded by Neil Coffee and J. P. Koenig in 2008 at the University at Buffalo, SUNY, this is Version 6, a modern reimplementation of the V3 algorithm."}),i.jsx("p",{className:"text-gray-700 leading-relaxed",children:'The name "Tesserae" refers to the small tiles used in Roman mosaics. Just as these tiles combine to form larger images, textual parallels reveal the interconnected nature of classical literature.'})]}),i.jsxs("section",{className:"bg-amber-50 border border-amber-200 rounded-lg p-5",children:[i.jsx("h3",{className:"text-lg font-semibold text-amber-900 mb-3",children:"Creation & Credits"}),i.jsxs("p",{className:"text-gray-700 mb-3",children:[i.jsx("strong",{children:"Tesserae V6"})," was created in January 2026 by"," ",i.jsx("a",{href:"https://arts-sciences.buffalo.edu/classics/faculty/core-faculty/coffee-neil.html",target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:underline font-semibold",children:"Neil Coffee"})," ","(University at Buffalo) using ",i.jsx("strong",{children:"Replit Agent"}),", an AI-assisted development platform."]}),i.jsxs("p",{className:"text-gray-700 mb-4",children:["Tesserae is a collaboration between"," ",i.jsx("a",{href:"https://www.buffalo.edu/cas/english/faculty/faculty_directory.host.html/content/shared/cas/english/faculty-staff/faculty/coffee.detail.html",target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:underline font-semibold",children:"Neil Coffee"})," ","(University at Buffalo) and"," ",i.jsx("a",{href:"https://engineering.nd.edu/faculty/walter-scheirer/",target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:underline font-semibold",children:"Walter Scheirer"})," ","(University of Notre Dame). Neil created V6 and the team collaborates on its ongoing development."]}),i.jsxs("p",{className:"text-gray-700 mb-4",children:[i.jsx("a",{href:"https://mta.ca/directory/chris-forstall",target:"_blank",rel:"noopener noreferrer",className:"text-amber-600 hover:underline font-semibold",children:"Chris Forstall"})," ","(Mount Allison University) was the lead developer of Tesserae V3, which established the core algorithms and infrastructure that V6 builds upon."]}),i.jsx("p",{className:"text-gray-700 mb-4",children:"Graduate Tesserae Fellows have been at the core of the project from its inception. In chronological order from the beginning of the project in 2008, they are (UB = U. Buffalo graduate student, ND = Notre Dame graduate student): Poornima Shakthi (UB), Roelant Ossewarde (UB), Chris Forstall (UB), James Gawley (UB), Jeffery Kinnison (ND), Tessa Little (UB), John James (UB), Abby Swenor (ND)."}),i.jsxs("div",{className:"text-sm text-gray-700 space-y-2",children:[i.jsx("p",{children:i.jsx("strong",{children:"Built upon:"})}),i.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Tesserae V3"}),": Original scoring algorithm, text corpus, and synonym dictionaries (developed by Chris Forstall at University at Buffalo)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Tesserae V5"}),": API design concepts and modern architecture patterns (developed with Walter Scheirer)"]})]}),i.jsxs("p",{className:"mt-3",children:[i.jsx("strong",{children:"License:"})," MIT License - free to use, modify, and redistribute."]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Key Features"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-red-700 mb-2",children:"Multi-Language Support"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Search within Latin, Greek, or English texts. Our corpus includes works from Homer to medieval authors."})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-red-700 mb-2",children:"Cross-Lingual Analysis"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Discover connections between Greek and Latin texts using AI-powered semantic matching (SPhilBERTa model)."})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-red-700 mb-2",children:"Rare Word Search"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Find rare vocabulary shared between texts - often indicative of direct influence."})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-red-700 mb-2",children:"V3-Style Scoring"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Our scoring algorithm uses Inverse Document Frequency (IDF) and distance penalties for precise results."})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-red-700 mb-2",children:"Word Pairs Detection"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Identify unusual word combinations (bigrams) that may indicate textual borrowing even when individual words are common."})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-red-700 mb-2",children:"Intertext Repository"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Save and share discovered parallels with the scholarly community. Track verified intertexts."})]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"The Corpus"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-4",children:[i.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[i.jsx("div",{className:"text-3xl font-bold text-red-700",children:"1,444+"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Latin Texts"})]}),i.jsxs("div",{className:"text-center p-4 bg-amber-50 rounded-lg",children:[i.jsx("div",{className:"text-3xl font-bold text-amber-700",children:"650+"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Greek Texts"})]}),i.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[i.jsx("div",{className:"text-3xl font-bold text-green-700",children:"14+"}),i.jsx("div",{className:"text-sm text-gray-600",children:"English Texts"})]})]}),i.jsx("p",{className:"text-gray-700 text-sm",children:"Our corpus draws from authoritative sources including Perseus Digital Library, CSEL, and other scholarly editions. Provenance information is tracked for each text."})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Technical Details"}),i.jsxs("ul",{className:"list-disc list-inside text-gray-700 space-y-2",children:[i.jsx("li",{children:"Lemmatization via CLTK (Classical Language Toolkit) for Latin and Greek"}),i.jsx("li",{children:"NLTK for English text processing"}),i.jsx("li",{children:"SPhilBERTa model for cross-lingual semantic similarity"}),i.jsx("li",{children:"Universal Dependencies treebank support for syntax analysis"}),i.jsx("li",{children:"Metrical scansion data integrated from MQDQ/Pede Certo"})]})]}),i.jsxs("section",{className:"bg-green-50 border border-green-200 rounded-lg p-5",children:[i.jsx("h3",{className:"text-lg font-semibold text-green-900 mb-4",children:"Grant Support & Acknowledgments"}),i.jsx("p",{className:"text-gray-700 mb-4",children:"The Tesserae Project has been made possible by the generous support of the following organizations:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx("div",{className:"bg-white p-4 rounded-lg border border-green-100",children:i.jsxs("a",{href:"https://www.neh.gov/divisions/odh",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 hover:opacity-80",children:[i.jsx("img",{src:"/logos/neh-logo.jpg",alt:"NEH Logo",className:"w-20 h-auto object-contain flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900",children:"National Endowment for the Humanities"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Office of Digital Humanities"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Digital Humanities Advancement Grant (2018-2020)"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Start-Up Phase II Grant (2012-2013)"})]})]})}),i.jsx("div",{className:"bg-white p-4 rounded-lg border border-green-100",children:i.jsxs("a",{href:"https://arts-sciences.buffalo.edu/classics.html",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 hover:opacity-80",children:[i.jsx("img",{src:"/logos/ub-logo.png",alt:"University at Buffalo Logo",className:"w-20 h-auto object-contain flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900",children:"University at Buffalo, SUNY"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Department of Classics"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Institutional home and ongoing support"})]})]})}),i.jsx("div",{className:"bg-white p-4 rounded-lg border border-green-100",children:i.jsxs("a",{href:"https://www.snf.ch/en",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 hover:opacity-80",children:[i.jsx("img",{src:"/logos/snsf-logo.png",alt:"Swiss National Science Foundation Logo",className:"w-24 h-auto object-contain flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900",children:"Swiss National Science Foundation"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Intertextuality in Flavian Epic Poetry"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Research Grant (2013-2016)"})]})]})}),i.jsx("div",{className:"bg-white p-4 rounded-lg border border-green-100",children:i.jsxs("a",{href:"https://www.fmsh.fr/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 hover:opacity-80",children:[i.jsx("img",{src:"/logos/fmsh-logo.png",alt:"Fondation Maison des Sciences de l'Homme Logo",className:"w-20 h-auto object-contain flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900",children:"Fondation Maison des Sciences de l'Homme"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Transatlantic Program for Digital Humanities"}),i.jsx("div",{className:"text-xs text-gray-500",children:"TESSERAE MUSIVAE Project (2016-2017)"})]})]})}),i.jsx("div",{className:"bg-white p-4 rounded-lg border border-green-100",children:i.jsxs("a",{href:"https://aws.amazon.com/",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 hover:opacity-80",children:[i.jsx("div",{className:"w-16 h-16 bg-orange-500 rounded-lg flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-white font-bold text-sm",children:"AWS"})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900",children:"Amazon Web Services"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Cloud Computing Resources"}),i.jsx("div",{className:"text-xs text-gray-500",children:"In-kind grant (2016-2017)"})]})]})}),i.jsx("div",{className:"bg-white p-4 rounded-lg border border-green-100",children:i.jsxs("a",{href:"https://www.buffalo.edu/humanities-institute.html",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-3 hover:opacity-80",children:[i.jsx("div",{className:"w-16 h-16 bg-blue-800 rounded-lg flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-white font-bold text-xs",children:"UBHI"})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900",children:"UB Humanities Institute"}),i.jsx("div",{className:"text-sm text-gray-600",children:"Digital Humanities Institute at Buffalo"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Seed Grants & Fellowships (2008-2020)"})]})]})})]}),i.jsx("p",{className:"text-sm text-gray-600 italic",children:"We are grateful to all our supporters who have made this research possible over the years."})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Contact"}),i.jsxs("p",{className:"text-gray-700",children:["Questions or feedback? Contact"," ",i.jsx("a",{href:"mailto:ncoffee@buffalo.edu",className:"text-amber-600 hover:underline",children:"ncoffee@buffalo.edu"})]}),i.jsxs("p",{className:"text-gray-700 mt-2",children:[i.jsx("strong",{children:"Neil Coffee"}),", Department of Classics, University at Buffalo"]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Citation"}),i.jsx("div",{className:"bg-gray-100 p-4 rounded font-mono text-sm",children:"Coffee, Neil. Tesserae V6: Intertextual and Literary Discovery. University at Buffalo, 2026. Available at: tesserae.caset.buffalo.edu"})]}),e.last_updated&&i.jsx("section",{className:"border-t pt-4 mt-6",children:i.jsxs("p",{className:"text-sm text-gray-500",children:[i.jsx("strong",{children:"Last Updated:"})," ",e.last_updated]})})]})]})}const Ht={description:"The Default stoplist combines curated function words with automatic high-frequency detection using Zipf's law.",howItWorks:["Curated words: Pronouns, articles, conjunctions, prepositions, common verbs","Zipf detection: Automatically identifies 10-50 additional high-frequency words from your selected texts","The two lists are combined to filter out noise while preserving meaningful vocabulary"],latin:{count:66,examples:["et","in","est","non","ut","cum","qui","quae","que","hic","ille","sum","esse"]},greek:{count:88,examples:["","","","","","","","","","","","",""]},english:{count:60,examples:["the","be","to","of","and","a","in","that","have","it","thou","thee","thy","hath"]},options:{default:"Uses curated stop words + Zipf elbow detection (recommended)",manual:"Enter a number (e.g., 50) to use only the top N most frequent words",disabled:"Enter -1 to disable stoplisting entirely (not recommended)"},customStopwordsNote:"Use dictionary forms (lemmata): pietas not pietate,  not , king not kings."};function cN(){const[e,t]=j.useState("getting-started"),[s,n]=j.useState(""),[r,a]=j.useState(""),[o,l]=j.useState(""),[c,u]=j.useState(""),[d,h]=j.useState("latin"),[f,m]=j.useState(""),[v,x]=j.useState(null),[y,g]=j.useState(!1),[p,w]=j.useState(null),[b,k]=j.useState(""),[E,_]=j.useState(""),[N,U]=j.useState("suggestion"),[B,q]=j.useState(""),[z,G]=j.useState(!1),[C,W]=j.useState(null),[S,V]=j.useState(""),[P,O]=j.useState(""),[A,L]=j.useState("poetry"),[M,I]=j.useState("1"),[$,Q]=j.useState("1"),[X,F]=j.useState(""),[ne,ue]=j.useState(""),[ie,D]=j.useState(!1),R=()=>{if(!S.trim()||!P.trim()||!X.trim())return;const re=S.toLowerCase().replace(/\s+/g,"_"),fe=P.toLowerCase().replace(/\s+/g,"_"),ye=X.split(`
`).filter(Ne=>Ne.trim());let ae=parseInt(M)||1,xe=parseInt($)||1;const be=ye.map((Ne,Ce)=>{const ve=Ne.trim(),Me=ve.match(/^(book|liber|chapter|act)\s*(\d+|[ivxlc]+)/i);if(Me)return ae=Me[2].match(/^\d+$/)?parseInt(Me[2]):Y(Me[2]),xe=1,null;if(!ve)return null;let Pe;return A==="poetry"?(Pe=`<${re}.${fe} ${ae}.${xe}>`,xe++):A==="prose"?(Pe=`<${re}.${fe} ${ae}.${xe}>`,xe++):A==="drama"&&(Pe=`<${re}.${fe} ${ae}.1.${xe}>`,xe++),`${Pe} ${ve}`}).filter(Boolean);ue(be.join(`
`))},Y=re=>{const fe={i:1,v:5,x:10,l:50,c:100};let ye=0;const ae=re.toLowerCase();for(let xe=0;xe<ae.length;xe++){const be=fe[ae[xe]]||0,Ne=fe[ae[xe+1]]||0;ye+=be<Ne?-be:be}return ye||1},K=()=>{navigator.clipboard.writeText(ne),D(!0),setTimeout(()=>D(!1),2e3)},te=()=>{const re=S.toLowerCase().replace(/\s+/g,"_"),fe=P.toLowerCase().replace(/\s+/g,"_"),ye=new Blob([ne],{type:"text/plain"}),ae=URL.createObjectURL(ye),xe=document.createElement("a");xe.href=ae,xe.download=`${re}.${fe}.tess`,xe.click(),URL.revokeObjectURL(ae)},ce=[{id:"getting-started",label:"Getting Started"},{id:"search-modes",label:"Search Modes"},{id:"match-types",label:"Match Types"},{id:"settings",label:"Search Settings"},{id:"stoplists",label:"Stoplists"},{id:"results",label:"Understanding Results"},{id:"best-practices",label:"Search Tips"},{id:"cross-lingual",label:"Cross-Lingual Search"},{id:"syntax-texts",label:"Syntax Matching Texts"},{id:"repository",label:"Repository"},{id:"faq",label:"FAQ"},{id:"upload-text",label:"Upload Your Text"},{id:"feedback",label:"Send Feedback"}],de=async re=>{if(re.preventDefault(),!o.trim()||!c.trim()){w({type:"error",text:"Please enter author and work title"});return}g(!0),w(null);try{const fe=new FormData;fe.append("name",s),fe.append("email",r),fe.append("author",o),fe.append("work",c),fe.append("language",d),fe.append("notes",f),v&&fe.append("file",v);const ae=await(await fetch("/api/request",{method:"POST",body:fe})).json();ae.success?(w({type:"success",text:"Text uploaded successfully! We will review and add it to the corpus soon."}),l(""),u(""),m(""),x(null)):w({type:"error",text:ae.error||"Failed to submit text"})}catch{w({type:"error",text:"Failed to submit request"})}g(!1)},he=async re=>{if(re.preventDefault(),!B.trim()){W({type:"error",text:"Please enter your feedback"});return}G(!0),W(null);try{const ye=await(await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:b,email:E,type:N,message:B})})).json();ye.success?(W({type:"success",text:"Thank you for your feedback!"}),q("")):W({type:"error",text:ye.error||"Failed to submit feedback"})}catch{W({type:"error",text:"Failed to submit feedback"})}G(!1)};return i.jsx("div",{className:"bg-white rounded-lg shadow",children:i.jsxs("div",{className:"flex flex-col md:flex-row",children:[i.jsxs("nav",{className:"md:w-64 p-4 bg-gray-50 border-b md:border-b-0 md:border-r",children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Help Topics"}),i.jsx("ul",{className:"space-y-1",children:ce.map(re=>i.jsx("li",{children:i.jsx("button",{onClick:()=>t(re.id),className:`w-full text-left px-3 py-2 rounded text-sm ${e===re.id?"bg-red-100 text-red-700":"text-gray-600 hover:bg-gray-100"}`,children:re.label})},re.id))})]}),i.jsxs("div",{className:"flex-1 p-6",children:[e==="getting-started"&&i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Getting Started"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-4 text-gray-700",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Select a Language:"})," Choose Latin, Greek, or English from the language tabs."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Choose Source Text:"}),' Select the "source" text - typically the earlier text.']}),i.jsxs("li",{children:[i.jsx("strong",{children:"Choose Target Text:"}),' Select the "target" text - the later text that may contain the allusion.']}),i.jsxs("li",{children:[i.jsx("strong",{children:"Adjust Settings (Optional):"})," Configure match type, minimum matches, and other parameters."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Run Search:"}),' Click "Find Parallels" to discover textual connections.']})]}),i.jsxs("div",{className:"mt-6 bg-amber-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-amber-800 mb-2",children:"Tip"}),i.jsx("p",{className:"text-amber-700 text-sm",children:"Start with a smaller section (e.g., Book 1) rather than complete works for faster results."})]}),i.jsx("div",{className:"mt-4 bg-gray-50 p-4 rounded-lg",children:i.jsxs("p",{className:"text-gray-700 text-sm",children:[i.jsx("strong",{children:"Example:"})," Compare Vergil's Aeneid Book 1 (source) with Lucan's Civil War Book 1 (target) to find how Lucan echoes Vergil."]})})]}),e==="search-modes"&&i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Search Modes"}),i.jsx("p",{className:"text-gray-700 mb-6",children:"Tesserae offers five main search modes, accessible via tabs:"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"border-l-4 border-red-500 pl-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Phrases (Parallel Search)"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:'The default search mode. Finds passages that share multiple words between source and target texts. Uses lemma matching by default so "amor" matches "amorem", "amores", etc.'}),i.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:[i.jsx("strong",{children:"Use for:"})," Discovering allusions, quotations, and thematic parallels between texts."]})]}),i.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Lines (Line Search)"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Search for parallels to a specific line across the entire corpus. Select a line from any text, or type/paste Latin or Greek text directly."}),i.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:[i.jsx("strong",{children:"Use for:"})," Finding all passages in the corpus that share vocabulary with a specific line of interest."]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded mt-2 text-sm",children:[i.jsx("strong",{children:"Example:"}),' Search for "arma virumque cano" to find all lines sharing "arma" and "vir".']})]}),i.jsxs("div",{className:"border-l-4 border-amber-500 pl-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Rare Words"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Finds words that appear rarely across the entire corpus but are shared between your source and target texts. These low-frequency words often indicate meaningful textual connections."}),i.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:[i.jsx("strong",{children:"Use for:"})," Identifying distinctive vocabulary that suggests direct borrowing or influence."]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded mt-2 text-sm",children:[i.jsx("strong",{children:"Example:"}),` If "laticlavius" appears only 3 times in the corpus, and both Vergil and Lucan use it, that's significant.`]})]}),i.jsxs("div",{className:"border-l-4 border-purple-500 pl-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Word Pairs (Bigram Search)"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Discovers unusual word combinations (bigrams) that appear together in very few texts. Even if individual words are common, their pairing may be distinctive."}),i.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:[i.jsx("strong",{children:"Use for:"})," Detecting stylistic fingerprints, ",i.jsx("em",{children:"kakemphaton"}),", or formulaic expressions shared between authors."]})]}),i.jsxs("div",{className:"border-l-4 border-green-500 pl-4",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"String Search"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Wildcard and boolean search across the entire corpus. Perfect for finding specific words, word patterns, or co-occurrences."}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mt-3 text-sm",children:[i.jsxs("div",{className:"bg-amber-50 p-3 rounded border border-amber-200",children:[i.jsx("strong",{className:"text-amber-800",children:"Wildcards"}),i.jsxs("ul",{className:"text-gray-600 mt-1 space-y-1",children:[i.jsxs("li",{children:[i.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"*"})," - any characters (am* = amor, amicus...)"]}),i.jsxs("li",{children:[i.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"?"})," - single character (?or = cor, for, mor)"]}),i.jsxs("li",{children:[i.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"#"})," - word break (am# = am but not amor)"]})]})]}),i.jsxs("div",{className:"bg-amber-50 p-3 rounded border border-amber-200",children:[i.jsx("strong",{className:"text-amber-800",children:"Boolean Operators"}),i.jsxs("ul",{className:"text-gray-600 mt-1 space-y-1",children:[i.jsxs("li",{children:[i.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"AND"})," - both words required"]}),i.jsxs("li",{children:[i.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"OR"})," - either word matches"]}),i.jsxs("li",{children:[i.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"NOT"})," - exclude a word"]}),i.jsxs("li",{children:[i.jsx("code",{className:"bg-amber-100 px-1 rounded",children:"~"})," - proximity (~100 chars apart)"]})]})]})]}),i.jsxs("div",{className:"bg-gray-50 p-3 rounded mt-3 text-sm",children:[i.jsx("strong",{children:"Examples:"}),i.jsxs("ul",{className:"mt-1 space-y-1 text-gray-600",children:[i.jsxs("li",{children:[i.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"arma ~ virum"}),' - finds "arma" within ~100 characters of "virum"']}),i.jsxs("li",{children:[i.jsx("code",{className:"bg-gray-200 px-1 rounded",children:"mort* NOT vita"}),' - words starting with "mort" but not in lines with "vita"']})]})]})]})]})]}),e==="match-types"&&i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Match Types"}),i.jsx("p",{className:"text-gray-700 mb-4",children:"Within Phrases search, choose how words are matched:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Lemma (default)"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:'Matches words with the same dictionary form. "amor" matches "amorem", "amores", etc. Best for finding semantic parallels.'})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Exact"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Only identical word forms match. Good for finding direct quotations or formulaic phrases."})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Sound (Trigrams)"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Matches based on phonetic similarity using character patterns. Detects alliteration, rhyme, assonance, and consonance."})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Edit Distance"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:'Fuzzy matching for character-similar words. Finds morphological variants and spelling variations: "bellum" matches "bello", "bella".'})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg md:col-span-2",children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Semantic (AI)"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Uses deep learning embeddings to find passages with similar meaning, even with different vocabulary. Powered by the SPhilBERTa model trained on classical texts. Includes 54,000+ synonym pairs. Examples: numen~deus, bellum~proelium, ignis~flamma."})]})]}),i.jsxs("p",{className:"text-gray-600 text-sm mt-4",children:[i.jsx("strong",{children:"Tip:"})," Sound and Edit Distance can also be enabled as feature boosts when using Lemma or Exact matching."]})]}),e==="settings"&&i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Search Settings"}),i.jsxs("dl",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("dt",{className:"font-medium text-gray-900",children:"Minimum Matches"}),i.jsx("dd",{className:"text-gray-600 text-sm mt-1",children:"Require at least N shared words (default: 2). Higher values find stronger parallels but fewer results."})]}),i.jsxs("div",{children:[i.jsx("dt",{className:"font-medium text-gray-900",children:"Max Distance"}),i.jsx("dd",{className:"text-gray-600 text-sm mt-1",children:"Maximum word span between matched terms within a line. Use 999 for no limit."})]}),i.jsxs("div",{children:[i.jsx("dt",{className:"font-medium text-gray-900",children:"Stoplist"}),i.jsxs("dd",{className:"text-gray-600 text-sm mt-1",children:['Filter common words like "et", "in", "est" to reduce noise. The default setting combines curated function words with automatic high-frequency detection.',i.jsx("button",{onClick:()=>t("stoplists"),className:"text-red-600 hover:underline ml-1",children:"See Stoplists section for details "})]})]}),i.jsxs("div",{children:[i.jsx("dt",{className:"font-medium text-gray-900",children:"Unit Type (Line/Phrase)"}),i.jsx("dd",{className:"text-gray-600 text-sm mt-1",children:"Compare by poetic lines (default) or prose sentences. Phrase mode splits on punctuation."})]})]})]}),e==="stoplists"&&i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Stoplists"}),i.jsx("p",{className:"text-gray-700 mb-4",children:Ht.description}),i.jsx("h4",{className:"font-medium text-gray-900 mt-6 mb-2",children:"How the Default Stoplist Works"}),i.jsx("ul",{className:"list-disc list-inside text-gray-600 text-sm space-y-1 ml-2",children:Ht.howItWorks.map((re,fe)=>i.jsx("li",{children:re},fe))}),i.jsx("h4",{className:"font-medium text-gray-900 mt-6 mb-2",children:"Curated Stop Words by Language"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-3",children:[i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[i.jsxs("h5",{className:"font-medium text-gray-800 mb-1",children:["Latin (",Ht.latin.count," words)"]}),i.jsxs("p",{className:"text-xs text-gray-500 italic",children:[Ht.latin.examples.join(", "),"..."]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[i.jsxs("h5",{className:"font-medium text-gray-800 mb-1",children:["Greek (",Ht.greek.count," words)"]}),i.jsxs("p",{className:"text-xs text-gray-500 italic",children:[Ht.greek.examples.join(", "),"..."]})]}),i.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[i.jsxs("h5",{className:"font-medium text-gray-800 mb-1",children:["English (",Ht.english.count," words)"]}),i.jsxs("p",{className:"text-xs text-gray-500 italic",children:[Ht.english.examples.join(", "),"..."]})]})]}),i.jsx("h4",{className:"font-medium text-gray-900 mt-6 mb-2",children:"Stoplist Options"}),i.jsxs("dl",{className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx("dt",{className:"font-medium text-gray-700 text-sm",children:"Default"}),i.jsx("dd",{className:"text-gray-600 text-sm",children:Ht.options.default})]}),i.jsxs("div",{children:[i.jsx("dt",{className:"font-medium text-gray-700 text-sm",children:"Manual number"}),i.jsx("dd",{className:"text-gray-600 text-sm",children:Ht.options.manual})]}),i.jsxs("div",{children:[i.jsx("dt",{className:"font-medium text-gray-700 text-sm",children:"Disabled (-1)"}),i.jsx("dd",{className:"text-gray-600 text-sm",children:Ht.options.disabled})]})]}),i.jsx("h4",{className:"font-medium text-gray-900 mt-6 mb-2",children:"Stoplist Basis"}),i.jsx("p",{className:"text-gray-600 text-sm",children:"Choose which text(s) to analyze for building the stoplist:"}),i.jsxs("ul",{className:"list-disc list-inside text-gray-600 text-sm mt-2 ml-2 space-y-1",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Source + Target"}),": Uses word frequencies from both texts (recommended)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Source Only"}),": Only considers frequencies in the source text"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Target Only"}),": Only considers frequencies in the target text"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Full Corpus"}),": Uses pre-computed frequencies from all texts in the corpus"]})]}),i.jsx("h4",{className:"font-medium text-gray-900 mt-6 mb-2",children:"Custom Stopwords"}),i.jsx("p",{className:"text-gray-600 text-sm",children:"Add your own comma-separated list of words to exclude from matching. These are added to whatever stoplist you've configured above."}),i.jsx("p",{className:"text-gray-600 text-sm mt-2 font-medium",children:Ht.customStopwordsNote})]}),e==="results"&&i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Understanding Results"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Score"}),i.jsx("p",{className:"text-gray-600 text-sm",children:"Higher scores indicate more significant parallels. The score combines:"}),i.jsxs("ul",{className:"list-disc list-inside text-gray-600 text-sm mt-1 ml-4",children:[i.jsx("li",{children:"IDF (Inverse Document Frequency) - rare words score higher"}),i.jsx("li",{children:"Distance penalty - closer matched words score higher"}),i.jsx("li",{children:"Number of matches - more shared words score higher"})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Highlighting"}),i.jsxs("ul",{className:"list-disc list-inside text-gray-600 text-sm mt-1",children:[i.jsxs("li",{children:[i.jsx("span",{className:"bg-yellow-200 px-1 rounded",children:"Yellow"})," - Matched lemmas (dictionary forms)"]}),i.jsxs("li",{children:[i.jsx("span",{className:"bg-indigo-200 px-1 rounded",children:"Indigo"})," - Synonym matches (semantic similarity)"]})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Actions"}),i.jsxs("ul",{className:"list-disc list-inside text-gray-600 text-sm mt-1",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Export CSV"}),": Download all results as a spreadsheet"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Search Corpus"}),": Find these matched words across all texts"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Register"}),": Save to the Intertext Repository"]})]})]})]})]}),e==="best-practices"&&i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Search Tips"}),i.jsx("p",{className:"text-gray-700 mb-4",children:"Tips for refining your searches to find the most relevant parallels."}),i.jsx("h4",{className:"font-medium text-gray-900 mt-6 mb-3",children:"Narrowing Down Results"}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:"Use these strategies when you have too many results or want more precision:"}),i.jsxs("ul",{className:"list-disc list-inside text-gray-600 text-sm space-y-2 ml-2",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Select smaller text sections"}),': Choose individual books instead of complete works (e.g., "Aeneid, Book 1" rather than "Aeneid (Complete)")']}),i.jsxs("li",{children:[i.jsx("strong",{children:"Increase minimum matches"}),": Require 3+ shared words instead of the default 2"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Add custom stopwords"}),': Exclude common thematic words that create noise (e.g., "bellum" in war narratives, "amor" in love poetry)']}),i.jsxs("li",{children:[i.jsx("strong",{children:"Reduce max distance"}),": Lower from 999 to require matched words to appear closer together"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Enable score boosts"}),': Turn on "Bigram frequency boost" to prioritize rare word pairs']}),i.jsxs("li",{children:[i.jsx("strong",{children:"Use syntax matching"}),": For supported texts, require grammatical structure similarity"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Sort by score"}),": Focus on highest-scoring results first"]})]}),i.jsx("h4",{className:"font-medium text-gray-900 mt-6 mb-3",children:"Expanding Results"}),i.jsx("p",{className:"text-gray-600 text-sm mb-2",children:"Use these strategies when you want to cast a wider net:"}),i.jsxs("ul",{className:"list-disc list-inside text-gray-600 text-sm space-y-2 ml-2",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Select complete works"}),": Search entire texts rather than individual books"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Lower minimum matches"}),": Set to 2 (the minimum) to catch more parallels"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Disable stoplist"}),": Enter -1 in Stoplist Size to include all words (not recommended for large texts)"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Use semantic matching"}),': Switch to "AI Semantic" match type to find conceptually similar passages']}),i.jsxs("li",{children:[i.jsx("strong",{children:"Try sound matching"}),': "Sound Matching" finds words that sound alike across texts']}),i.jsxs("li",{children:[i.jsx("strong",{children:"Increase max results"}),": Set to 0 for unlimited results, or raise the limit"]})]}),i.jsx("h4",{className:"font-medium text-gray-900 mt-6 mb-3",children:"General Tips"}),i.jsxs("ul",{className:"list-disc list-inside text-gray-600 text-sm space-y-2 ml-2",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Start small, then expand"}),": Begin with a single book comparison, then broaden your search"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Save interesting searches"}),': Use "Save Search" to bookmark productive queries']}),i.jsxs("li",{children:[i.jsx("strong",{children:"Export for analysis"}),": Download CSV files to analyze results in spreadsheet software"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Check the corpus"}),': Use "Search Corpus" on a result to see where else those words co-occur']}),i.jsxs("li",{children:[i.jsx("strong",{children:"Register discoveries"}),": Add significant parallels to the Repository for future reference"]})]})]}),e==="cross-lingual"&&i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Cross-Lingual Search (GreekLatin)"}),i.jsxs("p",{className:"text-gray-700 mb-4",children:["The GreekLatin tab enables searching for parallels ",i.jsx("em",{children:"across languages"})," - finding how Greek texts influenced Latin authors or vice versa."]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg border border-amber-200",children:[i.jsx("h4",{className:"font-medium text-amber-800 mb-2",children:"AI Semantic Mode"}),i.jsx("p",{className:"text-amber-700 text-sm",children:"Uses the SPhilBERTa model trained on parallel Greek-Latin texts to find conceptually similar passages. Best for discovering thematic connections and paraphrased ideas."})]}),i.jsxs("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:[i.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Dictionary Mode"}),i.jsx("p",{className:"text-green-700 text-sm",children:"Uses a curated vocabulary of 50,000+ Greek-Latin word pairs from V3 scholars. Scores matches by word rarity (IDF). Shows exact word correspondences with highlighting."})]})]}),i.jsx("div",{className:"mt-4 bg-gray-50 p-4 rounded-lg",children:i.jsxs("p",{className:"text-gray-700 text-sm",children:[i.jsx("strong",{children:"Example:"})," Compare Homer's Iliad Book 1 (Greek) with Vergil's Aeneid Book 1 (Latin) to discover how Vergil adapted Homeric themes and vocabulary."]})})]}),e==="syntax-texts"&&i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Texts with Syntax Matching"}),i.jsx("p",{className:"text-gray-700 mb-4",children:"Syntax matching uses Universal Dependencies (UD) treebank data to compare grammatical structures between passages. This feature is only available for texts that have been annotated in UD treebanks."}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{className:"bg-red-50 p-4 rounded border border-red-200",children:[i.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Latin Texts (UD-Latin-Perseus)"}),i.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[i.jsx("li",{children:"Vergil, Aeneid"}),i.jsx("li",{children:"Ovid, Metamorphoses (selections)"}),i.jsx("li",{children:"Propertius, Elegies"}),i.jsx("li",{children:"Petronius, Satyricon"}),i.jsx("li",{children:"Cicero, Letters to Atticus (selections)"})]})]}),i.jsxs("div",{className:"bg-red-50 p-4 rounded border border-red-200",children:[i.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Latin Texts (UD-Latin-PROIEL)"}),i.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[i.jsx("li",{children:"Cicero, Letters to Atticus"}),i.jsx("li",{children:"Jerome, Vulgate (Genesis, Revelation, Ephesians)"}),i.jsx("li",{children:"Palladius, Opus Agriculturae"}),i.jsx("li",{children:"Caesar, Commentarii de Bello Gallico"})]})]}),i.jsxs("div",{className:"bg-amber-50 p-4 rounded border border-amber-200",children:[i.jsx("h4",{className:"font-medium text-amber-800 mb-2",children:"Greek Texts (UD-Ancient_Greek-Perseus)"}),i.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[i.jsx("li",{children:"Homer, Iliad and Odyssey"}),i.jsx("li",{children:"Hesiod, Works and Days, Theogony, Shield"}),i.jsx("li",{children:"Aeschylus, Agamemnon, Eumenides, Libation Bearers, Persians, Prometheus Bound, Seven Against Thebes, Suppliants"}),i.jsx("li",{children:"Sophocles, Ajax, Antigone, Electra, Oedipus at Colonus, Oedipus Tyrannus, Philoctetes, Trachiniae"}),i.jsx("li",{children:"Plato, Euthyphro"})]})]}),i.jsxs("div",{className:"bg-amber-50 p-4 rounded border border-amber-200",children:[i.jsx("h4",{className:"font-medium text-amber-800 mb-2",children:"Greek Texts (UD-Ancient_Greek-PROIEL)"}),i.jsxs("ul",{className:"text-sm text-gray-700 space-y-1",children:[i.jsx("li",{children:"New Testament (all books)"}),i.jsx("li",{children:"Herodotus, Histories"}),i.jsx("li",{children:"Sphrantzes, Chronicle"})]})]})]}),i.jsx("div",{className:"bg-gray-100 p-4 rounded mb-4",children:i.jsxs("p",{className:"text-sm text-gray-600",children:[i.jsx("strong",{children:"Note:"})," Syntax matching will only produce results when both the source and target texts have UD treebank annotations. For best results, select texts from the same treebank source."]})}),i.jsxs("div",{className:"bg-blue-50 p-4 rounded border border-blue-200",children:[i.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Data Sources & Credits"}),i.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:["Syntactic annotations are provided by the ",i.jsx("a",{href:"https://universaldependencies.org/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Universal Dependencies"})," project:"]}),i.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 ml-4",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"UD-Latin-Perseus"}),": Treebank from the ",i.jsx("a",{href:"http://www.perseus.tufts.edu/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Perseus Digital Library"}),", converted by Giuseppe G. A. Celano"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"UD-Latin-PROIEL"}),": From the ",i.jsx("a",{href:"https://proiel.github.io/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"PROIEL Treebank"})," (Pragmatic Resources in Old Indo-European Languages), Dag Haug et al."]}),i.jsxs("li",{children:[i.jsx("strong",{children:"UD-Ancient_Greek-Perseus"}),": Greek treebank from the ",i.jsx("a",{href:"http://www.perseus.tufts.edu/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Perseus Digital Library"}),", converted by Giuseppe G. A. Celano"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"UD-Ancient_Greek-PROIEL"}),": From the ",i.jsx("a",{href:"https://proiel.github.io/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"PROIEL Treebank"}),", Dag Haug et al."]})]})]})]}),e==="repository"&&i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Intertext Repository"}),i.jsx("p",{className:"text-gray-700 mb-4",children:"Save discovered parallels to build a personal collection and optionally share with the scholarly community."}),i.jsxs("div",{className:"bg-blue-50 p-4 rounded border border-blue-200 mb-4",children:[i.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"How to Register an Intertext"}),i.jsxs("ol",{className:"list-decimal list-inside text-gray-700 text-sm space-y-1",children:[i.jsx("li",{children:'Click "Register" on any search result'}),i.jsx("li",{children:"Rate the scholarly significance (1-5 scale based on Coffee et al. 2012)"}),i.jsx("li",{children:"Add notes explaining the connection"}),i.jsx("li",{children:"Choose whether to share publicly"})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[i.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Scoring Scale (Coffee et al. 2012)"}),i.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"1"})," - Minimal similarity, possibly coincidental"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"2"})," - Some shared vocabulary"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"3"})," - Clear parallel, likely intentional"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"4"})," - Strong allusion with thematic resonance"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"5"})," - Direct quotation or unmistakable reference"]})]})]})]}),e==="faq"&&i.jsxs("div",{className:"prose max-w-none",children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Frequently Asked Questions"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Why is my search taking so long?"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Try searching smaller sections (e.g., individual books) for faster results. Semantic and cross-lingual searches take longer than lemma matching."})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"Can I request a text that's not in the corpus?"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:'Yes! Use the "Request a Text" section in this Help page.'})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"How do I save my results?"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:'Use "Export CSV" to download results, or "Register" to save parallels to the Repository.'})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"What's the difference between Phrases and Lines search?"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"Phrases compares two specific texts. Lines searches a single line against the entire corpus."})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-900",children:"How does the scoring work?"}),i.jsx("p",{className:"text-gray-600 text-sm mt-1",children:"The V3-style algorithm uses IDF (rare words score higher) and distance penalties (closer words score higher). More matching words also increase the score."})]})]})]}),e==="upload-text"&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Upload Your Text"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Have a text you'd like to add to the Tesserae corpus? Upload it here and we'll review it for inclusion. Pre-formatting your text speeds up the process significantly."}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[i.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Text Formatting Guidelines"}),i.jsxs("p",{className:"text-blue-800 text-sm mb-3",children:["Tesserae uses a simple ",i.jsx("code",{className:"bg-blue-100 px-1 rounded",children:".tess"})," format. Each line should have a section tag followed by the text content."]}),i.jsxs("div",{className:"bg-white rounded p-3 mb-3 font-mono text-xs overflow-x-auto",children:[i.jsx("div",{className:"text-gray-500 mb-2",children:"# Example format (Latin poetry):"}),i.jsx("div",{children:"<vergil.aeneid 1.1> Arma virumque cano, Troiae qui primus ab oris"}),i.jsx("div",{children:"<vergil.aeneid 1.2> Italiam, fato profugus, Laviniaque venit"}),i.jsx("div",{children:"<vergil.aeneid 1.3> litora, multum ille et terris iactatus et alto"}),i.jsx("div",{className:"text-gray-500 mt-3 mb-2",children:"# Example format (Greek prose):"}),i.jsx("div",{children:"<plato.republic 1.327a>      "}),i.jsx("div",{className:"text-gray-500 mt-3 mb-2",children:"# Example format (English):"}),i.jsx("div",{children:"<shakespeare.hamlet 1.1.1> Who's there?"})]}),i.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Tag Format:"})," ",i.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"<author.work section>"})]}),i.jsxs("ul",{className:"list-disc list-inside ml-2 space-y-1",children:[i.jsx("li",{children:"Use lowercase author and work names with periods as separators"}),i.jsxs("li",{children:["For poetry: use line numbers (e.g., ",i.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"1.1"})," for Book 1, Line 1)"]}),i.jsxs("li",{children:["For prose: use standard section references (e.g., ",i.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"1.327a"}),")"]}),i.jsxs("li",{children:["For drama: use act.scene.line (e.g., ",i.jsx("code",{className:"bg-blue-100 px-1 rounded",children:"1.1.1"}),")"]}),i.jsx("li",{children:"Plain text only - no HTML, markdown, or special formatting"}),i.jsx("li",{children:"UTF-8 encoding for Greek characters"})]})]})]}),i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[i.jsx("h4",{className:"font-semibold text-green-900 mb-3",children:"Text Formatter Utility"}),i.jsx("p",{className:"text-green-800 text-sm mb-4",children:"Paste your plain text below and we'll convert it to .tess format automatically."}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-green-800 mb-1",children:"Author"}),i.jsx("input",{type:"text",value:S,onChange:re=>V(re.target.value),placeholder:"e.g., Vergil",className:"w-full border border-green-300 rounded px-2 py-1 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-green-800 mb-1",children:"Work"}),i.jsx("input",{type:"text",value:P,onChange:re=>O(re.target.value),placeholder:"e.g., Aeneid",className:"w-full border border-green-300 rounded px-2 py-1 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-green-800 mb-1",children:"Text Type"}),i.jsxs("select",{value:A,onChange:re=>L(re.target.value),className:"w-full border border-green-300 rounded px-2 py-1 text-sm",children:[i.jsx("option",{value:"poetry",children:"Poetry (book.line)"}),i.jsx("option",{value:"prose",children:"Prose (section.para)"}),i.jsx("option",{value:"drama",children:"Drama (act.scene.line)"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-green-800 mb-1",children:"Start Book"}),i.jsx("input",{type:"number",min:"1",value:M,onChange:re=>I(re.target.value),className:"w-full border border-green-300 rounded px-2 py-1 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-green-800 mb-1",children:"Start Line"}),i.jsx("input",{type:"number",min:"1",value:$,onChange:re=>Q(re.target.value),className:"w-full border border-green-300 rounded px-2 py-1 text-sm"})]})]})]}),i.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-green-800 mb-1",children:"Paste Raw Text (one line per row)"}),i.jsx("textarea",{value:X,onChange:re=>F(re.target.value),placeholder:`Arma virumque cano, Troiae qui primus ab oris
Italiam, fato profugus, Laviniaque venit
litora, multum ille et terris iactatus et alto`,rows:8,className:"w-full border border-green-300 rounded px-2 py-2 text-sm font-mono"}),i.jsx("p",{className:"text-xs text-green-700 mt-1",children:'Tip: Lines starting with "Book", "Liber", "Chapter", or "Act" followed by a number will start a new section.'})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-green-800 mb-1",children:"Formatted .tess Output"}),i.jsx("textarea",{value:ne,readOnly:!0,rows:8,className:"w-full border border-green-300 rounded px-2 py-2 text-sm font-mono bg-white",placeholder:"Formatted output will appear here..."}),ne&&i.jsxs("div",{className:"flex gap-2 mt-2",children:[i.jsx("button",{type:"button",onClick:K,className:"px-3 py-1 text-xs bg-green-600 text-white rounded hover:bg-green-700",children:ie?"Copied!":"Copy to Clipboard"}),i.jsx("button",{type:"button",onClick:te,className:"px-3 py-1 text-xs bg-green-700 text-white rounded hover:bg-green-800",children:"Download .tess File"})]})]})]}),i.jsx("button",{type:"button",onClick:R,disabled:!S.trim()||!P.trim()||!X.trim(),className:"mt-3 px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Format Text"})]}),i.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Submit Your Formatted Text"}),i.jsxs("form",{onSubmit:de,className:"space-y-4 max-w-lg",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Name (optional)"}),i.jsx("input",{type:"text",value:s,onChange:re=>n(re.target.value),className:"w-full border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (optional)"}),i.jsx("input",{type:"email",value:r,onChange:re=>a(re.target.value),className:"w-full border rounded px-3 py-2 text-sm"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Author *"}),i.jsx("input",{type:"text",value:o,onChange:re=>l(re.target.value),placeholder:"e.g., Tacitus",required:!0,className:"w-full border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Language *"}),i.jsxs("select",{value:d,onChange:re=>h(re.target.value),className:"w-full border rounded px-3 py-2 text-sm",children:[i.jsx("option",{value:"latin",children:"Latin"}),i.jsx("option",{value:"greek",children:"Greek"}),i.jsx("option",{value:"english",children:"English"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Work Title *"}),i.jsx("input",{type:"text",value:c,onChange:re=>u(re.target.value),placeholder:"e.g., Annales",required:!0,className:"w-full border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Text File"}),i.jsx("input",{type:"file",accept:".txt,.tess",onChange:re=>x(re.target.files[0]),className:"w-full border rounded px-3 py-2 text-sm file:mr-3 file:py-1 file:px-3 file:border-0 file:bg-gray-100 file:text-gray-700 file:rounded file:cursor-pointer"}),i.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Accepts .txt or .tess files. Pre-formatted files are processed faster."})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes (optional)"}),i.jsx("textarea",{value:f,onChange:re=>m(re.target.value),placeholder:"Source edition, date, or any additional information...",rows:3,className:"w-full border rounded px-3 py-2 text-sm"})]}),p&&i.jsx("div",{className:`p-3 rounded text-sm ${p.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:p.text}),i.jsx("button",{type:"submit",disabled:y,className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:opacity-50",children:y?"Uploading...":"Upload Text"})]})]}),e==="feedback"&&i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Send Feedback"}),i.jsx("p",{className:"text-gray-600 mb-4",children:"Have a suggestion, found a bug, or want to share your experience? We'd love to hear from you."}),i.jsxs("form",{onSubmit:he,className:"space-y-4 max-w-lg",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Name (optional)"}),i.jsx("input",{type:"text",value:b,onChange:re=>k(re.target.value),className:"w-full border rounded px-3 py-2 text-sm"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (optional)"}),i.jsx("input",{type:"email",value:E,onChange:re=>_(re.target.value),className:"w-full border rounded px-3 py-2 text-sm"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Feedback Type"}),i.jsxs("select",{value:N,onChange:re=>U(re.target.value),className:"w-full border rounded px-3 py-2 text-sm",children:[i.jsx("option",{value:"suggestion",children:"Suggestion"}),i.jsx("option",{value:"bug",children:"Bug Report"}),i.jsx("option",{value:"question",children:"Question"}),i.jsx("option",{value:"praise",children:"Praise"}),i.jsx("option",{value:"other",children:"Other"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Message *"}),i.jsx("textarea",{value:B,onChange:re=>q(re.target.value),placeholder:"Tell us what's on your mind...",rows:5,required:!0,className:"w-full border rounded px-3 py-2 text-sm"})]}),C&&i.jsx("div",{className:`p-3 rounded text-sm ${C.type==="success"?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:C.text}),i.jsx("button",{type:"submit",disabled:z,className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:opacity-50",children:z?"Sending...":"Send Feedback"})]})]})]})]})})}const uN=()=>{const[e,t]=j.useState({}),s=async(r,a)=>{const o=`${r}-${a}`;t(l=>({...l,[o]:!0}));try{const l=`/api/downloads/${r}/${a}`,c=await fetch(l);if(!c.ok)throw new Error("Download failed");const u=await c.blob(),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download=`tesserae_${r}_${a}.zip`,h.click(),URL.revokeObjectURL(d)}catch(l){alert("Download failed: "+l.message)}t(l=>({...l,[o]:!1}))},n=[{code:"la",name:"Latin",texts:"~1,444",embeddings:!0},{code:"grc",name:"Greek",texts:"~650",embeddings:!0},{code:"en",name:"English",texts:"~14",embeddings:!1}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Downloads"}),i.jsx("p",{className:"text-gray-600",children:"Download the Tesserae corpus texts and pre-computed embeddings for offline analysis."})]}),i.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Corpus Texts"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Download all texts in .tess format for a language. Texts are organized by author and work."}),i.jsx("div",{className:"space-y-3",children:n.map(r=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:r.name}),i.jsxs("span",{className:"text-sm text-gray-500 ml-2",children:["(",r.texts," texts)"]})]}),i.jsx("button",{onClick:()=>s("texts",r.code),disabled:e[`texts-${r.code}`],className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:opacity-50 text-sm",children:e[`texts-${r.code}`]?"Downloading...":"Download ZIP"})]},r.code))})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Semantic Embeddings"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Pre-computed sentence embeddings for semantic search. Uses SPhilBERTa for Latin/Greek."}),i.jsx("div",{className:"space-y-3",children:n.filter(r=>r.embeddings).map(r=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:r.name}),i.jsx("span",{className:"text-sm text-gray-500 ml-2",children:"(embeddings)"})]}),i.jsx("button",{onClick:()=>s("embeddings",r.code),disabled:e[`embeddings-${r.code}`],className:"px-4 py-2 bg-amber-600 text-white rounded hover:bg-amber-700 disabled:opacity-50 text-sm",children:e[`embeddings-${r.code}`]?"Downloading...":"Download ZIP"})]},r.code))})]})]}),i.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Benchmark Sets"}),i.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Hand-curated datasets for evaluating intertextual detection algorithms. Includes hand-ranked parallels from scholarly commentaries (Hunter, Knauer, Neils) and Tesserae results with scoring."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Latin to Latin"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Lucan BC1 vs Vergil Aeneid - Benchmark 1"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(hand-ranked)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Lucan.BC1-Verg.Aeneid.benchmark1.xlsx",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"XLSX"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Lucan BC1 vs Vergil Aeneid - Benchmark 2"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(hand-ranked)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Lucan.BC1-Verg.Aeneid.benchmark2.xlsx",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"XLSX"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Lucan BC1 vs Vergil Aeneid - Tesserae Results"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(scored, XLSX)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Lucan.BC1-Verg.Aeneid.tess_.results2.xlsx",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"XLSX"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Lucan BC1 vs Vergil Aeneid - Tesserae Results"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(scored, TXT)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/bench41.txt",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"TXT"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Lucan BC1 vs Vergil Aeneid - 2010 Benchmark"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(formatted with match-words)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Tesserae-2010-Benchmark1.xlsx",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"XLSX"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Lucan BC II-IX vs Vergil Aeneid"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(raw)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Lucan.BC_.rest-Verg.Aeneid.benchmark.xlsx",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"XLSX"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Statius Achilleid vs Various"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(Geneva Seminar)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Stat.Achilleid1.benchmark.xlsx",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"XLSX"})]})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Greek to Greek"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Apollonius Argonautica vs Homer"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(Hunter commentary, hand-ranked)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Ap.Argonautica-Homer.benchmark.xlsx",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"XLSX"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Apollonius Argonautica III vs Homer"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(complete)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Ap.Argonautica3-Homer.benchmark.xlsx",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"XLSX"})]})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Greek to Latin (Cross-lingual)"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Vergil Aeneid I vs Homer Iliad"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(Knauer 1964, hand-ranked)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Verg.Aeneid1-Iliad.benchmark.xlsx",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"XLSX"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Vergil Aeneid I vs Homer Iliad - Raw 1"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(raw data)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Verg.Aeneid1-Iliad.benchmark.raw_.1.txt",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"TXT"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Vergil Aeneid I vs Homer Iliad - Raw 2"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(raw data)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Verg.Aeneid1-Iliad.benchmark.raw_.2.txt",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"TXT"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Vergil Aeneid I vs Homer Odyssey"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(Knauer 1964)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Verg.Aeneid1-Odyssey.benchmark.xlsx",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"XLSX"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Vergil Aeneid vs Apollonius Argonautica"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(Neils 2001)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Verg.Aeneid-Ap.Argonautica.benchmark.Neils2001.pdf",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"PDF"})]}),i.jsxs("div",{className:"flex items-center justify-between p-2 bg-gray-50 rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Vergil Georgics IV vs Various"}),i.jsx("span",{className:"text-gray-500 ml-2",children:"(partially ranked)"})]}),i.jsx("a",{href:"/static/downloads/benchmarks/Verg.Georgics4.benchmark.xlsx",className:"px-3 py-1 bg-red-700 text-white rounded hover:bg-red-800 text-xs",children:"XLSX"})]})]})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:i.jsxs("p",{className:"text-xs text-gray-500",children:[i.jsx("strong",{children:"Bibliography:"})," Hunter (1989) ",i.jsx("em",{children:"Apollonius of Rhodes: Argonautica Book III"}),"; Knauer (1964) ",i.jsx("em",{children:"Die Aeneis und Homer"}),"; Neils (2001) ",i.jsx("em",{children:"Vergil's Aeneid and the Argonautica"}),"."]})})]}),i.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[i.jsx("h4",{className:"font-medium text-amber-900 mb-2",children:"License Information"}),i.jsx("p",{className:"text-sm text-amber-800",children:"Texts are provided for research and educational use. Many texts derive from public domain sources (Perseus, CSEL, PHI Latin Texts). Metrical scansion data from MQDQ/Pede Certo is licensed under CC-BY-NC-ND 4.0."})]})]})};function dN(){return i.jsxs("div",{className:"bg-white rounded-lg shadow p-6 sm:p-8 max-w-4xl mx-auto",children:[i.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Privacy Policy"}),i.jsxs("div",{className:"prose max-w-none text-gray-700 space-y-6",children:[i.jsxs("section",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Data Collection"}),i.jsx("p",{children:"Tesserae V6 collects minimal personal information necessary to provide our intertextual analysis services. When you sign in using Replit authentication, we receive your name and email address to identify your account and attribute your contributions."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"How We Use Your Data"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[i.jsx("li",{children:"To provide personalized features like saved searches and personal intertext collections"}),i.jsx("li",{children:"To attribute contributions to the Intertext Repository"}),i.jsx("li",{children:"To respond to text requests and feedback submissions"}),i.jsx("li",{children:"To improve the Tesserae platform and user experience"})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"ORCID Integration"}),i.jsx("p",{children:"If you choose to link your ORCID identifier, this information is stored to provide proper academic attribution for your contributions. ORCID linking is entirely optional and can be removed at any time from your profile settings."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Data Storage"}),i.jsx("p",{children:`Your data is stored securely on Replit's infrastructure. Search configurations may be stored locally in your browser's localStorage for convenience. Intertext contributions you mark as "public" will be visible to other users.`})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Third-Party Services"}),i.jsx("p",{children:"Tesserae uses the following third-party services:"}),i.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[i.jsxs("li",{children:[i.jsx("strong",{children:"Replit:"})," Hosting and authentication services"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Wiktionary API:"})," Dictionary definitions for rare words"]}),i.jsxs("li",{children:[i.jsx("strong",{children:"Perseus Digital Library:"})," Fallback definitions"]})]})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Your Rights"}),i.jsx("p",{children:"You may request deletion of your account and associated data by contacting us through the feedback form. You can also manage your saved searches and intertext collections directly through the application."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Research Use"}),i.jsx("p",{children:"Tesserae is an academic research tool. Anonymized usage statistics may be used for research purposes to improve intertextual analysis methodologies. No personally identifiable information is shared in research publications."})]}),i.jsxs("section",{children:[i.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Contact"}),i.jsx("p",{children:"For privacy-related inquiries, please use the feedback form in the Help & Support section or contact the Tesserae project team."})]}),i.jsx("div",{className:"text-sm text-gray-500 pt-4 border-t",children:"Last updated: January 2026"})]})]})}function bo(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function hN(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function w0(e){let t,s,n;e.length!==2?(t=bo,s=(l,c)=>bo(e(l),c),n=(l,c)=>e(l)-c):(t=e===bo||e===hN?e:fN,s=e,n=e);function r(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;s(l[h],c)<0?u=h+1:d=h}while(u<d)}return u}function a(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;s(l[h],c)<=0?u=h+1:d=h}while(u<d)}return u}function o(l,c,u=0,d=l.length){const h=r(l,c,u,d-1);return h>u&&n(l[h-1],c)>-n(l[h],c)?h-1:h}return{left:r,center:o,right:a}}function fN(){return 0}function mN(e){return e===null?NaN:+e}const gN=w0(bo),pN=gN.right;w0(mN).center;const xN=Math.sqrt(50),yN=Math.sqrt(10),vN=Math.sqrt(2);function nl(e,t,s){const n=(t-e)/Math.max(0,s),r=Math.floor(Math.log10(n)),a=n/Math.pow(10,r),o=a>=xN?10:a>=yN?5:a>=vN?2:1;let l,c,u;return r<0?(u=Math.pow(10,-r)/o,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,r)*o,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=s&&s<2?nl(e,t,s*2):[l,c,u]}function bN(e,t,s){if(t=+t,e=+e,s=+s,!(s>0))return[];if(e===t)return[e];const n=t<e,[r,a,o]=n?nl(t,e,s):nl(e,t,s);if(!(a>=r))return[];const l=a-r+1,c=new Array(l);if(n)if(o<0)for(let u=0;u<l;++u)c[u]=(a-u)/-o;else for(let u=0;u<l;++u)c[u]=(a-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(r+u)/-o;else for(let u=0;u<l;++u)c[u]=(r+u)*o;return c}function Au(e,t,s){return t=+t,e=+e,s=+s,nl(e,t,s)[2]}function wN(e,t,s){t=+t,e=+e,s=+s;const n=t<e,r=n?Au(t,e,s):Au(e,t,s);return(n?-1:1)*(r<0?1/-r:r)}function Xm(e,t){let s;if(t===void 0)for(const n of e)n!=null&&(s<n||s===void 0&&n>=n)&&(s=n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(s<r||s===void 0&&r>=r)&&(s=r)}return s}var jN={value:()=>{}};function ua(){for(var e=0,t=arguments.length,s={},n;e<t;++e){if(!(n=arguments[e]+"")||n in s||/[\s.]/.test(n))throw new Error("illegal type: "+n);s[n]=[]}return new wo(s)}function wo(e){this._=e}function _N(e,t){return e.trim().split(/^|\s+/).map(function(s){var n="",r=s.indexOf(".");if(r>=0&&(n=s.slice(r+1),s=s.slice(0,r)),s&&!t.hasOwnProperty(s))throw new Error("unknown type: "+s);return{type:s,name:n}})}wo.prototype=ua.prototype={constructor:wo,on:function(e,t){var s=this._,n=_N(e+"",s),r,a=-1,o=n.length;if(arguments.length<2){for(;++a<o;)if((r=(e=n[a]).type)&&(r=NN(s[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++a<o;)if(r=(e=n[a]).type)s[r]=qm(s[r],e.name,t);else if(t==null)for(r in s)s[r]=qm(s[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var s in t)e[s]=t[s].slice();return new wo(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var s=new Array(r),n=0,r,a;n<r;++n)s[n]=arguments[n+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(a=this._[e],n=0,r=a.length;n<r;++n)a[n].value.apply(t,s)},apply:function(e,t,s){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var n=this._[e],r=0,a=n.length;r<a;++r)n[r].value.apply(t,s)}};function NN(e,t){for(var s=0,n=e.length,r;s<n;++s)if((r=e[s]).name===t)return r.value}function qm(e,t,s){for(var n=0,r=e.length;n<r;++n)if(e[n].name===t){e[n]=jN,e=e.slice(0,n).concat(e.slice(n+1));break}return s!=null&&e.push({name:t,value:s}),e}var Mu="http://www.w3.org/1999/xhtml";const Ym={svg:"http://www.w3.org/2000/svg",xhtml:Mu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Pl(e){var t=e+="",s=t.indexOf(":");return s>=0&&(t=e.slice(0,s))!=="xmlns"&&(e=e.slice(s+1)),Ym.hasOwnProperty(t)?{space:Ym[t],local:e}:e}function kN(e){return function(){var t=this.ownerDocument,s=this.namespaceURI;return s===Mu&&t.documentElement.namespaceURI===Mu?t.createElement(e):t.createElementNS(s,e)}}function SN(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function j0(e){var t=Pl(e);return(t.local?SN:kN)(t)}function CN(){}function Gd(e){return e==null?CN:function(){return this.querySelector(e)}}function EN(e){typeof e!="function"&&(e=Gd(e));for(var t=this._groups,s=t.length,n=new Array(s),r=0;r<s;++r)for(var a=t[r],o=a.length,l=n[r]=new Array(o),c,u,d=0;d<o;++d)(c=a[d])&&(u=e.call(c,c.__data__,d,a))&&("__data__"in c&&(u.__data__=c.__data__),l[d]=u);return new zt(n,this._parents)}function TN(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function LN(){return[]}function _0(e){return e==null?LN:function(){return this.querySelectorAll(e)}}function AN(e){return function(){return TN(e.apply(this,arguments))}}function MN(e){typeof e=="function"?e=AN(e):e=_0(e);for(var t=this._groups,s=t.length,n=[],r=[],a=0;a<s;++a)for(var o=t[a],l=o.length,c,u=0;u<l;++u)(c=o[u])&&(n.push(e.call(c,c.__data__,u,o)),r.push(c));return new zt(n,r)}function N0(e){return function(){return this.matches(e)}}function k0(e){return function(t){return t.matches(e)}}var PN=Array.prototype.find;function RN(e){return function(){return PN.call(this.children,e)}}function DN(){return this.firstElementChild}function ON(e){return this.select(e==null?DN:RN(typeof e=="function"?e:k0(e)))}var FN=Array.prototype.filter;function zN(){return Array.from(this.children)}function IN(e){return function(){return FN.call(this.children,e)}}function $N(e){return this.selectAll(e==null?zN:IN(typeof e=="function"?e:k0(e)))}function BN(e){typeof e!="function"&&(e=N0(e));for(var t=this._groups,s=t.length,n=new Array(s),r=0;r<s;++r)for(var a=t[r],o=a.length,l=n[r]=[],c,u=0;u<o;++u)(c=a[u])&&e.call(c,c.__data__,u,a)&&l.push(c);return new zt(n,this._parents)}function S0(e){return new Array(e.length)}function HN(){return new zt(this._enter||this._groups.map(S0),this._parents)}function rl(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}rl.prototype={constructor:rl,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function UN(e){return function(){return e}}function VN(e,t,s,n,r,a){for(var o=0,l,c=t.length,u=a.length;o<u;++o)(l=t[o])?(l.__data__=a[o],n[o]=l):s[o]=new rl(e,a[o]);for(;o<c;++o)(l=t[o])&&(r[o]=l)}function WN(e,t,s,n,r,a,o){var l,c,u=new Map,d=t.length,h=a.length,f=new Array(d),m;for(l=0;l<d;++l)(c=t[l])&&(f[l]=m=o.call(c,c.__data__,l,t)+"",u.has(m)?r[l]=c:u.set(m,c));for(l=0;l<h;++l)m=o.call(e,a[l],l,a)+"",(c=u.get(m))?(n[l]=c,c.__data__=a[l],u.delete(m)):s[l]=new rl(e,a[l]);for(l=0;l<d;++l)(c=t[l])&&u.get(f[l])===c&&(r[l]=c)}function XN(e){return e.__data__}function qN(e,t){if(!arguments.length)return Array.from(this,XN);var s=t?WN:VN,n=this._parents,r=this._groups;typeof e!="function"&&(e=UN(e));for(var a=r.length,o=new Array(a),l=new Array(a),c=new Array(a),u=0;u<a;++u){var d=n[u],h=r[u],f=h.length,m=YN(e.call(d,d&&d.__data__,u,n)),v=m.length,x=l[u]=new Array(v),y=o[u]=new Array(v),g=c[u]=new Array(f);s(d,h,x,y,g,m,t);for(var p=0,w=0,b,k;p<v;++p)if(b=x[p]){for(p>=w&&(w=p+1);!(k=y[w])&&++w<v;);b._next=k||null}}return o=new zt(o,n),o._enter=l,o._exit=c,o}function YN(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function GN(){return new zt(this._exit||this._groups.map(S0),this._parents)}function KN(e,t,s){var n=this.enter(),r=this,a=this.exit();return typeof e=="function"?(n=e(n),n&&(n=n.selection())):n=n.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),s==null?a.remove():s(a),n&&r?n.merge(r).order():r}function QN(e){for(var t=e.selection?e.selection():e,s=this._groups,n=t._groups,r=s.length,a=n.length,o=Math.min(r,a),l=new Array(r),c=0;c<o;++c)for(var u=s[c],d=n[c],h=u.length,f=l[c]=new Array(h),m,v=0;v<h;++v)(m=u[v]||d[v])&&(f[v]=m);for(;c<r;++c)l[c]=s[c];return new zt(l,this._parents)}function JN(){for(var e=this._groups,t=-1,s=e.length;++t<s;)for(var n=e[t],r=n.length-1,a=n[r],o;--r>=0;)(o=n[r])&&(a&&o.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(o,a),a=o);return this}function ZN(e){e||(e=ek);function t(h,f){return h&&f?e(h.__data__,f.__data__):!h-!f}for(var s=this._groups,n=s.length,r=new Array(n),a=0;a<n;++a){for(var o=s[a],l=o.length,c=r[a]=new Array(l),u,d=0;d<l;++d)(u=o[d])&&(c[d]=u);c.sort(t)}return new zt(r,this._parents).order()}function ek(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function tk(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function sk(){return Array.from(this)}function nk(){for(var e=this._groups,t=0,s=e.length;t<s;++t)for(var n=e[t],r=0,a=n.length;r<a;++r){var o=n[r];if(o)return o}return null}function rk(){let e=0;for(const t of this)++e;return e}function ik(){return!this.node()}function ak(e){for(var t=this._groups,s=0,n=t.length;s<n;++s)for(var r=t[s],a=0,o=r.length,l;a<o;++a)(l=r[a])&&e.call(l,l.__data__,a,r);return this}function ok(e){return function(){this.removeAttribute(e)}}function lk(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ck(e,t){return function(){this.setAttribute(e,t)}}function uk(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function dk(e,t){return function(){var s=t.apply(this,arguments);s==null?this.removeAttribute(e):this.setAttribute(e,s)}}function hk(e,t){return function(){var s=t.apply(this,arguments);s==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,s)}}function fk(e,t){var s=Pl(e);if(arguments.length<2){var n=this.node();return s.local?n.getAttributeNS(s.space,s.local):n.getAttribute(s)}return this.each((t==null?s.local?lk:ok:typeof t=="function"?s.local?hk:dk:s.local?uk:ck)(s,t))}function C0(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function mk(e){return function(){this.style.removeProperty(e)}}function gk(e,t,s){return function(){this.style.setProperty(e,t,s)}}function pk(e,t,s){return function(){var n=t.apply(this,arguments);n==null?this.style.removeProperty(e):this.style.setProperty(e,n,s)}}function xk(e,t,s){return arguments.length>1?this.each((t==null?mk:typeof t=="function"?pk:gk)(e,t,s??"")):Fr(this.node(),e)}function Fr(e,t){return e.style.getPropertyValue(t)||C0(e).getComputedStyle(e,null).getPropertyValue(t)}function yk(e){return function(){delete this[e]}}function vk(e,t){return function(){this[e]=t}}function bk(e,t){return function(){var s=t.apply(this,arguments);s==null?delete this[e]:this[e]=s}}function wk(e,t){return arguments.length>1?this.each((t==null?yk:typeof t=="function"?bk:vk)(e,t)):this.node()[e]}function E0(e){return e.trim().split(/^|\s+/)}function Kd(e){return e.classList||new T0(e)}function T0(e){this._node=e,this._names=E0(e.getAttribute("class")||"")}T0.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function L0(e,t){for(var s=Kd(e),n=-1,r=t.length;++n<r;)s.add(t[n])}function A0(e,t){for(var s=Kd(e),n=-1,r=t.length;++n<r;)s.remove(t[n])}function jk(e){return function(){L0(this,e)}}function _k(e){return function(){A0(this,e)}}function Nk(e,t){return function(){(t.apply(this,arguments)?L0:A0)(this,e)}}function kk(e,t){var s=E0(e+"");if(arguments.length<2){for(var n=Kd(this.node()),r=-1,a=s.length;++r<a;)if(!n.contains(s[r]))return!1;return!0}return this.each((typeof t=="function"?Nk:t?jk:_k)(s,t))}function Sk(){this.textContent=""}function Ck(e){return function(){this.textContent=e}}function Ek(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Tk(e){return arguments.length?this.each(e==null?Sk:(typeof e=="function"?Ek:Ck)(e)):this.node().textContent}function Lk(){this.innerHTML=""}function Ak(e){return function(){this.innerHTML=e}}function Mk(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Pk(e){return arguments.length?this.each(e==null?Lk:(typeof e=="function"?Mk:Ak)(e)):this.node().innerHTML}function Rk(){this.nextSibling&&this.parentNode.appendChild(this)}function Dk(){return this.each(Rk)}function Ok(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Fk(){return this.each(Ok)}function zk(e){var t=typeof e=="function"?e:j0(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Ik(){return null}function $k(e,t){var s=typeof e=="function"?e:j0(e),n=t==null?Ik:typeof t=="function"?t:Gd(t);return this.select(function(){return this.insertBefore(s.apply(this,arguments),n.apply(this,arguments)||null)})}function Bk(){var e=this.parentNode;e&&e.removeChild(this)}function Hk(){return this.each(Bk)}function Uk(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Vk(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Wk(e){return this.select(e?Vk:Uk)}function Xk(e){return arguments.length?this.property("__data__",e):this.node().__data__}function qk(e){return function(t){e.call(this,t,this.__data__)}}function Yk(e){return e.trim().split(/^|\s+/).map(function(t){var s="",n=t.indexOf(".");return n>=0&&(s=t.slice(n+1),t=t.slice(0,n)),{type:t,name:s}})}function Gk(e){return function(){var t=this.__on;if(t){for(var s=0,n=-1,r=t.length,a;s<r;++s)a=t[s],(!e.type||a.type===e.type)&&a.name===e.name?this.removeEventListener(a.type,a.listener,a.options):t[++n]=a;++n?t.length=n:delete this.__on}}}function Kk(e,t,s){return function(){var n=this.__on,r,a=qk(t);if(n){for(var o=0,l=n.length;o<l;++o)if((r=n[o]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=a,r.options=s),r.value=t;return}}this.addEventListener(e.type,a,s),r={type:e.type,name:e.name,value:t,listener:a,options:s},n?n.push(r):this.__on=[r]}}function Qk(e,t,s){var n=Yk(e+""),r,a=n.length,o;if(arguments.length<2){var l=this.node().__on;if(l){for(var c=0,u=l.length,d;c<u;++c)for(r=0,d=l[c];r<a;++r)if((o=n[r]).type===d.type&&o.name===d.name)return d.value}return}for(l=t?Kk:Gk,r=0;r<a;++r)this.each(l(n[r],t,s));return this}function M0(e,t,s){var n=C0(e),r=n.CustomEvent;typeof r=="function"?r=new r(t,s):(r=n.document.createEvent("Event"),s?(r.initEvent(t,s.bubbles,s.cancelable),r.detail=s.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Jk(e,t){return function(){return M0(this,e,t)}}function Zk(e,t){return function(){return M0(this,e,t.apply(this,arguments))}}function eS(e,t){return this.each((typeof t=="function"?Zk:Jk)(e,t))}function*tS(){for(var e=this._groups,t=0,s=e.length;t<s;++t)for(var n=e[t],r=0,a=n.length,o;r<a;++r)(o=n[r])&&(yield o)}var P0=[null];function zt(e,t){this._groups=e,this._parents=t}function da(){return new zt([[document.documentElement]],P0)}function sS(){return this}zt.prototype=da.prototype={constructor:zt,select:EN,selectAll:MN,selectChild:ON,selectChildren:$N,filter:BN,data:qN,enter:HN,exit:GN,join:KN,merge:QN,selection:sS,order:JN,sort:ZN,call:tk,nodes:sk,node:nk,size:rk,empty:ik,each:ak,attr:fk,style:xk,property:wk,classed:kk,text:Tk,html:Pk,raise:Dk,lower:Fk,append:zk,insert:$k,remove:Hk,clone:Wk,datum:Xk,on:Qk,dispatch:eS,[Symbol.iterator]:tS};function vs(e){return typeof e=="string"?new zt([[document.querySelector(e)]],[document.documentElement]):new zt([[e]],P0)}function nS(e){let t;for(;t=e.sourceEvent;)e=t;return e}function As(e,t){if(e=nS(e),t===void 0&&(t=e.currentTarget),t){var s=t.ownerSVGElement||t;if(s.createSVGPoint){var n=s.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,n=n.matrixTransform(t.getScreenCTM().inverse()),[n.x,n.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const rS={passive:!1},ea={capture:!0,passive:!1};function kc(e){e.stopImmediatePropagation()}function Sr(e){e.preventDefault(),e.stopImmediatePropagation()}function R0(e){var t=e.document.documentElement,s=vs(e).on("dragstart.drag",Sr,ea);"onselectstart"in t?s.on("selectstart.drag",Sr,ea):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function D0(e,t){var s=e.document.documentElement,n=vs(e).on("dragstart.drag",null);t&&(n.on("click.drag",Sr,ea),setTimeout(function(){n.on("click.drag",null)},0)),"onselectstart"in s?n.on("selectstart.drag",null):(s.style.MozUserSelect=s.__noselect,delete s.__noselect)}const Ya=e=>()=>e;function Pu(e,{sourceEvent:t,subject:s,target:n,identifier:r,active:a,x:o,y:l,dx:c,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:s,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:l,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}Pu.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function iS(e){return!e.ctrlKey&&!e.button}function aS(){return this.parentNode}function oS(e,t){return t??{x:e.x,y:e.y}}function lS(){return navigator.maxTouchPoints||"ontouchstart"in this}function cS(){var e=iS,t=aS,s=oS,n=lS,r={},a=ua("start","drag","end"),o=0,l,c,u,d,h=0;function f(b){b.on("mousedown.drag",m).filter(n).on("touchstart.drag",y).on("touchmove.drag",g,rS).on("touchend.drag touchcancel.drag",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(b,k){if(!(d||!e.call(this,b,k))){var E=w(this,t.call(this,b,k),b,k,"mouse");E&&(vs(b.view).on("mousemove.drag",v,ea).on("mouseup.drag",x,ea),R0(b.view),kc(b),u=!1,l=b.clientX,c=b.clientY,E("start",b))}}function v(b){if(Sr(b),!u){var k=b.clientX-l,E=b.clientY-c;u=k*k+E*E>h}r.mouse("drag",b)}function x(b){vs(b.view).on("mousemove.drag mouseup.drag",null),D0(b.view,u),Sr(b),r.mouse("end",b)}function y(b,k){if(e.call(this,b,k)){var E=b.changedTouches,_=t.call(this,b,k),N=E.length,U,B;for(U=0;U<N;++U)(B=w(this,_,b,k,E[U].identifier,E[U]))&&(kc(b),B("start",b,E[U]))}}function g(b){var k=b.changedTouches,E=k.length,_,N;for(_=0;_<E;++_)(N=r[k[_].identifier])&&(Sr(b),N("drag",b,k[_]))}function p(b){var k=b.changedTouches,E=k.length,_,N;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),_=0;_<E;++_)(N=r[k[_].identifier])&&(kc(b),N("end",b,k[_]))}function w(b,k,E,_,N,U){var B=a.copy(),q=As(U||E,k),z,G,C;if((C=s.call(b,new Pu("beforestart",{sourceEvent:E,target:f,identifier:N,active:o,x:q[0],y:q[1],dx:0,dy:0,dispatch:B}),_))!=null)return z=C.x-q[0]||0,G=C.y-q[1]||0,function W(S,V,P){var O=q,A;switch(S){case"start":r[N]=W,A=o++;break;case"end":delete r[N],--o;case"drag":q=As(P||V,k),A=o;break}B.call(S,b,new Pu(S,{sourceEvent:V,subject:C,target:f,identifier:N,active:A,x:q[0]+z,y:q[1]+G,dx:q[0]-O[0],dy:q[1]-O[1],dispatch:B}),_)}}return f.filter=function(b){return arguments.length?(e=typeof b=="function"?b:Ya(!!b),f):e},f.container=function(b){return arguments.length?(t=typeof b=="function"?b:Ya(b),f):t},f.subject=function(b){return arguments.length?(s=typeof b=="function"?b:Ya(b),f):s},f.touchable=function(b){return arguments.length?(n=typeof b=="function"?b:Ya(!!b),f):n},f.on=function(){var b=a.on.apply(a,arguments);return b===a?f:b},f.clickDistance=function(b){return arguments.length?(h=(b=+b)*b,f):Math.sqrt(h)},f}function Qd(e,t,s){e.prototype=t.prototype=s,s.constructor=e}function O0(e,t){var s=Object.create(e.prototype);for(var n in t)s[n]=t[n];return s}function ha(){}var ta=.7,il=1/ta,Cr="\\s*([+-]?\\d+)\\s*",sa="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",_s="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",uS=/^#([0-9a-f]{3,8})$/,dS=new RegExp(`^rgb\\(${Cr},${Cr},${Cr}\\)$`),hS=new RegExp(`^rgb\\(${_s},${_s},${_s}\\)$`),fS=new RegExp(`^rgba\\(${Cr},${Cr},${Cr},${sa}\\)$`),mS=new RegExp(`^rgba\\(${_s},${_s},${_s},${sa}\\)$`),gS=new RegExp(`^hsl\\(${sa},${_s},${_s}\\)$`),pS=new RegExp(`^hsla\\(${sa},${_s},${_s},${sa}\\)$`),Gm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Qd(ha,Kn,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Km,formatHex:Km,formatHex8:xS,formatHsl:yS,formatRgb:Qm,toString:Qm});function Km(){return this.rgb().formatHex()}function xS(){return this.rgb().formatHex8()}function yS(){return F0(this).formatHsl()}function Qm(){return this.rgb().formatRgb()}function Kn(e){var t,s;return e=(e+"").trim().toLowerCase(),(t=uS.exec(e))?(s=t[1].length,t=parseInt(t[1],16),s===6?Jm(t):s===3?new Lt(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):s===8?Ga(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):s===4?Ga(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=dS.exec(e))?new Lt(t[1],t[2],t[3],1):(t=hS.exec(e))?new Lt(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=fS.exec(e))?Ga(t[1],t[2],t[3],t[4]):(t=mS.exec(e))?Ga(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=gS.exec(e))?tg(t[1],t[2]/100,t[3]/100,1):(t=pS.exec(e))?tg(t[1],t[2]/100,t[3]/100,t[4]):Gm.hasOwnProperty(e)?Jm(Gm[e]):e==="transparent"?new Lt(NaN,NaN,NaN,0):null}function Jm(e){return new Lt(e>>16&255,e>>8&255,e&255,1)}function Ga(e,t,s,n){return n<=0&&(e=t=s=NaN),new Lt(e,t,s,n)}function vS(e){return e instanceof ha||(e=Kn(e)),e?(e=e.rgb(),new Lt(e.r,e.g,e.b,e.opacity)):new Lt}function Ru(e,t,s,n){return arguments.length===1?vS(e):new Lt(e,t,s,n??1)}function Lt(e,t,s,n){this.r=+e,this.g=+t,this.b=+s,this.opacity=+n}Qd(Lt,Ru,O0(ha,{brighter(e){return e=e==null?il:Math.pow(il,e),new Lt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ta:Math.pow(ta,e),new Lt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Lt(Hn(this.r),Hn(this.g),Hn(this.b),al(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zm,formatHex:Zm,formatHex8:bS,formatRgb:eg,toString:eg}));function Zm(){return`#${zn(this.r)}${zn(this.g)}${zn(this.b)}`}function bS(){return`#${zn(this.r)}${zn(this.g)}${zn(this.b)}${zn((isNaN(this.opacity)?1:this.opacity)*255)}`}function eg(){const e=al(this.opacity);return`${e===1?"rgb(":"rgba("}${Hn(this.r)}, ${Hn(this.g)}, ${Hn(this.b)}${e===1?")":`, ${e})`}`}function al(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Hn(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function zn(e){return e=Hn(e),(e<16?"0":"")+e.toString(16)}function tg(e,t,s,n){return n<=0?e=t=s=NaN:s<=0||s>=1?e=t=NaN:t<=0&&(e=NaN),new rs(e,t,s,n)}function F0(e){if(e instanceof rs)return new rs(e.h,e.s,e.l,e.opacity);if(e instanceof ha||(e=Kn(e)),!e)return new rs;if(e instanceof rs)return e;e=e.rgb();var t=e.r/255,s=e.g/255,n=e.b/255,r=Math.min(t,s,n),a=Math.max(t,s,n),o=NaN,l=a-r,c=(a+r)/2;return l?(t===a?o=(s-n)/l+(s<n)*6:s===a?o=(n-t)/l+2:o=(t-s)/l+4,l/=c<.5?a+r:2-a-r,o*=60):l=c>0&&c<1?0:o,new rs(o,l,c,e.opacity)}function wS(e,t,s,n){return arguments.length===1?F0(e):new rs(e,t,s,n??1)}function rs(e,t,s,n){this.h=+e,this.s=+t,this.l=+s,this.opacity=+n}Qd(rs,wS,O0(ha,{brighter(e){return e=e==null?il:Math.pow(il,e),new rs(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ta:Math.pow(ta,e),new rs(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,s=this.l,n=s+(s<.5?s:1-s)*t,r=2*s-n;return new Lt(Sc(e>=240?e-240:e+120,r,n),Sc(e,r,n),Sc(e<120?e+240:e-120,r,n),this.opacity)},clamp(){return new rs(sg(this.h),Ka(this.s),Ka(this.l),al(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=al(this.opacity);return`${e===1?"hsl(":"hsla("}${sg(this.h)}, ${Ka(this.s)*100}%, ${Ka(this.l)*100}%${e===1?")":`, ${e})`}`}}));function sg(e){return e=(e||0)%360,e<0?e+360:e}function Ka(e){return Math.max(0,Math.min(1,e||0))}function Sc(e,t,s){return(e<60?t+(s-t)*e/60:e<180?s:e<240?t+(s-t)*(240-e)/60:t)*255}const Jd=e=>()=>e;function jS(e,t){return function(s){return e+s*t}}function _S(e,t,s){return e=Math.pow(e,s),t=Math.pow(t,s)-e,s=1/s,function(n){return Math.pow(e+n*t,s)}}function NS(e){return(e=+e)==1?z0:function(t,s){return s-t?_S(t,s,e):Jd(isNaN(t)?s:t)}}function z0(e,t){var s=t-e;return s?jS(e,s):Jd(isNaN(e)?t:e)}const ol=function e(t){var s=NS(t);function n(r,a){var o=s((r=Ru(r)).r,(a=Ru(a)).r),l=s(r.g,a.g),c=s(r.b,a.b),u=z0(r.opacity,a.opacity);return function(d){return r.r=o(d),r.g=l(d),r.b=c(d),r.opacity=u(d),r+""}}return n.gamma=e,n}(1);function kS(e,t){t||(t=[]);var s=e?Math.min(t.length,e.length):0,n=t.slice(),r;return function(a){for(r=0;r<s;++r)n[r]=e[r]*(1-a)+t[r]*a;return n}}function SS(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function CS(e,t){var s=t?t.length:0,n=e?Math.min(s,e.length):0,r=new Array(n),a=new Array(s),o;for(o=0;o<n;++o)r[o]=Zd(e[o],t[o]);for(;o<s;++o)a[o]=t[o];return function(l){for(o=0;o<n;++o)a[o]=r[o](l);return a}}function ES(e,t){var s=new Date;return e=+e,t=+t,function(n){return s.setTime(e*(1-n)+t*n),s}}function ns(e,t){return e=+e,t=+t,function(s){return e*(1-s)+t*s}}function TS(e,t){var s={},n={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?s[r]=Zd(e[r],t[r]):n[r]=t[r];return function(a){for(r in s)n[r]=s[r](a);return n}}var Du=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Cc=new RegExp(Du.source,"g");function LS(e){return function(){return e}}function AS(e){return function(t){return e(t)+""}}function I0(e,t){var s=Du.lastIndex=Cc.lastIndex=0,n,r,a,o=-1,l=[],c=[];for(e=e+"",t=t+"";(n=Du.exec(e))&&(r=Cc.exec(t));)(a=r.index)>s&&(a=t.slice(s,a),l[o]?l[o]+=a:l[++o]=a),(n=n[0])===(r=r[0])?l[o]?l[o]+=r:l[++o]=r:(l[++o]=null,c.push({i:o,x:ns(n,r)})),s=Cc.lastIndex;return s<t.length&&(a=t.slice(s),l[o]?l[o]+=a:l[++o]=a),l.length<2?c[0]?AS(c[0].x):LS(t):(t=c.length,function(u){for(var d=0,h;d<t;++d)l[(h=c[d]).i]=h.x(u);return l.join("")})}function Zd(e,t){var s=typeof t,n;return t==null||s==="boolean"?Jd(t):(s==="number"?ns:s==="string"?(n=Kn(t))?(t=n,ol):I0:t instanceof Kn?ol:t instanceof Date?ES:SS(t)?kS:Array.isArray(t)?CS:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?TS:ns)(e,t)}function MS(e,t){return e=+e,t=+t,function(s){return Math.round(e*(1-s)+t*s)}}var ng=180/Math.PI,Ou={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function $0(e,t,s,n,r,a){var o,l,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*s+t*n)&&(s-=e*c,n-=t*c),(l=Math.sqrt(s*s+n*n))&&(s/=l,n/=l,c/=l),e*n<t*s&&(e=-e,t=-t,c=-c,o=-o),{translateX:r,translateY:a,rotate:Math.atan2(t,e)*ng,skewX:Math.atan(c)*ng,scaleX:o,scaleY:l}}var Qa;function PS(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Ou:$0(t.a,t.b,t.c,t.d,t.e,t.f)}function RS(e){return e==null||(Qa||(Qa=document.createElementNS("http://www.w3.org/2000/svg","g")),Qa.setAttribute("transform",e),!(e=Qa.transform.baseVal.consolidate()))?Ou:(e=e.matrix,$0(e.a,e.b,e.c,e.d,e.e,e.f))}function B0(e,t,s,n){function r(u){return u.length?u.pop()+" ":""}function a(u,d,h,f,m,v){if(u!==h||d!==f){var x=m.push("translate(",null,t,null,s);v.push({i:x-4,x:ns(u,h)},{i:x-2,x:ns(d,f)})}else(h||f)&&m.push("translate("+h+t+f+s)}function o(u,d,h,f){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),f.push({i:h.push(r(h)+"rotate(",null,n)-2,x:ns(u,d)})):d&&h.push(r(h)+"rotate("+d+n)}function l(u,d,h,f){u!==d?f.push({i:h.push(r(h)+"skewX(",null,n)-2,x:ns(u,d)}):d&&h.push(r(h)+"skewX("+d+n)}function c(u,d,h,f,m,v){if(u!==h||d!==f){var x=m.push(r(m)+"scale(",null,",",null,")");v.push({i:x-4,x:ns(u,h)},{i:x-2,x:ns(d,f)})}else(h!==1||f!==1)&&m.push(r(m)+"scale("+h+","+f+")")}return function(u,d){var h=[],f=[];return u=e(u),d=e(d),a(u.translateX,u.translateY,d.translateX,d.translateY,h,f),o(u.rotate,d.rotate,h,f),l(u.skewX,d.skewX,h,f),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,h,f),u=d=null,function(m){for(var v=-1,x=f.length,y;++v<x;)h[(y=f[v]).i]=y.x(m);return h.join("")}}}var DS=B0(PS,"px, ","px)","deg)"),OS=B0(RS,", ",")",")"),FS=1e-12;function rg(e){return((e=Math.exp(e))+1/e)/2}function zS(e){return((e=Math.exp(e))-1/e)/2}function IS(e){return((e=Math.exp(2*e))-1)/(e+1)}const $S=function e(t,s,n){function r(a,o){var l=a[0],c=a[1],u=a[2],d=o[0],h=o[1],f=o[2],m=d-l,v=h-c,x=m*m+v*v,y,g;if(x<FS)g=Math.log(f/u)/t,y=function(_){return[l+_*m,c+_*v,u*Math.exp(t*_*g)]};else{var p=Math.sqrt(x),w=(f*f-u*u+n*x)/(2*u*s*p),b=(f*f-u*u-n*x)/(2*f*s*p),k=Math.log(Math.sqrt(w*w+1)-w),E=Math.log(Math.sqrt(b*b+1)-b);g=(E-k)/t,y=function(_){var N=_*g,U=rg(k),B=u/(s*p)*(U*IS(t*N+k)-zS(k));return[l+B*m,c+B*v,u*U/rg(t*N+k)]}}return y.duration=g*1e3*t/Math.SQRT2,y}return r.rho=function(a){var o=Math.max(.001,+a),l=o*o,c=l*l;return e(o,l,c)},r}(Math.SQRT2,2,4);var zr=0,pi=0,oi=0,H0=1e3,ll,xi,cl=0,Qn=0,Rl=0,na=typeof performance=="object"&&performance.now?performance:Date,U0=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function eh(){return Qn||(U0(BS),Qn=na.now()+Rl)}function BS(){Qn=0}function ul(){this._call=this._time=this._next=null}ul.prototype=th.prototype={constructor:ul,restart:function(e,t,s){if(typeof e!="function")throw new TypeError("callback is not a function");s=(s==null?eh():+s)+(t==null?0:+t),!this._next&&xi!==this&&(xi?xi._next=this:ll=this,xi=this),this._call=e,this._time=s,Fu()},stop:function(){this._call&&(this._call=null,this._time=1/0,Fu())}};function th(e,t,s){var n=new ul;return n.restart(e,t,s),n}function HS(){eh(),++zr;for(var e=ll,t;e;)(t=Qn-e._time)>=0&&e._call.call(void 0,t),e=e._next;--zr}function ig(){Qn=(cl=na.now())+Rl,zr=pi=0;try{HS()}finally{zr=0,VS(),Qn=0}}function US(){var e=na.now(),t=e-cl;t>H0&&(Rl-=t,cl=e)}function VS(){for(var e,t=ll,s,n=1/0;t;)t._call?(n>t._time&&(n=t._time),e=t,t=t._next):(s=t._next,t._next=null,t=e?e._next=s:ll=s);xi=e,Fu(n)}function Fu(e){if(!zr){pi&&(pi=clearTimeout(pi));var t=e-Qn;t>24?(e<1/0&&(pi=setTimeout(ig,e-na.now()-Rl)),oi&&(oi=clearInterval(oi))):(oi||(cl=na.now(),oi=setInterval(US,H0)),zr=1,U0(ig))}}function ag(e,t,s){var n=new ul;return t=t==null?0:+t,n.restart(r=>{n.stop(),e(r+t)},t,s),n}var WS=ua("start","end","cancel","interrupt"),XS=[],V0=0,og=1,zu=2,jo=3,lg=4,Iu=5,_o=6;function Dl(e,t,s,n,r,a){var o=e.__transition;if(!o)e.__transition={};else if(s in o)return;qS(e,s,{name:t,index:n,group:r,on:WS,tween:XS,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:V0})}function sh(e,t){var s=us(e,t);if(s.state>V0)throw new Error("too late; already scheduled");return s}function ks(e,t){var s=us(e,t);if(s.state>jo)throw new Error("too late; already running");return s}function us(e,t){var s=e.__transition;if(!s||!(s=s[t]))throw new Error("transition not found");return s}function qS(e,t,s){var n=e.__transition,r;n[t]=s,s.timer=th(a,0,s.time);function a(u){s.state=og,s.timer.restart(o,s.delay,s.time),s.delay<=u&&o(u-s.delay)}function o(u){var d,h,f,m;if(s.state!==og)return c();for(d in n)if(m=n[d],m.name===s.name){if(m.state===jo)return ag(o);m.state===lg?(m.state=_o,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete n[d]):+d<t&&(m.state=_o,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete n[d])}if(ag(function(){s.state===jo&&(s.state=lg,s.timer.restart(l,s.delay,s.time),l(u))}),s.state=zu,s.on.call("start",e,e.__data__,s.index,s.group),s.state===zu){for(s.state=jo,r=new Array(f=s.tween.length),d=0,h=-1;d<f;++d)(m=s.tween[d].value.call(e,e.__data__,s.index,s.group))&&(r[++h]=m);r.length=h+1}}function l(u){for(var d=u<s.duration?s.ease.call(null,u/s.duration):(s.timer.restart(c),s.state=Iu,1),h=-1,f=r.length;++h<f;)r[h].call(e,d);s.state===Iu&&(s.on.call("end",e,e.__data__,s.index,s.group),c())}function c(){s.state=_o,s.timer.stop(),delete n[t];for(var u in n)return;delete e.__transition}}function No(e,t){var s=e.__transition,n,r,a=!0,o;if(s){t=t==null?null:t+"";for(o in s){if((n=s[o]).name!==t){a=!1;continue}r=n.state>zu&&n.state<Iu,n.state=_o,n.timer.stop(),n.on.call(r?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete s[o]}a&&delete e.__transition}}function YS(e){return this.each(function(){No(this,e)})}function GS(e,t){var s,n;return function(){var r=ks(this,e),a=r.tween;if(a!==s){n=s=a;for(var o=0,l=n.length;o<l;++o)if(n[o].name===t){n=n.slice(),n.splice(o,1);break}}r.tween=n}}function KS(e,t,s){var n,r;if(typeof s!="function")throw new Error;return function(){var a=ks(this,e),o=a.tween;if(o!==n){r=(n=o).slice();for(var l={name:t,value:s},c=0,u=r.length;c<u;++c)if(r[c].name===t){r[c]=l;break}c===u&&r.push(l)}a.tween=r}}function QS(e,t){var s=this._id;if(e+="",arguments.length<2){for(var n=us(this.node(),s).tween,r=0,a=n.length,o;r<a;++r)if((o=n[r]).name===e)return o.value;return null}return this.each((t==null?GS:KS)(s,e,t))}function nh(e,t,s){var n=e._id;return e.each(function(){var r=ks(this,n);(r.value||(r.value={}))[t]=s.apply(this,arguments)}),function(r){return us(r,n).value[t]}}function W0(e,t){var s;return(typeof t=="number"?ns:t instanceof Kn?ol:(s=Kn(t))?(t=s,ol):I0)(e,t)}function JS(e){return function(){this.removeAttribute(e)}}function ZS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function e2(e,t,s){var n,r=s+"",a;return function(){var o=this.getAttribute(e);return o===r?null:o===n?a:a=t(n=o,s)}}function t2(e,t,s){var n,r=s+"",a;return function(){var o=this.getAttributeNS(e.space,e.local);return o===r?null:o===n?a:a=t(n=o,s)}}function s2(e,t,s){var n,r,a;return function(){var o,l=s(this),c;return l==null?void this.removeAttribute(e):(o=this.getAttribute(e),c=l+"",o===c?null:o===n&&c===r?a:(r=c,a=t(n=o,l)))}}function n2(e,t,s){var n,r,a;return function(){var o,l=s(this),c;return l==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),c=l+"",o===c?null:o===n&&c===r?a:(r=c,a=t(n=o,l)))}}function r2(e,t){var s=Pl(e),n=s==="transform"?OS:W0;return this.attrTween(e,typeof t=="function"?(s.local?n2:s2)(s,n,nh(this,"attr."+e,t)):t==null?(s.local?ZS:JS)(s):(s.local?t2:e2)(s,n,t))}function i2(e,t){return function(s){this.setAttribute(e,t.call(this,s))}}function a2(e,t){return function(s){this.setAttributeNS(e.space,e.local,t.call(this,s))}}function o2(e,t){var s,n;function r(){var a=t.apply(this,arguments);return a!==n&&(s=(n=a)&&a2(e,a)),s}return r._value=t,r}function l2(e,t){var s,n;function r(){var a=t.apply(this,arguments);return a!==n&&(s=(n=a)&&i2(e,a)),s}return r._value=t,r}function c2(e,t){var s="attr."+e;if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;var n=Pl(e);return this.tween(s,(n.local?o2:l2)(n,t))}function u2(e,t){return function(){sh(this,e).delay=+t.apply(this,arguments)}}function d2(e,t){return t=+t,function(){sh(this,e).delay=t}}function h2(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?u2:d2)(t,e)):us(this.node(),t).delay}function f2(e,t){return function(){ks(this,e).duration=+t.apply(this,arguments)}}function m2(e,t){return t=+t,function(){ks(this,e).duration=t}}function g2(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?f2:m2)(t,e)):us(this.node(),t).duration}function p2(e,t){if(typeof t!="function")throw new Error;return function(){ks(this,e).ease=t}}function x2(e){var t=this._id;return arguments.length?this.each(p2(t,e)):us(this.node(),t).ease}function y2(e,t){return function(){var s=t.apply(this,arguments);if(typeof s!="function")throw new Error;ks(this,e).ease=s}}function v2(e){if(typeof e!="function")throw new Error;return this.each(y2(this._id,e))}function b2(e){typeof e!="function"&&(e=N0(e));for(var t=this._groups,s=t.length,n=new Array(s),r=0;r<s;++r)for(var a=t[r],o=a.length,l=n[r]=[],c,u=0;u<o;++u)(c=a[u])&&e.call(c,c.__data__,u,a)&&l.push(c);return new Vs(n,this._parents,this._name,this._id)}function w2(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,s=e._groups,n=t.length,r=s.length,a=Math.min(n,r),o=new Array(n),l=0;l<a;++l)for(var c=t[l],u=s[l],d=c.length,h=o[l]=new Array(d),f,m=0;m<d;++m)(f=c[m]||u[m])&&(h[m]=f);for(;l<n;++l)o[l]=t[l];return new Vs(o,this._parents,this._name,this._id)}function j2(e){return(e+"").trim().split(/^|\s+/).every(function(t){var s=t.indexOf(".");return s>=0&&(t=t.slice(0,s)),!t||t==="start"})}function _2(e,t,s){var n,r,a=j2(t)?sh:ks;return function(){var o=a(this,e),l=o.on;l!==n&&(r=(n=l).copy()).on(t,s),o.on=r}}function N2(e,t){var s=this._id;return arguments.length<2?us(this.node(),s).on.on(e):this.each(_2(s,e,t))}function k2(e){return function(){var t=this.parentNode;for(var s in this.__transition)if(+s!==e)return;t&&t.removeChild(this)}}function S2(){return this.on("end.remove",k2(this._id))}function C2(e){var t=this._name,s=this._id;typeof e!="function"&&(e=Gd(e));for(var n=this._groups,r=n.length,a=new Array(r),o=0;o<r;++o)for(var l=n[o],c=l.length,u=a[o]=new Array(c),d,h,f=0;f<c;++f)(d=l[f])&&(h=e.call(d,d.__data__,f,l))&&("__data__"in d&&(h.__data__=d.__data__),u[f]=h,Dl(u[f],t,s,f,u,us(d,s)));return new Vs(a,this._parents,t,s)}function E2(e){var t=this._name,s=this._id;typeof e!="function"&&(e=_0(e));for(var n=this._groups,r=n.length,a=[],o=[],l=0;l<r;++l)for(var c=n[l],u=c.length,d,h=0;h<u;++h)if(d=c[h]){for(var f=e.call(d,d.__data__,h,c),m,v=us(d,s),x=0,y=f.length;x<y;++x)(m=f[x])&&Dl(m,t,s,x,f,v);a.push(f),o.push(d)}return new Vs(a,o,t,s)}var T2=da.prototype.constructor;function L2(){return new T2(this._groups,this._parents)}function A2(e,t){var s,n,r;return function(){var a=Fr(this,e),o=(this.style.removeProperty(e),Fr(this,e));return a===o?null:a===s&&o===n?r:r=t(s=a,n=o)}}function X0(e){return function(){this.style.removeProperty(e)}}function M2(e,t,s){var n,r=s+"",a;return function(){var o=Fr(this,e);return o===r?null:o===n?a:a=t(n=o,s)}}function P2(e,t,s){var n,r,a;return function(){var o=Fr(this,e),l=s(this),c=l+"";return l==null&&(c=l=(this.style.removeProperty(e),Fr(this,e))),o===c?null:o===n&&c===r?a:(r=c,a=t(n=o,l))}}function R2(e,t){var s,n,r,a="style."+t,o="end."+a,l;return function(){var c=ks(this,e),u=c.on,d=c.value[a]==null?l||(l=X0(t)):void 0;(u!==s||r!==d)&&(n=(s=u).copy()).on(o,r=d),c.on=n}}function D2(e,t,s){var n=(e+="")=="transform"?DS:W0;return t==null?this.styleTween(e,A2(e,n)).on("end.style."+e,X0(e)):typeof t=="function"?this.styleTween(e,P2(e,n,nh(this,"style."+e,t))).each(R2(this._id,e)):this.styleTween(e,M2(e,n,t),s).on("end.style."+e,null)}function O2(e,t,s){return function(n){this.style.setProperty(e,t.call(this,n),s)}}function F2(e,t,s){var n,r;function a(){var o=t.apply(this,arguments);return o!==r&&(n=(r=o)&&O2(e,o,s)),n}return a._value=t,a}function z2(e,t,s){var n="style."+(e+="");if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,F2(e,t,s??""))}function I2(e){return function(){this.textContent=e}}function $2(e){return function(){var t=e(this);this.textContent=t??""}}function B2(e){return this.tween("text",typeof e=="function"?$2(nh(this,"text",e)):I2(e==null?"":e+""))}function H2(e){return function(t){this.textContent=e.call(this,t)}}function U2(e){var t,s;function n(){var r=e.apply(this,arguments);return r!==s&&(t=(s=r)&&H2(r)),t}return n._value=e,n}function V2(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,U2(e))}function W2(){for(var e=this._name,t=this._id,s=q0(),n=this._groups,r=n.length,a=0;a<r;++a)for(var o=n[a],l=o.length,c,u=0;u<l;++u)if(c=o[u]){var d=us(c,t);Dl(c,e,s,u,o,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Vs(n,this._parents,e,s)}function X2(){var e,t,s=this,n=s._id,r=s.size();return new Promise(function(a,o){var l={value:o},c={value:function(){--r===0&&a()}};s.each(function(){var u=ks(this,n),d=u.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(l),t._.interrupt.push(l),t._.end.push(c)),u.on=t}),r===0&&a()})}var q2=0;function Vs(e,t,s,n){this._groups=e,this._parents=t,this._name=s,this._id=n}function q0(){return++q2}var Cs=da.prototype;Vs.prototype={constructor:Vs,select:C2,selectAll:E2,selectChild:Cs.selectChild,selectChildren:Cs.selectChildren,filter:b2,merge:w2,selection:L2,transition:W2,call:Cs.call,nodes:Cs.nodes,node:Cs.node,size:Cs.size,empty:Cs.empty,each:Cs.each,on:N2,attr:r2,attrTween:c2,style:D2,styleTween:z2,text:B2,textTween:V2,remove:S2,tween:QS,delay:h2,duration:g2,ease:x2,easeVarying:v2,end:X2,[Symbol.iterator]:Cs[Symbol.iterator]};function Y2(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var G2={time:null,delay:0,duration:250,ease:Y2};function K2(e,t){for(var s;!(s=e.__transition)||!(s=s[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return s}function Q2(e){var t,s;e instanceof Vs?(t=e._id,e=e._name):(t=q0(),(s=G2).time=eh(),e=e==null?null:e+"");for(var n=this._groups,r=n.length,a=0;a<r;++a)for(var o=n[a],l=o.length,c,u=0;u<l;++u)(c=o[u])&&Dl(c,e,t,u,o,s||K2(c,t));return new Vs(n,this._parents,e,t)}da.prototype.interrupt=YS;da.prototype.transition=Q2;function J2(e,t){var s,n=1;e==null&&(e=0),t==null&&(t=0);function r(){var a,o=s.length,l,c=0,u=0;for(a=0;a<o;++a)l=s[a],c+=l.x,u+=l.y;for(c=(c/o-e)*n,u=(u/o-t)*n,a=0;a<o;++a)l=s[a],l.x-=c,l.y-=u}return r.initialize=function(a){s=a},r.x=function(a){return arguments.length?(e=+a,r):e},r.y=function(a){return arguments.length?(t=+a,r):t},r.strength=function(a){return arguments.length?(n=+a,r):n},r}function Z2(e){const t=+this._x.call(null,e),s=+this._y.call(null,e);return Y0(this.cover(t,s),t,s,e)}function Y0(e,t,s,n){if(isNaN(t)||isNaN(s))return e;var r,a=e._root,o={data:n},l=e._x0,c=e._y0,u=e._x1,d=e._y1,h,f,m,v,x,y,g,p;if(!a)return e._root=o,e;for(;a.length;)if((x=t>=(h=(l+u)/2))?l=h:u=h,(y=s>=(f=(c+d)/2))?c=f:d=f,r=a,!(a=a[g=y<<1|x]))return r[g]=o,e;if(m=+e._x.call(null,a.data),v=+e._y.call(null,a.data),t===m&&s===v)return o.next=a,r?r[g]=o:e._root=o,e;do r=r?r[g]=new Array(4):e._root=new Array(4),(x=t>=(h=(l+u)/2))?l=h:u=h,(y=s>=(f=(c+d)/2))?c=f:d=f;while((g=y<<1|x)===(p=(v>=f)<<1|m>=h));return r[p]=a,r[g]=o,e}function eC(e){var t,s,n=e.length,r,a,o=new Array(n),l=new Array(n),c=1/0,u=1/0,d=-1/0,h=-1/0;for(s=0;s<n;++s)isNaN(r=+this._x.call(null,t=e[s]))||isNaN(a=+this._y.call(null,t))||(o[s]=r,l[s]=a,r<c&&(c=r),r>d&&(d=r),a<u&&(u=a),a>h&&(h=a));if(c>d||u>h)return this;for(this.cover(c,u).cover(d,h),s=0;s<n;++s)Y0(this,o[s],l[s],e[s]);return this}function tC(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var s=this._x0,n=this._y0,r=this._x1,a=this._y1;if(isNaN(s))r=(s=Math.floor(e))+1,a=(n=Math.floor(t))+1;else{for(var o=r-s||1,l=this._root,c,u;s>e||e>=r||n>t||t>=a;)switch(u=(t<n)<<1|e<s,c=new Array(4),c[u]=l,l=c,o*=2,u){case 0:r=s+o,a=n+o;break;case 1:s=r-o,a=n+o;break;case 2:r=s+o,n=a-o;break;case 3:s=r-o,n=a-o;break}this._root&&this._root.length&&(this._root=l)}return this._x0=s,this._y0=n,this._x1=r,this._y1=a,this}function sC(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function nC(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function wt(e,t,s,n,r){this.node=e,this.x0=t,this.y0=s,this.x1=n,this.y1=r}function rC(e,t,s){var n,r=this._x0,a=this._y0,o,l,c,u,d=this._x1,h=this._y1,f=[],m=this._root,v,x;for(m&&f.push(new wt(m,r,a,d,h)),s==null?s=1/0:(r=e-s,a=t-s,d=e+s,h=t+s,s*=s);v=f.pop();)if(!(!(m=v.node)||(o=v.x0)>d||(l=v.y0)>h||(c=v.x1)<r||(u=v.y1)<a))if(m.length){var y=(o+c)/2,g=(l+u)/2;f.push(new wt(m[3],y,g,c,u),new wt(m[2],o,g,y,u),new wt(m[1],y,l,c,g),new wt(m[0],o,l,y,g)),(x=(t>=g)<<1|e>=y)&&(v=f[f.length-1],f[f.length-1]=f[f.length-1-x],f[f.length-1-x]=v)}else{var p=e-+this._x.call(null,m.data),w=t-+this._y.call(null,m.data),b=p*p+w*w;if(b<s){var k=Math.sqrt(s=b);r=e-k,a=t-k,d=e+k,h=t+k,n=m.data}}return n}function iC(e){if(isNaN(d=+this._x.call(null,e))||isNaN(h=+this._y.call(null,e)))return this;var t,s=this._root,n,r,a,o=this._x0,l=this._y0,c=this._x1,u=this._y1,d,h,f,m,v,x,y,g;if(!s)return this;if(s.length)for(;;){if((v=d>=(f=(o+c)/2))?o=f:c=f,(x=h>=(m=(l+u)/2))?l=m:u=m,t=s,!(s=s[y=x<<1|v]))return this;if(!s.length)break;(t[y+1&3]||t[y+2&3]||t[y+3&3])&&(n=t,g=y)}for(;s.data!==e;)if(r=s,!(s=s.next))return this;return(a=s.next)&&delete s.next,r?(a?r.next=a:delete r.next,this):t?(a?t[y]=a:delete t[y],(s=t[0]||t[1]||t[2]||t[3])&&s===(t[3]||t[2]||t[1]||t[0])&&!s.length&&(n?n[g]=s:this._root=s),this):(this._root=a,this)}function aC(e){for(var t=0,s=e.length;t<s;++t)this.remove(e[t]);return this}function oC(){return this._root}function lC(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function cC(e){var t=[],s,n=this._root,r,a,o,l,c;for(n&&t.push(new wt(n,this._x0,this._y0,this._x1,this._y1));s=t.pop();)if(!e(n=s.node,a=s.x0,o=s.y0,l=s.x1,c=s.y1)&&n.length){var u=(a+l)/2,d=(o+c)/2;(r=n[3])&&t.push(new wt(r,u,d,l,c)),(r=n[2])&&t.push(new wt(r,a,d,u,c)),(r=n[1])&&t.push(new wt(r,u,o,l,d)),(r=n[0])&&t.push(new wt(r,a,o,u,d))}return this}function uC(e){var t=[],s=[],n;for(this._root&&t.push(new wt(this._root,this._x0,this._y0,this._x1,this._y1));n=t.pop();){var r=n.node;if(r.length){var a,o=n.x0,l=n.y0,c=n.x1,u=n.y1,d=(o+c)/2,h=(l+u)/2;(a=r[0])&&t.push(new wt(a,o,l,d,h)),(a=r[1])&&t.push(new wt(a,d,l,c,h)),(a=r[2])&&t.push(new wt(a,o,h,d,u)),(a=r[3])&&t.push(new wt(a,d,h,c,u))}s.push(n)}for(;n=s.pop();)e(n.node,n.x0,n.y0,n.x1,n.y1);return this}function dC(e){return e[0]}function hC(e){return arguments.length?(this._x=e,this):this._x}function fC(e){return e[1]}function mC(e){return arguments.length?(this._y=e,this):this._y}function rh(e,t,s){var n=new ih(t??dC,s??fC,NaN,NaN,NaN,NaN);return e==null?n:n.addAll(e)}function ih(e,t,s,n,r,a){this._x=e,this._y=t,this._x0=s,this._y0=n,this._x1=r,this._y1=a,this._root=void 0}function cg(e){for(var t={data:e.data},s=t;e=e.next;)s=s.next={data:e.data};return t}var kt=rh.prototype=ih.prototype;kt.copy=function(){var e=new ih(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,s,n;if(!t)return e;if(!t.length)return e._root=cg(t),e;for(s=[{source:t,target:e._root=new Array(4)}];t=s.pop();)for(var r=0;r<4;++r)(n=t.source[r])&&(n.length?s.push({source:n,target:t.target[r]=new Array(4)}):t.target[r]=cg(n));return e};kt.add=Z2;kt.addAll=eC;kt.cover=tC;kt.data=sC;kt.extent=nC;kt.find=rC;kt.remove=iC;kt.removeAll=aC;kt.root=oC;kt.size=lC;kt.visit=cC;kt.visitAfter=uC;kt.x=hC;kt.y=mC;function Un(e){return function(){return e}}function an(e){return(e()-.5)*1e-6}function gC(e){return e.x+e.vx}function pC(e){return e.y+e.vy}function xC(e){var t,s,n,r=1,a=1;typeof e!="function"&&(e=Un(e==null?1:+e));function o(){for(var u,d=t.length,h,f,m,v,x,y,g=0;g<a;++g)for(h=rh(t,gC,pC).visitAfter(l),u=0;u<d;++u)f=t[u],x=s[f.index],y=x*x,m=f.x+f.vx,v=f.y+f.vy,h.visit(p);function p(w,b,k,E,_){var N=w.data,U=w.r,B=x+U;if(N){if(N.index>f.index){var q=m-N.x-N.vx,z=v-N.y-N.vy,G=q*q+z*z;G<B*B&&(q===0&&(q=an(n),G+=q*q),z===0&&(z=an(n),G+=z*z),G=(B-(G=Math.sqrt(G)))/G*r,f.vx+=(q*=G)*(B=(U*=U)/(y+U)),f.vy+=(z*=G)*B,N.vx-=q*(B=1-B),N.vy-=z*B)}return}return b>m+B||E<m-B||k>v+B||_<v-B}}function l(u){if(u.data)return u.r=s[u.data.index];for(var d=u.r=0;d<4;++d)u[d]&&u[d].r>u.r&&(u.r=u[d].r)}function c(){if(t){var u,d=t.length,h;for(s=new Array(d),u=0;u<d;++u)h=t[u],s[h.index]=+e(h,u,t)}}return o.initialize=function(u,d){t=u,n=d,c()},o.iterations=function(u){return arguments.length?(a=+u,o):a},o.strength=function(u){return arguments.length?(r=+u,o):r},o.radius=function(u){return arguments.length?(e=typeof u=="function"?u:Un(+u),c(),o):e},o}function yC(e){return e.index}function ug(e,t){var s=e.get(t);if(!s)throw new Error("node not found: "+t);return s}function vC(e){var t=yC,s=h,n,r=Un(30),a,o,l,c,u,d=1;e==null&&(e=[]);function h(y){return 1/Math.min(l[y.source.index],l[y.target.index])}function f(y){for(var g=0,p=e.length;g<d;++g)for(var w=0,b,k,E,_,N,U,B;w<p;++w)b=e[w],k=b.source,E=b.target,_=E.x+E.vx-k.x-k.vx||an(u),N=E.y+E.vy-k.y-k.vy||an(u),U=Math.sqrt(_*_+N*N),U=(U-a[w])/U*y*n[w],_*=U,N*=U,E.vx-=_*(B=c[w]),E.vy-=N*B,k.vx+=_*(B=1-B),k.vy+=N*B}function m(){if(o){var y,g=o.length,p=e.length,w=new Map(o.map((k,E)=>[t(k,E,o),k])),b;for(y=0,l=new Array(g);y<p;++y)b=e[y],b.index=y,typeof b.source!="object"&&(b.source=ug(w,b.source)),typeof b.target!="object"&&(b.target=ug(w,b.target)),l[b.source.index]=(l[b.source.index]||0)+1,l[b.target.index]=(l[b.target.index]||0)+1;for(y=0,c=new Array(p);y<p;++y)b=e[y],c[y]=l[b.source.index]/(l[b.source.index]+l[b.target.index]);n=new Array(p),v(),a=new Array(p),x()}}function v(){if(o)for(var y=0,g=e.length;y<g;++y)n[y]=+s(e[y],y,e)}function x(){if(o)for(var y=0,g=e.length;y<g;++y)a[y]=+r(e[y],y,e)}return f.initialize=function(y,g){o=y,u=g,m()},f.links=function(y){return arguments.length?(e=y,m(),f):e},f.id=function(y){return arguments.length?(t=y,f):t},f.iterations=function(y){return arguments.length?(d=+y,f):d},f.strength=function(y){return arguments.length?(s=typeof y=="function"?y:Un(+y),v(),f):s},f.distance=function(y){return arguments.length?(r=typeof y=="function"?y:Un(+y),x(),f):r},f}const bC=1664525,wC=1013904223,dg=4294967296;function jC(){let e=1;return()=>(e=(bC*e+wC)%dg)/dg}function _C(e){return e.x}function NC(e){return e.y}var kC=10,SC=Math.PI*(3-Math.sqrt(5));function CC(e){var t,s=1,n=.001,r=1-Math.pow(n,1/300),a=0,o=.6,l=new Map,c=th(h),u=ua("tick","end"),d=jC();e==null&&(e=[]);function h(){f(),u.call("tick",t),s<n&&(c.stop(),u.call("end",t))}function f(x){var y,g=e.length,p;x===void 0&&(x=1);for(var w=0;w<x;++w)for(s+=(a-s)*r,l.forEach(function(b){b(s)}),y=0;y<g;++y)p=e[y],p.fx==null?p.x+=p.vx*=o:(p.x=p.fx,p.vx=0),p.fy==null?p.y+=p.vy*=o:(p.y=p.fy,p.vy=0);return t}function m(){for(var x=0,y=e.length,g;x<y;++x){if(g=e[x],g.index=x,g.fx!=null&&(g.x=g.fx),g.fy!=null&&(g.y=g.fy),isNaN(g.x)||isNaN(g.y)){var p=kC*Math.sqrt(.5+x),w=x*SC;g.x=p*Math.cos(w),g.y=p*Math.sin(w)}(isNaN(g.vx)||isNaN(g.vy))&&(g.vx=g.vy=0)}}function v(x){return x.initialize&&x.initialize(e,d),x}return m(),t={tick:f,restart:function(){return c.restart(h),t},stop:function(){return c.stop(),t},nodes:function(x){return arguments.length?(e=x,m(),l.forEach(v),t):e},alpha:function(x){return arguments.length?(s=+x,t):s},alphaMin:function(x){return arguments.length?(n=+x,t):n},alphaDecay:function(x){return arguments.length?(r=+x,t):+r},alphaTarget:function(x){return arguments.length?(a=+x,t):a},velocityDecay:function(x){return arguments.length?(o=1-x,t):1-o},randomSource:function(x){return arguments.length?(d=x,l.forEach(v),t):d},force:function(x,y){return arguments.length>1?(y==null?l.delete(x):l.set(x,v(y)),t):l.get(x)},find:function(x,y,g){var p=0,w=e.length,b,k,E,_,N;for(g==null?g=1/0:g*=g,p=0;p<w;++p)_=e[p],b=x-_.x,k=y-_.y,E=b*b+k*k,E<g&&(N=_,g=E);return N},on:function(x,y){return arguments.length>1?(u.on(x,y),t):u.on(x)}}}function EC(){var e,t,s,n,r=Un(-30),a,o=1,l=1/0,c=.81;function u(m){var v,x=e.length,y=rh(e,_C,NC).visitAfter(h);for(n=m,v=0;v<x;++v)t=e[v],y.visit(f)}function d(){if(e){var m,v=e.length,x;for(a=new Array(v),m=0;m<v;++m)x=e[m],a[x.index]=+r(x,m,e)}}function h(m){var v=0,x,y,g=0,p,w,b;if(m.length){for(p=w=b=0;b<4;++b)(x=m[b])&&(y=Math.abs(x.value))&&(v+=x.value,g+=y,p+=y*x.x,w+=y*x.y);m.x=p/g,m.y=w/g}else{x=m,x.x=x.data.x,x.y=x.data.y;do v+=a[x.data.index];while(x=x.next)}m.value=v}function f(m,v,x,y){if(!m.value)return!0;var g=m.x-t.x,p=m.y-t.y,w=y-v,b=g*g+p*p;if(w*w/c<b)return b<l&&(g===0&&(g=an(s),b+=g*g),p===0&&(p=an(s),b+=p*p),b<o&&(b=Math.sqrt(o*b)),t.vx+=g*m.value*n/b,t.vy+=p*m.value*n/b),!0;if(m.length||b>=l)return;(m.data!==t||m.next)&&(g===0&&(g=an(s),b+=g*g),p===0&&(p=an(s),b+=p*p),b<o&&(b=Math.sqrt(o*b)));do m.data!==t&&(w=a[m.data.index]*n/b,t.vx+=g*w,t.vy+=p*w);while(m=m.next)}return u.initialize=function(m,v){e=m,s=v,d()},u.strength=function(m){return arguments.length?(r=typeof m=="function"?m:Un(+m),d(),u):r},u.distanceMin=function(m){return arguments.length?(o=m*m,u):Math.sqrt(o)},u.distanceMax=function(m){return arguments.length?(l=m*m,u):Math.sqrt(l)},u.theta=function(m){return arguments.length?(c=m*m,u):Math.sqrt(c)},u}function TC(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function dl(e,t){if(!isFinite(e)||e===0)return null;var s=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,s);return[n.length>1?n[0]+n.slice(2):n,+e.slice(s+1)]}function Ir(e){return e=dl(Math.abs(e)),e?e[1]:NaN}function LC(e,t){return function(s,n){for(var r=s.length,a=[],o=0,l=e[0],c=0;r>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),a.push(s.substring(r-=l,r+l)),!((c+=l+1)>n));)l=e[o=(o+1)%e.length];return a.reverse().join(t)}}function AC(e){return function(t){return t.replace(/[0-9]/g,function(s){return e[+s]})}}var MC=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hl(e){if(!(t=MC.exec(e)))throw new Error("invalid format: "+e);var t;return new ah({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}hl.prototype=ah.prototype;function ah(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}ah.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function PC(e){e:for(var t=e.length,s=1,n=-1,r;s<t;++s)switch(e[s]){case".":n=r=s;break;case"0":n===0&&(n=s),r=s;break;default:if(!+e[s])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(r+1):e}var fl;function RC(e,t){var s=dl(e,t);if(!s)return fl=void 0,e.toPrecision(t);var n=s[0],r=s[1],a=r-(fl=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,o=n.length;return a===o?n:a>o?n+new Array(a-o+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+dl(e,Math.max(0,t+a-1))[0]}function hg(e,t){var s=dl(e,t);if(!s)return e+"";var n=s[0],r=s[1];return r<0?"0."+new Array(-r).join("0")+n:n.length>r+1?n.slice(0,r+1)+"."+n.slice(r+1):n+new Array(r-n.length+2).join("0")}const fg={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:TC,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>hg(e*100,t),r:hg,s:RC,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function mg(e){return e}var gg=Array.prototype.map,pg=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function DC(e){var t=e.grouping===void 0||e.thousands===void 0?mg:LC(gg.call(e.grouping,Number),e.thousands+""),s=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",r=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?mg:AC(gg.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(h,f){h=hl(h);var m=h.fill,v=h.align,x=h.sign,y=h.symbol,g=h.zero,p=h.width,w=h.comma,b=h.precision,k=h.trim,E=h.type;E==="n"?(w=!0,E="g"):fg[E]||(b===void 0&&(b=12),k=!0,E="g"),(g||m==="0"&&v==="=")&&(g=!0,m="0",v="=");var _=(f&&f.prefix!==void 0?f.prefix:"")+(y==="$"?s:y==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():""),N=(y==="$"?n:/[%p]/.test(E)?o:"")+(f&&f.suffix!==void 0?f.suffix:""),U=fg[E],B=/[defgprs%]/.test(E);b=b===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function q(z){var G=_,C=N,W,S,V;if(E==="c")C=U(z)+C,z="";else{z=+z;var P=z<0||1/z<0;if(z=isNaN(z)?c:U(Math.abs(z),b),k&&(z=PC(z)),P&&+z==0&&x!=="+"&&(P=!1),G=(P?x==="("?x:l:x==="-"||x==="("?"":x)+G,C=(E==="s"&&!isNaN(z)&&fl!==void 0?pg[8+fl/3]:"")+C+(P&&x==="("?")":""),B){for(W=-1,S=z.length;++W<S;)if(V=z.charCodeAt(W),48>V||V>57){C=(V===46?r+z.slice(W+1):z.slice(W))+C,z=z.slice(0,W);break}}}w&&!g&&(z=t(z,1/0));var O=G.length+z.length+C.length,A=O<p?new Array(p-O+1).join(m):"";switch(w&&g&&(z=t(A+z,A.length?p-C.length:1/0),A=""),v){case"<":z=G+z+C+A;break;case"=":z=G+A+z+C;break;case"^":z=A.slice(0,O=A.length>>1)+G+z+C+A.slice(O);break;default:z=A+G+z+C;break}return a(z)}return q.toString=function(){return h+""},q}function d(h,f){var m=Math.max(-8,Math.min(8,Math.floor(Ir(f)/3)))*3,v=Math.pow(10,-m),x=u((h=hl(h),h.type="f",h),{suffix:pg[8+m/3]});return function(y){return x(v*y)}}return{format:u,formatPrefix:d}}var Ja,G0,K0;OC({thousands:",",grouping:[3],currency:["$",""]});function OC(e){return Ja=DC(e),G0=Ja.format,K0=Ja.formatPrefix,Ja}function FC(e){return Math.max(0,-Ir(Math.abs(e)))}function zC(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ir(t)/3)))*3-Ir(Math.abs(e)))}function IC(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ir(t)-Ir(e))+1}function Q0(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function $C(e){return function(){return e}}function BC(e){return+e}var xg=[0,1];function bs(e){return e}function $u(e,t){return(t-=e=+e)?function(s){return(s-e)/t}:$C(isNaN(t)?NaN:.5)}function HC(e,t){var s;return e>t&&(s=e,e=t,t=s),function(n){return Math.max(e,Math.min(t,n))}}function UC(e,t,s){var n=e[0],r=e[1],a=t[0],o=t[1];return r<n?(n=$u(r,n),a=s(o,a)):(n=$u(n,r),a=s(a,o)),function(l){return a(n(l))}}function VC(e,t,s){var n=Math.min(e.length,t.length)-1,r=new Array(n),a=new Array(n),o=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<n;)r[o]=$u(e[o],e[o+1]),a[o]=s(t[o],t[o+1]);return function(l){var c=pN(e,l,1,n)-1;return a[c](r[c](l))}}function J0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Z0(){var e=xg,t=xg,s=Zd,n,r,a,o=bs,l,c,u;function d(){var f=Math.min(e.length,t.length);return o!==bs&&(o=HC(e[0],e[f-1])),l=f>2?VC:UC,c=u=null,h}function h(f){return f==null||isNaN(f=+f)?a:(c||(c=l(e.map(n),t,s)))(n(o(f)))}return h.invert=function(f){return o(r((u||(u=l(t,e.map(n),ns)))(f)))},h.domain=function(f){return arguments.length?(e=Array.from(f,BC),d()):e.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),d()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),s=MS,d()},h.clamp=function(f){return arguments.length?(o=f?!0:bs,d()):o!==bs},h.interpolate=function(f){return arguments.length?(s=f,d()):s},h.unknown=function(f){return arguments.length?(a=f,h):a},function(f,m){return n=f,r=m,d()}}function WC(){return Z0()(bs,bs)}function XC(e,t,s,n){var r=wN(e,t,s),a;switch(n=hl(n??",f"),n.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=zC(r,o))&&(n.precision=a),K0(n,o)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=IC(r,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=FC(r))&&(n.precision=a-(n.type==="%")*2);break}}return G0(n)}function ey(e){var t=e.domain;return e.ticks=function(s){var n=t();return bN(n[0],n[n.length-1],s??10)},e.tickFormat=function(s,n){var r=t();return XC(r[0],r[r.length-1],s??10,n)},e.nice=function(s){s==null&&(s=10);var n=t(),r=0,a=n.length-1,o=n[r],l=n[a],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=r,r=a,a=u);d-- >0;){if(u=Au(o,l,s),u===c)return n[r]=o,n[a]=l,t(n);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function ty(){var e=WC();return e.copy=function(){return J0(e,ty())},Q0.apply(e,arguments),ey(e)}function yg(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function qC(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function YC(e){return e<0?-e*e:e*e}function GC(e){var t=e(bs,bs),s=1;function n(){return s===1?e(bs,bs):s===.5?e(qC,YC):e(yg(s),yg(1/s))}return t.exponent=function(r){return arguments.length?(s=+r,n()):s},ey(t)}function sy(){var e=GC(Z0());return e.copy=function(){return J0(e,sy()).exponent(e.exponent())},Q0.apply(e,arguments),e}function KC(){return sy.apply(null,arguments).exponent(.5)}const Za=e=>()=>e;function QC(e,{sourceEvent:t,target:s,transform:n,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},transform:{value:n,enumerable:!0,configurable:!0},_:{value:r}})}function Os(e,t,s){this.k=e,this.x=t,this.y=s}Os.prototype={constructor:Os,scale:function(e){return e===1?this:new Os(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Os(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ny=new Os(1,0,0);Os.prototype;function Ec(e){e.stopImmediatePropagation()}function li(e){e.preventDefault(),e.stopImmediatePropagation()}function JC(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function ZC(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function vg(){return this.__zoom||ny}function eE(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function tE(){return navigator.maxTouchPoints||"ontouchstart"in this}function sE(e,t,s){var n=e.invertX(t[0][0])-s[0][0],r=e.invertX(t[1][0])-s[1][0],a=e.invertY(t[0][1])-s[0][1],o=e.invertY(t[1][1])-s[1][1];return e.translate(r>n?(n+r)/2:Math.min(0,n)||Math.max(0,r),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}function nE(){var e=JC,t=ZC,s=sE,n=eE,r=tE,a=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],l=250,c=$S,u=ua("start","zoom","end"),d,h,f,m=500,v=150,x=0,y=10;function g(C){C.property("__zoom",vg).on("wheel.zoom",N,{passive:!1}).on("mousedown.zoom",U).on("dblclick.zoom",B).filter(r).on("touchstart.zoom",q).on("touchmove.zoom",z).on("touchend.zoom touchcancel.zoom",G).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(C,W,S,V){var P=C.selection?C.selection():C;P.property("__zoom",vg),C!==P?k(C,W,S,V):P.interrupt().each(function(){E(this,arguments).event(V).start().zoom(null,typeof W=="function"?W.apply(this,arguments):W).end()})},g.scaleBy=function(C,W,S,V){g.scaleTo(C,function(){var P=this.__zoom.k,O=typeof W=="function"?W.apply(this,arguments):W;return P*O},S,V)},g.scaleTo=function(C,W,S,V){g.transform(C,function(){var P=t.apply(this,arguments),O=this.__zoom,A=S==null?b(P):typeof S=="function"?S.apply(this,arguments):S,L=O.invert(A),M=typeof W=="function"?W.apply(this,arguments):W;return s(w(p(O,M),A,L),P,o)},S,V)},g.translateBy=function(C,W,S,V){g.transform(C,function(){return s(this.__zoom.translate(typeof W=="function"?W.apply(this,arguments):W,typeof S=="function"?S.apply(this,arguments):S),t.apply(this,arguments),o)},null,V)},g.translateTo=function(C,W,S,V,P){g.transform(C,function(){var O=t.apply(this,arguments),A=this.__zoom,L=V==null?b(O):typeof V=="function"?V.apply(this,arguments):V;return s(ny.translate(L[0],L[1]).scale(A.k).translate(typeof W=="function"?-W.apply(this,arguments):-W,typeof S=="function"?-S.apply(this,arguments):-S),O,o)},V,P)};function p(C,W){return W=Math.max(a[0],Math.min(a[1],W)),W===C.k?C:new Os(W,C.x,C.y)}function w(C,W,S){var V=W[0]-S[0]*C.k,P=W[1]-S[1]*C.k;return V===C.x&&P===C.y?C:new Os(C.k,V,P)}function b(C){return[(+C[0][0]+ +C[1][0])/2,(+C[0][1]+ +C[1][1])/2]}function k(C,W,S,V){C.on("start.zoom",function(){E(this,arguments).event(V).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(V).end()}).tween("zoom",function(){var P=this,O=arguments,A=E(P,O).event(V),L=t.apply(P,O),M=S==null?b(L):typeof S=="function"?S.apply(P,O):S,I=Math.max(L[1][0]-L[0][0],L[1][1]-L[0][1]),$=P.__zoom,Q=typeof W=="function"?W.apply(P,O):W,X=c($.invert(M).concat(I/$.k),Q.invert(M).concat(I/Q.k));return function(F){if(F===1)F=Q;else{var ne=X(F),ue=I/ne[2];F=new Os(ue,M[0]-ne[0]*ue,M[1]-ne[1]*ue)}A.zoom(null,F)}})}function E(C,W,S){return!S&&C.__zooming||new _(C,W)}function _(C,W){this.that=C,this.args=W,this.active=0,this.sourceEvent=null,this.extent=t.apply(C,W),this.taps=0}_.prototype={event:function(C){return C&&(this.sourceEvent=C),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(C,W){return this.mouse&&C!=="mouse"&&(this.mouse[1]=W.invert(this.mouse[0])),this.touch0&&C!=="touch"&&(this.touch0[1]=W.invert(this.touch0[0])),this.touch1&&C!=="touch"&&(this.touch1[1]=W.invert(this.touch1[0])),this.that.__zoom=W,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(C){var W=vs(this.that).datum();u.call(C,this.that,new QC(C,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:u}),W)}};function N(C,...W){if(!e.apply(this,arguments))return;var S=E(this,W).event(C),V=this.__zoom,P=Math.max(a[0],Math.min(a[1],V.k*Math.pow(2,n.apply(this,arguments)))),O=As(C);if(S.wheel)(S.mouse[0][0]!==O[0]||S.mouse[0][1]!==O[1])&&(S.mouse[1]=V.invert(S.mouse[0]=O)),clearTimeout(S.wheel);else{if(V.k===P)return;S.mouse=[O,V.invert(O)],No(this),S.start()}li(C),S.wheel=setTimeout(A,v),S.zoom("mouse",s(w(p(V,P),S.mouse[0],S.mouse[1]),S.extent,o));function A(){S.wheel=null,S.end()}}function U(C,...W){if(f||!e.apply(this,arguments))return;var S=C.currentTarget,V=E(this,W,!0).event(C),P=vs(C.view).on("mousemove.zoom",M,!0).on("mouseup.zoom",I,!0),O=As(C,S),A=C.clientX,L=C.clientY;R0(C.view),Ec(C),V.mouse=[O,this.__zoom.invert(O)],No(this),V.start();function M($){if(li($),!V.moved){var Q=$.clientX-A,X=$.clientY-L;V.moved=Q*Q+X*X>x}V.event($).zoom("mouse",s(w(V.that.__zoom,V.mouse[0]=As($,S),V.mouse[1]),V.extent,o))}function I($){P.on("mousemove.zoom mouseup.zoom",null),D0($.view,V.moved),li($),V.event($).end()}}function B(C,...W){if(e.apply(this,arguments)){var S=this.__zoom,V=As(C.changedTouches?C.changedTouches[0]:C,this),P=S.invert(V),O=S.k*(C.shiftKey?.5:2),A=s(w(p(S,O),V,P),t.apply(this,W),o);li(C),l>0?vs(this).transition().duration(l).call(k,A,V,C):vs(this).call(g.transform,A,V,C)}}function q(C,...W){if(e.apply(this,arguments)){var S=C.touches,V=S.length,P=E(this,W,C.changedTouches.length===V).event(C),O,A,L,M;for(Ec(C),A=0;A<V;++A)L=S[A],M=As(L,this),M=[M,this.__zoom.invert(M),L.identifier],P.touch0?!P.touch1&&P.touch0[2]!==M[2]&&(P.touch1=M,P.taps=0):(P.touch0=M,O=!0,P.taps=1+!!d);d&&(d=clearTimeout(d)),O&&(P.taps<2&&(h=M[0],d=setTimeout(function(){d=null},m)),No(this),P.start())}}function z(C,...W){if(this.__zooming){var S=E(this,W).event(C),V=C.changedTouches,P=V.length,O,A,L,M;for(li(C),O=0;O<P;++O)A=V[O],L=As(A,this),S.touch0&&S.touch0[2]===A.identifier?S.touch0[0]=L:S.touch1&&S.touch1[2]===A.identifier&&(S.touch1[0]=L);if(A=S.that.__zoom,S.touch1){var I=S.touch0[0],$=S.touch0[1],Q=S.touch1[0],X=S.touch1[1],F=(F=Q[0]-I[0])*F+(F=Q[1]-I[1])*F,ne=(ne=X[0]-$[0])*ne+(ne=X[1]-$[1])*ne;A=p(A,Math.sqrt(F/ne)),L=[(I[0]+Q[0])/2,(I[1]+Q[1])/2],M=[($[0]+X[0])/2,($[1]+X[1])/2]}else if(S.touch0)L=S.touch0[0],M=S.touch0[1];else return;S.zoom("touch",s(w(A,L,M),S.extent,o))}}function G(C,...W){if(this.__zooming){var S=E(this,W).event(C),V=C.changedTouches,P=V.length,O,A;for(Ec(C),f&&clearTimeout(f),f=setTimeout(function(){f=null},m),O=0;O<P;++O)A=V[O],S.touch0&&S.touch0[2]===A.identifier?delete S.touch0:S.touch1&&S.touch1[2]===A.identifier&&delete S.touch1;if(S.touch1&&!S.touch0&&(S.touch0=S.touch1,delete S.touch1),S.touch0)S.touch0[1]=this.__zoom.invert(S.touch0[0]);else if(S.end(),S.taps===2&&(A=As(A,this),Math.hypot(h[0]-A[0],h[1]-A[1])<y)){var L=vs(this).on("dblclick.zoom");L&&L.apply(this,arguments)}}}return g.wheelDelta=function(C){return arguments.length?(n=typeof C=="function"?C:Za(+C),g):n},g.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Za(!!C),g):e},g.touchable=function(C){return arguments.length?(r=typeof C=="function"?C:Za(!!C),g):r},g.extent=function(C){return arguments.length?(t=typeof C=="function"?C:Za([[+C[0][0],+C[0][1]],[+C[1][0],+C[1][1]]]),g):t},g.scaleExtent=function(C){return arguments.length?(a[0]=+C[0],a[1]=+C[1],g):[a[0],a[1]]},g.translateExtent=function(C){return arguments.length?(o[0][0]=+C[0][0],o[1][0]=+C[1][0],o[0][1]=+C[0][1],o[1][1]=+C[1][1],g):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},g.constrain=function(C){return arguments.length?(s=C,g):s},g.duration=function(C){return arguments.length?(l=+C,g):l},g.interpolate=function(C){return arguments.length?(c=C,g):c},g.on=function(){var C=u.on.apply(u,arguments);return C===u?g:C},g.clickDistance=function(C){return arguments.length?(x=(C=+C)*C,g):Math.sqrt(x)},g.tapDistance=function(C){return arguments.length?(y=+C,g):y},g}const Tc={Archaic:"#9b2335",Classical:"#e07b00",Hellenistic:"#c5b358",Republic:"#006994",Augustan:"#7851a9","Early Imperial":"#228b22","Later Imperial":"#1e90ff","Late Antique":"#8b4513","Early Medieval":"#708090",default:"#4a5568"};function rE({language:e="la",nodeType:t="author"}){const s=j.useRef(null),n=j.useRef(null),[r,a]=j.useState([]),[o,l]=j.useState([]),[c,u]=j.useState(!0),[d,h]=j.useState(null),[f,m]=j.useState(null),[v,x]=j.useState({minDegree:0,era:"all",minTier:"all"}),[y,g]=j.useState({width:800,height:600});j.useEffect(()=>{const N=()=>{if(n.current){const U=n.current.getBoundingClientRect();g({width:Math.max(U.width,400),height:Math.max(U.height,400)})}};return N(),window.addEventListener("resize",N),()=>window.removeEventListener("resize",N)},[]),j.useEffect(()=>{p()},[e,t]);const p=async()=>{u(!0),h(null);try{const[N,U]=await Promise.all([fetch(`/api/batch/network/nodes?language=${e}&type=${t}`),fetch(`/api/batch/connections?language=${e}&per_page=500`)]),B=await N.json(),q=await U.json();if(B.nodes&&a(B.nodes),q.connections){const z=q.connections.map(G=>{let C="copper";return G.stats.gold_count>0?C="gold":G.stats.silver_count>0?C="silver":G.stats.bronze_count>0&&(C="bronze"),{source:t==="author"?G.source.author:G.source.text_id,target:t==="author"?G.target.author:G.target.text_id,strength:G.stats.connection_strength,goldCount:G.stats.gold_count,silverCount:G.stats.silver_count,bronzeCount:G.stats.bronze_count,totalParallels:G.stats.total_parallels,tier:C}});l(z)}}catch(N){h("Failed to load network data"),console.error(N)}finally{u(!1)}},w=r.filter(N=>!(N.total_degree<v.minDegree||v.era!=="all"&&N.era!==v.era)),b=new Set(w.map(N=>N.id)),k=o.filter(N=>{if(!b.has(N.source)||!b.has(N.target))return!1;if(v.minTier!=="all"){const U={gold:4,silver:3,bronze:2,copper:1};if(U[N.tier]<U[v.minTier])return!1}return!0}),E={gold:"#fbbf24",silver:"#9ca3af",bronze:"#b45309",copper:"#c2410c"};j.useEffect(()=>{if(!s.current)return;const N=vs(s.current);N.selectAll("*").remove();const{width:U,height:B}=y;if(w.length===0){N.append("text").attr("x",U/2).attr("y",B/2).attr("text-anchor","middle").attr("fill","#9ca3af").text("No data available. Run a batch job to generate network data.");return}const q=new Map(w.map(F=>[F.id,{...F}])),z=w.map(F=>({id:F.id,era:F.era,inDegree:F.in_degree||0,outDegree:F.out_degree||0,totalDegree:F.total_degree||0,goldTotal:F.gold_total||0,author:F.author,work:F.work})),G=k.map(F=>({source:F.source,target:F.target,strength:F.strength||1,goldCount:F.goldCount||0,tier:F.tier||"bronze"})).filter(F=>q.has(F.source)&&q.has(F.target)),C=N.append("g"),W=nE().scaleExtent([.1,4]).on("zoom",F=>{C.attr("transform",F.transform)});N.call(W);const S=CC(z).force("link",vC(G).id(F=>F.id).distance(100)).force("charge",EC().strength(-200)).force("center",J2(U/2,B/2)).force("collision",xC().radius(F=>Math.sqrt(F.totalDegree)*3+10)),V=Xm(G,F=>F.strength)||1,P=ty().domain([0,V]).range([.5,4]),O=C.append("g").attr("class","links").selectAll("line").data(G).join("line").attr("stroke",F=>E[F.tier]||"#4b5563").attr("stroke-opacity",.6).attr("stroke-width",F=>P(F.strength)),A=Xm(z,F=>F.totalDegree)||1,L=KC().domain([0,A]).range([4,30]),M=C.append("g").attr("class","nodes").selectAll("circle").data(z).join("circle").attr("r",F=>L(F.totalDegree)).attr("fill",F=>Tc[F.era]||Tc.default).attr("stroke","#1f2937").attr("stroke-width",1.5).style("cursor","pointer").call(cS().on("start",$).on("drag",Q).on("end",X)).on("click",(F,ne)=>{m(ne)});M.append("title").text(F=>`${F.id}
Era: ${F.era||"Unknown"}
In-degree: ${F.inDegree}
Out-degree: ${F.outDegree}`);const I=C.append("g").attr("class","labels").selectAll("text").data(z.filter(F=>F.totalDegree>A*.2)).join("text").attr("text-anchor","middle").attr("dy",F=>L(F.totalDegree)+12).attr("fill","#d1d5db").attr("font-size","10px").text(F=>F.id.length>15?F.id.substring(0,12)+"...":F.id);S.on("tick",()=>{O.attr("x1",F=>F.source.x).attr("y1",F=>F.source.y).attr("x2",F=>F.target.x).attr("y2",F=>F.target.y),M.attr("cx",F=>F.x).attr("cy",F=>F.y),I.attr("x",F=>F.x).attr("y",F=>F.y)});function $(F){F.active||S.alphaTarget(.3).restart(),F.subject.fx=F.subject.x,F.subject.fy=F.subject.y}function Q(F){F.subject.fx=F.x,F.subject.fy=F.y}function X(F){F.active||S.alphaTarget(0),F.subject.fx=null,F.subject.fy=null}return()=>{S.stop()}},[w,k,y]);const _=[...new Set(r.map(N=>N.era).filter(Boolean))].sort();return i.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 h-full flex flex-col",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 items-center",children:[i.jsx("h3",{className:"text-lg font-semibold text-amber-400",children:"Network Graph"}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm text-gray-400",children:"Min Degree:"}),i.jsx("input",{type:"range",min:"0",max:Math.max(...r.map(N=>N.total_degree||0),10),value:v.minDegree,onChange:N=>x(U=>({...U,minDegree:parseInt(N.target.value)})),className:"w-24"}),i.jsx("span",{className:"text-sm text-gray-300",children:v.minDegree})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm text-gray-400",children:"Era:"}),i.jsxs("select",{value:v.era,onChange:N=>x(U=>({...U,era:N.target.value})),className:"bg-gray-700 text-gray-200 rounded px-2 py-1 text-sm",children:[i.jsx("option",{value:"all",children:"All Eras"}),_.map(N=>i.jsx("option",{value:N,children:N},N))]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm text-gray-400",children:"Min Tier:"}),i.jsxs("select",{value:v.minTier,onChange:N=>x(U=>({...U,minTier:N.target.value})),className:"bg-gray-700 text-gray-200 rounded px-2 py-1 text-sm",children:[i.jsx("option",{value:"all",children:"All Tiers"}),i.jsx("option",{value:"copper",children:"Copper+"}),i.jsx("option",{value:"bronze",children:"Bronze+"}),i.jsx("option",{value:"silver",children:"Silver+"}),i.jsx("option",{value:"gold",children:"Gold Only"})]})]}),i.jsxs("div",{className:"text-sm text-gray-400",children:[w.length," nodes, ",k.length," edges"]})]}),i.jsxs("div",{className:"flex gap-4 mb-3 flex-wrap items-center",children:[i.jsx("div",{className:"flex gap-3",children:Object.entries(Tc).filter(([N])=>N!=="default").slice(0,6).map(([N,U])=>i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:U}}),i.jsx("span",{className:"text-xs text-gray-400",children:N})]},N))}),i.jsxs("div",{className:"border-l border-gray-600 pl-3 flex gap-3",children:[i.jsx("span",{className:"text-xs text-gray-500",children:"Edges:"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-8 h-1 rounded",style:{backgroundColor:"#fbbf24"}}),i.jsx("span",{className:"text-xs text-gray-400",children:"Gold"})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-8 h-1 rounded",style:{backgroundColor:"#9ca3af"}}),i.jsx("span",{className:"text-xs text-gray-400",children:"Silver"})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-8 h-1 rounded",style:{backgroundColor:"#b45309"}}),i.jsx("span",{className:"text-xs text-gray-400",children:"Bronze"})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-8 h-1 rounded",style:{backgroundColor:"#c2410c"}}),i.jsx("span",{className:"text-xs text-gray-400",children:"Copper"})]})]})]}),i.jsxs("div",{ref:n,className:"flex-1 relative min-h-[400px] bg-gray-900 rounded",children:[c&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/80",children:i.jsx("div",{className:"text-gray-400",children:"Loading network data..."})}),d&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900/80",children:i.jsx("div",{className:"text-red-400",children:d})}),i.jsx("svg",{ref:s,width:y.width,height:y.height,className:"w-full h-full"})]}),f&&i.jsxs("div",{className:"mt-4 p-3 bg-gray-700 rounded",children:[i.jsx("h4",{className:"font-semibold text-amber-300 mb-2",children:f.id}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-400",children:"Era:"})," ",i.jsx("span",{className:"text-gray-200",children:f.era||"Unknown"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-400",children:"In-degree (cited):"})," ",i.jsx("span",{className:"text-gray-200",children:f.inDegree})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-400",children:"Out-degree (citing):"})," ",i.jsx("span",{className:"text-gray-200",children:f.outDegree})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-400",children:"Gold connections:"})," ",i.jsx("span",{className:"text-yellow-400",children:f.goldTotal})]})]}),i.jsx("button",{onClick:()=>m(null),className:"mt-2 text-sm text-gray-400 hover:text-gray-200",children:"Close"})]})]})}function iE(){const[e,t]=j.useState("la"),[s,n]=j.useState("author"),[r,a]=j.useState("network");return i.jsxs("div",{className:"p-4 sm:p-6 min-h-screen",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-red-700 mb-2",children:"Distant Reading Visualizations"}),i.jsx("p",{className:"text-gray-400",children:"Explore large-scale patterns of literary influence across the classical corpus. These visualizations reveal connections invisible through traditional close reading."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 mb-6",children:[i.jsx("button",{onClick:()=>a("network"),className:`px-4 py-2 rounded ${r==="network"?"bg-amber-600 text-white":"bg-gray-700 text-gray-300"}`,children:"Network Graph"}),i.jsx("button",{onClick:()=>a("sankey"),className:`px-4 py-2 rounded ${r==="sankey"?"bg-amber-600 text-white":"bg-gray-700 text-gray-300"}`,children:"Era Flow (Coming Soon)"}),i.jsx("button",{onClick:()=>a("rankings"),className:`px-4 py-2 rounded ${r==="rankings"?"bg-amber-600 text-white":"bg-gray-700 text-gray-300"}`,children:"Centrality Rankings (Coming Soon)"})]}),i.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 p-3 bg-gray-800 rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm text-gray-400",children:"Language:"}),i.jsxs("select",{value:e,onChange:o=>t(o.target.value),className:"bg-gray-700 text-gray-200 rounded px-3 py-1",children:[i.jsx("option",{value:"la",children:"Latin"}),i.jsx("option",{value:"grc",children:"Greek"}),i.jsx("option",{value:"en",children:"English"})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("label",{className:"text-sm text-gray-400",children:"Node Type:"}),i.jsxs("select",{value:s,onChange:o=>n(o.target.value),className:"bg-gray-700 text-gray-200 rounded px-3 py-1",children:[i.jsx("option",{value:"author",children:"Authors"}),i.jsx("option",{value:"work",children:"Works"})]})]}),i.jsx("div",{className:"flex-1 text-right",children:i.jsx("a",{href:"/api/docs",target:"_blank",className:"text-sm text-amber-400 hover:text-amber-300",children:"API Documentation"})})]}),i.jsxs("div",{className:"bg-gray-900 rounded-lg min-h-[500px]",children:[r==="network"&&i.jsx(rE,{language:e,nodeType:s}),r==="sankey"&&i.jsx("div",{className:"flex items-center justify-center h-[500px] text-gray-500",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("p",{children:"Era-to-Era Flow Diagram"}),i.jsx("p",{className:"text-sm mt-2",children:"Coming soon - will show how literary influence flows across time periods"})]})}),r==="rankings"&&i.jsx("div",{className:"flex items-center justify-center h-[500px] text-gray-500",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-6xl mb-4",children:""}),i.jsx("p",{children:"Centrality Rankings"}),i.jsx("p",{className:"text-sm mt-2",children:"Coming soon - will show the most-cited and most-citing works"})]})})]}),i.jsxs("div",{className:"mt-6 p-4 bg-gray-800 rounded-lg",children:[i.jsx("h3",{className:"text-lg font-semibold text-amber-300 mb-2",children:"Methodology"}),i.jsx("p",{className:"text-sm text-gray-400 mb-3",children:"Connections are identified using a multi-signal composite scoring system that correlates four independent matching algorithms for high precision:"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"p-3 bg-gray-700 rounded",children:[i.jsx("div",{className:"font-semibold text-amber-200",children:"Lemma Matching"}),i.jsx("div",{className:"text-sm text-gray-400",children:"Threshold: 7+ shared lemmas"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Dictionary-normalized word comparison"})]}),i.jsxs("div",{className:"p-3 bg-gray-700 rounded",children:[i.jsx("div",{className:"font-semibold text-amber-200",children:"Semantic Similarity"}),i.jsx("div",{className:"text-sm text-gray-400",children:"Threshold: 0.7+ cosine similarity"}),i.jsx("div",{className:"text-xs text-gray-500",children:"SPhilBERTa neural embeddings"})]}),i.jsxs("div",{className:"p-3 bg-gray-700 rounded",children:[i.jsx("div",{className:"font-semibold text-amber-200",children:"Sound Matching"}),i.jsx("div",{className:"text-sm text-gray-400",children:"Threshold: 0.6+ phonetic similarity"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Phonetic transcription comparison"})]}),i.jsxs("div",{className:"p-3 bg-gray-700 rounded",children:[i.jsx("div",{className:"font-semibold text-amber-200",children:"Edit Distance"}),i.jsx("div",{className:"text-sm text-gray-400",children:"Threshold: 0.5+ similarity"}),i.jsx("div",{className:"text-xs text-gray-500",children:"Character-level Levenshtein distance"})]})]}),i.jsxs("div",{className:"mt-4 flex flex-wrap gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"px-2 py-1 bg-yellow-600 rounded text-xs font-semibold",children:"GOLD"}),i.jsx("span",{className:"text-sm text-gray-400",children:"4 signals confirm"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"px-2 py-1 bg-gray-500 rounded text-xs font-semibold",children:"SILVER"}),i.jsx("span",{className:"text-sm text-gray-400",children:"3 signals confirm"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"px-2 py-1 bg-amber-800 rounded text-xs font-semibold",children:"BRONZE"}),i.jsx("span",{className:"text-sm text-gray-400",children:"2 signals confirm"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"px-2 py-1 bg-orange-900 rounded text-xs font-semibold",children:"COPPER"}),i.jsx("span",{className:"text-sm text-gray-400",children:"1 signal confirms"})]})]})]})]})}const aE=e=>{const[t,s]=j.useState([]),[n,r]=j.useState([]),[a,o]=j.useState([]),[l,c]=j.useState(!0),[u,d]=j.useState(null);j.useEffect(()=>{e&&(c(!0),d(null),s([]),r([]),o([]),Promise.all([$b(e),Bb(e)]).then(([f,m])=>{const v=Array.isArray(f)?f:f.texts||[];s(v);const x=Array.isArray(m)?m:m.authors||[],y=x.map(p=>{var w,b,k;return{author:p.name||p.author,author_key:((b=(w=p.works)==null?void 0:w[0])==null?void 0:b.author_key)||((k=p.name)==null?void 0:k.toLowerCase().replace(/\s+/g,"_"))||"",era:p.era,year:p.year,works:p.works||[]}});r(y);const g=x.map(p=>{var k,E,_;const w=((E=(k=p.works)==null?void 0:k[0])==null?void 0:E.author_key)||((_=p.name)==null?void 0:_.toLowerCase().replace(/\s+/g,"_"))||"",b={};return(p.works||[]).forEach(N=>{var B;const U=N.work_key||((B=N.work)==null?void 0:B.toLowerCase().replace(/\s+/g,"_"))||"";b[U]||(b[U]={work_key:U,work:N.work||N.title,sections:[]}),b[U].sections.push({file:N.id,label:N.is_part&&N.part||N.title})}),{author:p.name||p.author,author_key:w,works:Object.values(b)}});o(g),c(!1)}).catch(f=>{d(f.message),c(!1)}))},[e]);const h=j.useCallback(async f=>Hb(f),[]);return{corpus:t,authors:n,hierarchy:a,loading:l,error:u,getTextsForAuthor:h}},oE=()=>{const[e,t]=j.useState([]),[s,n]=j.useState(!1),[r,a]=j.useState(null),[o,l]=j.useState(0),[c,u]=j.useState(""),[d,h]=j.useState(0),[f,m]=j.useState(null),v=j.useRef(null),x=j.useRef(null),y=j.useRef(null);j.useEffect(()=>(s?(y.current=Date.now(),h(0),x.current=setInterval(()=>{h(Math.floor((Date.now()-y.current)/1e3))},1e3)):x.current&&(clearInterval(x.current),x.current=null),()=>{x.current&&clearInterval(x.current)}),[s]);const g=j.useCallback(async _=>{var U;v.current&&v.current.abort(),v.current=new AbortController,n(!0),a(null),l(0),u(""),m(null);const N=(B,q,z)=>{u(q?`${B}: ${q}`:B),h(Math.floor(z))};try{const B=_.match_type||((U=_.settings)==null?void 0:U.match_type),q=B==="semantic_cross"||B==="dictionary_cross";let z;q?z=await Ub(_,v.current.signal):z=await Vb(_,N,v.current.signal),t(z.results||[]),m({elapsed_time:z.elapsed_time,source_lines:z.source_lines,target_lines:z.target_lines}),l(100),u("Complete")}catch(B){B.name!=="AbortError"&&a(B.message||"Search failed")}finally{n(!1)}},[]),p=j.useCallback(async _=>{v.current&&v.current.abort(),v.current=new AbortController,n(!0),a(null);try{const N=await Wb(_,v.current.signal);return t(N.results||[]),N}catch(N){N.name!=="AbortError"&&a(N.message||"Search failed")}finally{n(!1)}},[]),w=j.useCallback(async _=>{v.current&&v.current.abort(),v.current=new AbortController,n(!0),a(null);try{const N=await Xb(_,v.current.signal);return t(N.results||N.shared_words||[]),N}catch(N){N.name!=="AbortError"&&a(N.message||"Search failed")}finally{n(!1)}},[]),b=j.useCallback(async _=>{v.current&&v.current.abort(),v.current=new AbortController,n(!0),a(null);try{const N=await qb(_,v.current.signal);return N.error?(a(N.error),t([]),N):(t(N.results||N.shared_bigrams||[]),N)}catch(N){N.name!=="AbortError"&&a(N.message||"Search failed")}finally{n(!1)}},[]),k=j.useCallback(()=>{v.current&&(v.current.abort(),v.current=null),n(!1),l(0),u("")},[]),E=j.useCallback(()=>{t([]),a(null)},[]);return{results:e,loading:s,error:r,progress:o,progressText:c,elapsedTime:d,searchStats:f,search:g,searchCrossLingual:p,searchRareWords:w,searchWordPairs:b,cancel:k,clearResults:E}},eo=(e,t)=>{try{const s=sessionStorage.getItem("tesserae_"+e);return s!==null?s:t}catch{return t}},to=(e,t)=>{try{sessionStorage.setItem("tesserae_"+e,t)}catch{}},bg={"/":"search","/browse":"browse","/repository":"repository","/line-search":"line-search","/string-search":"string-search","/visualize":"visualizations","/downloads":"downloads","/about":"about","/help":"help","/privacy":"privacy","/admin":"admin"},lE={search:"/",browse:"/browse",repository:"/repository","line-search":"/line-search","string-search":"/string-search",visualizations:"/visualize",downloads:"/downloads",about:"/about",help:"/help",privacy:"/privacy",admin:"/admin"},cE=()=>{const e=new URLSearchParams(window.location.search);return{source:e.get("source")||"",target:e.get("target")||"",source_author:e.get("source_author")||"",target_author:e.get("target_author")||"",lang:e.get("lang")||e.get("language")||"",tab:e.get("tab")||"",match_type:e.get("match_type")||"",min_matches:e.get("min_matches")?parseInt(e.get("min_matches")):null}},uE=(e,t,s,n,r,a)=>{const o=new URLSearchParams;return e&&o.set("source",e),t&&o.set("target",t),s&&o.set("source_author",s),n&&o.set("target_author",n),r&&o.set("lang",r),a.match_type&&o.set("match_type",a.match_type),a.min_matches&&o.set("min_matches",a.min_matches),`${window.location.origin}/?${o.toString()}`};function dE(){const[e,t]=j.useState(null),[s,n]=j.useState(()=>{const Z=window.location.pathname;return bg[Z]||"search"}),[r,a]=j.useState(()=>{const Z=new URLSearchParams(window.location.search),ge=Z.get("lang")||Z.get("language");return ge&&["la","grc","en","cross"].includes(ge)?ge:"la"}),[o,l]=j.useState(()=>{const Z=sessionStorage.getItem("tesserae_goto_tab");if(Z&&["parallel","line","string","hapax","bigram"].includes(Z))return sessionStorage.removeItem("tesserae_goto_tab"),Z;const ze=new URLSearchParams(window.location.search).get("tab");return ze&&["parallel","line","string","hapax","bigram"].includes(ze)?ze:"parallel"}),[c,u]=j.useState("texts"),[d,h]=j.useState(()=>eo("sourceAuthor","")),[f,m]=j.useState(()=>eo("sourceText","")),[v,x]=j.useState(()=>eo("targetAuthor","")),[y,g]=j.useState(()=>eo("targetText","")),[p,w]=j.useState({match_type:"lemma",min_matches:2,stoplist_basis:"source_target",stoplist_size:0,custom_stopwords:"",source_unit_type:"line",target_unit_type:"line",max_distance:999,max_results:0,bigram_boost:!1}),[b,k]=j.useState(!1),[E,_]=j.useState(50),[N,U]=j.useState("score"),[B,q]=j.useState(!1),[z,G]=j.useState(null),[C,W]=j.useState(0),[S,V]=j.useState(""),[P,O]=j.useState(null),[A,L]=j.useState(!1),[M,I]=j.useState(null),[$,Q]=j.useState(null),[X,F]=j.useState(0),[ne,ue]=j.useState(!1),{corpus:ie,authors:D,hierarchy:R,loading:Y,getTextsForAuthor:K}=aE(r),{results:te,loading:ce,error:de,searchStats:he,progressText:re,elapsedTime:fe,search:ye,searchRareWords:ae,searchWordPairs:xe,cancel:be,clearResults:Ne}=oE();j.useEffect(()=>{fetch("/api/auth/user").then(Z=>Z.json()).then(Z=>{if(Z.user){const ge=Z.user.first_name||"",ze=Z.user.last_name||"";Z.user.name=Z.user.orcid_name||`${ge} ${ze}`.trim()||"Account"}t(Z.user)}).catch(()=>{})},[]),j.useEffect(()=>{const Z=cE();Z.lang&&["la","grc","en","cross"].includes(Z.lang)&&a(Z.lang),Z.tab&&["parallel","line","string","hapax","bigram"].includes(Z.tab)&&l(Z.tab),Z.source_author&&h(Z.source_author),Z.target_author&&x(Z.target_author),Z.source&&m(Z.source),Z.target&&g(Z.target),Z.match_type&&w(ge=>({...ge,match_type:Z.match_type})),Z.min_matches&&w(ge=>({...ge,min_matches:Z.min_matches}))},[]),j.useEffect(()=>{const Z=lE[s]||"/";window.location.pathname!==Z&&window.history.pushState({},"",Z+window.location.search)},[s]),j.useEffect(()=>{const Z=()=>{const ge=window.location.pathname;n(bg[ge]||"search")};return window.addEventListener("popstate",Z),()=>window.removeEventListener("popstate",Z)},[]);const Ce=j.useRef(null),ve=j.useRef(null);j.useEffect(()=>{var st,Je,Ge;const Z=Ce.current!==null&&Ce.current!==r;Ce.current=r,Z&&(Ne(),O(null),I(null),F(0),ue(!1));const ge=ie.length>0&&((st=ie[0])==null?void 0:st.language)===r,ze=ge&&ve.current!==r;if(ze&&(ve.current=r),ge&&(ze||!f||!y)){let Ve,Oe;r==="grc"?(Ve="homer.iliad.part.1.tess",Oe="apollonius_rhodius.argonautica.part.1.tess"):r==="en"?(Ve="shakespeare.hamlet.tess",Oe="cowper.task.tess"):(Ve="vergil.aeneid.tess",Oe="lucan.bellum_civile.tess");const H=ie.find(oe=>oe.id===Ve)||ie[0],se=ie.find(oe=>oe.id===Oe)||ie[1]||ie[0];H&&(h(H.author_key||((Je=H.author)==null?void 0:Je.toLowerCase().replace(/\s+/g,"_"))||""),m(H.id)),se&&(x(se.author_key||((Ge=se.author)==null?void 0:Ge.toLowerCase().replace(/\s+/g,"_"))||""),g(se.id))}},[r,ie,f,y,Ne]),j.useEffect(()=>{Ne(),O(null),I(null),F(0),ue(!1)},[o,Ne]),j.useEffect(()=>{to("sourceAuthor",d)},[d]),j.useEffect(()=>{to("sourceText",f)},[f]),j.useEffect(()=>{to("targetAuthor",v)},[v]),j.useEffect(()=>{to("targetText",y)},[y]);const Me=j.useCallback(async()=>{if(!f||!y)return;const Z={source:f,target:y,language:r,...p};o==="parallel"?await ye(Z):o==="hapax"?await ae(Z):o==="bigram"&&await xe(Z)},[f,y,r,p,o,ye,ae,xe]),Pe=j.useCallback(Z=>{G(Z),W(0),q(!0)},[]),et=j.useCallback(async Z=>{var Je,Ge,Ve,Oe;let ge,ze;if(typeof Z=="string"?(ge=Z.split(/\s*\+\s*|\s+/).filter(Boolean),ze={source:{ref:"Rare Word/Pair Search",text:Z},target:{ref:"",text:""},lemmas:ge}):(ge=(Z.matched_words||[]).map(H=>typeof H=="object"?H.lemma||H.word||"":H).filter(Boolean),ze={source:{ref:Z.source_locus||((Je=Z.source)==null?void 0:Je.ref),text:Z.source_text||((Ge=Z.source)==null?void 0:Ge.text)},target:{ref:Z.target_locus||((Ve=Z.target)==null?void 0:Ve.ref),text:Z.target_text||((Oe=Z.target)==null?void 0:Oe.text)},lemmas:ge}),ge.length<1){alert("At least 1 word is required for corpus search");return}I(ze),O(null),Q(null),L(!0),ue(!0),F(0);const tt=Date.now(),st=setInterval(()=>{F(Math.floor((Date.now()-tt)/1e3))},1e3);try{const se=await(await fetch("/api/corpus-search",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lemmas:ge,language:r,exclude_texts:[f,y].filter(Boolean)})})).json();clearInterval(st),se.error?Q(se.error):O(se.results||[])}catch{clearInterval(st),Q("Corpus search failed. Please try again.")}L(!1)},[r,f,y]),Re=j.useCallback(async()=>{var Z,ge,ze,tt,st,Je;if(z)try{const Ge=z.source_locus||((Z=z.source)==null?void 0:Z.ref)||"",Ve=z.source_text||z.source_snippet||((ge=z.source)==null?void 0:ge.text)||"",Oe=z.target_locus||((ze=z.target)==null?void 0:ze.ref)||"",H=z.target_text||z.target_snippet||((tt=z.target)==null?void 0:tt.text)||"",se=z.source_text_id||((st=z.source)==null?void 0:st.text_id)||(Ve==null?void 0:Ve.split(" ")[0])||"unknown",oe=z.target_text_id||((Je=z.target)==null?void 0:Je.text_id)||(H==null?void 0:H.split(" ")[0])||"unknown",me=(z.matched_words||[]).map(Ie=>typeof Ie=="object"?Ie.lemma||Ie.word||"":Ie).filter(Boolean),je=await fetch("/api/intertexts",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:{text_id:se,reference:Ge,snippet:Ve,language:r},target:{text_id:oe,reference:Oe,snippet:H,language:r},matched_lemmas:me,tesserae_score:z.score||z.overall_score||0,user_score:C,notes:S.trim().slice(0,500)})});if(!je.ok){const Ie=await je.json();alert("Failed to register: "+(Ie.error||"Unknown error"));return}q(!1),G(null),W(0),V(""),n("repository"),window.history.pushState({},"","/repository")}catch(Ge){console.error("Failed to register intertext:",Ge),alert("Failed to register intertext: "+Ge.message)}},[z,r,C,S]),qs=Array.isArray(te)?[...te].sort((Z,ge)=>N==="score"?(ge.score||0)-(Z.score||0):N==="source_locus"?(Z.source_locus||"").localeCompare(ge.source_locus||"",void 0,{numeric:!0}):N==="target_locus"?(Z.target_locus||"").localeCompare(ge.target_locus||"",void 0,{numeric:!0}):0):[];return i.jsxs("div",{className:"min-h-screen bg-gray-100",children:[i.jsx(Kb,{user:e,setUser:t}),i.jsx(Zb,{pageType:s,setPageType:n,activeTab:r,setActiveTab:a,onLanguageReset:()=>{h(""),m(""),x(""),g(""),l("parallel")}}),i.jsxs("main",{className:"max-w-7xl mx-auto px-3 sm:px-6 py-4 sm:py-6",children:[s==="search"&&r!=="cross"&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["Search ",r==="la"?"Latin":r==="grc"?"Greek":"English"," Texts"]}),i.jsx(Y1,{sourceAuthor:d,sourceText:f,targetAuthor:v,targetText:y,settings:p,activeTab:r,onLoad:Z=>{a(Z.language),h(Z.sourceAuthor),m(Z.sourceText),x(Z.targetAuthor),g(Z.targetText),Z.settings&&w(Z.settings)}}),f&&y&&i.jsxs("button",{onClick:()=>{const Z=uE(f,y,d,v,r,p);navigator.clipboard.writeText(Z),alert("Search link copied to clipboard!")},className:"text-sm text-gray-500 hover:text-red-600 flex items-center gap-1",title:"Copy shareable link",children:[i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),"Share"]})]}),i.jsx(ew,{searchMode:o,setSearchMode:l})]}),o==="line"?i.jsx(Dm,{language:r},r):o==="string"?i.jsx(Fm,{language:r}):Y?i.jsx(Kt,{text:"Loading corpus..."}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 mb-6",children:[i.jsx(wf,{label:"Source",language:r,authors:D,selectedAuthor:d,setSelectedAuthor:h,selectedText:f,setSelectedText:m,hierarchy:R,fetchTexts:K}),i.jsx(wf,{label:"Target",language:r,authors:D,selectedAuthor:v,setSelectedAuthor:x,selectedText:y,setSelectedText:g,hierarchy:R,fetchTexts:K})]}),o==="parallel"&&i.jsx(tw,{settings:p,setSettings:w,showAdvanced:b,setShowAdvanced:k,language:r}),i.jsx("div",{className:"flex justify-center mt-6",children:ce?i.jsx("button",{onClick:be,className:"px-6 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-200",children:"Cancel Search"}):i.jsx("button",{onClick:Me,disabled:!f||!y,className:"px-6 py-2 bg-red-700 text-white rounded-lg hover:bg-red-800 disabled:opacity-50 disabled:cursor-not-allowed",children:o==="parallel"?"Find Parallels":o==="hapax"?"Find Rare Words":"Find Rare Pairs"})})]})]}),(te.length>0||ce||de)&&!ne&&i.jsx("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:o==="hapax"||o==="bigram"?i.jsx(Z1,{results:te,loading:ce,error:de,displayLimit:E,setDisplayLimit:_,searchMode:o,sourceText:f,targetText:y,onRegister:Pe,onCorpusSearch:et,elapsedTime:fe}):i.jsx(U1,{results:qs,loading:ce,error:de,displayLimit:E,setDisplayLimit:_,onRegister:Pe,onCorpusSearch:et,sortBy:N,setSortBy:U,searchStats:he,sourceTextInfo:ie.find(Z=>Z.id===f),targetTextInfo:ie.find(Z=>Z.id===y),elapsedTime:fe,progressText:re,matchType:p.match_type})}),ne&&i.jsx(J1,{results:P,loading:A,error:$,query:M,elapsedTime:X,onBack:()=>ue(!1)})]}),s==="search"&&r==="cross"&&i.jsx(W1,{}),s==="browse"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex gap-2 mb-4",children:[i.jsx("button",{onClick:()=>u("texts"),className:`px-4 py-2 rounded text-sm ${c==="texts"?"bg-red-700 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:"Browse Texts"}),i.jsx("button",{onClick:()=>u("rare"),className:`px-4 py-2 rounded text-sm ${c==="rare"?"bg-red-700 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:"Rare Words Explorer"})]}),i.jsx("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:c==="texts"?i.jsx(eN,{}):i.jsx(tN,{})})]}),s==="repository"&&i.jsx(iN,{user:e}),s==="line-search"&&i.jsx("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:i.jsx(Dm,{language:r},r)}),s==="string-search"&&i.jsx("div",{className:"bg-white rounded-lg shadow p-4 sm:p-6",children:i.jsx(Fm,{language:r})}),s==="about"&&i.jsx(lN,{}),s==="help"&&i.jsx(cN,{}),s==="downloads"&&i.jsx(uN,{}),s==="privacy"&&i.jsx(dN,{}),s==="admin"&&i.jsx(oN,{}),s==="visualizations"&&i.jsx(iE,{})]}),i.jsx(Gi,{isOpen:B,onClose:()=>{q(!1),G(null),V("")},title:"Register Intertext",children:z&&(()=>{var st,Je,Ge,Ve;const Z=z.source_locus||((st=z.source)==null?void 0:st.ref)||"",ge=z.source_text||z.source_snippet||((Je=z.source)==null?void 0:Je.text)||"",ze=z.target_locus||((Ge=z.target)==null?void 0:Ge.ref)||"",tt=z.target_text||z.target_snippet||((Ve=z.target)==null?void 0:Ve.text)||"";return i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-gray-600",children:"Register this parallel to the Intertext Repository for future reference and sharing."}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded",children:[i.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Source"}),i.jsx("div",{className:"font-medium text-red-700",children:Z}),i.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:[ge==null?void 0:ge.substring(0,100),(ge==null?void 0:ge.length)>100?"...":""]}),i.jsx("div",{className:"text-sm text-gray-500 mt-3 mb-1",children:"Target"}),i.jsx("div",{className:"font-medium text-amber-600",children:ze}),i.jsxs("div",{className:"text-sm text-gray-700 mt-1",children:[tt==null?void 0:tt.substring(0,100),(tt==null?void 0:tt.length)>100?"...":""]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx("div",{className:"text-sm text-gray-600 mb-2",children:"Rate this parallel (optional):"}),i.jsxs("div",{className:"flex gap-1",children:[[1,2,3,4,5].map(Oe=>i.jsx("button",{type:"button",onClick:()=>W(Oe===C?0:Oe),className:`text-2xl ${Oe<=C?"text-yellow-500":"text-gray-300"} hover:text-yellow-400 transition-colors`,children:""},Oe)),C>0&&i.jsxs("span",{className:"ml-2 text-sm text-gray-500 self-center",children:[C,"/5"]})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsx("label",{className:"text-sm text-gray-600 mb-2 block",children:"Notes (optional, max 500 characters):"}),i.jsx("textarea",{value:S,onChange:Oe=>V(Oe.target.value.slice(0,500)),placeholder:"Add scholarly commentary, interpretation, or notes about this parallel...",className:"w-full px-3 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-red-500 focus:border-transparent resize-none",rows:3,maxLength:500}),i.jsxs("div",{className:"text-xs text-gray-400 text-right mt-1",children:[S.length,"/500"]})]}),i.jsxs("div",{className:"flex gap-3 justify-end",children:[i.jsx("button",{onClick:()=>{q(!1),G(null),W(0),V("")},className:"px-4 py-2 bg-gray-100 text-gray-700 border border-gray-300 rounded hover:bg-gray-200",children:"Cancel"}),i.jsx("button",{onClick:Re,className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800",children:"Register"})]})]})})()}),i.jsx("footer",{className:"bg-gray-100 border-t mt-8 py-4",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 text-center text-sm text-gray-500",children:i.jsx("p",{children:"Tesserae V6"})})})]})}Lc.createRoot(document.getElementById("root")).render(i.jsx(Ey.StrictMode,{children:i.jsx(dE,{})}));
